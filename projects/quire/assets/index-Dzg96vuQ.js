var hm=f=>{throw TypeError(f)};var dd=(f,t,s)=>t.has(f)||hm("Cannot "+s);var qs=(f,t,s)=>(dd(f,t,"read from private field"),s?s.call(f):t.get(f)),_a=(f,t,s)=>t.has(f)?hm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(f):t.set(f,s),Er=(f,t,s,n)=>(dd(f,t,"write to private field"),n?n.call(f,s):t.set(f,s),s),uo=(f,t,s)=>(dd(f,t,"access private method"),s);var fm=(f,t,s,n)=>({set _(r){Er(f,t,r,s)},get _(){return qs(f,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=s(r);fetch(r.href,l)}})();var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function qA(f){if(Object.prototype.hasOwnProperty.call(f,"__esModule"))return f;var t=f.default;if(typeof t=="function"){var s=function n(){var r=!1;try{r=this instanceof n}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(f).forEach(function(n){var r=Object.getOwnPropertyDescriptor(f,n);Object.defineProperty(s,n,r.get?r:{enumerable:!0,get:function(){return f[n]}})}),s}var hd={exports:{}},Cr={};var gm;function yv(){if(gm)return Cr;gm=1;var f=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function s(n,r,l){var o=null;if(l!==void 0&&(o=""+l),r.key!==void 0&&(o=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:f,type:n,key:o,ref:r!==void 0?r:null,props:l}}return Cr.Fragment=t,Cr.jsx=s,Cr.jsxs=s,Cr}var pm;function vv(){return pm||(pm=1,hd.exports=yv()),hd.exports}var m=vv(),fd={exports:{}},Bt={};var mm;function xv(){if(mm)return Bt;mm=1;var f=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),v=Symbol.iterator;function x(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function A(M,L,J){this.props=M,this.context=L,this.refs=S,this.updater=J||_}A.prototype.isReactComponent={},A.prototype.setState=function(M,L){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,L,"setState")},A.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function E(){}E.prototype=A.prototype;function N(M,L,J){this.props=M,this.context=L,this.refs=S,this.updater=J||_}var R=N.prototype=new E;R.constructor=N,w(R,A.prototype),R.isPureReactComponent=!0;var O=Array.isArray;function G(){}var I={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function Y(M,L,J){var rt=J.ref;return{$$typeof:f,type:M,key:L,ref:rt!==void 0?rt:null,props:J}}function W(M,L){return Y(M.type,L,M.props)}function gt(M){return typeof M=="object"&&M!==null&&M.$$typeof===f}function z(M){var L={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(J){return L[J]})}var Q=/\/+/g;function T(M,L){return typeof M=="object"&&M!==null&&M.key!=null?z(""+M.key):L.toString(36)}function lt(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(G,G):(M.status="pending",M.then(function(L){M.status==="pending"&&(M.status="fulfilled",M.value=L)},function(L){M.status==="pending"&&(M.status="rejected",M.reason=L)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function H(M,L,J,rt,nt){var _t=typeof M;(_t==="undefined"||_t==="boolean")&&(M=null);var xt=!1;if(M===null)xt=!0;else switch(_t){case"bigint":case"string":case"number":xt=!0;break;case"object":switch(M.$$typeof){case f:case t:xt=!0;break;case g:return xt=M._init,H(xt(M._payload),L,J,rt,nt)}}if(xt)return nt=nt(M),xt=rt===""?"."+T(M,0):rt,O(nt)?(J="",xt!=null&&(J=xt.replace(Q,"$&/")+"/"),H(nt,L,J,"",function(At){return At})):nt!=null&&(gt(nt)&&(nt=W(nt,J+(nt.key==null||M&&M.key===nt.key?"":(""+nt.key).replace(Q,"$&/")+"/")+xt)),L.push(nt)),1;xt=0;var Et=rt===""?".":rt+":";if(O(M))for(var ot=0;ot<M.length;ot++)rt=M[ot],_t=Et+T(rt,ot),xt+=H(rt,L,J,_t,nt);else if(ot=x(M),typeof ot=="function")for(M=ot.call(M),ot=0;!(rt=M.next()).done;)rt=rt.value,_t=Et+T(rt,ot++),xt+=H(rt,L,J,_t,nt);else if(_t==="object"){if(typeof M.then=="function")return H(lt(M),L,J,rt,nt);throw L=String(M),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return xt}function D(M,L,J){if(M==null)return M;var rt=[],nt=0;return H(M,rt,"","",function(_t){return L.call(J,_t,nt++)}),rt}function X(M){if(M._status===-1){var L=M._result;L=L(),L.then(function(J){(M._status===0||M._status===-1)&&(M._status=1,M._result=J)},function(J){(M._status===0||M._status===-1)&&(M._status=2,M._result=J)}),M._status===-1&&(M._status=0,M._result=L)}if(M._status===1)return M._result.default;throw M._result}var q=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},ut={map:D,forEach:function(M,L,J){D(M,function(){L.apply(this,arguments)},J)},count:function(M){var L=0;return D(M,function(){L++}),L},toArray:function(M){return D(M,function(L){return L})||[]},only:function(M){if(!gt(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Bt.Activity=b,Bt.Children=ut,Bt.Component=A,Bt.Fragment=s,Bt.Profiler=r,Bt.PureComponent=N,Bt.StrictMode=n,Bt.Suspense=d,Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Bt.__COMPILER_RUNTIME={__proto__:null,c:function(M){return I.H.useMemoCache(M)}},Bt.cache=function(M){return function(){return M.apply(null,arguments)}},Bt.cacheSignal=function(){return null},Bt.cloneElement=function(M,L,J){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var rt=w({},M.props),nt=M.key;if(L!=null)for(_t in L.key!==void 0&&(nt=""+L.key),L)!P.call(L,_t)||_t==="key"||_t==="__self"||_t==="__source"||_t==="ref"&&L.ref===void 0||(rt[_t]=L[_t]);var _t=arguments.length-2;if(_t===1)rt.children=J;else if(1<_t){for(var xt=Array(_t),Et=0;Et<_t;Et++)xt[Et]=arguments[Et+2];rt.children=xt}return Y(M.type,nt,rt)},Bt.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:l,_context:M},M},Bt.createElement=function(M,L,J){var rt,nt={},_t=null;if(L!=null)for(rt in L.key!==void 0&&(_t=""+L.key),L)P.call(L,rt)&&rt!=="key"&&rt!=="__self"&&rt!=="__source"&&(nt[rt]=L[rt]);var xt=arguments.length-2;if(xt===1)nt.children=J;else if(1<xt){for(var Et=Array(xt),ot=0;ot<xt;ot++)Et[ot]=arguments[ot+2];nt.children=Et}if(M&&M.defaultProps)for(rt in xt=M.defaultProps,xt)nt[rt]===void 0&&(nt[rt]=xt[rt]);return Y(M,_t,nt)},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function(M){return{$$typeof:u,render:M}},Bt.isValidElement=gt,Bt.lazy=function(M){return{$$typeof:g,_payload:{_status:-1,_result:M},_init:X}},Bt.memo=function(M,L){return{$$typeof:h,type:M,compare:L===void 0?null:L}},Bt.startTransition=function(M){var L=I.T,J={};I.T=J;try{var rt=M(),nt=I.S;nt!==null&&nt(J,rt),typeof rt=="object"&&rt!==null&&typeof rt.then=="function"&&rt.then(G,q)}catch(_t){q(_t)}finally{L!==null&&J.types!==null&&(L.types=J.types),I.T=L}},Bt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Bt.use=function(M){return I.H.use(M)},Bt.useActionState=function(M,L,J){return I.H.useActionState(M,L,J)},Bt.useCallback=function(M,L){return I.H.useCallback(M,L)},Bt.useContext=function(M){return I.H.useContext(M)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function(M,L){return I.H.useDeferredValue(M,L)},Bt.useEffect=function(M,L){return I.H.useEffect(M,L)},Bt.useEffectEvent=function(M){return I.H.useEffectEvent(M)},Bt.useId=function(){return I.H.useId()},Bt.useImperativeHandle=function(M,L,J){return I.H.useImperativeHandle(M,L,J)},Bt.useInsertionEffect=function(M,L){return I.H.useInsertionEffect(M,L)},Bt.useLayoutEffect=function(M,L){return I.H.useLayoutEffect(M,L)},Bt.useMemo=function(M,L){return I.H.useMemo(M,L)},Bt.useOptimistic=function(M,L){return I.H.useOptimistic(M,L)},Bt.useReducer=function(M,L,J){return I.H.useReducer(M,L,J)},Bt.useRef=function(M){return I.H.useRef(M)},Bt.useState=function(M){return I.H.useState(M)},Bt.useSyncExternalStore=function(M,L,J){return I.H.useSyncExternalStore(M,L,J)},Bt.useTransition=function(){return I.H.useTransition()},Bt.version="19.2.4",Bt}var bm;function Yd(){return bm||(bm=1,fd.exports=xv()),fd.exports}var B=Yd();const Dr=Xd(B);var gd={exports:{}},Tr={},pd={exports:{}},md={};var ym;function _v(){return ym||(ym=1,(function(f){function t(H,D){var X=H.length;H.push(D);t:for(;0<X;){var q=X-1>>>1,ut=H[q];if(0<r(ut,D))H[q]=D,H[X]=ut,X=q;else break t}}function s(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var D=H[0],X=H.pop();if(X!==D){H[0]=X;t:for(var q=0,ut=H.length,M=ut>>>1;q<M;){var L=2*(q+1)-1,J=H[L],rt=L+1,nt=H[rt];if(0>r(J,X))rt<ut&&0>r(nt,J)?(H[q]=nt,H[rt]=X,q=rt):(H[q]=J,H[L]=X,q=L);else if(rt<ut&&0>r(nt,X))H[q]=nt,H[rt]=X,q=rt;else break t}}return D}function r(H,D){var X=H.sortIndex-D.sortIndex;return X!==0?X:H.id-D.id}if(f.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;f.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();f.unstable_now=function(){return o.now()-u}}var d=[],h=[],g=1,b=null,v=3,x=!1,_=!1,w=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function R(H){for(var D=s(h);D!==null;){if(D.callback===null)n(h);else if(D.startTime<=H)n(h),D.sortIndex=D.expirationTime,t(d,D);else break;D=s(h)}}function O(H){if(w=!1,R(H),!_)if(s(d)!==null)_=!0,G||(G=!0,z());else{var D=s(h);D!==null&&lt(O,D.startTime-H)}}var G=!1,I=-1,P=5,Y=-1;function W(){return S?!0:!(f.unstable_now()-Y<P)}function gt(){if(S=!1,G){var H=f.unstable_now();Y=H;var D=!0;try{t:{_=!1,w&&(w=!1,E(I),I=-1),x=!0;var X=v;try{e:{for(R(H),b=s(d);b!==null&&!(b.expirationTime>H&&W());){var q=b.callback;if(typeof q=="function"){b.callback=null,v=b.priorityLevel;var ut=q(b.expirationTime<=H);if(H=f.unstable_now(),typeof ut=="function"){b.callback=ut,R(H),D=!0;break e}b===s(d)&&n(d),R(H)}else n(d);b=s(d)}if(b!==null)D=!0;else{var M=s(h);M!==null&&lt(O,M.startTime-H),D=!1}}break t}finally{b=null,v=X,x=!1}D=void 0}}finally{D?z():G=!1}}}var z;if(typeof N=="function")z=function(){N(gt)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,T=Q.port2;Q.port1.onmessage=gt,z=function(){T.postMessage(null)}}else z=function(){A(gt,0)};function lt(H,D){I=A(function(){H(f.unstable_now())},D)}f.unstable_IdlePriority=5,f.unstable_ImmediatePriority=1,f.unstable_LowPriority=4,f.unstable_NormalPriority=3,f.unstable_Profiling=null,f.unstable_UserBlockingPriority=2,f.unstable_cancelCallback=function(H){H.callback=null},f.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<H?Math.floor(1e3/H):5},f.unstable_getCurrentPriorityLevel=function(){return v},f.unstable_next=function(H){switch(v){case 1:case 2:case 3:var D=3;break;default:D=v}var X=v;v=D;try{return H()}finally{v=X}},f.unstable_requestPaint=function(){S=!0},f.unstable_runWithPriority=function(H,D){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=v;v=H;try{return D()}finally{v=X}},f.unstable_scheduleCallback=function(H,D,X){var q=f.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?q+X:q):X=q,H){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=X+ut,H={id:g++,callback:D,priorityLevel:H,startTime:X,expirationTime:ut,sortIndex:-1},X>q?(H.sortIndex=X,t(h,H),s(d)===null&&H===s(h)&&(w?(E(I),I=-1):w=!0,lt(O,X-q))):(H.sortIndex=ut,t(d,H),_||x||(_=!0,G||(G=!0,z()))),H},f.unstable_shouldYield=W,f.unstable_wrapCallback=function(H){var D=v;return function(){var X=v;v=D;try{return H.apply(this,arguments)}finally{v=X}}}})(md)),md}var vm;function wv(){return vm||(vm=1,pd.exports=_v()),pd.exports}var bd={exports:{}},He={};var xm;function Av(){if(xm)return He;xm=1;var f=Yd();function t(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var n={d:{f:s,r:function(){throw Error(t(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(d,h,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:d,containerInfo:h,implementation:g}}var o=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return He.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,He.createPortal=function(d,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return l(d,h,null,g)},He.flushSync=function(d){var h=o.T,g=n.p;try{if(o.T=null,n.p=2,d)return d()}finally{o.T=h,n.p=g,n.d.f()}},He.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},He.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},He.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var g=h.as,b=u(g,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,x=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:b,integrity:v,fetchPriority:x}):g==="script"&&n.d.X(d,{crossOrigin:b,integrity:v,fetchPriority:x,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},He.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=u(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},He.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,b=u(g,h.crossOrigin);n.d.L(d,g,{crossOrigin:b,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},He.preloadModule=function(d,h){if(typeof d=="string")if(h){var g=u(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},He.requestFormReset=function(d){n.d.r(d)},He.unstable_batchedUpdates=function(d,h){return d(h)},He.useFormState=function(d,h,g){return o.H.useFormState(d,h,g)},He.useFormStatus=function(){return o.H.useHostTransitionStatus()},He.version="19.2.4",He}var _m;function Sv(){if(_m)return bd.exports;_m=1;function f(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f)}catch(t){console.error(t)}}return f(),bd.exports=Av(),bd.exports}var wm;function kv(){if(wm)return Tr;wm=1;var f=wv(),t=Yd(),s=Sv();function n(e){var i="https://react.dev/errors/"+e;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,(i.flags&4098)!==0&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function o(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function u(e){if(e.tag===31){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(n(188))}function h(e){var i=e.alternate;if(!i){if(i=l(e),i===null)throw Error(n(188));return i!==e?null:e}for(var a=e,c=i;;){var p=a.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){a=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===a)return d(p),e;if(y===c)return d(p),i;y=y.sibling}throw Error(n(188))}if(a.return!==c.return)a=p,c=y;else{for(var k=!1,j=p.child;j;){if(j===a){k=!0,a=p,c=y;break}if(j===c){k=!0,c=p,a=y;break}j=j.sibling}if(!k){for(j=y.child;j;){if(j===a){k=!0,a=y,c=p;break}if(j===c){k=!0,c=y,a=p;break}j=j.sibling}if(!k)throw Error(n(189))}}if(a.alternate!==c)throw Error(n(190))}if(a.tag!==3)throw Error(n(188));return a.stateNode.current===a?e:i}function g(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e;for(e=e.child;e!==null;){if(i=g(e),i!==null)return i;e=e.sibling}return null}var b=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),N=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),gt=Symbol.iterator;function z(e){return e===null||typeof e!="object"?null:(e=gt&&e[gt]||e["@@iterator"],typeof e=="function"?e:null)}var Q=Symbol.for("react.client.reference");function T(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case A:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case G:return"SuspenseList";case Y:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case _:return"Portal";case N:return e.displayName||"Context";case E:return(e._context.displayName||"Context")+".Consumer";case R:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case I:return i=e.displayName||null,i!==null?i:T(e.type)||"Memo";case P:i=e._payload,e=e._init;try{return T(e(i))}catch{}}return null}var lt=Array.isArray,H=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},q=[],ut=-1;function M(e){return{current:e}}function L(e){0>ut||(e.current=q[ut],q[ut]=null,ut--)}function J(e,i){ut++,q[ut]=e.current,e.current=i}var rt=M(null),nt=M(null),_t=M(null),xt=M(null);function Et(e,i){switch(J(_t,i),J(nt,e),J(rt,null),i.nodeType){case 9:case 11:e=(e=i.documentElement)&&(e=e.namespaceURI)?zp(e):0;break;default:if(e=i.tagName,i=i.namespaceURI)i=zp(i),e=Lp(i,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}L(rt),J(rt,e)}function ot(){L(rt),L(nt),L(_t)}function At(e){e.memoizedState!==null&&J(xt,e);var i=rt.current,a=Lp(i,e.type);i!==a&&(J(nt,e),J(rt,a))}function Ot(e){nt.current===e&&(L(rt),L(nt)),xt.current===e&&(L(xt),wr._currentValue=X)}var zt,Ft;function C(e){if(zt===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);zt=i&&i[1]||"",Ft=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zt+e+Ft}var dt=!1;function at(e,i){if(!e||dt)return"";dt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var pt=function(){throw Error()};if(Object.defineProperty(pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pt,[])}catch(ct){var it=ct}Reflect.construct(e,[],pt)}else{try{pt.call()}catch(ct){it=ct}e.call(pt.prototype)}}else{try{throw Error()}catch(ct){it=ct}(pt=e())&&typeof pt.catch=="function"&&pt.catch(function(){})}}catch(ct){if(ct&&it&&typeof ct.stack=="string")return[ct.stack,it.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),k=y[0],j=y[1];if(k&&j){var V=k.split(`
`),et=j.split(`
`);for(p=c=0;c<V.length&&!V[c].includes("DetermineComponentFrameRoot");)c++;for(;p<et.length&&!et[p].includes("DetermineComponentFrameRoot");)p++;if(c===V.length||p===et.length)for(c=V.length-1,p=et.length-1;1<=c&&0<=p&&V[c]!==et[p];)p--;for(;1<=c&&0<=p;c--,p--)if(V[c]!==et[p]){if(c!==1||p!==1)do if(c--,p--,0>p||V[c]!==et[p]){var ht=`
`+V[c].replace(" at new "," at ");return e.displayName&&ht.includes("<anonymous>")&&(ht=ht.replace("<anonymous>",e.displayName)),ht}while(1<=c&&0<=p);break}}}finally{dt=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?C(a):""}function U(e,i){switch(e.tag){case 26:case 27:case 5:return C(e.type);case 16:return C("Lazy");case 13:return e.child!==i&&i!==null?C("Suspense Fallback"):C("Suspense");case 19:return C("SuspenseList");case 0:case 15:return at(e.type,!1);case 11:return at(e.type.render,!1);case 1:return at(e.type,!0);case 31:return C("Activity");default:return""}}function F(e){try{var i="",a=null;do i+=U(e,a),a=e,e=e.return;while(e);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Z=Object.prototype.hasOwnProperty,mt=f.unstable_scheduleCallback,bt=f.unstable_cancelCallback,st=f.unstable_shouldYield,yt=f.unstable_requestPaint,wt=f.unstable_now,vt=f.unstable_getCurrentPriorityLevel,Nt=f.unstable_ImmediatePriority,se=f.unstable_UserBlockingPriority,Vt=f.unstable_NormalPriority,Je=f.unstable_LowPriority,Ci=f.unstable_IdlePriority,Es=f.log,ln=f.unstable_setDisableYieldValue,oe=null,Oe=null;function Cs(e){if(typeof Es=="function"&&ln(e),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(oe,e)}catch{}}var me=Math.clz32?Math.clz32:Qo,Kr=Math.log,Wo=Math.LN2;function Qo(e){return e>>>=0,e===0?32:31-(Kr(e)/Wo|0)|0}var Ln=256,on=262144,$s=4194304;function Ts(e){var i=e&42;if(i!==0)return i;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Wr(e,i,a){var c=e.pendingLanes;if(c===0)return 0;var p=0,y=e.suspendedLanes,k=e.pingedLanes;e=e.warmLanes;var j=c&134217727;return j!==0?(c=j&~y,c!==0?p=Ts(c):(k&=j,k!==0?p=Ts(k):a||(a=j&~e,a!==0&&(p=Ts(a))))):(j=c&~y,j!==0?p=Ts(j):k!==0?p=Ts(k):a||(a=c&~e,a!==0&&(p=Ts(a)))),p===0?0:i!==0&&i!==p&&(i&y)===0&&(y=p&-p,a=i&-i,y>=a||y===32&&(a&4194048)!==0)?i:p}function za(e,i){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&i)===0}function ab(e,i){switch(e){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ph(){var e=$s;return $s<<=1,($s&62914560)===0&&($s=4194304),e}function Jo(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function La(e,i){e.pendingLanes|=i,i!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function rb(e,i,a,c,p,y){var k=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var j=e.entanglements,V=e.expirationTimes,et=e.hiddenUpdates;for(a=k&~a;0<a;){var ht=31-me(a),pt=1<<ht;j[ht]=0,V[ht]=-1;var it=et[ht];if(it!==null)for(et[ht]=null,ht=0;ht<it.length;ht++){var ct=it[ht];ct!==null&&(ct.lane&=-536870913)}a&=~pt}c!==0&&mh(e,c,0),y!==0&&p===0&&e.tag!==0&&(e.suspendedLanes|=y&~(k&~i))}function mh(e,i,a){e.pendingLanes|=i,e.suspendedLanes&=~i;var c=31-me(i);e.entangledLanes|=i,e.entanglements[c]=e.entanglements[c]|1073741824|a&261930}function bh(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var c=31-me(a),p=1<<c;p&i|e[c]&i&&(e[c]|=i),a&=~p}}function yh(e,i){var a=i&-i;return a=(a&42)!==0?1:tc(a),(a&(e.suspendedLanes|i))!==0?0:a}function tc(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ec(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function vh(){var e=D.p;return e!==0?e:(e=window.event,e===void 0?32:am(e.type))}function xh(e,i){var a=D.p;try{return D.p=e,i()}finally{D.p=a}}var Ti=Math.random().toString(36).slice(2),Pe="__reactFiber$"+Ti,ts="__reactProps$"+Ti,Pn="__reactContainer$"+Ti,sc="__reactEvents$"+Ti,lb="__reactListeners$"+Ti,ob="__reactHandles$"+Ti,_h="__reactResources$"+Ti,Pa="__reactMarker$"+Ti;function ic(e){delete e[Pe],delete e[ts],delete e[sc],delete e[lb],delete e[ob]}function Fn(e){var i=e[Pe];if(i)return i;for(var a=e.parentNode;a;){if(i=a[Pn]||a[Pe]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=Gp(e);e!==null;){if(a=e[Pe])return a;e=Gp(e)}return i}e=a,a=e.parentNode}return null}function Bn(e){if(e=e[Pe]||e[Pn]){var i=e.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return e}return null}function Fa(e){var i=e.tag;if(i===5||i===26||i===27||i===6)return e.stateNode;throw Error(n(33))}function In(e){var i=e[_h];return i||(i=e[_h]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ze(e){e[Pa]=!0}var wh=new Set,Ah={};function cn(e,i){Un(e,i),Un(e+"Capture",i)}function Un(e,i){for(Ah[e]=i,e=0;e<i.length;e++)wh.add(i[e])}var cb=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Sh={},kh={};function ub(e){return Z.call(kh,e)?!0:Z.call(Sh,e)?!1:cb.test(e)?kh[e]=!0:(Sh[e]=!0,!1)}function Qr(e,i,a){if(ub(i))if(a===null)e.removeAttribute(i);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(i);return}}e.setAttribute(i,""+a)}}function Jr(e,i,a){if(a===null)e.removeAttribute(i);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttribute(i,""+a)}}function ni(e,i,a,c){if(c===null)e.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(i,a,""+c)}}function Ns(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Eh(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function db(e,i,a){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);if(!e.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return p.call(this)},set:function(k){a=""+k,y.call(this,k)}}),Object.defineProperty(e,i,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(k){a=""+k},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function nc(e){if(!e._valueTracker){var i=Eh(e)?"checked":"value";e._valueTracker=db(e,i,""+e[i])}}function Ch(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),c="";return e&&(c=Eh(e)?e.checked?"true":"false":e.value),e=c,e!==a?(i.setValue(e),!0):!1}function tl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var hb=/[\n"\\]/g;function Ms(e){return e.replace(hb,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function ac(e,i,a,c,p,y,k,j){e.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?e.type=k:e.removeAttribute("type"),i!=null?k==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+Ns(i)):e.value!==""+Ns(i)&&(e.value=""+Ns(i)):k!=="submit"&&k!=="reset"||e.removeAttribute("value"),i!=null?rc(e,k,Ns(i)):a!=null?rc(e,k,Ns(a)):c!=null&&e.removeAttribute("value"),p==null&&y!=null&&(e.defaultChecked=!!y),p!=null&&(e.checked=p&&typeof p!="function"&&typeof p!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?e.name=""+Ns(j):e.removeAttribute("name")}function Th(e,i,a,c,p,y,k,j){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.type=y),i!=null||a!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){nc(e);return}a=a!=null?""+Ns(a):"",i=i!=null?""+Ns(i):a,j||i===e.value||(e.value=i),e.defaultValue=i}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=j?e.checked:!!c,e.defaultChecked=!!c,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(e.name=k),nc(e)}function rc(e,i,a){i==="number"&&tl(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Hn(e,i,a,c){if(e=e.options,i){i={};for(var p=0;p<a.length;p++)i["$"+a[p]]=!0;for(a=0;a<e.length;a++)p=i.hasOwnProperty("$"+e[a].value),e[a].selected!==p&&(e[a].selected=p),p&&c&&(e[a].defaultSelected=!0)}else{for(a=""+Ns(a),i=null,p=0;p<e.length;p++){if(e[p].value===a){e[p].selected=!0,c&&(e[p].defaultSelected=!0);return}i!==null||e[p].disabled||(i=e[p])}i!==null&&(i.selected=!0)}}function Nh(e,i,a){if(i!=null&&(i=""+Ns(i),i!==e.value&&(e.value=i),a==null)){e.defaultValue!==i&&(e.defaultValue=i);return}e.defaultValue=a!=null?""+Ns(a):""}function Mh(e,i,a,c){if(i==null){if(c!=null){if(a!=null)throw Error(n(92));if(lt(c)){if(1<c.length)throw Error(n(93));c=c[0]}a=c}a==null&&(a=""),i=a}a=Ns(i),e.defaultValue=a,c=e.textContent,c===a&&c!==""&&c!==null&&(e.value=c),nc(e)}function Gn(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var fb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rh(e,i,a){var c=i.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="":c?e.setProperty(i,a):typeof a!="number"||a===0||fb.has(i)?i==="float"?e.cssFloat=a:e[i]=(""+a).trim():e[i]=a+"px"}function jh(e,i,a){if(i!=null&&typeof i!="object")throw Error(n(62));if(e=e.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var p in i)c=i[p],i.hasOwnProperty(p)&&a[p]!==c&&Rh(e,p,c)}else for(var y in i)i.hasOwnProperty(y)&&Rh(e,y,i[y])}function lc(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function el(e){return pb.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ai(){}var oc=null;function cc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qn=null,Vn=null;function Dh(e){var i=Bn(e);if(i&&(e=i.stateNode)){var a=e[ts]||null;t:switch(e=i.stateNode,i.type){case"input":if(ac(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Ms(""+i)+'"][type="radio"]'),i=0;i<a.length;i++){var c=a[i];if(c!==e&&c.form===e.form){var p=c[ts]||null;if(!p)throw Error(n(90));ac(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<a.length;i++)c=a[i],c.form===e.form&&Ch(c)}break t;case"textarea":Nh(e,a.value,a.defaultValue);break t;case"select":i=a.value,i!=null&&Hn(e,!!a.multiple,i,!1)}}}var uc=!1;function Oh(e,i,a){if(uc)return e(i,a);uc=!0;try{var c=e(i);return c}finally{if(uc=!1,(qn!==null||Vn!==null)&&(Hl(),qn&&(i=qn,e=Vn,Vn=qn=null,Dh(i),e)))for(i=0;i<e.length;i++)Dh(e[i])}}function Ba(e,i){var a=e.stateNode;if(a===null)return null;var c=a[ts]||null;if(c===null)return null;a=c[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(n(231,i,typeof a));return a}var ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dc=!1;if(ri)try{var Ia={};Object.defineProperty(Ia,"passive",{get:function(){dc=!0}}),window.addEventListener("test",Ia,Ia),window.removeEventListener("test",Ia,Ia)}catch{dc=!1}var Ni=null,hc=null,sl=null;function zh(){if(sl)return sl;var e,i=hc,a=i.length,c,p="value"in Ni?Ni.value:Ni.textContent,y=p.length;for(e=0;e<a&&i[e]===p[e];e++);var k=a-e;for(c=1;c<=k&&i[a-c]===p[y-c];c++);return sl=p.slice(e,1<c?1-c:void 0)}function il(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function nl(){return!0}function Lh(){return!1}function es(e){function i(a,c,p,y,k){this._reactName=a,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=k,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(a=e[j],this[j]=a?a(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?nl:Lh,this.isPropagationStopped=Lh,this}return b(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=nl)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=nl)},persist:function(){},isPersistent:nl}),i}var un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},al=es(un),Ua=b({},un,{view:0,detail:0}),mb=es(Ua),fc,gc,Ha,rl=b({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ha&&(Ha&&e.type==="mousemove"?(fc=e.screenX-Ha.screenX,gc=e.screenY-Ha.screenY):gc=fc=0,Ha=e),fc)},movementY:function(e){return"movementY"in e?e.movementY:gc}}),Ph=es(rl),bb=b({},rl,{dataTransfer:0}),yb=es(bb),vb=b({},Ua,{relatedTarget:0}),pc=es(vb),xb=b({},un,{animationName:0,elapsedTime:0,pseudoElement:0}),_b=es(xb),wb=b({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ab=es(wb),Sb=b({},un,{data:0}),Fh=es(Sb),kb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tb(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Cb[e])?!!i[e]:!1}function mc(){return Tb}var Nb=b({},Ua,{key:function(e){if(e.key){var i=kb[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=il(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Eb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mc,charCode:function(e){return e.type==="keypress"?il(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?il(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Mb=es(Nb),Rb=b({},rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bh=es(Rb),jb=b({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mc}),Db=es(jb),Ob=b({},un,{propertyName:0,elapsedTime:0,pseudoElement:0}),zb=es(Ob),Lb=b({},rl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pb=es(Lb),Fb=b({},un,{newState:0,oldState:0}),Bb=es(Fb),Ib=[9,13,27,32],bc=ri&&"CompositionEvent"in window,Ga=null;ri&&"documentMode"in document&&(Ga=document.documentMode);var Ub=ri&&"TextEvent"in window&&!Ga,Ih=ri&&(!bc||Ga&&8<Ga&&11>=Ga),Uh=" ",Hh=!1;function Gh(e,i){switch(e){case"keyup":return Ib.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xn=!1;function Hb(e,i){switch(e){case"compositionend":return qh(i);case"keypress":return i.which!==32?null:(Hh=!0,Uh);case"textInput":return e=i.data,e===Uh&&Hh?null:e;default:return null}}function Gb(e,i){if(Xn)return e==="compositionend"||!bc&&Gh(e,i)?(e=zh(),sl=hc=Ni=null,Xn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ih&&i.locale!=="ko"?null:i.data;default:return null}}var qb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vh(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!qb[e.type]:i==="textarea"}function Xh(e,i,a,c){qn?Vn?Vn.push(c):Vn=[c]:qn=c,i=Zl(i,"onChange"),0<i.length&&(a=new al("onChange","change",null,a,c),e.push({event:a,listeners:i}))}var qa=null,Va=null;function Vb(e){Np(e,0)}function ll(e){var i=Fa(e);if(Ch(i))return e}function Yh(e,i){if(e==="change")return i}var $h=!1;if(ri){var yc;if(ri){var vc="oninput"in document;if(!vc){var Zh=document.createElement("div");Zh.setAttribute("oninput","return;"),vc=typeof Zh.oninput=="function"}yc=vc}else yc=!1;$h=yc&&(!document.documentMode||9<document.documentMode)}function Kh(){qa&&(qa.detachEvent("onpropertychange",Wh),Va=qa=null)}function Wh(e){if(e.propertyName==="value"&&ll(Va)){var i=[];Xh(i,Va,e,cc(e)),Oh(Vb,i)}}function Xb(e,i,a){e==="focusin"?(Kh(),qa=i,Va=a,qa.attachEvent("onpropertychange",Wh)):e==="focusout"&&Kh()}function Yb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ll(Va)}function $b(e,i){if(e==="click")return ll(i)}function Zb(e,i){if(e==="input"||e==="change")return ll(i)}function Kb(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var gs=typeof Object.is=="function"?Object.is:Kb;function Xa(e,i){if(gs(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),c=Object.keys(i);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var p=a[c];if(!Z.call(i,p)||!gs(e[p],i[p]))return!1}return!0}function Qh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jh(e,i){var a=Qh(e);e=0;for(var c;a;){if(a.nodeType===3){if(c=e+a.textContent.length,e<=i&&c>=i)return{node:a,offset:i-e};e=c}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=Qh(a)}}function tf(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?tf(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function ef(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var i=tl(e.document);i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=tl(e.document)}return i}function xc(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}var Wb=ri&&"documentMode"in document&&11>=document.documentMode,Yn=null,_c=null,Ya=null,wc=!1;function sf(e,i,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;wc||Yn==null||Yn!==tl(c)||(c=Yn,"selectionStart"in c&&xc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ya&&Xa(Ya,c)||(Ya=c,c=Zl(_c,"onSelect"),0<c.length&&(i=new al("onSelect","select",null,i,a),e.push({event:i,listeners:c}),i.target=Yn)))}function dn(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var $n={animationend:dn("Animation","AnimationEnd"),animationiteration:dn("Animation","AnimationIteration"),animationstart:dn("Animation","AnimationStart"),transitionrun:dn("Transition","TransitionRun"),transitionstart:dn("Transition","TransitionStart"),transitioncancel:dn("Transition","TransitionCancel"),transitionend:dn("Transition","TransitionEnd")},Ac={},nf={};ri&&(nf=document.createElement("div").style,"AnimationEvent"in window||(delete $n.animationend.animation,delete $n.animationiteration.animation,delete $n.animationstart.animation),"TransitionEvent"in window||delete $n.transitionend.transition);function hn(e){if(Ac[e])return Ac[e];if(!$n[e])return e;var i=$n[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in nf)return Ac[e]=i[a];return e}var af=hn("animationend"),rf=hn("animationiteration"),lf=hn("animationstart"),Qb=hn("transitionrun"),Jb=hn("transitionstart"),ty=hn("transitioncancel"),of=hn("transitionend"),cf=new Map,Sc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Sc.push("scrollEnd");function Us(e,i){cf.set(e,i),cn(i,[e])}var ol=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Rs=[],Zn=0,kc=0;function cl(){for(var e=Zn,i=kc=Zn=0;i<e;){var a=Rs[i];Rs[i++]=null;var c=Rs[i];Rs[i++]=null;var p=Rs[i];Rs[i++]=null;var y=Rs[i];if(Rs[i++]=null,c!==null&&p!==null){var k=c.pending;k===null?p.next=p:(p.next=k.next,k.next=p),c.pending=p}y!==0&&uf(a,p,y)}}function ul(e,i,a,c){Rs[Zn++]=e,Rs[Zn++]=i,Rs[Zn++]=a,Rs[Zn++]=c,kc|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function Ec(e,i,a,c){return ul(e,i,a,c),dl(e)}function fn(e,i){return ul(e,null,null,i),dl(e)}function uf(e,i,a){e.lanes|=a;var c=e.alternate;c!==null&&(c.lanes|=a);for(var p=!1,y=e.return;y!==null;)y.childLanes|=a,c=y.alternate,c!==null&&(c.childLanes|=a),y.tag===22&&(e=y.stateNode,e===null||e._visibility&1||(p=!0)),e=y,y=y.return;return e.tag===3?(y=e.stateNode,p&&i!==null&&(p=31-me(a),e=y.hiddenUpdates,c=e[p],c===null?e[p]=[i]:c.push(i),i.lane=a|536870912),y):null}function dl(e){if(50<pr)throw pr=0,zu=null,Error(n(185));for(var i=e.return;i!==null;)e=i,i=e.return;return e.tag===3?e.stateNode:null}var Kn={};function ey(e,i,a,c){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(e,i,a,c){return new ey(e,i,a,c)}function Cc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function li(e,i){var a=e.alternate;return a===null?(a=ps(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function df(e,i){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=i,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,i=a.dependencies,e.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e}function hl(e,i,a,c,p,y){var k=0;if(c=e,typeof e=="function")Cc(e)&&(k=1);else if(typeof e=="string")k=rv(e,a,rt.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case Y:return e=ps(31,a,i,p),e.elementType=Y,e.lanes=y,e;case w:return gn(a.children,p,y,i);case S:k=8,p|=24;break;case A:return e=ps(12,a,i,p|2),e.elementType=A,e.lanes=y,e;case O:return e=ps(13,a,i,p),e.elementType=O,e.lanes=y,e;case G:return e=ps(19,a,i,p),e.elementType=G,e.lanes=y,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N:k=10;break t;case E:k=9;break t;case R:k=11;break t;case I:k=14;break t;case P:k=16,c=null;break t}k=29,a=Error(n(130,e===null?"null":typeof e,"")),c=null}return i=ps(k,a,i,p),i.elementType=e,i.type=c,i.lanes=y,i}function gn(e,i,a,c){return e=ps(7,e,c,i),e.lanes=a,e}function Tc(e,i,a){return e=ps(6,e,null,i),e.lanes=a,e}function hf(e){var i=ps(18,null,null,0);return i.stateNode=e,i}function Nc(e,i,a){return i=ps(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}var ff=new WeakMap;function js(e,i){if(typeof e=="object"&&e!==null){var a=ff.get(e);return a!==void 0?a:(i={value:e,source:i,stack:F(i)},ff.set(e,i),i)}return{value:e,source:i,stack:F(i)}}var Wn=[],Qn=0,fl=null,$a=0,Ds=[],Os=0,Mi=null,Zs=1,Ks="";function oi(e,i){Wn[Qn++]=$a,Wn[Qn++]=fl,fl=e,$a=i}function gf(e,i,a){Ds[Os++]=Zs,Ds[Os++]=Ks,Ds[Os++]=Mi,Mi=e;var c=Zs;e=Ks;var p=32-me(c)-1;c&=~(1<<p),a+=1;var y=32-me(i)+p;if(30<y){var k=p-p%5;y=(c&(1<<k)-1).toString(32),c>>=k,p-=k,Zs=1<<32-me(i)+p|a<<p|c,Ks=y+e}else Zs=1<<y|a<<p|c,Ks=e}function Mc(e){e.return!==null&&(oi(e,1),gf(e,1,0))}function Rc(e){for(;e===fl;)fl=Wn[--Qn],Wn[Qn]=null,$a=Wn[--Qn],Wn[Qn]=null;for(;e===Mi;)Mi=Ds[--Os],Ds[Os]=null,Ks=Ds[--Os],Ds[Os]=null,Zs=Ds[--Os],Ds[Os]=null}function pf(e,i){Ds[Os++]=Zs,Ds[Os++]=Ks,Ds[Os++]=Mi,Zs=i.id,Ks=i.overflow,Mi=e}var Fe=null,de=null,Wt=!1,Ri=null,zs=!1,jc=Error(n(519));function ji(e){var i=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Za(js(i,e)),jc}function mf(e){var i=e.stateNode,a=e.type,c=e.memoizedProps;switch(i[Pe]=e,i[ts]=c,a){case"dialog":$t("cancel",i),$t("close",i);break;case"iframe":case"object":case"embed":$t("load",i);break;case"video":case"audio":for(a=0;a<br.length;a++)$t(br[a],i);break;case"source":$t("error",i);break;case"img":case"image":case"link":$t("error",i),$t("load",i);break;case"details":$t("toggle",i);break;case"input":$t("invalid",i),Th(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":$t("invalid",i);break;case"textarea":$t("invalid",i),Mh(i,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||i.textContent===""+a||c.suppressHydrationWarning===!0||Dp(i.textContent,a)?(c.popover!=null&&($t("beforetoggle",i),$t("toggle",i)),c.onScroll!=null&&$t("scroll",i),c.onScrollEnd!=null&&$t("scrollend",i),c.onClick!=null&&(i.onclick=ai),i=!0):i=!1,i||ji(e,!0)}function bf(e){for(Fe=e.return;Fe;)switch(Fe.tag){case 5:case 31:case 13:zs=!1;return;case 27:case 3:zs=!0;return;default:Fe=Fe.return}}function Jn(e){if(e!==Fe)return!1;if(!Wt)return bf(e),Wt=!0,!1;var i=e.tag,a;if((a=i!==3&&i!==27)&&((a=i===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Ku(e.type,e.memoizedProps)),a=!a),a&&de&&ji(e),bf(e),i===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));de=Hp(e)}else if(i===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));de=Hp(e)}else i===27?(i=de,Xi(e.type)?(e=ed,ed=null,de=e):de=i):de=Fe?Ps(e.stateNode.nextSibling):null;return!0}function pn(){de=Fe=null,Wt=!1}function Dc(){var e=Ri;return e!==null&&(as===null?as=e:as.push.apply(as,e),Ri=null),e}function Za(e){Ri===null?Ri=[e]:Ri.push(e)}var Oc=M(null),mn=null,ci=null;function Di(e,i,a){J(Oc,i._currentValue),i._currentValue=a}function ui(e){e._currentValue=Oc.current,L(Oc)}function zc(e,i,a){for(;e!==null;){var c=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),e===a)break;e=e.return}}function Lc(e,i,a,c){var p=e.child;for(p!==null&&(p.return=e);p!==null;){var y=p.dependencies;if(y!==null){var k=p.child;y=y.firstContext;t:for(;y!==null;){var j=y;y=p;for(var V=0;V<i.length;V++)if(j.context===i[V]){y.lanes|=a,j=y.alternate,j!==null&&(j.lanes|=a),zc(y.return,a,e),c||(k=null);break t}y=j.next}}else if(p.tag===18){if(k=p.return,k===null)throw Error(n(341));k.lanes|=a,y=k.alternate,y!==null&&(y.lanes|=a),zc(k,a,e),k=null}else k=p.child;if(k!==null)k.return=p;else for(k=p;k!==null;){if(k===e){k=null;break}if(p=k.sibling,p!==null){p.return=k.return,k=p;break}k=k.return}p=k}}function ta(e,i,a,c){e=null;for(var p=i,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var k=p.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var j=p.type;gs(p.pendingProps.value,k.value)||(e!==null?e.push(j):e=[j])}}else if(p===xt.current){if(k=p.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(e!==null?e.push(wr):e=[wr])}p=p.return}e!==null&&Lc(i,e,a,c),i.flags|=262144}function gl(e){for(e=e.firstContext;e!==null;){if(!gs(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function bn(e){mn=e,ci=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Be(e){return yf(mn,e)}function pl(e,i){return mn===null&&bn(e),yf(e,i)}function yf(e,i){var a=i._currentValue;if(i={context:i,memoizedValue:a,next:null},ci===null){if(e===null)throw Error(n(308));ci=i,e.dependencies={lanes:0,firstContext:i},e.flags|=524288}else ci=ci.next=i;return a}var sy=typeof AbortController<"u"?AbortController:function(){var e=[],i=this.signal={aborted:!1,addEventListener:function(a,c){e.push(c)}};this.abort=function(){i.aborted=!0,e.forEach(function(a){return a()})}},iy=f.unstable_scheduleCallback,ny=f.unstable_NormalPriority,Ae={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pc(){return{controller:new sy,data:new Map,refCount:0}}function Ka(e){e.refCount--,e.refCount===0&&iy(ny,function(){e.controller.abort()})}var Wa=null,Fc=0,ea=0,sa=null;function ay(e,i){if(Wa===null){var a=Wa=[];Fc=0,ea=Uu(),sa={status:"pending",value:void 0,then:function(c){a.push(c)}}}return Fc++,i.then(vf,vf),i}function vf(){if(--Fc===0&&Wa!==null){sa!==null&&(sa.status="fulfilled");var e=Wa;Wa=null,ea=0,sa=null;for(var i=0;i<e.length;i++)(0,e[i])()}}function ry(e,i){var a=[],c={status:"pending",value:null,reason:null,then:function(p){a.push(p)}};return e.then(function(){c.status="fulfilled",c.value=i;for(var p=0;p<a.length;p++)(0,a[p])(i)},function(p){for(c.status="rejected",c.reason=p,p=0;p<a.length;p++)(0,a[p])(void 0)}),c}var xf=H.S;H.S=function(e,i){ip=wt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&ay(e,i),xf!==null&&xf(e,i)};var yn=M(null);function Bc(){var e=yn.current;return e!==null?e:ce.pooledCache}function ml(e,i){i===null?J(yn,yn.current):J(yn,i.pool)}function _f(){var e=Bc();return e===null?null:{parent:Ae._currentValue,pool:e}}var ia=Error(n(460)),Ic=Error(n(474)),bl=Error(n(542)),yl={then:function(){}};function wf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Af(e,i,a){switch(a=e[a],a===void 0?e.push(i):a!==i&&(i.then(ai,ai),i=a),i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,kf(e),e;default:if(typeof i.status=="string")i.then(ai,ai);else{if(e=ce,e!==null&&100<e.shellSuspendCounter)throw Error(n(482));e=i,e.status="pending",e.then(function(c){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=c}},function(c){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw e=i.reason,kf(e),e}throw xn=i,ia}}function vn(e){try{var i=e._init;return i(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(xn=a,ia):a}}var xn=null;function Sf(){if(xn===null)throw Error(n(459));var e=xn;return xn=null,e}function kf(e){if(e===ia||e===bl)throw Error(n(483))}var na=null,Qa=0;function vl(e){var i=Qa;return Qa+=1,na===null&&(na=[]),Af(na,e,i)}function Ja(e,i){i=i.props.ref,e.ref=i!==void 0?i:null}function xl(e,i){throw i.$$typeof===v?Error(n(525)):(e=Object.prototype.toString.call(i),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)))}function Ef(e){function i(K,$){if(e){var tt=K.deletions;tt===null?(K.deletions=[$],K.flags|=16):tt.push($)}}function a(K,$){if(!e)return null;for(;$!==null;)i(K,$),$=$.sibling;return null}function c(K){for(var $=new Map;K!==null;)K.key!==null?$.set(K.key,K):$.set(K.index,K),K=K.sibling;return $}function p(K,$){return K=li(K,$),K.index=0,K.sibling=null,K}function y(K,$,tt){return K.index=tt,e?(tt=K.alternate,tt!==null?(tt=tt.index,tt<$?(K.flags|=67108866,$):tt):(K.flags|=67108866,$)):(K.flags|=1048576,$)}function k(K){return e&&K.alternate===null&&(K.flags|=67108866),K}function j(K,$,tt,ft){return $===null||$.tag!==6?($=Tc(tt,K.mode,ft),$.return=K,$):($=p($,tt),$.return=K,$)}function V(K,$,tt,ft){var Mt=tt.type;return Mt===w?ht(K,$,tt.props.children,ft,tt.key):$!==null&&($.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===P&&vn(Mt)===$.type)?($=p($,tt.props),Ja($,tt),$.return=K,$):($=hl(tt.type,tt.key,tt.props,null,K.mode,ft),Ja($,tt),$.return=K,$)}function et(K,$,tt,ft){return $===null||$.tag!==4||$.stateNode.containerInfo!==tt.containerInfo||$.stateNode.implementation!==tt.implementation?($=Nc(tt,K.mode,ft),$.return=K,$):($=p($,tt.children||[]),$.return=K,$)}function ht(K,$,tt,ft,Mt){return $===null||$.tag!==7?($=gn(tt,K.mode,ft,Mt),$.return=K,$):($=p($,tt),$.return=K,$)}function pt(K,$,tt){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Tc(""+$,K.mode,tt),$.return=K,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case x:return tt=hl($.type,$.key,$.props,null,K.mode,tt),Ja(tt,$),tt.return=K,tt;case _:return $=Nc($,K.mode,tt),$.return=K,$;case P:return $=vn($),pt(K,$,tt)}if(lt($)||z($))return $=gn($,K.mode,tt,null),$.return=K,$;if(typeof $.then=="function")return pt(K,vl($),tt);if($.$$typeof===N)return pt(K,pl(K,$),tt);xl(K,$)}return null}function it(K,$,tt,ft){var Mt=$!==null?$.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return Mt!==null?null:j(K,$,""+tt,ft);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case x:return tt.key===Mt?V(K,$,tt,ft):null;case _:return tt.key===Mt?et(K,$,tt,ft):null;case P:return tt=vn(tt),it(K,$,tt,ft)}if(lt(tt)||z(tt))return Mt!==null?null:ht(K,$,tt,ft,null);if(typeof tt.then=="function")return it(K,$,vl(tt),ft);if(tt.$$typeof===N)return it(K,$,pl(K,tt),ft);xl(K,tt)}return null}function ct(K,$,tt,ft,Mt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return K=K.get(tt)||null,j($,K,""+ft,Mt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case x:return K=K.get(ft.key===null?tt:ft.key)||null,V($,K,ft,Mt);case _:return K=K.get(ft.key===null?tt:ft.key)||null,et($,K,ft,Mt);case P:return ft=vn(ft),ct(K,$,tt,ft,Mt)}if(lt(ft)||z(ft))return K=K.get(tt)||null,ht($,K,ft,Mt,null);if(typeof ft.then=="function")return ct(K,$,tt,vl(ft),Mt);if(ft.$$typeof===N)return ct(K,$,tt,pl($,ft),Mt);xl($,ft)}return null}function St(K,$,tt,ft){for(var Mt=null,Jt=null,Ct=$,Ht=$=0,Kt=null;Ct!==null&&Ht<tt.length;Ht++){Ct.index>Ht?(Kt=Ct,Ct=null):Kt=Ct.sibling;var te=it(K,Ct,tt[Ht],ft);if(te===null){Ct===null&&(Ct=Kt);break}e&&Ct&&te.alternate===null&&i(K,Ct),$=y(te,$,Ht),Jt===null?Mt=te:Jt.sibling=te,Jt=te,Ct=Kt}if(Ht===tt.length)return a(K,Ct),Wt&&oi(K,Ht),Mt;if(Ct===null){for(;Ht<tt.length;Ht++)Ct=pt(K,tt[Ht],ft),Ct!==null&&($=y(Ct,$,Ht),Jt===null?Mt=Ct:Jt.sibling=Ct,Jt=Ct);return Wt&&oi(K,Ht),Mt}for(Ct=c(Ct);Ht<tt.length;Ht++)Kt=ct(Ct,K,Ht,tt[Ht],ft),Kt!==null&&(e&&Kt.alternate!==null&&Ct.delete(Kt.key===null?Ht:Kt.key),$=y(Kt,$,Ht),Jt===null?Mt=Kt:Jt.sibling=Kt,Jt=Kt);return e&&Ct.forEach(function(Wi){return i(K,Wi)}),Wt&&oi(K,Ht),Mt}function Rt(K,$,tt,ft){if(tt==null)throw Error(n(151));for(var Mt=null,Jt=null,Ct=$,Ht=$=0,Kt=null,te=tt.next();Ct!==null&&!te.done;Ht++,te=tt.next()){Ct.index>Ht?(Kt=Ct,Ct=null):Kt=Ct.sibling;var Wi=it(K,Ct,te.value,ft);if(Wi===null){Ct===null&&(Ct=Kt);break}e&&Ct&&Wi.alternate===null&&i(K,Ct),$=y(Wi,$,Ht),Jt===null?Mt=Wi:Jt.sibling=Wi,Jt=Wi,Ct=Kt}if(te.done)return a(K,Ct),Wt&&oi(K,Ht),Mt;if(Ct===null){for(;!te.done;Ht++,te=tt.next())te=pt(K,te.value,ft),te!==null&&($=y(te,$,Ht),Jt===null?Mt=te:Jt.sibling=te,Jt=te);return Wt&&oi(K,Ht),Mt}for(Ct=c(Ct);!te.done;Ht++,te=tt.next())te=ct(Ct,K,Ht,te.value,ft),te!==null&&(e&&te.alternate!==null&&Ct.delete(te.key===null?Ht:te.key),$=y(te,$,Ht),Jt===null?Mt=te:Jt.sibling=te,Jt=te);return e&&Ct.forEach(function(bv){return i(K,bv)}),Wt&&oi(K,Ht),Mt}function le(K,$,tt,ft){if(typeof tt=="object"&&tt!==null&&tt.type===w&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case x:t:{for(var Mt=tt.key;$!==null;){if($.key===Mt){if(Mt=tt.type,Mt===w){if($.tag===7){a(K,$.sibling),ft=p($,tt.props.children),ft.return=K,K=ft;break t}}else if($.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===P&&vn(Mt)===$.type){a(K,$.sibling),ft=p($,tt.props),Ja(ft,tt),ft.return=K,K=ft;break t}a(K,$);break}else i(K,$);$=$.sibling}tt.type===w?(ft=gn(tt.props.children,K.mode,ft,tt.key),ft.return=K,K=ft):(ft=hl(tt.type,tt.key,tt.props,null,K.mode,ft),Ja(ft,tt),ft.return=K,K=ft)}return k(K);case _:t:{for(Mt=tt.key;$!==null;){if($.key===Mt)if($.tag===4&&$.stateNode.containerInfo===tt.containerInfo&&$.stateNode.implementation===tt.implementation){a(K,$.sibling),ft=p($,tt.children||[]),ft.return=K,K=ft;break t}else{a(K,$);break}else i(K,$);$=$.sibling}ft=Nc(tt,K.mode,ft),ft.return=K,K=ft}return k(K);case P:return tt=vn(tt),le(K,$,tt,ft)}if(lt(tt))return St(K,$,tt,ft);if(z(tt)){if(Mt=z(tt),typeof Mt!="function")throw Error(n(150));return tt=Mt.call(tt),Rt(K,$,tt,ft)}if(typeof tt.then=="function")return le(K,$,vl(tt),ft);if(tt.$$typeof===N)return le(K,$,pl(K,tt),ft);xl(K,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint"?(tt=""+tt,$!==null&&$.tag===6?(a(K,$.sibling),ft=p($,tt),ft.return=K,K=ft):(a(K,$),ft=Tc(tt,K.mode,ft),ft.return=K,K=ft),k(K)):a(K,$)}return function(K,$,tt,ft){try{Qa=0;var Mt=le(K,$,tt,ft);return na=null,Mt}catch(Ct){if(Ct===ia||Ct===bl)throw Ct;var Jt=ps(29,Ct,null,K.mode);return Jt.lanes=ft,Jt.return=K,Jt}}}var _n=Ef(!0),Cf=Ef(!1),Oi=!1;function Uc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hc(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function zi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Li(e,i,a){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(ee&2)!==0){var p=c.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),c.pending=i,i=dl(e),uf(e,null,a),i}return ul(e,c,i,a),dl(e)}function tr(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194048)!==0)){var c=i.lanes;c&=e.pendingLanes,a|=c,i.lanes=a,bh(e,a)}}function Gc(e,i){var a=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var p=null,y=null;if(a=a.firstBaseUpdate,a!==null){do{var k={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};y===null?p=y=k:y=y.next=k,a=a.next}while(a!==null);y===null?p=y=i:y=y.next=i}else p=y=i;a={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}var qc=!1;function er(){if(qc){var e=sa;if(e!==null)throw e}}function sr(e,i,a,c){qc=!1;var p=e.updateQueue;Oi=!1;var y=p.firstBaseUpdate,k=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var V=j,et=V.next;V.next=null,k===null?y=et:k.next=et,k=V;var ht=e.alternate;ht!==null&&(ht=ht.updateQueue,j=ht.lastBaseUpdate,j!==k&&(j===null?ht.firstBaseUpdate=et:j.next=et,ht.lastBaseUpdate=V))}if(y!==null){var pt=p.baseState;k=0,ht=et=V=null,j=y;do{var it=j.lane&-536870913,ct=it!==j.lane;if(ct?(Zt&it)===it:(c&it)===it){it!==0&&it===ea&&(qc=!0),ht!==null&&(ht=ht.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});t:{var St=e,Rt=j;it=i;var le=a;switch(Rt.tag){case 1:if(St=Rt.payload,typeof St=="function"){pt=St.call(le,pt,it);break t}pt=St;break t;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Rt.payload,it=typeof St=="function"?St.call(le,pt,it):St,it==null)break t;pt=b({},pt,it);break t;case 2:Oi=!0}}it=j.callback,it!==null&&(e.flags|=64,ct&&(e.flags|=8192),ct=p.callbacks,ct===null?p.callbacks=[it]:ct.push(it))}else ct={lane:it,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ht===null?(et=ht=ct,V=pt):ht=ht.next=ct,k|=it;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;ct=j,j=ct.next,ct.next=null,p.lastBaseUpdate=ct,p.shared.pending=null}}while(!0);ht===null&&(V=pt),p.baseState=V,p.firstBaseUpdate=et,p.lastBaseUpdate=ht,y===null&&(p.shared.lanes=0),Ui|=k,e.lanes=k,e.memoizedState=pt}}function Tf(e,i){if(typeof e!="function")throw Error(n(191,e));e.call(i)}function Nf(e,i){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Tf(a[e],i)}var aa=M(null),_l=M(0);function Mf(e,i){e=vi,J(_l,e),J(aa,i),vi=e|i.baseLanes}function Vc(){J(_l,vi),J(aa,aa.current)}function Xc(){vi=_l.current,L(aa),L(_l)}var ms=M(null),Ls=null;function Pi(e){var i=e.alternate;J(ve,ve.current&1),J(ms,e),Ls===null&&(i===null||aa.current!==null||i.memoizedState!==null)&&(Ls=e)}function Yc(e){J(ve,ve.current),J(ms,e),Ls===null&&(Ls=e)}function Rf(e){e.tag===22?(J(ve,ve.current),J(ms,e),Ls===null&&(Ls=e)):Fi()}function Fi(){J(ve,ve.current),J(ms,ms.current)}function bs(e){L(ms),Ls===e&&(Ls=null),L(ve)}var ve=M(0);function wl(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Ju(a)||td(a)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var di=0,Ut=null,ae=null,Se=null,Al=!1,ra=!1,wn=!1,Sl=0,ir=0,la=null,ly=0;function be(){throw Error(n(321))}function $c(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!gs(e[a],i[a]))return!1;return!0}function Zc(e,i,a,c,p,y){return di=y,Ut=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,H.H=e===null||e.memoizedState===null?gg:uu,wn=!1,y=a(c,p),wn=!1,ra&&(y=Df(i,a,c,p)),jf(e),y}function jf(e){H.H=rr;var i=ae!==null&&ae.next!==null;if(di=0,Se=ae=Ut=null,Al=!1,ir=0,la=null,i)throw Error(n(300));e===null||ke||(e=e.dependencies,e!==null&&gl(e)&&(ke=!0))}function Df(e,i,a,c){Ut=e;var p=0;do{if(ra&&(la=null),ir=0,ra=!1,25<=p)throw Error(n(301));if(p+=1,Se=ae=null,e.updateQueue!=null){var y=e.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}H.H=pg,y=i(a,c)}while(ra);return y}function oy(){var e=H.H,i=e.useState()[0];return i=typeof i.then=="function"?nr(i):i,e=e.useState()[0],(ae!==null?ae.memoizedState:null)!==e&&(Ut.flags|=1024),i}function Kc(){var e=Sl!==0;return Sl=0,e}function Wc(e,i,a){i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~a}function Qc(e){if(Al){for(e=e.memoizedState;e!==null;){var i=e.queue;i!==null&&(i.pending=null),e=e.next}Al=!1}di=0,Se=ae=Ut=null,ra=!1,ir=Sl=0,la=null}function $e(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?Ut.memoizedState=Se=e:Se=Se.next=e,Se}function xe(){if(ae===null){var e=Ut.alternate;e=e!==null?e.memoizedState:null}else e=ae.next;var i=Se===null?Ut.memoizedState:Se.next;if(i!==null)Se=i,ae=e;else{if(e===null)throw Ut.alternate===null?Error(n(467)):Error(n(310));ae=e,e={memoizedState:ae.memoizedState,baseState:ae.baseState,baseQueue:ae.baseQueue,queue:ae.queue,next:null},Se===null?Ut.memoizedState=Se=e:Se=Se.next=e}return Se}function kl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nr(e){var i=ir;return ir+=1,la===null&&(la=[]),e=Af(la,e,i),i=Ut,(Se===null?i.memoizedState:Se.next)===null&&(i=i.alternate,H.H=i===null||i.memoizedState===null?gg:uu),e}function El(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return nr(e);if(e.$$typeof===N)return Be(e)}throw Error(n(438,String(e)))}function Jc(e){var i=null,a=Ut.updateQueue;if(a!==null&&(i=a.memoCache),i==null){var c=Ut.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),a===null&&(a=kl(),Ut.updateQueue=a),a.memoCache=i,a=i.data[i.index],a===void 0)for(a=i.data[i.index]=Array(e),c=0;c<e;c++)a[c]=W;return i.index++,a}function hi(e,i){return typeof i=="function"?i(e):i}function Cl(e){var i=xe();return tu(i,ae,e)}function tu(e,i,a){var c=e.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var p=e.baseQueue,y=c.pending;if(y!==null){if(p!==null){var k=p.next;p.next=y.next,y.next=k}i.baseQueue=p=y,c.pending=null}if(y=e.baseState,p===null)e.memoizedState=y;else{i=p.next;var j=k=null,V=null,et=i,ht=!1;do{var pt=et.lane&-536870913;if(pt!==et.lane?(Zt&pt)===pt:(di&pt)===pt){var it=et.revertLane;if(it===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),pt===ea&&(ht=!0);else if((di&it)===it){et=et.next,it===ea&&(ht=!0);continue}else pt={lane:0,revertLane:et.revertLane,gesture:null,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null},V===null?(j=V=pt,k=y):V=V.next=pt,Ut.lanes|=it,Ui|=it;pt=et.action,wn&&a(y,pt),y=et.hasEagerState?et.eagerState:a(y,pt)}else it={lane:pt,revertLane:et.revertLane,gesture:et.gesture,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null},V===null?(j=V=it,k=y):V=V.next=it,Ut.lanes|=pt,Ui|=pt;et=et.next}while(et!==null&&et!==i);if(V===null?k=y:V.next=j,!gs(y,e.memoizedState)&&(ke=!0,ht&&(a=sa,a!==null)))throw a;e.memoizedState=y,e.baseState=k,e.baseQueue=V,c.lastRenderedState=y}return p===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function eu(e){var i=xe(),a=i.queue;if(a===null)throw Error(n(311));a.lastRenderedReducer=e;var c=a.dispatch,p=a.pending,y=i.memoizedState;if(p!==null){a.pending=null;var k=p=p.next;do y=e(y,k.action),k=k.next;while(k!==p);gs(y,i.memoizedState)||(ke=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),a.lastRenderedState=y}return[y,c]}function Of(e,i,a){var c=Ut,p=xe(),y=Wt;if(y){if(a===void 0)throw Error(n(407));a=a()}else a=i();var k=!gs((ae||p).memoizedState,a);if(k&&(p.memoizedState=a,ke=!0),p=p.queue,nu(Pf.bind(null,c,p,e),[e]),p.getSnapshot!==i||k||Se!==null&&Se.memoizedState.tag&1){if(c.flags|=2048,oa(9,{destroy:void 0},Lf.bind(null,c,p,a,i),null),ce===null)throw Error(n(349));y||(di&127)!==0||zf(c,i,a)}return a}function zf(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=Ut.updateQueue,i===null?(i=kl(),Ut.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function Lf(e,i,a,c){i.value=a,i.getSnapshot=c,Ff(i)&&Bf(e)}function Pf(e,i,a){return a(function(){Ff(i)&&Bf(e)})}function Ff(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!gs(e,a)}catch{return!0}}function Bf(e){var i=fn(e,2);i!==null&&rs(i,e,2)}function su(e){var i=$e();if(typeof e=="function"){var a=e;if(e=a(),wn){Cs(!0);try{a()}finally{Cs(!1)}}}return i.memoizedState=i.baseState=e,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:e},i}function If(e,i,a,c){return e.baseState=a,tu(e,ae,typeof c=="function"?c:hi)}function cy(e,i,a,c,p){if(Ml(e))throw Error(n(485));if(e=i.action,e!==null){var y={payload:p,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){y.listeners.push(k)}};H.T!==null?a(!0):y.isTransition=!1,c(y),a=i.pending,a===null?(y.next=i.pending=y,Uf(i,y)):(y.next=a.next,i.pending=a.next=y)}}function Uf(e,i){var a=i.action,c=i.payload,p=e.state;if(i.isTransition){var y=H.T,k={};H.T=k;try{var j=a(p,c),V=H.S;V!==null&&V(k,j),Hf(e,i,j)}catch(et){iu(e,i,et)}finally{y!==null&&k.types!==null&&(y.types=k.types),H.T=y}}else try{y=a(p,c),Hf(e,i,y)}catch(et){iu(e,i,et)}}function Hf(e,i,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){Gf(e,i,c)},function(c){return iu(e,i,c)}):Gf(e,i,a)}function Gf(e,i,a){i.status="fulfilled",i.value=a,qf(i),e.state=a,i=e.pending,i!==null&&(a=i.next,a===i?e.pending=null:(a=a.next,i.next=a,Uf(e,a)))}function iu(e,i,a){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=a,qf(i),i=i.next;while(i!==c)}e.action=null}function qf(e){e=e.listeners;for(var i=0;i<e.length;i++)(0,e[i])()}function Vf(e,i){return i}function Xf(e,i){if(Wt){var a=ce.formState;if(a!==null){t:{var c=Ut;if(Wt){if(de){e:{for(var p=de,y=zs;p.nodeType!==8;){if(!y){p=null;break e}if(p=Ps(p.nextSibling),p===null){p=null;break e}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){de=Ps(p.nextSibling),c=p.data==="F!";break t}}ji(c)}c=!1}c&&(i=a[0])}}return a=$e(),a.memoizedState=a.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vf,lastRenderedState:i},a.queue=c,a=dg.bind(null,Ut,c),c.dispatch=a,c=su(!1),y=cu.bind(null,Ut,!1,c.queue),c=$e(),p={state:i,dispatch:null,action:e,pending:null},c.queue=p,a=cy.bind(null,Ut,p,y,a),p.dispatch=a,c.memoizedState=e,[i,a,!1]}function Yf(e){var i=xe();return $f(i,ae,e)}function $f(e,i,a){if(i=tu(e,i,Vf)[0],e=Cl(hi)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=nr(i)}catch(k){throw k===ia?bl:k}else c=i;i=xe();var p=i.queue,y=p.dispatch;return a!==i.memoizedState&&(Ut.flags|=2048,oa(9,{destroy:void 0},uy.bind(null,p,a),null)),[c,y,e]}function uy(e,i){e.action=i}function Zf(e){var i=xe(),a=ae;if(a!==null)return $f(i,a,e);xe(),i=i.memoizedState,a=xe();var c=a.queue.dispatch;return a.memoizedState=e,[i,c,!1]}function oa(e,i,a,c){return e={tag:e,create:a,deps:c,inst:i,next:null},i=Ut.updateQueue,i===null&&(i=kl(),Ut.updateQueue=i),a=i.lastEffect,a===null?i.lastEffect=e.next=e:(c=a.next,a.next=e,e.next=c,i.lastEffect=e),e}function Kf(){return xe().memoizedState}function Tl(e,i,a,c){var p=$e();Ut.flags|=e,p.memoizedState=oa(1|i,{destroy:void 0},a,c===void 0?null:c)}function Nl(e,i,a,c){var p=xe();c=c===void 0?null:c;var y=p.memoizedState.inst;ae!==null&&c!==null&&$c(c,ae.memoizedState.deps)?p.memoizedState=oa(i,y,a,c):(Ut.flags|=e,p.memoizedState=oa(1|i,y,a,c))}function Wf(e,i){Tl(8390656,8,e,i)}function nu(e,i){Nl(2048,8,e,i)}function dy(e){Ut.flags|=4;var i=Ut.updateQueue;if(i===null)i=kl(),Ut.updateQueue=i,i.events=[e];else{var a=i.events;a===null?i.events=[e]:a.push(e)}}function Qf(e){var i=xe().memoizedState;return dy({ref:i,nextImpl:e}),function(){if((ee&2)!==0)throw Error(n(440));return i.impl.apply(void 0,arguments)}}function Jf(e,i){return Nl(4,2,e,i)}function tg(e,i){return Nl(4,4,e,i)}function eg(e,i){if(typeof i=="function"){e=e();var a=i(e);return function(){typeof a=="function"?a():i(null)}}if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function sg(e,i,a){a=a!=null?a.concat([e]):null,Nl(4,4,eg.bind(null,i,e),a)}function au(){}function ig(e,i){var a=xe();i=i===void 0?null:i;var c=a.memoizedState;return i!==null&&$c(i,c[1])?c[0]:(a.memoizedState=[e,i],e)}function ng(e,i){var a=xe();i=i===void 0?null:i;var c=a.memoizedState;if(i!==null&&$c(i,c[1]))return c[0];if(c=e(),wn){Cs(!0);try{e()}finally{Cs(!1)}}return a.memoizedState=[c,i],c}function ru(e,i,a){return a===void 0||(di&1073741824)!==0&&(Zt&261930)===0?e.memoizedState=i:(e.memoizedState=a,e=ap(),Ut.lanes|=e,Ui|=e,a)}function ag(e,i,a,c){return gs(a,i)?a:aa.current!==null?(e=ru(e,a,c),gs(e,i)||(ke=!0),e):(di&42)===0||(di&1073741824)!==0&&(Zt&261930)===0?(ke=!0,e.memoizedState=a):(e=ap(),Ut.lanes|=e,Ui|=e,i)}function rg(e,i,a,c,p){var y=D.p;D.p=y!==0&&8>y?y:8;var k=H.T,j={};H.T=j,cu(e,!1,i,a);try{var V=p(),et=H.S;if(et!==null&&et(j,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ht=ry(V,c);ar(e,i,ht,xs(e))}else ar(e,i,c,xs(e))}catch(pt){ar(e,i,{then:function(){},status:"rejected",reason:pt},xs())}finally{D.p=y,k!==null&&j.types!==null&&(k.types=j.types),H.T=k}}function hy(){}function lu(e,i,a,c){if(e.tag!==5)throw Error(n(476));var p=lg(e).queue;rg(e,p,i,X,a===null?hy:function(){return og(e),a(c)})}function lg(e){var i=e.memoizedState;if(i!==null)return i;i={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:X},next:null};var a={};return i.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:a},next:null},e.memoizedState=i,e=e.alternate,e!==null&&(e.memoizedState=i),i}function og(e){var i=lg(e);i.next===null&&(i=e.alternate.memoizedState),ar(e,i.next.queue,{},xs())}function ou(){return Be(wr)}function cg(){return xe().memoizedState}function ug(){return xe().memoizedState}function fy(e){for(var i=e.return;i!==null;){switch(i.tag){case 24:case 3:var a=xs();e=zi(a);var c=Li(i,e,a);c!==null&&(rs(c,i,a),tr(c,i,a)),i={cache:Pc()},e.payload=i;return}i=i.return}}function gy(e,i,a){var c=xs();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Ml(e)?hg(i,a):(a=Ec(e,i,a,c),a!==null&&(rs(a,e,c),fg(a,i,c)))}function dg(e,i,a){var c=xs();ar(e,i,a,c)}function ar(e,i,a,c){var p={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ml(e))hg(i,p);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var k=i.lastRenderedState,j=y(k,a);if(p.hasEagerState=!0,p.eagerState=j,gs(j,k))return ul(e,i,p,0),ce===null&&cl(),!1}catch{}if(a=Ec(e,i,p,c),a!==null)return rs(a,e,c),fg(a,i,c),!0}return!1}function cu(e,i,a,c){if(c={lane:2,revertLane:Uu(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ml(e)){if(i)throw Error(n(479))}else i=Ec(e,a,c,2),i!==null&&rs(i,e,2)}function Ml(e){var i=e.alternate;return e===Ut||i!==null&&i===Ut}function hg(e,i){ra=Al=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function fg(e,i,a){if((a&4194048)!==0){var c=i.lanes;c&=e.pendingLanes,a|=c,i.lanes=a,bh(e,a)}}var rr={readContext:Be,use:El,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useLayoutEffect:be,useInsertionEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useSyncExternalStore:be,useId:be,useHostTransitionStatus:be,useFormState:be,useActionState:be,useOptimistic:be,useMemoCache:be,useCacheRefresh:be};rr.useEffectEvent=be;var gg={readContext:Be,use:El,useCallback:function(e,i){return $e().memoizedState=[e,i===void 0?null:i],e},useContext:Be,useEffect:Wf,useImperativeHandle:function(e,i,a){a=a!=null?a.concat([e]):null,Tl(4194308,4,eg.bind(null,i,e),a)},useLayoutEffect:function(e,i){return Tl(4194308,4,e,i)},useInsertionEffect:function(e,i){Tl(4,2,e,i)},useMemo:function(e,i){var a=$e();i=i===void 0?null:i;var c=e();if(wn){Cs(!0);try{e()}finally{Cs(!1)}}return a.memoizedState=[c,i],c},useReducer:function(e,i,a){var c=$e();if(a!==void 0){var p=a(i);if(wn){Cs(!0);try{a(i)}finally{Cs(!1)}}}else p=i;return c.memoizedState=c.baseState=p,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:p},c.queue=e,e=e.dispatch=gy.bind(null,Ut,e),[c.memoizedState,e]},useRef:function(e){var i=$e();return e={current:e},i.memoizedState=e},useState:function(e){e=su(e);var i=e.queue,a=dg.bind(null,Ut,i);return i.dispatch=a,[e.memoizedState,a]},useDebugValue:au,useDeferredValue:function(e,i){var a=$e();return ru(a,e,i)},useTransition:function(){var e=su(!1);return e=rg.bind(null,Ut,e.queue,!0,!1),$e().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,i,a){var c=Ut,p=$e();if(Wt){if(a===void 0)throw Error(n(407));a=a()}else{if(a=i(),ce===null)throw Error(n(349));(Zt&127)!==0||zf(c,i,a)}p.memoizedState=a;var y={value:a,getSnapshot:i};return p.queue=y,Wf(Pf.bind(null,c,y,e),[e]),c.flags|=2048,oa(9,{destroy:void 0},Lf.bind(null,c,y,a,i),null),a},useId:function(){var e=$e(),i=ce.identifierPrefix;if(Wt){var a=Ks,c=Zs;a=(c&~(1<<32-me(c)-1)).toString(32)+a,i="_"+i+"R_"+a,a=Sl++,0<a&&(i+="H"+a.toString(32)),i+="_"}else a=ly++,i="_"+i+"r_"+a.toString(32)+"_";return e.memoizedState=i},useHostTransitionStatus:ou,useFormState:Xf,useActionState:Xf,useOptimistic:function(e){var i=$e();i.memoizedState=i.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=a,i=cu.bind(null,Ut,!0,a),a.dispatch=i,[e,i]},useMemoCache:Jc,useCacheRefresh:function(){return $e().memoizedState=fy.bind(null,Ut)},useEffectEvent:function(e){var i=$e(),a={impl:e};return i.memoizedState=a,function(){if((ee&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}},uu={readContext:Be,use:El,useCallback:ig,useContext:Be,useEffect:nu,useImperativeHandle:sg,useInsertionEffect:Jf,useLayoutEffect:tg,useMemo:ng,useReducer:Cl,useRef:Kf,useState:function(){return Cl(hi)},useDebugValue:au,useDeferredValue:function(e,i){var a=xe();return ag(a,ae.memoizedState,e,i)},useTransition:function(){var e=Cl(hi)[0],i=xe().memoizedState;return[typeof e=="boolean"?e:nr(e),i]},useSyncExternalStore:Of,useId:cg,useHostTransitionStatus:ou,useFormState:Yf,useActionState:Yf,useOptimistic:function(e,i){var a=xe();return If(a,ae,e,i)},useMemoCache:Jc,useCacheRefresh:ug};uu.useEffectEvent=Qf;var pg={readContext:Be,use:El,useCallback:ig,useContext:Be,useEffect:nu,useImperativeHandle:sg,useInsertionEffect:Jf,useLayoutEffect:tg,useMemo:ng,useReducer:eu,useRef:Kf,useState:function(){return eu(hi)},useDebugValue:au,useDeferredValue:function(e,i){var a=xe();return ae===null?ru(a,e,i):ag(a,ae.memoizedState,e,i)},useTransition:function(){var e=eu(hi)[0],i=xe().memoizedState;return[typeof e=="boolean"?e:nr(e),i]},useSyncExternalStore:Of,useId:cg,useHostTransitionStatus:ou,useFormState:Zf,useActionState:Zf,useOptimistic:function(e,i){var a=xe();return ae!==null?If(a,ae,e,i):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Jc,useCacheRefresh:ug};pg.useEffectEvent=Qf;function du(e,i,a,c){i=e.memoizedState,a=a(c,i),a=a==null?i:b({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var hu={enqueueSetState:function(e,i,a){e=e._reactInternals;var c=xs(),p=zi(c);p.payload=i,a!=null&&(p.callback=a),i=Li(e,p,c),i!==null&&(rs(i,e,c),tr(i,e,c))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var c=xs(),p=zi(c);p.tag=1,p.payload=i,a!=null&&(p.callback=a),i=Li(e,p,c),i!==null&&(rs(i,e,c),tr(i,e,c))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=xs(),c=zi(a);c.tag=2,i!=null&&(c.callback=i),i=Li(e,c,a),i!==null&&(rs(i,e,a),tr(i,e,a))}};function mg(e,i,a,c,p,y,k){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,y,k):i.prototype&&i.prototype.isPureReactComponent?!Xa(a,c)||!Xa(p,y):!0}function bg(e,i,a,c){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,c),i.state!==e&&hu.enqueueReplaceState(i,i.state,null)}function An(e,i){var a=i;if("ref"in i){a={};for(var c in i)c!=="ref"&&(a[c]=i[c])}if(e=e.defaultProps){a===i&&(a=b({},a));for(var p in e)a[p]===void 0&&(a[p]=e[p])}return a}function yg(e){ol(e)}function vg(e){console.error(e)}function xg(e){ol(e)}function Rl(e,i){try{var a=e.onUncaughtError;a(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function _g(e,i,a){try{var c=e.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function fu(e,i,a){return a=zi(a),a.tag=3,a.payload={element:null},a.callback=function(){Rl(e,i)},a}function wg(e){return e=zi(e),e.tag=3,e}function Ag(e,i,a,c){var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var y=c.value;e.payload=function(){return p(y)},e.callback=function(){_g(i,a,c)}}var k=a.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(e.callback=function(){_g(i,a,c),typeof p!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function py(e,i,a,c,p){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=a.alternate,i!==null&&ta(i,a,p,!0),a=ms.current,a!==null){switch(a.tag){case 31:case 13:return Ls===null?Gl():a.alternate===null&&ye===0&&(ye=3),a.flags&=-257,a.flags|=65536,a.lanes=p,c===yl?a.flags|=16384:(i=a.updateQueue,i===null?a.updateQueue=new Set([c]):i.add(c),Fu(e,c,p)),!1;case 22:return a.flags|=65536,c===yl?a.flags|=16384:(i=a.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=i):(a=i.retryQueue,a===null?i.retryQueue=new Set([c]):a.add(c)),Fu(e,c,p)),!1}throw Error(n(435,a.tag))}return Fu(e,c,p),Gl(),!1}if(Wt)return i=ms.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,c!==jc&&(e=Error(n(422),{cause:c}),Za(js(e,a)))):(c!==jc&&(i=Error(n(423),{cause:c}),Za(js(i,a))),e=e.current.alternate,e.flags|=65536,p&=-p,e.lanes|=p,c=js(c,a),p=fu(e.stateNode,c,p),Gc(e,p),ye!==4&&(ye=2)),!1;var y=Error(n(520),{cause:c});if(y=js(y,a),gr===null?gr=[y]:gr.push(y),ye!==4&&(ye=2),i===null)return!0;c=js(c,a),a=i;do{switch(a.tag){case 3:return a.flags|=65536,e=p&-p,a.lanes|=e,e=fu(a.stateNode,c,e),Gc(a,e),!1;case 1:if(i=a.type,y=a.stateNode,(a.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Hi===null||!Hi.has(y))))return a.flags|=65536,p&=-p,a.lanes|=p,p=wg(p),Ag(p,e,a,c),Gc(a,p),!1}a=a.return}while(a!==null);return!1}var gu=Error(n(461)),ke=!1;function Ie(e,i,a,c){i.child=e===null?Cf(i,null,a,c):_n(i,e.child,a,c)}function Sg(e,i,a,c,p){a=a.render;var y=i.ref;if("ref"in c){var k={};for(var j in c)j!=="ref"&&(k[j]=c[j])}else k=c;return bn(i),c=Zc(e,i,a,k,y,p),j=Kc(),e!==null&&!ke?(Wc(e,i,p),fi(e,i,p)):(Wt&&j&&Mc(i),i.flags|=1,Ie(e,i,c,p),i.child)}function kg(e,i,a,c,p){if(e===null){var y=a.type;return typeof y=="function"&&!Cc(y)&&y.defaultProps===void 0&&a.compare===null?(i.tag=15,i.type=y,Eg(e,i,y,c,p)):(e=hl(a.type,null,c,i,i.mode,p),e.ref=i.ref,e.return=i,i.child=e)}if(y=e.child,!wu(e,p)){var k=y.memoizedProps;if(a=a.compare,a=a!==null?a:Xa,a(k,c)&&e.ref===i.ref)return fi(e,i,p)}return i.flags|=1,e=li(y,c),e.ref=i.ref,e.return=i,i.child=e}function Eg(e,i,a,c,p){if(e!==null){var y=e.memoizedProps;if(Xa(y,c)&&e.ref===i.ref)if(ke=!1,i.pendingProps=c=y,wu(e,p))(e.flags&131072)!==0&&(ke=!0);else return i.lanes=e.lanes,fi(e,i,p)}return pu(e,i,a,c,p)}function Cg(e,i,a,c){var p=c.children,y=e!==null?e.memoizedState:null;if(e===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|a:a,e!==null){for(c=i.child=e.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~y}else c=0,i.child=null;return Tg(e,i,y,a,c)}if((a&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},e!==null&&ml(i,y!==null?y.cachePool:null),y!==null?Mf(i,y):Vc(),Rf(i);else return c=i.lanes=536870912,Tg(e,i,y!==null?y.baseLanes|a:a,a,c)}else y!==null?(ml(i,y.cachePool),Mf(i,y),Fi(),i.memoizedState=null):(e!==null&&ml(i,null),Vc(),Fi());return Ie(e,i,p,a),i.child}function lr(e,i){return e!==null&&e.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Tg(e,i,a,c,p){var y=Bc();return y=y===null?null:{parent:Ae._currentValue,pool:y},i.memoizedState={baseLanes:a,cachePool:y},e!==null&&ml(i,null),Vc(),Rf(i),e!==null&&ta(e,i,c,!0),i.childLanes=p,null}function jl(e,i){return i=Ol({mode:i.mode,children:i.children},e.mode),i.ref=e.ref,e.child=i,i.return=e,i}function Ng(e,i,a){return _n(i,e.child,null,a),e=jl(i,i.pendingProps),e.flags|=2,bs(i),i.memoizedState=null,e}function my(e,i,a){var c=i.pendingProps,p=(i.flags&128)!==0;if(i.flags&=-129,e===null){if(Wt){if(c.mode==="hidden")return e=jl(i,c),i.lanes=536870912,lr(null,e);if(Yc(i),(e=de)?(e=Up(e,zs),e=e!==null&&e.data==="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Mi!==null?{id:Zs,overflow:Ks}:null,retryLane:536870912,hydrationErrors:null},a=hf(e),a.return=i,i.child=a,Fe=i,de=null)):e=null,e===null)throw ji(i);return i.lanes=536870912,null}return jl(i,c)}var y=e.memoizedState;if(y!==null){var k=y.dehydrated;if(Yc(i),p)if(i.flags&256)i.flags&=-257,i=Ng(e,i,a);else if(i.memoizedState!==null)i.child=e.child,i.flags|=128,i=null;else throw Error(n(558));else if(ke||ta(e,i,a,!1),p=(a&e.childLanes)!==0,ke||p){if(c=ce,c!==null&&(k=yh(c,a),k!==0&&k!==y.retryLane))throw y.retryLane=k,fn(e,k),rs(c,e,k),gu;Gl(),i=Ng(e,i,a)}else e=y.treeContext,de=Ps(k.nextSibling),Fe=i,Wt=!0,Ri=null,zs=!1,e!==null&&pf(i,e),i=jl(i,c),i.flags|=4096;return i}return e=li(e.child,{mode:c.mode,children:c.children}),e.ref=i.ref,i.child=e,e.return=i,e}function Dl(e,i){var a=i.ref;if(a===null)e!==null&&e.ref!==null&&(i.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(n(284));(e===null||e.ref!==a)&&(i.flags|=4194816)}}function pu(e,i,a,c,p){return bn(i),a=Zc(e,i,a,c,void 0,p),c=Kc(),e!==null&&!ke?(Wc(e,i,p),fi(e,i,p)):(Wt&&c&&Mc(i),i.flags|=1,Ie(e,i,a,p),i.child)}function Mg(e,i,a,c,p,y){return bn(i),i.updateQueue=null,a=Df(i,c,a,p),jf(e),c=Kc(),e!==null&&!ke?(Wc(e,i,y),fi(e,i,y)):(Wt&&c&&Mc(i),i.flags|=1,Ie(e,i,a,y),i.child)}function Rg(e,i,a,c,p){if(bn(i),i.stateNode===null){var y=Kn,k=a.contextType;typeof k=="object"&&k!==null&&(y=Be(k)),y=new a(c,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=hu,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=c,y.state=i.memoizedState,y.refs={},Uc(i),k=a.contextType,y.context=typeof k=="object"&&k!==null?Be(k):Kn,y.state=i.memoizedState,k=a.getDerivedStateFromProps,typeof k=="function"&&(du(i,a,k,c),y.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(k=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),k!==y.state&&hu.enqueueReplaceState(y,y.state,null),sr(i,c,y,p),er(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(e===null){y=i.stateNode;var j=i.memoizedProps,V=An(a,j);y.props=V;var et=y.context,ht=a.contextType;k=Kn,typeof ht=="object"&&ht!==null&&(k=Be(ht));var pt=a.getDerivedStateFromProps;ht=typeof pt=="function"||typeof y.getSnapshotBeforeUpdate=="function",j=i.pendingProps!==j,ht||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(j||et!==k)&&bg(i,y,c,k),Oi=!1;var it=i.memoizedState;y.state=it,sr(i,c,y,p),er(),et=i.memoizedState,j||it!==et||Oi?(typeof pt=="function"&&(du(i,a,pt,c),et=i.memoizedState),(V=Oi||mg(i,a,V,c,it,et,k))?(ht||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=et),y.props=c,y.state=et,y.context=k,c=V):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{y=i.stateNode,Hc(e,i),k=i.memoizedProps,ht=An(a,k),y.props=ht,pt=i.pendingProps,it=y.context,et=a.contextType,V=Kn,typeof et=="object"&&et!==null&&(V=Be(et)),j=a.getDerivedStateFromProps,(et=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k!==pt||it!==V)&&bg(i,y,c,V),Oi=!1,it=i.memoizedState,y.state=it,sr(i,c,y,p),er();var ct=i.memoizedState;k!==pt||it!==ct||Oi||e!==null&&e.dependencies!==null&&gl(e.dependencies)?(typeof j=="function"&&(du(i,a,j,c),ct=i.memoizedState),(ht=Oi||mg(i,a,ht,c,it,ct,V)||e!==null&&e.dependencies!==null&&gl(e.dependencies))?(et||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,ct,V),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,ct,V)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||k===e.memoizedProps&&it===e.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&it===e.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=ct),y.props=c,y.state=ct,y.context=V,c=ht):(typeof y.componentDidUpdate!="function"||k===e.memoizedProps&&it===e.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&it===e.memoizedState||(i.flags|=1024),c=!1)}return y=c,Dl(e,i),c=(i.flags&128)!==0,y||c?(y=i.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,e!==null&&c?(i.child=_n(i,e.child,null,p),i.child=_n(i,null,a,p)):Ie(e,i,a,p),i.memoizedState=y.state,e=i.child):e=fi(e,i,p),e}function jg(e,i,a,c){return pn(),i.flags|=256,Ie(e,i,a,c),i.child}var mu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bu(e){return{baseLanes:e,cachePool:_f()}}function yu(e,i,a){return e=e!==null?e.childLanes&~a:0,i&&(e|=vs),e}function Dg(e,i,a){var c=i.pendingProps,p=!1,y=(i.flags&128)!==0,k;if((k=y)||(k=e!==null&&e.memoizedState===null?!1:(ve.current&2)!==0),k&&(p=!0,i.flags&=-129),k=(i.flags&32)!==0,i.flags&=-33,e===null){if(Wt){if(p?Pi(i):Fi(),(e=de)?(e=Up(e,zs),e=e!==null&&e.data!=="&"?e:null,e!==null&&(i.memoizedState={dehydrated:e,treeContext:Mi!==null?{id:Zs,overflow:Ks}:null,retryLane:536870912,hydrationErrors:null},a=hf(e),a.return=i,i.child=a,Fe=i,de=null)):e=null,e===null)throw ji(i);return td(e)?i.lanes=32:i.lanes=536870912,null}var j=c.children;return c=c.fallback,p?(Fi(),p=i.mode,j=Ol({mode:"hidden",children:j},p),c=gn(c,p,a,null),j.return=i,c.return=i,j.sibling=c,i.child=j,c=i.child,c.memoizedState=bu(a),c.childLanes=yu(e,k,a),i.memoizedState=mu,lr(null,c)):(Pi(i),vu(i,j))}var V=e.memoizedState;if(V!==null&&(j=V.dehydrated,j!==null)){if(y)i.flags&256?(Pi(i),i.flags&=-257,i=xu(e,i,a)):i.memoizedState!==null?(Fi(),i.child=e.child,i.flags|=128,i=null):(Fi(),j=c.fallback,p=i.mode,c=Ol({mode:"visible",children:c.children},p),j=gn(j,p,a,null),j.flags|=2,c.return=i,j.return=i,c.sibling=j,i.child=c,_n(i,e.child,null,a),c=i.child,c.memoizedState=bu(a),c.childLanes=yu(e,k,a),i.memoizedState=mu,i=lr(null,c));else if(Pi(i),td(j)){if(k=j.nextSibling&&j.nextSibling.dataset,k)var et=k.dgst;k=et,c=Error(n(419)),c.stack="",c.digest=k,Za({value:c,source:null,stack:null}),i=xu(e,i,a)}else if(ke||ta(e,i,a,!1),k=(a&e.childLanes)!==0,ke||k){if(k=ce,k!==null&&(c=yh(k,a),c!==0&&c!==V.retryLane))throw V.retryLane=c,fn(e,c),rs(k,e,c),gu;Ju(j)||Gl(),i=xu(e,i,a)}else Ju(j)?(i.flags|=192,i.child=e.child,i=null):(e=V.treeContext,de=Ps(j.nextSibling),Fe=i,Wt=!0,Ri=null,zs=!1,e!==null&&pf(i,e),i=vu(i,c.children),i.flags|=4096);return i}return p?(Fi(),j=c.fallback,p=i.mode,V=e.child,et=V.sibling,c=li(V,{mode:"hidden",children:c.children}),c.subtreeFlags=V.subtreeFlags&65011712,et!==null?j=li(et,j):(j=gn(j,p,a,null),j.flags|=2),j.return=i,c.return=i,c.sibling=j,i.child=c,lr(null,c),c=i.child,j=e.child.memoizedState,j===null?j=bu(a):(p=j.cachePool,p!==null?(V=Ae._currentValue,p=p.parent!==V?{parent:V,pool:V}:p):p=_f(),j={baseLanes:j.baseLanes|a,cachePool:p}),c.memoizedState=j,c.childLanes=yu(e,k,a),i.memoizedState=mu,lr(e.child,c)):(Pi(i),a=e.child,e=a.sibling,a=li(a,{mode:"visible",children:c.children}),a.return=i,a.sibling=null,e!==null&&(k=i.deletions,k===null?(i.deletions=[e],i.flags|=16):k.push(e)),i.child=a,i.memoizedState=null,a)}function vu(e,i){return i=Ol({mode:"visible",children:i},e.mode),i.return=e,e.child=i}function Ol(e,i){return e=ps(22,e,null,i),e.lanes=0,e}function xu(e,i,a){return _n(i,e.child,null,a),e=vu(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function Og(e,i,a){e.lanes|=i;var c=e.alternate;c!==null&&(c.lanes|=i),zc(e.return,i,a)}function _u(e,i,a,c,p,y){var k=e.memoizedState;k===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:p,treeForkCount:y}:(k.isBackwards=i,k.rendering=null,k.renderingStartTime=0,k.last=c,k.tail=a,k.tailMode=p,k.treeForkCount=y)}function zg(e,i,a){var c=i.pendingProps,p=c.revealOrder,y=c.tail;c=c.children;var k=ve.current,j=(k&2)!==0;if(j?(k=k&1|2,i.flags|=128):k&=1,J(ve,k),Ie(e,i,c,a),c=Wt?$a:0,!j&&e!==null&&(e.flags&128)!==0)t:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Og(e,a,i);else if(e.tag===19)Og(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break t;for(;e.sibling===null;){if(e.return===null||e.return===i)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(p){case"forwards":for(a=i.child,p=null;a!==null;)e=a.alternate,e!==null&&wl(e)===null&&(p=a),a=a.sibling;a=p,a===null?(p=i.child,i.child=null):(p=a.sibling,a.sibling=null),_u(i,!1,p,a,y,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,p=i.child,i.child=null;p!==null;){if(e=p.alternate,e!==null&&wl(e)===null){i.child=p;break}e=p.sibling,p.sibling=a,a=p,p=e}_u(i,!0,a,null,y,c);break;case"together":_u(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function fi(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),Ui|=i.lanes,(a&i.childLanes)===0)if(e!==null){if(ta(e,i,a,!1),(a&i.childLanes)===0)return null}else return null;if(e!==null&&i.child!==e.child)throw Error(n(153));if(i.child!==null){for(e=i.child,a=li(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=li(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function wu(e,i){return(e.lanes&i)!==0?!0:(e=e.dependencies,!!(e!==null&&gl(e)))}function by(e,i,a){switch(i.tag){case 3:Et(i,i.stateNode.containerInfo),Di(i,Ae,e.memoizedState.cache),pn();break;case 27:case 5:At(i);break;case 4:Et(i,i.stateNode.containerInfo);break;case 10:Di(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Yc(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Pi(i),i.flags|=128,null):(a&i.child.childLanes)!==0?Dg(e,i,a):(Pi(i),e=fi(e,i,a),e!==null?e.sibling:null);Pi(i);break;case 19:var p=(e.flags&128)!==0;if(c=(a&i.childLanes)!==0,c||(ta(e,i,a,!1),c=(a&i.childLanes)!==0),p){if(c)return zg(e,i,a);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),J(ve,ve.current),c)break;return null;case 22:return i.lanes=0,Cg(e,i,a,i.pendingProps);case 24:Di(i,Ae,e.memoizedState.cache)}return fi(e,i,a)}function Lg(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps)ke=!0;else{if(!wu(e,a)&&(i.flags&128)===0)return ke=!1,by(e,i,a);ke=(e.flags&131072)!==0}else ke=!1,Wt&&(i.flags&1048576)!==0&&gf(i,$a,i.index);switch(i.lanes=0,i.tag){case 16:t:{var c=i.pendingProps;if(e=vn(i.elementType),i.type=e,typeof e=="function")Cc(e)?(c=An(e,c),i.tag=1,i=Rg(null,i,e,c,a)):(i.tag=0,i=pu(null,i,e,c,a));else{if(e!=null){var p=e.$$typeof;if(p===R){i.tag=11,i=Sg(null,i,e,c,a);break t}else if(p===I){i.tag=14,i=kg(null,i,e,c,a);break t}}throw i=T(e)||e,Error(n(306,i,""))}}return i;case 0:return pu(e,i,i.type,i.pendingProps,a);case 1:return c=i.type,p=An(c,i.pendingProps),Rg(e,i,c,p,a);case 3:t:{if(Et(i,i.stateNode.containerInfo),e===null)throw Error(n(387));c=i.pendingProps;var y=i.memoizedState;p=y.element,Hc(e,i),sr(i,c,null,a);var k=i.memoizedState;if(c=k.cache,Di(i,Ae,c),c!==y.cache&&Lc(i,[Ae],a,!0),er(),c=k.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:k.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=jg(e,i,c,a);break t}else if(c!==p){p=js(Error(n(424)),i),Za(p),i=jg(e,i,c,a);break t}else for(e=i.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,de=Ps(e.firstChild),Fe=i,Wt=!0,Ri=null,zs=!0,a=Cf(i,null,c,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(pn(),c===p){i=fi(e,i,a);break t}Ie(e,i,c,a)}i=i.child}return i;case 26:return Dl(e,i),e===null?(a=Yp(i.type,null,i.pendingProps,null))?i.memoizedState=a:Wt||(a=i.type,e=i.pendingProps,c=Kl(_t.current).createElement(a),c[Pe]=i,c[ts]=e,Ue(c,a,e),ze(c),i.stateNode=c):i.memoizedState=Yp(i.type,e.memoizedProps,i.pendingProps,e.memoizedState),null;case 27:return At(i),e===null&&Wt&&(c=i.stateNode=qp(i.type,i.pendingProps,_t.current),Fe=i,zs=!0,p=de,Xi(i.type)?(ed=p,de=Ps(c.firstChild)):de=p),Ie(e,i,i.pendingProps.children,a),Dl(e,i),e===null&&(i.flags|=4194304),i.child;case 5:return e===null&&Wt&&((p=c=de)&&(c=Yy(c,i.type,i.pendingProps,zs),c!==null?(i.stateNode=c,Fe=i,de=Ps(c.firstChild),zs=!1,p=!0):p=!1),p||ji(i)),At(i),p=i.type,y=i.pendingProps,k=e!==null?e.memoizedProps:null,c=y.children,Ku(p,y)?c=null:k!==null&&Ku(p,k)&&(i.flags|=32),i.memoizedState!==null&&(p=Zc(e,i,oy,null,null,a),wr._currentValue=p),Dl(e,i),Ie(e,i,c,a),i.child;case 6:return e===null&&Wt&&((e=a=de)&&(a=$y(a,i.pendingProps,zs),a!==null?(i.stateNode=a,Fe=i,de=null,e=!0):e=!1),e||ji(i)),null;case 13:return Dg(e,i,a);case 4:return Et(i,i.stateNode.containerInfo),c=i.pendingProps,e===null?i.child=_n(i,null,c,a):Ie(e,i,c,a),i.child;case 11:return Sg(e,i,i.type,i.pendingProps,a);case 7:return Ie(e,i,i.pendingProps,a),i.child;case 8:return Ie(e,i,i.pendingProps.children,a),i.child;case 12:return Ie(e,i,i.pendingProps.children,a),i.child;case 10:return c=i.pendingProps,Di(i,i.type,c.value),Ie(e,i,c.children,a),i.child;case 9:return p=i.type._context,c=i.pendingProps.children,bn(i),p=Be(p),c=c(p),i.flags|=1,Ie(e,i,c,a),i.child;case 14:return kg(e,i,i.type,i.pendingProps,a);case 15:return Eg(e,i,i.type,i.pendingProps,a);case 19:return zg(e,i,a);case 31:return my(e,i,a);case 22:return Cg(e,i,a,i.pendingProps);case 24:return bn(i),c=Be(Ae),e===null?(p=Bc(),p===null&&(p=ce,y=Pc(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=a),p=y),i.memoizedState={parent:c,cache:p},Uc(i),Di(i,Ae,p)):((e.lanes&a)!==0&&(Hc(e,i),sr(i,null,null,a),er()),p=e.memoizedState,y=i.memoizedState,p.parent!==c?(p={parent:c,cache:c},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),Di(i,Ae,c)):(c=y.cache,Di(i,Ae,c),c!==p.cache&&Lc(i,[Ae],a,!0))),Ie(e,i,i.pendingProps.children,a),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function gi(e){e.flags|=4}function Au(e,i,a,c,p){if((i=(e.mode&32)!==0)&&(i=!1),i){if(e.flags|=16777216,(p&335544128)===p)if(e.stateNode.complete)e.flags|=8192;else if(cp())e.flags|=8192;else throw xn=yl,Ic}else e.flags&=-16777217}function Pg(e,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Qp(i))if(cp())e.flags|=8192;else throw xn=yl,Ic}function zl(e,i){i!==null&&(e.flags|=4),e.flags&16384&&(i=e.tag!==22?ph():536870912,e.lanes|=i,ha|=i)}function or(e,i){if(!Wt)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function he(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,c=0;if(i)for(var p=e.child;p!==null;)a|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=e,p=p.sibling;else for(p=e.child;p!==null;)a|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=e,p=p.sibling;return e.subtreeFlags|=c,e.childLanes=a,i}function yy(e,i,a){var c=i.pendingProps;switch(Rc(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return he(i),null;case 1:return he(i),null;case 3:return a=i.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),ui(Ae),ot(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Jn(i)?gi(i):e===null||e.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Dc())),he(i),null;case 26:var p=i.type,y=i.memoizedState;return e===null?(gi(i),y!==null?(he(i),Pg(i,y)):(he(i),Au(i,p,null,c,a))):y?y!==e.memoizedState?(gi(i),he(i),Pg(i,y)):(he(i),i.flags&=-16777217):(e=e.memoizedProps,e!==c&&gi(i),he(i),Au(i,p,e,c,a)),null;case 27:if(Ot(i),a=_t.current,p=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==c&&gi(i);else{if(!c){if(i.stateNode===null)throw Error(n(166));return he(i),null}e=rt.current,Jn(i)?mf(i):(e=qp(p,c,a),i.stateNode=e,gi(i))}return he(i),null;case 5:if(Ot(i),p=i.type,e!==null&&i.stateNode!=null)e.memoizedProps!==c&&gi(i);else{if(!c){if(i.stateNode===null)throw Error(n(166));return he(i),null}if(y=rt.current,Jn(i))mf(i);else{var k=Kl(_t.current);switch(y){case 1:y=k.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=k.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=k.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=k.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=k.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?k.createElement("select",{is:c.is}):k.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?k.createElement(p,{is:c.is}):k.createElement(p)}}y[Pe]=i,y[ts]=c;t:for(k=i.child;k!==null;){if(k.tag===5||k.tag===6)y.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===i)break t;for(;k.sibling===null;){if(k.return===null||k.return===i)break t;k=k.return}k.sibling.return=k.return,k=k.sibling}i.stateNode=y;t:switch(Ue(y,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&gi(i)}}return he(i),Au(i,i.type,e===null?null:e.memoizedProps,i.pendingProps,a),null;case 6:if(e&&i.stateNode!=null)e.memoizedProps!==c&&gi(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(n(166));if(e=_t.current,Jn(i)){if(e=i.stateNode,a=i.memoizedProps,c=null,p=Fe,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}e[Pe]=i,e=!!(e.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||Dp(e.nodeValue,a)),e||ji(i,!0)}else e=Kl(e).createTextNode(c),e[Pe]=i,i.stateNode=e}return he(i),null;case 31:if(a=i.memoizedState,e===null||e.memoizedState!==null){if(c=Jn(i),a!==null){if(e===null){if(!c)throw Error(n(318));if(e=i.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(557));e[Pe]=i}else pn(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;he(i),e=!1}else a=Dc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return i.flags&256?(bs(i),i):(bs(i),null);if((i.flags&128)!==0)throw Error(n(558))}return he(i),null;case 13:if(c=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(p=Jn(i),c!==null&&c.dehydrated!==null){if(e===null){if(!p)throw Error(n(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[Pe]=i}else pn(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;he(i),p=!1}else p=Dc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(bs(i),i):(bs(i),null)}return bs(i),(i.flags&128)!==0?(i.lanes=a,i):(a=c!==null,e=e!==null&&e.memoizedState!==null,a&&(c=i.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048)),a!==e&&a&&(i.child.flags|=8192),zl(i,i.updateQueue),he(i),null);case 4:return ot(),e===null&&Vu(i.stateNode.containerInfo),he(i),null;case 10:return ui(i.type),he(i),null;case 19:if(L(ve),c=i.memoizedState,c===null)return he(i),null;if(p=(i.flags&128)!==0,y=c.rendering,y===null)if(p)or(c,!1);else{if(ye!==0||e!==null&&(e.flags&128)!==0)for(e=i.child;e!==null;){if(y=wl(e),y!==null){for(i.flags|=128,or(c,!1),e=y.updateQueue,i.updateQueue=e,zl(i,e),i.subtreeFlags=0,e=a,a=i.child;a!==null;)df(a,e),a=a.sibling;return J(ve,ve.current&1|2),Wt&&oi(i,c.treeForkCount),i.child}e=e.sibling}c.tail!==null&&wt()>Il&&(i.flags|=128,p=!0,or(c,!1),i.lanes=4194304)}else{if(!p)if(e=wl(y),e!==null){if(i.flags|=128,p=!0,e=e.updateQueue,i.updateQueue=e,zl(i,e),or(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!Wt)return he(i),null}else 2*wt()-c.renderingStartTime>Il&&a!==536870912&&(i.flags|=128,p=!0,or(c,!1),i.lanes=4194304);c.isBackwards?(y.sibling=i.child,i.child=y):(e=c.last,e!==null?e.sibling=y:i.child=y,c.last=y)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=wt(),e.sibling=null,a=ve.current,J(ve,p?a&1|2:a&1),Wt&&oi(i,c.treeForkCount),e):(he(i),null);case 22:case 23:return bs(i),Xc(),c=i.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(a&536870912)!==0&&(i.flags&128)===0&&(he(i),i.subtreeFlags&6&&(i.flags|=8192)):he(i),a=i.updateQueue,a!==null&&zl(i,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==a&&(i.flags|=2048),e!==null&&L(yn),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),i.memoizedState.cache!==a&&(i.flags|=2048),ui(Ae),he(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function vy(e,i){switch(Rc(i),i.tag){case 1:return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return ui(Ae),ot(),e=i.flags,(e&65536)!==0&&(e&128)===0?(i.flags=e&-65537|128,i):null;case 26:case 27:case 5:return Ot(i),null;case 31:if(i.memoizedState!==null){if(bs(i),i.alternate===null)throw Error(n(340));pn()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 13:if(bs(i),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(n(340));pn()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return L(ve),null;case 4:return ot(),null;case 10:return ui(i.type),null;case 22:case 23:return bs(i),Xc(),e!==null&&L(yn),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 24:return ui(Ae),null;case 25:return null;default:return null}}function Fg(e,i){switch(Rc(i),i.tag){case 3:ui(Ae),ot();break;case 26:case 27:case 5:Ot(i);break;case 4:ot();break;case 31:i.memoizedState!==null&&bs(i);break;case 13:bs(i);break;case 19:L(ve);break;case 10:ui(i.type);break;case 22:case 23:bs(i),Xc(),e!==null&&L(yn);break;case 24:ui(Ae)}}function cr(e,i){try{var a=i.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var p=c.next;a=p;do{if((a.tag&e)===e){c=void 0;var y=a.create,k=a.inst;c=y(),k.destroy=c}a=a.next}while(a!==p)}}catch(j){ne(i,i.return,j)}}function Bi(e,i,a){try{var c=i.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var y=p.next;c=y;do{if((c.tag&e)===e){var k=c.inst,j=k.destroy;if(j!==void 0){k.destroy=void 0,p=i;var V=a,et=j;try{et()}catch(ht){ne(p,V,ht)}}}c=c.next}while(c!==y)}}catch(ht){ne(i,i.return,ht)}}function Bg(e){var i=e.updateQueue;if(i!==null){var a=e.stateNode;try{Nf(i,a)}catch(c){ne(e,e.return,c)}}}function Ig(e,i,a){a.props=An(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(c){ne(e,i,c)}}function ur(e,i){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof a=="function"?e.refCleanup=a(c):a.current=c}}catch(p){ne(e,i,p)}}function Ws(e,i){var a=e.ref,c=e.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(p){ne(e,i,p)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(p){ne(e,i,p)}else a.current=null}function Ug(e){var i=e.type,a=e.memoizedProps,c=e.stateNode;try{t:switch(i){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break t;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(p){ne(e,e.return,p)}}function Su(e,i,a){try{var c=e.stateNode;Uy(c,e.type,a,i),c[ts]=i}catch(p){ne(e,e.return,p)}}function Hg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Xi(e.type)||e.tag===4}function ku(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Hg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Xi(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Eu(e,i,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,i?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,i):(i=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,i.appendChild(e),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=ai));else if(c!==4&&(c===27&&Xi(e.type)&&(a=e.stateNode,i=null),e=e.child,e!==null))for(Eu(e,i,a),e=e.sibling;e!==null;)Eu(e,i,a),e=e.sibling}function Ll(e,i,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(c!==4&&(c===27&&Xi(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Ll(e,i,a),e=e.sibling;e!==null;)Ll(e,i,a),e=e.sibling}function Gg(e){var i=e.stateNode,a=e.memoizedProps;try{for(var c=e.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);Ue(i,c,a),i[Pe]=e,i[ts]=a}catch(y){ne(e,e.return,y)}}var pi=!1,Ee=!1,Cu=!1,qg=typeof WeakSet=="function"?WeakSet:Set,Le=null;function xy(e,i){if(e=e.containerInfo,$u=io,e=ef(e),xc(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{a.nodeType,y.nodeType}catch{a=null;break t}var k=0,j=-1,V=-1,et=0,ht=0,pt=e,it=null;e:for(;;){for(var ct;pt!==a||p!==0&&pt.nodeType!==3||(j=k+p),pt!==y||c!==0&&pt.nodeType!==3||(V=k+c),pt.nodeType===3&&(k+=pt.nodeValue.length),(ct=pt.firstChild)!==null;)it=pt,pt=ct;for(;;){if(pt===e)break e;if(it===a&&++et===p&&(j=k),it===y&&++ht===c&&(V=k),(ct=pt.nextSibling)!==null)break;pt=it,it=pt.parentNode}pt=ct}a=j===-1||V===-1?null:{start:j,end:V}}else a=null}a=a||{start:0,end:0}}else a=null;for(Zu={focusedElem:e,selectionRange:a},io=!1,Le=i;Le!==null;)if(i=Le,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,Le=e;else for(;Le!==null;){switch(i=Le,y=i.alternate,e=i.flags,i.tag){case 0:if((e&4)!==0&&(e=i.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)p=e[a],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&y!==null){e=void 0,a=i,p=y.memoizedProps,y=y.memoizedState,c=a.stateNode;try{var St=An(a.type,p);e=c.getSnapshotBeforeUpdate(St,y),c.__reactInternalSnapshotBeforeUpdate=e}catch(Rt){ne(a,a.return,Rt)}}break;case 3:if((e&1024)!==0){if(e=i.stateNode.containerInfo,a=e.nodeType,a===9)Qu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Qu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(n(163))}if(e=i.sibling,e!==null){e.return=i.return,Le=e;break}Le=i.return}}function Vg(e,i,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:bi(e,a),c&4&&cr(5,a);break;case 1:if(bi(e,a),c&4)if(e=a.stateNode,i===null)try{e.componentDidMount()}catch(k){ne(a,a.return,k)}else{var p=An(a.type,i.memoizedProps);i=i.memoizedState;try{e.componentDidUpdate(p,i,e.__reactInternalSnapshotBeforeUpdate)}catch(k){ne(a,a.return,k)}}c&64&&Bg(a),c&512&&ur(a,a.return);break;case 3:if(bi(e,a),c&64&&(e=a.updateQueue,e!==null)){if(i=null,a.child!==null)switch(a.child.tag){case 27:case 5:i=a.child.stateNode;break;case 1:i=a.child.stateNode}try{Nf(e,i)}catch(k){ne(a,a.return,k)}}break;case 27:i===null&&c&4&&Gg(a);case 26:case 5:bi(e,a),i===null&&c&4&&Ug(a),c&512&&ur(a,a.return);break;case 12:bi(e,a);break;case 31:bi(e,a),c&4&&$g(e,a);break;case 13:bi(e,a),c&4&&Zg(e,a),c&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Ny.bind(null,a),Zy(e,a))));break;case 22:if(c=a.memoizedState!==null||pi,!c){i=i!==null&&i.memoizedState!==null||Ee,p=pi;var y=Ee;pi=c,(Ee=i)&&!y?yi(e,a,(a.subtreeFlags&8772)!==0):bi(e,a),pi=p,Ee=y}break;case 30:break;default:bi(e,a)}}function Xg(e){var i=e.alternate;i!==null&&(e.alternate=null,Xg(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&ic(i)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var fe=null,ss=!1;function mi(e,i,a){for(a=a.child;a!==null;)Yg(e,i,a),a=a.sibling}function Yg(e,i,a){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(oe,a)}catch{}switch(a.tag){case 26:Ee||Ws(a,i),mi(e,i,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Ee||Ws(a,i);var c=fe,p=ss;Xi(a.type)&&(fe=a.stateNode,ss=!1),mi(e,i,a),vr(a.stateNode),fe=c,ss=p;break;case 5:Ee||Ws(a,i);case 6:if(c=fe,p=ss,fe=null,mi(e,i,a),fe=c,ss=p,fe!==null)if(ss)try{(fe.nodeType===9?fe.body:fe.nodeName==="HTML"?fe.ownerDocument.body:fe).removeChild(a.stateNode)}catch(y){ne(a,i,y)}else try{fe.removeChild(a.stateNode)}catch(y){ne(a,i,y)}break;case 18:fe!==null&&(ss?(e=fe,Bp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),xa(e)):Bp(fe,a.stateNode));break;case 4:c=fe,p=ss,fe=a.stateNode.containerInfo,ss=!0,mi(e,i,a),fe=c,ss=p;break;case 0:case 11:case 14:case 15:Bi(2,a,i),Ee||Bi(4,a,i),mi(e,i,a);break;case 1:Ee||(Ws(a,i),c=a.stateNode,typeof c.componentWillUnmount=="function"&&Ig(a,i,c)),mi(e,i,a);break;case 21:mi(e,i,a);break;case 22:Ee=(c=Ee)||a.memoizedState!==null,mi(e,i,a),Ee=c;break;default:mi(e,i,a)}}function $g(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{xa(e)}catch(a){ne(i,i.return,a)}}}function Zg(e,i){if(i.memoizedState===null&&(e=i.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{xa(e)}catch(a){ne(i,i.return,a)}}function _y(e){switch(e.tag){case 31:case 13:case 19:var i=e.stateNode;return i===null&&(i=e.stateNode=new qg),i;case 22:return e=e.stateNode,i=e._retryCache,i===null&&(i=e._retryCache=new qg),i;default:throw Error(n(435,e.tag))}}function Pl(e,i){var a=_y(e);i.forEach(function(c){if(!a.has(c)){a.add(c);var p=My.bind(null,e,c);c.then(p,p)}})}function is(e,i){var a=i.deletions;if(a!==null)for(var c=0;c<a.length;c++){var p=a[c],y=e,k=i,j=k;t:for(;j!==null;){switch(j.tag){case 27:if(Xi(j.type)){fe=j.stateNode,ss=!1;break t}break;case 5:fe=j.stateNode,ss=!1;break t;case 3:case 4:fe=j.stateNode.containerInfo,ss=!0;break t}j=j.return}if(fe===null)throw Error(n(160));Yg(y,k,p),fe=null,ss=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Kg(i,e),i=i.sibling}var Hs=null;function Kg(e,i){var a=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:is(i,e),ns(e),c&4&&(Bi(3,e,e.return),cr(3,e),Bi(5,e,e.return));break;case 1:is(i,e),ns(e),c&512&&(Ee||a===null||Ws(a,a.return)),c&64&&pi&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var p=Hs;if(is(i,e),ns(e),c&512&&(Ee||a===null||Ws(a,a.return)),c&4){var y=a!==null?a.memoizedState:null;if(c=e.memoizedState,a===null)if(c===null)if(e.stateNode===null){t:{c=e.type,a=e.memoizedProps,p=p.ownerDocument||p;e:switch(c){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Pa]||y[Pe]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(c),p.head.insertBefore(y,p.querySelector("head > title"))),Ue(y,c,a),y[Pe]=e,ze(y),c=y;break t;case"link":var k=Kp("link","href",p).get(c+(a.href||""));if(k){for(var j=0;j<k.length;j++)if(y=k[j],y.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&y.getAttribute("rel")===(a.rel==null?null:a.rel)&&y.getAttribute("title")===(a.title==null?null:a.title)&&y.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){k.splice(j,1);break e}}y=p.createElement(c),Ue(y,c,a),p.head.appendChild(y);break;case"meta":if(k=Kp("meta","content",p).get(c+(a.content||""))){for(j=0;j<k.length;j++)if(y=k[j],y.getAttribute("content")===(a.content==null?null:""+a.content)&&y.getAttribute("name")===(a.name==null?null:a.name)&&y.getAttribute("property")===(a.property==null?null:a.property)&&y.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&y.getAttribute("charset")===(a.charSet==null?null:a.charSet)){k.splice(j,1);break e}}y=p.createElement(c),Ue(y,c,a),p.head.appendChild(y);break;default:throw Error(n(468,c))}y[Pe]=e,ze(y),c=y}e.stateNode=c}else Wp(p,e.type,e.stateNode);else e.stateNode=Zp(p,c,e.memoizedProps);else y!==c?(y===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):y.count--,c===null?Wp(p,e.type,e.stateNode):Zp(p,c,e.memoizedProps)):c===null&&e.stateNode!==null&&Su(e,e.memoizedProps,a.memoizedProps)}break;case 27:is(i,e),ns(e),c&512&&(Ee||a===null||Ws(a,a.return)),a!==null&&c&4&&Su(e,e.memoizedProps,a.memoizedProps);break;case 5:if(is(i,e),ns(e),c&512&&(Ee||a===null||Ws(a,a.return)),e.flags&32){p=e.stateNode;try{Gn(p,"")}catch(St){ne(e,e.return,St)}}c&4&&e.stateNode!=null&&(p=e.memoizedProps,Su(e,p,a!==null?a.memoizedProps:p)),c&1024&&(Cu=!0);break;case 6:if(is(i,e),ns(e),c&4){if(e.stateNode===null)throw Error(n(162));c=e.memoizedProps,a=e.stateNode;try{a.nodeValue=c}catch(St){ne(e,e.return,St)}}break;case 3:if(Jl=null,p=Hs,Hs=Wl(i.containerInfo),is(i,e),Hs=p,ns(e),c&4&&a!==null&&a.memoizedState.isDehydrated)try{xa(i.containerInfo)}catch(St){ne(e,e.return,St)}Cu&&(Cu=!1,Wg(e));break;case 4:c=Hs,Hs=Wl(e.stateNode.containerInfo),is(i,e),ns(e),Hs=c;break;case 12:is(i,e),ns(e);break;case 31:is(i,e),ns(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Pl(e,c)));break;case 13:is(i,e),ns(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Bl=wt()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Pl(e,c)));break;case 22:p=e.memoizedState!==null;var V=a!==null&&a.memoizedState!==null,et=pi,ht=Ee;if(pi=et||p,Ee=ht||V,is(i,e),Ee=ht,pi=et,ns(e),c&8192)t:for(i=e.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(a===null||V||pi||Ee||Sn(e)),a=null,i=e;;){if(i.tag===5||i.tag===26){if(a===null){V=a=i;try{if(y=V.stateNode,p)k=y.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{j=V.stateNode;var pt=V.memoizedProps.style,it=pt!=null&&pt.hasOwnProperty("display")?pt.display:null;j.style.display=it==null||typeof it=="boolean"?"":(""+it).trim()}}catch(St){ne(V,V.return,St)}}}else if(i.tag===6){if(a===null){V=i;try{V.stateNode.nodeValue=p?"":V.memoizedProps}catch(St){ne(V,V.return,St)}}}else if(i.tag===18){if(a===null){V=i;try{var ct=V.stateNode;p?Ip(ct,!0):Ip(V.stateNode,!1)}catch(St){ne(V,V.return,St)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===e)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;a===i&&(a=null),i=i.return}a===i&&(a=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=e.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,Pl(e,a))));break;case 19:is(i,e),ns(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,Pl(e,c)));break;case 30:break;case 21:break;default:is(i,e),ns(e)}}function ns(e){var i=e.flags;if(i&2){try{for(var a,c=e.return;c!==null;){if(Hg(c)){a=c;break}c=c.return}if(a==null)throw Error(n(160));switch(a.tag){case 27:var p=a.stateNode,y=ku(e);Ll(e,y,p);break;case 5:var k=a.stateNode;a.flags&32&&(Gn(k,""),a.flags&=-33);var j=ku(e);Ll(e,j,k);break;case 3:case 4:var V=a.stateNode.containerInfo,et=ku(e);Eu(e,et,V);break;default:throw Error(n(161))}}catch(ht){ne(e,e.return,ht)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function Wg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var i=e;Wg(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),e=e.sibling}}function bi(e,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Vg(e,i.alternate,i),i=i.sibling}function Sn(e){for(e=e.child;e!==null;){var i=e;switch(i.tag){case 0:case 11:case 14:case 15:Bi(4,i,i.return),Sn(i);break;case 1:Ws(i,i.return);var a=i.stateNode;typeof a.componentWillUnmount=="function"&&Ig(i,i.return,a),Sn(i);break;case 27:vr(i.stateNode);case 26:case 5:Ws(i,i.return),Sn(i);break;case 22:i.memoizedState===null&&Sn(i);break;case 30:Sn(i);break;default:Sn(i)}e=e.sibling}}function yi(e,i,a){for(a=a&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,p=e,y=i,k=y.flags;switch(y.tag){case 0:case 11:case 15:yi(p,y,a),cr(4,y);break;case 1:if(yi(p,y,a),c=y,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(et){ne(c,c.return,et)}if(c=y,p=c.updateQueue,p!==null){var j=c.stateNode;try{var V=p.shared.hiddenCallbacks;if(V!==null)for(p.shared.hiddenCallbacks=null,p=0;p<V.length;p++)Tf(V[p],j)}catch(et){ne(c,c.return,et)}}a&&k&64&&Bg(y),ur(y,y.return);break;case 27:Gg(y);case 26:case 5:yi(p,y,a),a&&c===null&&k&4&&Ug(y),ur(y,y.return);break;case 12:yi(p,y,a);break;case 31:yi(p,y,a),a&&k&4&&$g(p,y);break;case 13:yi(p,y,a),a&&k&4&&Zg(p,y);break;case 22:y.memoizedState===null&&yi(p,y,a),ur(y,y.return);break;case 30:break;default:yi(p,y,a)}i=i.sibling}}function Tu(e,i){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Ka(a))}function Nu(e,i){e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Ka(e))}function Gs(e,i,a,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Qg(e,i,a,c),i=i.sibling}function Qg(e,i,a,c){var p=i.flags;switch(i.tag){case 0:case 11:case 15:Gs(e,i,a,c),p&2048&&cr(9,i);break;case 1:Gs(e,i,a,c);break;case 3:Gs(e,i,a,c),p&2048&&(e=null,i.alternate!==null&&(e=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==e&&(i.refCount++,e!=null&&Ka(e)));break;case 12:if(p&2048){Gs(e,i,a,c),e=i.stateNode;try{var y=i.memoizedProps,k=y.id,j=y.onPostCommit;typeof j=="function"&&j(k,i.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(V){ne(i,i.return,V)}}else Gs(e,i,a,c);break;case 31:Gs(e,i,a,c);break;case 13:Gs(e,i,a,c);break;case 23:break;case 22:y=i.stateNode,k=i.alternate,i.memoizedState!==null?y._visibility&2?Gs(e,i,a,c):dr(e,i):y._visibility&2?Gs(e,i,a,c):(y._visibility|=2,ca(e,i,a,c,(i.subtreeFlags&10256)!==0||!1)),p&2048&&Tu(k,i);break;case 24:Gs(e,i,a,c),p&2048&&Nu(i.alternate,i);break;default:Gs(e,i,a,c)}}function ca(e,i,a,c,p){for(p=p&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=e,k=i,j=a,V=c,et=k.flags;switch(k.tag){case 0:case 11:case 15:ca(y,k,j,V,p),cr(8,k);break;case 23:break;case 22:var ht=k.stateNode;k.memoizedState!==null?ht._visibility&2?ca(y,k,j,V,p):dr(y,k):(ht._visibility|=2,ca(y,k,j,V,p)),p&&et&2048&&Tu(k.alternate,k);break;case 24:ca(y,k,j,V,p),p&&et&2048&&Nu(k.alternate,k);break;default:ca(y,k,j,V,p)}i=i.sibling}}function dr(e,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var a=e,c=i,p=c.flags;switch(c.tag){case 22:dr(a,c),p&2048&&Tu(c.alternate,c);break;case 24:dr(a,c),p&2048&&Nu(c.alternate,c);break;default:dr(a,c)}i=i.sibling}}var hr=8192;function ua(e,i,a){if(e.subtreeFlags&hr)for(e=e.child;e!==null;)Jg(e,i,a),e=e.sibling}function Jg(e,i,a){switch(e.tag){case 26:ua(e,i,a),e.flags&hr&&e.memoizedState!==null&&lv(a,Hs,e.memoizedState,e.memoizedProps);break;case 5:ua(e,i,a);break;case 3:case 4:var c=Hs;Hs=Wl(e.stateNode.containerInfo),ua(e,i,a),Hs=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=hr,hr=16777216,ua(e,i,a),hr=c):ua(e,i,a));break;default:ua(e,i,a)}}function tp(e){var i=e.alternate;if(i!==null&&(e=i.child,e!==null)){i.child=null;do i=e.sibling,e.sibling=null,e=i;while(e!==null)}}function fr(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var a=0;a<i.length;a++){var c=i[a];Le=c,sp(c,e)}tp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ep(e),e=e.sibling}function ep(e){switch(e.tag){case 0:case 11:case 15:fr(e),e.flags&2048&&Bi(9,e,e.return);break;case 3:fr(e);break;case 12:fr(e);break;case 22:var i=e.stateNode;e.memoizedState!==null&&i._visibility&2&&(e.return===null||e.return.tag!==13)?(i._visibility&=-3,Fl(e)):fr(e);break;default:fr(e)}}function Fl(e){var i=e.deletions;if((e.flags&16)!==0){if(i!==null)for(var a=0;a<i.length;a++){var c=i[a];Le=c,sp(c,e)}tp(e)}for(e=e.child;e!==null;){switch(i=e,i.tag){case 0:case 11:case 15:Bi(8,i,i.return),Fl(i);break;case 22:a=i.stateNode,a._visibility&2&&(a._visibility&=-3,Fl(i));break;default:Fl(i)}e=e.sibling}}function sp(e,i){for(;Le!==null;){var a=Le;switch(a.tag){case 0:case 11:case 15:Bi(8,a,i);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ka(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,Le=c;else t:for(a=e;Le!==null;){c=Le;var p=c.sibling,y=c.return;if(Xg(c),c===a){Le=null;break t}if(p!==null){p.return=y,Le=p;break t}Le=y}}}var wy={getCacheForType:function(e){var i=Be(Ae),a=i.data.get(e);return a===void 0&&(a=e(),i.data.set(e,a)),a},cacheSignal:function(){return Be(Ae).controller.signal}},Ay=typeof WeakMap=="function"?WeakMap:Map,ee=0,ce=null,Yt=null,Zt=0,ie=0,ys=null,Ii=!1,da=!1,Mu=!1,vi=0,ye=0,Ui=0,kn=0,Ru=0,vs=0,ha=0,gr=null,as=null,ju=!1,Bl=0,ip=0,Il=1/0,Ul=null,Hi=null,Ne=0,Gi=null,fa=null,xi=0,Du=0,Ou=null,np=null,pr=0,zu=null;function xs(){return(ee&2)!==0&&Zt!==0?Zt&-Zt:H.T!==null?Uu():vh()}function ap(){if(vs===0)if((Zt&536870912)===0||Wt){var e=on;on<<=1,(on&3932160)===0&&(on=262144),vs=e}else vs=536870912;return e=ms.current,e!==null&&(e.flags|=32),vs}function rs(e,i,a){(e===ce&&(ie===2||ie===9)||e.cancelPendingCommit!==null)&&(ga(e,0),qi(e,Zt,vs,!1)),La(e,a),((ee&2)===0||e!==ce)&&(e===ce&&((ee&2)===0&&(kn|=a),ye===4&&qi(e,Zt,vs,!1)),Qs(e))}function rp(e,i,a){if((ee&6)!==0)throw Error(n(327));var c=!a&&(i&127)===0&&(i&e.expiredLanes)===0||za(e,i),p=c?Ey(e,i):Pu(e,i,!0),y=c;do{if(p===0){da&&!c&&qi(e,i,0,!1);break}else{if(a=e.current.alternate,y&&!Sy(a)){p=Pu(e,i,!1),y=!1;continue}if(p===2){if(y=i,e.errorRecoveryDisabledLanes&y)var k=0;else k=e.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){i=k;t:{var j=e;p=gr;var V=j.current.memoizedState.isDehydrated;if(V&&(ga(j,k).flags|=256),k=Pu(j,k,!1),k!==2){if(Mu&&!V){j.errorRecoveryDisabledLanes|=y,kn|=y,p=4;break t}y=as,as=p,y!==null&&(as===null?as=y:as.push.apply(as,y))}p=k}if(y=!1,p!==2)continue}}if(p===1){ga(e,0),qi(e,i,0,!0);break}t:{switch(c=e,y=p,y){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:qi(c,i,vs,!Ii);break t;case 2:as=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(p=Bl+300-wt(),10<p)){if(qi(c,i,vs,!Ii),Wr(c,0,!0)!==0)break t;xi=i,c.timeoutHandle=Pp(lp.bind(null,c,a,as,Ul,ju,i,vs,kn,ha,Ii,y,"Throttled",-0,0),p);break t}lp(c,a,as,Ul,ju,i,vs,kn,ha,Ii,y,null,-0,0)}}break}while(!0);Qs(e)}function lp(e,i,a,c,p,y,k,j,V,et,ht,pt,it,ct){if(e.timeoutHandle=-1,pt=i.subtreeFlags,pt&8192||(pt&16785408)===16785408){pt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ai},Jg(i,y,pt);var St=(y&62914560)===y?Bl-wt():(y&4194048)===y?ip-wt():0;if(St=ov(pt,St),St!==null){xi=y,e.cancelPendingCommit=St(pp.bind(null,e,i,y,a,c,p,k,j,V,ht,pt,null,it,ct)),qi(e,y,k,!et);return}}pp(e,i,y,a,c,p,k,j,V)}function Sy(e){for(var i=e;;){var a=i.tag;if((a===0||a===11||a===15)&&i.flags&16384&&(a=i.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var p=a[c],y=p.getSnapshot;p=p.value;try{if(!gs(y(),p))return!1}catch{return!1}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function qi(e,i,a,c){i&=~Ru,i&=~kn,e.suspendedLanes|=i,e.pingedLanes&=~i,c&&(e.warmLanes|=i),c=e.expirationTimes;for(var p=i;0<p;){var y=31-me(p),k=1<<y;c[y]=-1,p&=~k}a!==0&&mh(e,a,i)}function Hl(){return(ee&6)===0?(mr(0),!1):!0}function Lu(){if(Yt!==null){if(ie===0)var e=Yt.return;else e=Yt,ci=mn=null,Qc(e),na=null,Qa=0,e=Yt;for(;e!==null;)Fg(e.alternate,e),e=e.return;Yt=null}}function ga(e,i){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,qy(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),xi=0,Lu(),ce=e,Yt=a=li(e.current,null),Zt=i,ie=0,ys=null,Ii=!1,da=za(e,i),Mu=!1,ha=vs=Ru=kn=Ui=ye=0,as=gr=null,ju=!1,(i&8)!==0&&(i|=i&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=i;0<c;){var p=31-me(c),y=1<<p;i|=e[p],c&=~y}return vi=i,cl(),a}function op(e,i){Ut=null,H.H=rr,i===ia||i===bl?(i=Sf(),ie=3):i===Ic?(i=Sf(),ie=4):ie=i===gu?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ys=i,Yt===null&&(ye=1,Rl(e,js(i,e.current)))}function cp(){var e=ms.current;return e===null?!0:(Zt&4194048)===Zt?Ls===null:(Zt&62914560)===Zt||(Zt&536870912)!==0?e===Ls:!1}function up(){var e=H.H;return H.H=rr,e===null?rr:e}function dp(){var e=H.A;return H.A=wy,e}function Gl(){ye=4,Ii||(Zt&4194048)!==Zt&&ms.current!==null||(da=!0),(Ui&134217727)===0&&(kn&134217727)===0||ce===null||qi(ce,Zt,vs,!1)}function Pu(e,i,a){var c=ee;ee|=2;var p=up(),y=dp();(ce!==e||Zt!==i)&&(Ul=null,ga(e,i)),i=!1;var k=ye;t:do try{if(ie!==0&&Yt!==null){var j=Yt,V=ys;switch(ie){case 8:Lu(),k=6;break t;case 3:case 2:case 9:case 6:ms.current===null&&(i=!0);var et=ie;if(ie=0,ys=null,pa(e,j,V,et),a&&da){k=0;break t}break;default:et=ie,ie=0,ys=null,pa(e,j,V,et)}}ky(),k=ye;break}catch(ht){op(e,ht)}while(!0);return i&&e.shellSuspendCounter++,ci=mn=null,ee=c,H.H=p,H.A=y,Yt===null&&(ce=null,Zt=0,cl()),k}function ky(){for(;Yt!==null;)hp(Yt)}function Ey(e,i){var a=ee;ee|=2;var c=up(),p=dp();ce!==e||Zt!==i?(Ul=null,Il=wt()+500,ga(e,i)):da=za(e,i);t:do try{if(ie!==0&&Yt!==null){i=Yt;var y=ys;e:switch(ie){case 1:ie=0,ys=null,pa(e,i,y,1);break;case 2:case 9:if(wf(y)){ie=0,ys=null,fp(i);break}i=function(){ie!==2&&ie!==9||ce!==e||(ie=7),Qs(e)},y.then(i,i);break t;case 3:ie=7;break t;case 4:ie=5;break t;case 7:wf(y)?(ie=0,ys=null,fp(i)):(ie=0,ys=null,pa(e,i,y,7));break;case 5:var k=null;switch(Yt.tag){case 26:k=Yt.memoizedState;case 5:case 27:var j=Yt;if(k?Qp(k):j.stateNode.complete){ie=0,ys=null;var V=j.sibling;if(V!==null)Yt=V;else{var et=j.return;et!==null?(Yt=et,ql(et)):Yt=null}break e}}ie=0,ys=null,pa(e,i,y,5);break;case 6:ie=0,ys=null,pa(e,i,y,6);break;case 8:Lu(),ye=6;break t;default:throw Error(n(462))}}Cy();break}catch(ht){op(e,ht)}while(!0);return ci=mn=null,H.H=c,H.A=p,ee=a,Yt!==null?0:(ce=null,Zt=0,cl(),ye)}function Cy(){for(;Yt!==null&&!st();)hp(Yt)}function hp(e){var i=Lg(e.alternate,e,vi);e.memoizedProps=e.pendingProps,i===null?ql(e):Yt=i}function fp(e){var i=e,a=i.alternate;switch(i.tag){case 15:case 0:i=Mg(a,i,i.pendingProps,i.type,void 0,Zt);break;case 11:i=Mg(a,i,i.pendingProps,i.type.render,i.ref,Zt);break;case 5:Qc(i);default:Fg(a,i),i=Yt=df(i,vi),i=Lg(a,i,vi)}e.memoizedProps=e.pendingProps,i===null?ql(e):Yt=i}function pa(e,i,a,c){ci=mn=null,Qc(i),na=null,Qa=0;var p=i.return;try{if(py(e,p,i,a,Zt)){ye=1,Rl(e,js(a,e.current)),Yt=null;return}}catch(y){if(p!==null)throw Yt=p,y;ye=1,Rl(e,js(a,e.current)),Yt=null;return}i.flags&32768?(Wt||c===1?e=!0:da||(Zt&536870912)!==0?e=!1:(Ii=e=!0,(c===2||c===9||c===3||c===6)&&(c=ms.current,c!==null&&c.tag===13&&(c.flags|=16384))),gp(i,e)):ql(i)}function ql(e){var i=e;do{if((i.flags&32768)!==0){gp(i,Ii);return}e=i.return;var a=yy(i.alternate,i,vi);if(a!==null){Yt=a;return}if(i=i.sibling,i!==null){Yt=i;return}Yt=i=e}while(i!==null);ye===0&&(ye=5)}function gp(e,i){do{var a=vy(e.alternate,e);if(a!==null){a.flags&=32767,Yt=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!i&&(e=e.sibling,e!==null)){Yt=e;return}Yt=e=a}while(e!==null);ye=6,Yt=null}function pp(e,i,a,c,p,y,k,j,V){e.cancelPendingCommit=null;do Vl();while(Ne!==0);if((ee&6)!==0)throw Error(n(327));if(i!==null){if(i===e.current)throw Error(n(177));if(y=i.lanes|i.childLanes,y|=kc,rb(e,a,y,k,j,V),e===ce&&(Yt=ce=null,Zt=0),fa=i,Gi=e,xi=a,Du=y,Ou=p,np=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ry(Vt,function(){return xp(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=H.T,H.T=null,p=D.p,D.p=2,k=ee,ee|=4;try{xy(e,i,a)}finally{ee=k,D.p=p,H.T=c}}Ne=1,mp(),bp(),yp()}}function mp(){if(Ne===1){Ne=0;var e=Gi,i=fa,a=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||a){a=H.T,H.T=null;var c=D.p;D.p=2;var p=ee;ee|=4;try{Kg(i,e);var y=Zu,k=ef(e.containerInfo),j=y.focusedElem,V=y.selectionRange;if(k!==j&&j&&j.ownerDocument&&tf(j.ownerDocument.documentElement,j)){if(V!==null&&xc(j)){var et=V.start,ht=V.end;if(ht===void 0&&(ht=et),"selectionStart"in j)j.selectionStart=et,j.selectionEnd=Math.min(ht,j.value.length);else{var pt=j.ownerDocument||document,it=pt&&pt.defaultView||window;if(it.getSelection){var ct=it.getSelection(),St=j.textContent.length,Rt=Math.min(V.start,St),le=V.end===void 0?Rt:Math.min(V.end,St);!ct.extend&&Rt>le&&(k=le,le=Rt,Rt=k);var K=Jh(j,Rt),$=Jh(j,le);if(K&&$&&(ct.rangeCount!==1||ct.anchorNode!==K.node||ct.anchorOffset!==K.offset||ct.focusNode!==$.node||ct.focusOffset!==$.offset)){var tt=pt.createRange();tt.setStart(K.node,K.offset),ct.removeAllRanges(),Rt>le?(ct.addRange(tt),ct.extend($.node,$.offset)):(tt.setEnd($.node,$.offset),ct.addRange(tt))}}}}for(pt=[],ct=j;ct=ct.parentNode;)ct.nodeType===1&&pt.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<pt.length;j++){var ft=pt[j];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}io=!!$u,Zu=$u=null}finally{ee=p,D.p=c,H.T=a}}e.current=i,Ne=2}}function bp(){if(Ne===2){Ne=0;var e=Gi,i=fa,a=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||a){a=H.T,H.T=null;var c=D.p;D.p=2;var p=ee;ee|=4;try{Vg(e,i.alternate,i)}finally{ee=p,D.p=c,H.T=a}}Ne=3}}function yp(){if(Ne===4||Ne===3){Ne=0,yt();var e=Gi,i=fa,a=xi,c=np;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Ne=5:(Ne=0,fa=Gi=null,vp(e,e.pendingLanes));var p=e.pendingLanes;if(p===0&&(Hi=null),ec(a),i=i.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(oe,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=H.T,p=D.p,D.p=2,H.T=null;try{for(var y=e.onRecoverableError,k=0;k<c.length;k++){var j=c[k];y(j.value,{componentStack:j.stack})}}finally{H.T=i,D.p=p}}(xi&3)!==0&&Vl(),Qs(e),p=e.pendingLanes,(a&261930)!==0&&(p&42)!==0?e===zu?pr++:(pr=0,zu=e):pr=0,mr(0)}}function vp(e,i){(e.pooledCacheLanes&=i)===0&&(i=e.pooledCache,i!=null&&(e.pooledCache=null,Ka(i)))}function Vl(){return mp(),bp(),yp(),xp()}function xp(){if(Ne!==5)return!1;var e=Gi,i=Du;Du=0;var a=ec(xi),c=H.T,p=D.p;try{D.p=32>a?32:a,H.T=null,a=Ou,Ou=null;var y=Gi,k=xi;if(Ne=0,fa=Gi=null,xi=0,(ee&6)!==0)throw Error(n(331));var j=ee;if(ee|=4,ep(y.current),Qg(y,y.current,k,a),ee=j,mr(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(oe,y)}catch{}return!0}finally{D.p=p,H.T=c,vp(e,i)}}function _p(e,i,a){i=js(a,i),i=fu(e.stateNode,i,2),e=Li(e,i,2),e!==null&&(La(e,2),Qs(e))}function ne(e,i,a){if(e.tag===3)_p(e,e,a);else for(;i!==null;){if(i.tag===3){_p(i,e,a);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Hi===null||!Hi.has(c))){e=js(a,e),a=wg(2),c=Li(i,a,2),c!==null&&(Ag(a,c,i,e),La(c,2),Qs(c));break}}i=i.return}}function Fu(e,i,a){var c=e.pingCache;if(c===null){c=e.pingCache=new Ay;var p=new Set;c.set(i,p)}else p=c.get(i),p===void 0&&(p=new Set,c.set(i,p));p.has(a)||(Mu=!0,p.add(a),e=Ty.bind(null,e,i,a),i.then(e,e))}function Ty(e,i,a){var c=e.pingCache;c!==null&&c.delete(i),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,ce===e&&(Zt&a)===a&&(ye===4||ye===3&&(Zt&62914560)===Zt&&300>wt()-Bl?(ee&2)===0&&ga(e,0):Ru|=a,ha===Zt&&(ha=0)),Qs(e)}function wp(e,i){i===0&&(i=ph()),e=fn(e,i),e!==null&&(La(e,i),Qs(e))}function Ny(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),wp(e,a)}function My(e,i){var a=0;switch(e.tag){case 31:case 13:var c=e.stateNode,p=e.memoizedState;p!==null&&(a=p.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(n(314))}c!==null&&c.delete(i),wp(e,a)}function Ry(e,i){return mt(e,i)}var Xl=null,ma=null,Bu=!1,Yl=!1,Iu=!1,Vi=0;function Qs(e){e!==ma&&e.next===null&&(ma===null?Xl=ma=e:ma=ma.next=e),Yl=!0,Bu||(Bu=!0,Dy())}function mr(e,i){if(!Iu&&Yl){Iu=!0;do for(var a=!1,c=Xl;c!==null;){if(e!==0){var p=c.pendingLanes;if(p===0)var y=0;else{var k=c.suspendedLanes,j=c.pingedLanes;y=(1<<31-me(42|e)+1)-1,y&=p&~(k&~j),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(a=!0,Ep(c,y))}else y=Zt,y=Wr(c,c===ce?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||za(c,y)||(a=!0,Ep(c,y));c=c.next}while(a);Iu=!1}}function jy(){Ap()}function Ap(){Yl=Bu=!1;var e=0;Vi!==0&&Gy()&&(e=Vi);for(var i=wt(),a=null,c=Xl;c!==null;){var p=c.next,y=Sp(c,i);y===0?(c.next=null,a===null?Xl=p:a.next=p,p===null&&(ma=a)):(a=c,(e!==0||(y&3)!==0)&&(Yl=!0)),c=p}Ne!==0&&Ne!==5||mr(e),Vi!==0&&(Vi=0)}function Sp(e,i){for(var a=e.suspendedLanes,c=e.pingedLanes,p=e.expirationTimes,y=e.pendingLanes&-62914561;0<y;){var k=31-me(y),j=1<<k,V=p[k];V===-1?((j&a)===0||(j&c)!==0)&&(p[k]=ab(j,i)):V<=i&&(e.expiredLanes|=j),y&=~j}if(i=ce,a=Zt,a=Wr(e,e===i?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,a===0||e===i&&(ie===2||ie===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&bt(c),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||za(e,a)){if(i=a&-a,i===e.callbackPriority)return i;switch(c!==null&&bt(c),ec(a)){case 2:case 8:a=se;break;case 32:a=Vt;break;case 268435456:a=Ci;break;default:a=Vt}return c=kp.bind(null,e),a=mt(a,c),e.callbackPriority=i,e.callbackNode=a,i}return c!==null&&c!==null&&bt(c),e.callbackPriority=2,e.callbackNode=null,2}function kp(e,i){if(Ne!==0&&Ne!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Vl()&&e.callbackNode!==a)return null;var c=Zt;return c=Wr(e,e===ce?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(rp(e,c,i),Sp(e,wt()),e.callbackNode!=null&&e.callbackNode===a?kp.bind(null,e):null)}function Ep(e,i){if(Vl())return null;rp(e,i,!0)}function Dy(){Vy(function(){(ee&6)!==0?mt(Nt,jy):Ap()})}function Uu(){if(Vi===0){var e=ea;e===0&&(e=Ln,Ln<<=1,(Ln&261888)===0&&(Ln=256)),Vi=e}return Vi}function Cp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:el(""+e)}function Tp(e,i){var a=i.ownerDocument.createElement("input");return a.name=i.name,a.value=i.value,e.id&&a.setAttribute("form",e.id),i.parentNode.insertBefore(a,i),e=new FormData(e),a.parentNode.removeChild(a),e}function Oy(e,i,a,c,p){if(i==="submit"&&a&&a.stateNode===p){var y=Cp((p[ts]||null).action),k=c.submitter;k&&(i=(i=k[ts]||null)?Cp(i.formAction):k.getAttribute("formAction"),i!==null&&(y=i,k=null));var j=new al("action","action",null,c,p);e.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var V=k?Tp(p,k):new FormData(p);lu(a,{pending:!0,data:V,method:p.method,action:y},null,V)}}else typeof y=="function"&&(j.preventDefault(),V=k?Tp(p,k):new FormData(p),lu(a,{pending:!0,data:V,method:p.method,action:y},y,V))},currentTarget:p}]})}}for(var Hu=0;Hu<Sc.length;Hu++){var Gu=Sc[Hu],zy=Gu.toLowerCase(),Ly=Gu[0].toUpperCase()+Gu.slice(1);Us(zy,"on"+Ly)}Us(af,"onAnimationEnd"),Us(rf,"onAnimationIteration"),Us(lf,"onAnimationStart"),Us("dblclick","onDoubleClick"),Us("focusin","onFocus"),Us("focusout","onBlur"),Us(Qb,"onTransitionRun"),Us(Jb,"onTransitionStart"),Us(ty,"onTransitionCancel"),Us(of,"onTransitionEnd"),Un("onMouseEnter",["mouseout","mouseover"]),Un("onMouseLeave",["mouseout","mouseover"]),Un("onPointerEnter",["pointerout","pointerover"]),Un("onPointerLeave",["pointerout","pointerover"]),cn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cn("onBeforeInput",["compositionend","keypress","textInput","paste"]),cn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Py=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(br));function Np(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var c=e[a],p=c.event;c=c.listeners;t:{var y=void 0;if(i)for(var k=c.length-1;0<=k;k--){var j=c[k],V=j.instance,et=j.currentTarget;if(j=j.listener,V!==y&&p.isPropagationStopped())break t;y=j,p.currentTarget=et;try{y(p)}catch(ht){ol(ht)}p.currentTarget=null,y=V}else for(k=0;k<c.length;k++){if(j=c[k],V=j.instance,et=j.currentTarget,j=j.listener,V!==y&&p.isPropagationStopped())break t;y=j,p.currentTarget=et;try{y(p)}catch(ht){ol(ht)}p.currentTarget=null,y=V}}}}function $t(e,i){var a=i[sc];a===void 0&&(a=i[sc]=new Set);var c=e+"__bubble";a.has(c)||(Mp(i,e,2,!1),a.add(c))}function qu(e,i,a){var c=0;i&&(c|=4),Mp(a,e,c,i)}var $l="_reactListening"+Math.random().toString(36).slice(2);function Vu(e){if(!e[$l]){e[$l]=!0,wh.forEach(function(a){a!=="selectionchange"&&(Py.has(a)||qu(a,!1,e),qu(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[$l]||(i[$l]=!0,qu("selectionchange",!1,i))}}function Mp(e,i,a,c){switch(am(i)){case 2:var p=dv;break;case 8:p=hv;break;default:p=rd}a=p.bind(null,i,a,e),p=void 0,!dc||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),c?p!==void 0?e.addEventListener(i,a,{capture:!0,passive:p}):e.addEventListener(i,a,!0):p!==void 0?e.addEventListener(i,a,{passive:p}):e.addEventListener(i,a,!1)}function Xu(e,i,a,c,p){var y=c;if((i&1)===0&&(i&2)===0&&c!==null)t:for(;;){if(c===null)return;var k=c.tag;if(k===3||k===4){var j=c.stateNode.containerInfo;if(j===p)break;if(k===4)for(k=c.return;k!==null;){var V=k.tag;if((V===3||V===4)&&k.stateNode.containerInfo===p)return;k=k.return}for(;j!==null;){if(k=Fn(j),k===null)return;if(V=k.tag,V===5||V===6||V===26||V===27){c=y=k;continue t}j=j.parentNode}}c=c.return}Oh(function(){var et=y,ht=cc(a),pt=[];t:{var it=cf.get(e);if(it!==void 0){var ct=al,St=e;switch(e){case"keypress":if(il(a)===0)break t;case"keydown":case"keyup":ct=Mb;break;case"focusin":St="focus",ct=pc;break;case"focusout":St="blur",ct=pc;break;case"beforeblur":case"afterblur":ct=pc;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Ph;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=yb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Db;break;case af:case rf:case lf:ct=_b;break;case of:ct=zb;break;case"scroll":case"scrollend":ct=mb;break;case"wheel":ct=Pb;break;case"copy":case"cut":case"paste":ct=Ab;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=Bh;break;case"toggle":case"beforetoggle":ct=Bb}var Rt=(i&4)!==0,le=!Rt&&(e==="scroll"||e==="scrollend"),K=Rt?it!==null?it+"Capture":null:it;Rt=[];for(var $=et,tt;$!==null;){var ft=$;if(tt=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||tt===null||K===null||(ft=Ba($,K),ft!=null&&Rt.push(yr($,ft,tt))),le)break;$=$.return}0<Rt.length&&(it=new ct(it,St,null,a,ht),pt.push({event:it,listeners:Rt}))}}if((i&7)===0){t:{if(it=e==="mouseover"||e==="pointerover",ct=e==="mouseout"||e==="pointerout",it&&a!==oc&&(St=a.relatedTarget||a.fromElement)&&(Fn(St)||St[Pn]))break t;if((ct||it)&&(it=ht.window===ht?ht:(it=ht.ownerDocument)?it.defaultView||it.parentWindow:window,ct?(St=a.relatedTarget||a.toElement,ct=et,St=St?Fn(St):null,St!==null&&(le=l(St),Rt=St.tag,St!==le||Rt!==5&&Rt!==27&&Rt!==6)&&(St=null)):(ct=null,St=et),ct!==St)){if(Rt=Ph,ft="onMouseLeave",K="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(Rt=Bh,ft="onPointerLeave",K="onPointerEnter",$="pointer"),le=ct==null?it:Fa(ct),tt=St==null?it:Fa(St),it=new Rt(ft,$+"leave",ct,a,ht),it.target=le,it.relatedTarget=tt,ft=null,Fn(ht)===et&&(Rt=new Rt(K,$+"enter",St,a,ht),Rt.target=tt,Rt.relatedTarget=le,ft=Rt),le=ft,ct&&St)e:{for(Rt=Fy,K=ct,$=St,tt=0,ft=K;ft;ft=Rt(ft))tt++;ft=0;for(var Mt=$;Mt;Mt=Rt(Mt))ft++;for(;0<tt-ft;)K=Rt(K),tt--;for(;0<ft-tt;)$=Rt($),ft--;for(;tt--;){if(K===$||$!==null&&K===$.alternate){Rt=K;break e}K=Rt(K),$=Rt($)}Rt=null}else Rt=null;ct!==null&&Rp(pt,it,ct,Rt,!1),St!==null&&le!==null&&Rp(pt,le,St,Rt,!0)}}t:{if(it=et?Fa(et):window,ct=it.nodeName&&it.nodeName.toLowerCase(),ct==="select"||ct==="input"&&it.type==="file")var Jt=Yh;else if(Vh(it))if($h)Jt=Zb;else{Jt=Yb;var Ct=Xb}else ct=it.nodeName,!ct||ct.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?et&&lc(et.elementType)&&(Jt=Yh):Jt=$b;if(Jt&&(Jt=Jt(e,et))){Xh(pt,Jt,a,ht);break t}Ct&&Ct(e,it,et),e==="focusout"&&et&&it.type==="number"&&et.memoizedProps.value!=null&&rc(it,"number",it.value)}switch(Ct=et?Fa(et):window,e){case"focusin":(Vh(Ct)||Ct.contentEditable==="true")&&(Yn=Ct,_c=et,Ya=null);break;case"focusout":Ya=_c=Yn=null;break;case"mousedown":wc=!0;break;case"contextmenu":case"mouseup":case"dragend":wc=!1,sf(pt,a,ht);break;case"selectionchange":if(Wb)break;case"keydown":case"keyup":sf(pt,a,ht)}var Ht;if(bc)t:{switch(e){case"compositionstart":var Kt="onCompositionStart";break t;case"compositionend":Kt="onCompositionEnd";break t;case"compositionupdate":Kt="onCompositionUpdate";break t}Kt=void 0}else Xn?Gh(e,a)&&(Kt="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Kt="onCompositionStart");Kt&&(Ih&&a.locale!=="ko"&&(Xn||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&Xn&&(Ht=zh()):(Ni=ht,hc="value"in Ni?Ni.value:Ni.textContent,Xn=!0)),Ct=Zl(et,Kt),0<Ct.length&&(Kt=new Fh(Kt,e,null,a,ht),pt.push({event:Kt,listeners:Ct}),Ht?Kt.data=Ht:(Ht=qh(a),Ht!==null&&(Kt.data=Ht)))),(Ht=Ub?Hb(e,a):Gb(e,a))&&(Kt=Zl(et,"onBeforeInput"),0<Kt.length&&(Ct=new Fh("onBeforeInput","beforeinput",null,a,ht),pt.push({event:Ct,listeners:Kt}),Ct.data=Ht)),Oy(pt,e,et,a,ht)}Np(pt,i)})}function yr(e,i,a){return{instance:e,listener:i,currentTarget:a}}function Zl(e,i){for(var a=i+"Capture",c=[];e!==null;){var p=e,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Ba(e,a),p!=null&&c.unshift(yr(e,p,y)),p=Ba(e,i),p!=null&&c.push(yr(e,p,y))),e.tag===3)return c;e=e.return}return[]}function Fy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rp(e,i,a,c,p){for(var y=i._reactName,k=[];a!==null&&a!==c;){var j=a,V=j.alternate,et=j.stateNode;if(j=j.tag,V!==null&&V===c)break;j!==5&&j!==26&&j!==27||et===null||(V=et,p?(et=Ba(a,y),et!=null&&k.unshift(yr(a,et,V))):p||(et=Ba(a,y),et!=null&&k.push(yr(a,et,V)))),a=a.return}k.length!==0&&e.push({event:i,listeners:k})}var By=/\r\n?/g,Iy=/\u0000|\uFFFD/g;function jp(e){return(typeof e=="string"?e:""+e).replace(By,`
`).replace(Iy,"")}function Dp(e,i){return i=jp(i),jp(e)===i}function re(e,i,a,c,p,y){switch(a){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Gn(e,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Gn(e,""+c);break;case"className":Jr(e,"class",c);break;case"tabIndex":Jr(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Jr(e,a,c);break;case"style":jh(e,c,y);break;case"data":if(i!=="object"){Jr(e,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||a!=="href")){e.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(a);break}c=el(""+c),e.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(a==="formAction"?(i!=="input"&&re(e,i,"name",p.name,p,null),re(e,i,"formEncType",p.formEncType,p,null),re(e,i,"formMethod",p.formMethod,p,null),re(e,i,"formTarget",p.formTarget,p,null)):(re(e,i,"encType",p.encType,p,null),re(e,i,"method",p.method,p,null),re(e,i,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(a);break}c=el(""+c),e.setAttribute(a,c);break;case"onClick":c!=null&&(e.onclick=ai);break;case"onScroll":c!=null&&$t("scroll",e);break;case"onScrollEnd":c!=null&&$t("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(n(61));if(a=c.__html,a!=null){if(p.children!=null)throw Error(n(60));e.innerHTML=a}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}a=el(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,""+c):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":c===!0?e.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(a,c):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(a,c):e.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(a):e.setAttribute(a,c);break;case"popover":$t("beforetoggle",e),$t("toggle",e),Qr(e,"popover",c);break;case"xlinkActuate":ni(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ni(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ni(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ni(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ni(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ni(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ni(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ni(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ni(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Qr(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=gb.get(a)||a,Qr(e,a,c))}}function Yu(e,i,a,c,p,y){switch(a){case"style":jh(e,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(n(61));if(a=c.__html,a!=null){if(p.children!=null)throw Error(n(60));e.innerHTML=a}}break;case"children":typeof c=="string"?Gn(e,c):(typeof c=="number"||typeof c=="bigint")&&Gn(e,""+c);break;case"onScroll":c!=null&&$t("scroll",e);break;case"onScrollEnd":c!=null&&$t("scrollend",e);break;case"onClick":c!=null&&(e.onclick=ai);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ah.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(p=a.endsWith("Capture"),i=a.slice(2,p?a.length-7:void 0),y=e[ts]||null,y=y!=null?y[a]:null,typeof y=="function"&&e.removeEventListener(i,y,p),typeof c=="function")){typeof y!="function"&&y!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(i,c,p);break t}a in e?e[a]=c:c===!0?e.setAttribute(a,""):Qr(e,a,c)}}}function Ue(e,i,a){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$t("error",e),$t("load",e);var c=!1,p=!1,y;for(y in a)if(a.hasOwnProperty(y)){var k=a[y];if(k!=null)switch(y){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:re(e,i,y,k,a,null)}}p&&re(e,i,"srcSet",a.srcSet,a,null),c&&re(e,i,"src",a.src,a,null);return;case"input":$t("invalid",e);var j=y=k=p=null,V=null,et=null;for(c in a)if(a.hasOwnProperty(c)){var ht=a[c];if(ht!=null)switch(c){case"name":p=ht;break;case"type":k=ht;break;case"checked":V=ht;break;case"defaultChecked":et=ht;break;case"value":y=ht;break;case"defaultValue":j=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(n(137,i));break;default:re(e,i,c,ht,a,null)}}Th(e,y,j,V,et,k,p,!1);return;case"select":$t("invalid",e),c=k=y=null;for(p in a)if(a.hasOwnProperty(p)&&(j=a[p],j!=null))switch(p){case"value":y=j;break;case"defaultValue":k=j;break;case"multiple":c=j;default:re(e,i,p,j,a,null)}i=y,a=k,e.multiple=!!c,i!=null?Hn(e,!!c,i,!1):a!=null&&Hn(e,!!c,a,!0);return;case"textarea":$t("invalid",e),y=p=c=null;for(k in a)if(a.hasOwnProperty(k)&&(j=a[k],j!=null))switch(k){case"value":c=j;break;case"defaultValue":p=j;break;case"children":y=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(91));break;default:re(e,i,k,j,a,null)}Mh(e,c,p,y);return;case"option":for(V in a)a.hasOwnProperty(V)&&(c=a[V],c!=null)&&(V==="selected"?e.selected=c&&typeof c!="function"&&typeof c!="symbol":re(e,i,V,c,a,null));return;case"dialog":$t("beforetoggle",e),$t("toggle",e),$t("cancel",e),$t("close",e);break;case"iframe":case"object":$t("load",e);break;case"video":case"audio":for(c=0;c<br.length;c++)$t(br[c],e);break;case"image":$t("error",e),$t("load",e);break;case"details":$t("toggle",e);break;case"embed":case"source":case"link":$t("error",e),$t("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(et in a)if(a.hasOwnProperty(et)&&(c=a[et],c!=null))switch(et){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:re(e,i,et,c,a,null)}return;default:if(lc(i)){for(ht in a)a.hasOwnProperty(ht)&&(c=a[ht],c!==void 0&&Yu(e,i,ht,c,a,void 0));return}}for(j in a)a.hasOwnProperty(j)&&(c=a[j],c!=null&&re(e,i,j,c,a,null))}function Uy(e,i,a,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,k=null,j=null,V=null,et=null,ht=null;for(ct in a){var pt=a[ct];if(a.hasOwnProperty(ct)&&pt!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":V=pt;default:c.hasOwnProperty(ct)||re(e,i,ct,null,c,pt)}}for(var it in c){var ct=c[it];if(pt=a[it],c.hasOwnProperty(it)&&(ct!=null||pt!=null))switch(it){case"type":y=ct;break;case"name":p=ct;break;case"checked":et=ct;break;case"defaultChecked":ht=ct;break;case"value":k=ct;break;case"defaultValue":j=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(n(137,i));break;default:ct!==pt&&re(e,i,it,ct,c,pt)}}ac(e,k,j,V,et,ht,y,p);return;case"select":ct=k=j=it=null;for(y in a)if(V=a[y],a.hasOwnProperty(y)&&V!=null)switch(y){case"value":break;case"multiple":ct=V;default:c.hasOwnProperty(y)||re(e,i,y,null,c,V)}for(p in c)if(y=c[p],V=a[p],c.hasOwnProperty(p)&&(y!=null||V!=null))switch(p){case"value":it=y;break;case"defaultValue":j=y;break;case"multiple":k=y;default:y!==V&&re(e,i,p,y,c,V)}i=j,a=k,c=ct,it!=null?Hn(e,!!a,it,!1):!!c!=!!a&&(i!=null?Hn(e,!!a,i,!0):Hn(e,!!a,a?[]:"",!1));return;case"textarea":ct=it=null;for(j in a)if(p=a[j],a.hasOwnProperty(j)&&p!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:re(e,i,j,null,c,p)}for(k in c)if(p=c[k],y=a[k],c.hasOwnProperty(k)&&(p!=null||y!=null))switch(k){case"value":it=p;break;case"defaultValue":ct=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==y&&re(e,i,k,p,c,y)}Nh(e,it,ct);return;case"option":for(var St in a)it=a[St],a.hasOwnProperty(St)&&it!=null&&!c.hasOwnProperty(St)&&(St==="selected"?e.selected=!1:re(e,i,St,null,c,it));for(V in c)it=c[V],ct=a[V],c.hasOwnProperty(V)&&it!==ct&&(it!=null||ct!=null)&&(V==="selected"?e.selected=it&&typeof it!="function"&&typeof it!="symbol":re(e,i,V,it,c,ct));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rt in a)it=a[Rt],a.hasOwnProperty(Rt)&&it!=null&&!c.hasOwnProperty(Rt)&&re(e,i,Rt,null,c,it);for(et in c)if(it=c[et],ct=a[et],c.hasOwnProperty(et)&&it!==ct&&(it!=null||ct!=null))switch(et){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,i));break;default:re(e,i,et,it,c,ct)}return;default:if(lc(i)){for(var le in a)it=a[le],a.hasOwnProperty(le)&&it!==void 0&&!c.hasOwnProperty(le)&&Yu(e,i,le,void 0,c,it);for(ht in c)it=c[ht],ct=a[ht],!c.hasOwnProperty(ht)||it===ct||it===void 0&&ct===void 0||Yu(e,i,ht,it,c,ct);return}}for(var K in a)it=a[K],a.hasOwnProperty(K)&&it!=null&&!c.hasOwnProperty(K)&&re(e,i,K,null,c,it);for(pt in c)it=c[pt],ct=a[pt],!c.hasOwnProperty(pt)||it===ct||it==null&&ct==null||re(e,i,pt,it,c,ct)}function Op(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,i=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var p=a[c],y=p.transferSize,k=p.initiatorType,j=p.duration;if(y&&j&&Op(k)){for(k=0,j=p.responseEnd,c+=1;c<a.length;c++){var V=a[c],et=V.startTime;if(et>j)break;var ht=V.transferSize,pt=V.initiatorType;ht&&Op(pt)&&(V=V.responseEnd,k+=ht*(V<j?1:(j-et)/(V-et)))}if(--c,i+=8*(y+k)/(p.duration/1e3),e++,10<e)break}}if(0<e)return i/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var $u=null,Zu=null;function Kl(e){return e.nodeType===9?e:e.ownerDocument}function zp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lp(e,i){if(e===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&i==="foreignObject"?0:e}function Ku(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Wu=null;function Gy(){var e=window.event;return e&&e.type==="popstate"?e===Wu?!1:(Wu=e,!0):(Wu=null,!1)}var Pp=typeof setTimeout=="function"?setTimeout:void 0,qy=typeof clearTimeout=="function"?clearTimeout:void 0,Fp=typeof Promise=="function"?Promise:void 0,Vy=typeof queueMicrotask=="function"?queueMicrotask:typeof Fp<"u"?function(e){return Fp.resolve(null).then(e).catch(Xy)}:Pp;function Xy(e){setTimeout(function(){throw e})}function Xi(e){return e==="head"}function Bp(e,i){var a=i,c=0;do{var p=a.nextSibling;if(e.removeChild(a),p&&p.nodeType===8)if(a=p.data,a==="/$"||a==="/&"){if(c===0){e.removeChild(p),xa(i);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")vr(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,vr(a);for(var y=a.firstChild;y;){var k=y.nextSibling,j=y.nodeName;y[Pa]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&y.rel.toLowerCase()==="stylesheet"||a.removeChild(y),y=k}}else a==="body"&&vr(e.ownerDocument.body);a=p}while(a);xa(i)}function Ip(e,i){var a=e;e=0;do{var c=a.nextSibling;if(a.nodeType===1?i?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(i?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=c}while(a)}function Qu(e){var i=e.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var a=i;switch(i=i.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Qu(a),ic(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Yy(e,i,a,c){for(;e.nodeType===1;){var p=a;if(e.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[Pa])switch(i){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(y=e.getAttribute("rel"),y==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(y!==p.rel||e.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||e.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||e.getAttribute("title")!==(p.title==null?null:p.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(y=e.getAttribute("src"),(y!==(p.src==null?null:p.src)||e.getAttribute("type")!==(p.type==null?null:p.type)||e.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(i==="input"&&e.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&e.getAttribute("name")===y)return e}else return e;if(e=Ps(e.nextSibling),e===null)break}return null}function $y(e,i,a){if(i==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Ps(e.nextSibling),e===null))return null;return e}function Up(e,i){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=Ps(e.nextSibling),e===null))return null;return e}function Ju(e){return e.data==="$?"||e.data==="$~"}function td(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Zy(e,i){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=i;else if(e.data!=="$?"||a.readyState!=="loading")i();else{var c=function(){i(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Ps(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return e}var ed=null;function Hp(e){e=e.nextSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(i===0)return Ps(e.nextSibling);i--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||i++}e=e.nextSibling}return null}function Gp(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(i===0)return e;i--}else a!=="/$"&&a!=="/&"||i++}e=e.previousSibling}return null}function qp(e,i,a){switch(i=Kl(a),e){case"html":if(e=i.documentElement,!e)throw Error(n(452));return e;case"head":if(e=i.head,!e)throw Error(n(453));return e;case"body":if(e=i.body,!e)throw Error(n(454));return e;default:throw Error(n(451))}}function vr(e){for(var i=e.attributes;i.length;)e.removeAttributeNode(i[0]);ic(e)}var Fs=new Map,Vp=new Set;function Wl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var _i=D.d;D.d={f:Ky,r:Wy,D:Qy,C:Jy,L:tv,m:ev,X:iv,S:sv,M:nv};function Ky(){var e=_i.f(),i=Hl();return e||i}function Wy(e){var i=Bn(e);i!==null&&i.tag===5&&i.type==="form"?og(i):_i.r(e)}var ba=typeof document>"u"?null:document;function Xp(e,i,a){var c=ba;if(c&&typeof i=="string"&&i){var p=Ms(i);p='link[rel="'+e+'"][href="'+p+'"]',typeof a=="string"&&(p+='[crossorigin="'+a+'"]'),Vp.has(p)||(Vp.add(p),e={rel:e,crossOrigin:a,href:i},c.querySelector(p)===null&&(i=c.createElement("link"),Ue(i,"link",e),ze(i),c.head.appendChild(i)))}}function Qy(e){_i.D(e),Xp("dns-prefetch",e,null)}function Jy(e,i){_i.C(e,i),Xp("preconnect",e,i)}function tv(e,i,a){_i.L(e,i,a);var c=ba;if(c&&e&&i){var p='link[rel="preload"][as="'+Ms(i)+'"]';i==="image"&&a&&a.imageSrcSet?(p+='[imagesrcset="'+Ms(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(p+='[imagesizes="'+Ms(a.imageSizes)+'"]')):p+='[href="'+Ms(e)+'"]';var y=p;switch(i){case"style":y=ya(e);break;case"script":y=va(e)}Fs.has(y)||(e=b({rel:"preload",href:i==="image"&&a&&a.imageSrcSet?void 0:e,as:i},a),Fs.set(y,e),c.querySelector(p)!==null||i==="style"&&c.querySelector(xr(y))||i==="script"&&c.querySelector(_r(y))||(i=c.createElement("link"),Ue(i,"link",e),ze(i),c.head.appendChild(i)))}}function ev(e,i){_i.m(e,i);var a=ba;if(a&&e){var c=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+Ms(c)+'"][href="'+Ms(e)+'"]',y=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=va(e)}if(!Fs.has(y)&&(e=b({rel:"modulepreload",href:e},i),Fs.set(y,e),a.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(_r(y)))return}c=a.createElement("link"),Ue(c,"link",e),ze(c),a.head.appendChild(c)}}}function sv(e,i,a){_i.S(e,i,a);var c=ba;if(c&&e){var p=In(c).hoistableStyles,y=ya(e);i=i||"default";var k=p.get(y);if(!k){var j={loading:0,preload:null};if(k=c.querySelector(xr(y)))j.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":i},a),(a=Fs.get(y))&&sd(e,a);var V=k=c.createElement("link");ze(V),Ue(V,"link",e),V._p=new Promise(function(et,ht){V.onload=et,V.onerror=ht}),V.addEventListener("load",function(){j.loading|=1}),V.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Ql(k,i,c)}k={type:"stylesheet",instance:k,count:1,state:j},p.set(y,k)}}}function iv(e,i){_i.X(e,i);var a=ba;if(a&&e){var c=In(a).hoistableScripts,p=va(e),y=c.get(p);y||(y=a.querySelector(_r(p)),y||(e=b({src:e,async:!0},i),(i=Fs.get(p))&&id(e,i),y=a.createElement("script"),ze(y),Ue(y,"link",e),a.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function nv(e,i){_i.M(e,i);var a=ba;if(a&&e){var c=In(a).hoistableScripts,p=va(e),y=c.get(p);y||(y=a.querySelector(_r(p)),y||(e=b({src:e,async:!0,type:"module"},i),(i=Fs.get(p))&&id(e,i),y=a.createElement("script"),ze(y),Ue(y,"link",e),a.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function Yp(e,i,a,c){var p=(p=_t.current)?Wl(p):null;if(!p)throw Error(n(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(i=ya(a.href),a=In(p).hoistableStyles,c=a.get(i),c||(c={type:"style",instance:null,count:0,state:null},a.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=ya(a.href);var y=In(p).hoistableStyles,k=y.get(e);if(k||(p=p.ownerDocument||p,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(e,k),(y=p.querySelector(xr(e)))&&!y._p&&(k.instance=y,k.state.loading=5),Fs.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Fs.set(e,a),y||av(p,e,a,k.state))),i&&c===null)throw Error(n(528,""));return k}if(i&&c!==null)throw Error(n(529,""));return null;case"script":return i=a.async,a=a.src,typeof a=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=va(a),a=In(p).hoistableScripts,c=a.get(i),c||(c={type:"script",instance:null,count:0,state:null},a.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,e))}}function ya(e){return'href="'+Ms(e)+'"'}function xr(e){return'link[rel="stylesheet"]['+e+"]"}function $p(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function av(e,i,a,c){e.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=e.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),Ue(i,"link",a),ze(i),e.head.appendChild(i))}function va(e){return'[src="'+Ms(e)+'"]'}function _r(e){return"script[async]"+e}function Zp(e,i,a){if(i.count++,i.instance===null)switch(i.type){case"style":var c=e.querySelector('style[data-href~="'+Ms(a.href)+'"]');if(c)return i.instance=c,ze(c),c;var p=b({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),ze(c),Ue(c,"style",p),Ql(c,a.precedence,e),i.instance=c;case"stylesheet":p=ya(a.href);var y=e.querySelector(xr(p));if(y)return i.state.loading|=4,i.instance=y,ze(y),y;c=$p(a),(p=Fs.get(p))&&sd(c,p),y=(e.ownerDocument||e).createElement("link"),ze(y);var k=y;return k._p=new Promise(function(j,V){k.onload=j,k.onerror=V}),Ue(y,"link",c),i.state.loading|=4,Ql(y,a.precedence,e),i.instance=y;case"script":return y=va(a.src),(p=e.querySelector(_r(y)))?(i.instance=p,ze(p),p):(c=a,(p=Fs.get(y))&&(c=b({},a),id(c,p)),e=e.ownerDocument||e,p=e.createElement("script"),ze(p),Ue(p,"link",c),e.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,Ql(c,a.precedence,e));return i.instance}function Ql(e,i,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,y=p,k=0;k<c.length;k++){var j=c[k];if(j.dataset.precedence===i)y=j;else if(y!==p)break}y?y.parentNode.insertBefore(e,y.nextSibling):(i=a.nodeType===9?a.head:a,i.insertBefore(e,i.firstChild))}function sd(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.title==null&&(e.title=i.title)}function id(e,i){e.crossOrigin==null&&(e.crossOrigin=i.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=i.referrerPolicy),e.integrity==null&&(e.integrity=i.integrity)}var Jl=null;function Kp(e,i,a){if(Jl===null){var c=new Map,p=Jl=new Map;p.set(a,c)}else p=Jl,c=p.get(a),c||(c=new Map,p.set(a,c));if(c.has(e))return c;for(c.set(e,null),a=a.getElementsByTagName(e),p=0;p<a.length;p++){var y=a[p];if(!(y[Pa]||y[Pe]||e==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var k=y.getAttribute(i)||"";k=e+k;var j=c.get(k);j?j.push(y):c.set(k,[y])}}return c}function Wp(e,i,a){e=e.ownerDocument||e,e.head.insertBefore(a,i==="title"?e.querySelector("head > title"):null)}function rv(e,i,a){if(a===1||i.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(e=i.disabled,typeof i.precedence=="string"&&e==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Qp(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function lv(e,i,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var p=ya(c.href),y=i.querySelector(xr(p));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(e.count++,e=to.bind(e),i.then(e,e)),a.state.loading|=4,a.instance=y,ze(y);return}y=i.ownerDocument||i,c=$p(c),(p=Fs.get(p))&&sd(c,p),y=y.createElement("link"),ze(y);var k=y;k._p=new Promise(function(j,V){k.onload=j,k.onerror=V}),Ue(y,"link",c),a.instance=y}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,i),(i=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=to.bind(e),i.addEventListener("load",a),i.addEventListener("error",a))}}var nd=0;function ov(e,i){return e.stylesheets&&e.count===0&&so(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var c=setTimeout(function(){if(e.stylesheets&&so(e,e.stylesheets),e.unsuspend){var y=e.unsuspend;e.unsuspend=null,y()}},6e4+i);0<e.imgBytes&&nd===0&&(nd=62500*Hy());var p=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&so(e,e.stylesheets),e.unsuspend)){var y=e.unsuspend;e.unsuspend=null,y()}},(e.imgBytes>nd?50:800)+i);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function to(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)so(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var eo=null;function so(e,i){e.stylesheets=null,e.unsuspend!==null&&(e.count++,eo=new Map,i.forEach(cv,e),eo=null,to.call(e))}function cv(e,i){if(!(i.state.loading&4)){var a=eo.get(e);if(a)var c=a.get(null);else{a=new Map,eo.set(e,a);for(var p=e.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var k=p[y];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(a.set(k.dataset.precedence,k),c=k)}c&&a.set(null,c)}p=i.instance,k=p.getAttribute("data-precedence"),y=a.get(k)||c,y===c&&a.set(null,p),a.set(k,p),this.count++,c=to.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),y?y.parentNode.insertBefore(p,y.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(p,e.firstChild)),i.state.loading|=4}}var wr={$$typeof:N,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function uv(e,i,a,c,p,y,k,j,V){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jo(0),this.hiddenUpdates=Jo(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function Jp(e,i,a,c,p,y,k,j,V,et,ht,pt){return e=new uv(e,i,a,k,V,et,ht,pt,j),i=1,y===!0&&(i|=24),y=ps(3,null,null,i),e.current=y,y.stateNode=e,i=Pc(),i.refCount++,e.pooledCache=i,i.refCount++,y.memoizedState={element:c,isDehydrated:a,cache:i},Uc(y),e}function tm(e){return e?(e=Kn,e):Kn}function em(e,i,a,c,p,y){p=tm(p),c.context===null?c.context=p:c.pendingContext=p,c=zi(i),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=Li(e,c,i),a!==null&&(rs(a,e,i),tr(a,e,i))}function sm(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function ad(e,i){sm(e,i),(e=e.alternate)&&sm(e,i)}function im(e){if(e.tag===13||e.tag===31){var i=fn(e,67108864);i!==null&&rs(i,e,67108864),ad(e,67108864)}}function nm(e){if(e.tag===13||e.tag===31){var i=xs();i=tc(i);var a=fn(e,i);a!==null&&rs(a,e,i),ad(e,i)}}var io=!0;function dv(e,i,a,c){var p=H.T;H.T=null;var y=D.p;try{D.p=2,rd(e,i,a,c)}finally{D.p=y,H.T=p}}function hv(e,i,a,c){var p=H.T;H.T=null;var y=D.p;try{D.p=8,rd(e,i,a,c)}finally{D.p=y,H.T=p}}function rd(e,i,a,c){if(io){var p=ld(c);if(p===null)Xu(e,i,c,no,a),rm(e,c);else if(gv(p,e,i,a,c))c.stopPropagation();else if(rm(e,c),i&4&&-1<fv.indexOf(e)){for(;p!==null;){var y=Bn(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var k=Ts(y.pendingLanes);if(k!==0){var j=y;for(j.pendingLanes|=2,j.entangledLanes|=2;k;){var V=1<<31-me(k);j.entanglements[1]|=V,k&=~V}Qs(y),(ee&6)===0&&(Il=wt()+500,mr(0))}}break;case 31:case 13:j=fn(y,2),j!==null&&rs(j,y,2),Hl(),ad(y,2)}if(y=ld(c),y===null&&Xu(e,i,c,no,a),y===p)break;p=y}p!==null&&c.stopPropagation()}else Xu(e,i,c,null,a)}}function ld(e){return e=cc(e),od(e)}var no=null;function od(e){if(no=null,e=Fn(e),e!==null){var i=l(e);if(i===null)e=null;else{var a=i.tag;if(a===13){if(e=o(i),e!==null)return e;e=null}else if(a===31){if(e=u(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null)}}return no=e,null}function am(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vt()){case Nt:return 2;case se:return 8;case Vt:case Je:return 32;case Ci:return 268435456;default:return 32}default:return 32}}var cd=!1,Yi=null,$i=null,Zi=null,Ar=new Map,Sr=new Map,Ki=[],fv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rm(e,i){switch(e){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Zi=null;break;case"pointerover":case"pointerout":Ar.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sr.delete(i.pointerId)}}function kr(e,i,a,c,p,y){return e===null||e.nativeEvent!==y?(e={blockedOn:i,domEventName:a,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},i!==null&&(i=Bn(i),i!==null&&im(i)),e):(e.eventSystemFlags|=c,i=e.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),e)}function gv(e,i,a,c,p){switch(i){case"focusin":return Yi=kr(Yi,e,i,a,c,p),!0;case"dragenter":return $i=kr($i,e,i,a,c,p),!0;case"mouseover":return Zi=kr(Zi,e,i,a,c,p),!0;case"pointerover":var y=p.pointerId;return Ar.set(y,kr(Ar.get(y)||null,e,i,a,c,p)),!0;case"gotpointercapture":return y=p.pointerId,Sr.set(y,kr(Sr.get(y)||null,e,i,a,c,p)),!0}return!1}function lm(e){var i=Fn(e.target);if(i!==null){var a=l(i);if(a!==null){if(i=a.tag,i===13){if(i=o(a),i!==null){e.blockedOn=i,xh(e.priority,function(){nm(a)});return}}else if(i===31){if(i=u(a),i!==null){e.blockedOn=i,xh(e.priority,function(){nm(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ao(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=ld(e.nativeEvent);if(a===null){a=e.nativeEvent;var c=new a.constructor(a.type,a);oc=c,a.target.dispatchEvent(c),oc=null}else return i=Bn(a),i!==null&&im(i),e.blockedOn=a,!1;i.shift()}return!0}function om(e,i,a){ao(e)&&a.delete(i)}function pv(){cd=!1,Yi!==null&&ao(Yi)&&(Yi=null),$i!==null&&ao($i)&&($i=null),Zi!==null&&ao(Zi)&&(Zi=null),Ar.forEach(om),Sr.forEach(om)}function ro(e,i){e.blockedOn===i&&(e.blockedOn=null,cd||(cd=!0,f.unstable_scheduleCallback(f.unstable_NormalPriority,pv)))}var lo=null;function cm(e){lo!==e&&(lo=e,f.unstable_scheduleCallback(f.unstable_NormalPriority,function(){lo===e&&(lo=null);for(var i=0;i<e.length;i+=3){var a=e[i],c=e[i+1],p=e[i+2];if(typeof c!="function"){if(od(c||a)===null)continue;break}var y=Bn(a);y!==null&&(e.splice(i,3),i-=3,lu(y,{pending:!0,data:p,method:a.method,action:c},c,p))}}))}function xa(e){function i(V){return ro(V,e)}Yi!==null&&ro(Yi,e),$i!==null&&ro($i,e),Zi!==null&&ro(Zi,e),Ar.forEach(i),Sr.forEach(i);for(var a=0;a<Ki.length;a++){var c=Ki[a];c.blockedOn===e&&(c.blockedOn=null)}for(;0<Ki.length&&(a=Ki[0],a.blockedOn===null);)lm(a),a.blockedOn===null&&Ki.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var p=a[c],y=a[c+1],k=p[ts]||null;if(typeof y=="function")k||cm(a);else if(k){var j=null;if(y&&y.hasAttribute("formAction")){if(p=y,k=y[ts]||null)j=k.formAction;else if(od(p)!==null)continue}else j=k.action;typeof j=="function"?a[c+1]=j:(a.splice(c,3),c-=3),cm(a)}}}function um(){function e(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(k){return p=k})},focusReset:"manual",scroll:"manual"})}function i(){p!==null&&(p(),p=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),p!==null&&(p(),p=null)}}}function ud(e){this._internalRoot=e}oo.prototype.render=ud.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(n(409));var a=i.current,c=xs();em(a,c,e,i,null,null)},oo.prototype.unmount=ud.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;em(e.current,2,null,e,null,null),Hl(),i[Pn]=null}};function oo(e){this._internalRoot=e}oo.prototype.unstable_scheduleHydration=function(e){if(e){var i=vh();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Ki.length&&i!==0&&i<Ki[a].priority;a++);Ki.splice(a,0,e),a===0&&lm(e)}};var dm=t.version;if(dm!=="19.2.4")throw Error(n(527,dm,"19.2.4"));D.findDOMNode=function(e){var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=h(i),e=e!==null?g(e):null,e=e===null?null:e.stateNode,e};var mv={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var co=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!co.isDisabled&&co.supportsFiber)try{oe=co.inject(mv),Oe=co}catch{}}return Tr.createRoot=function(e,i){if(!r(e))throw Error(n(299));var a=!1,c="",p=yg,y=vg,k=xg;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError)),i=Jp(e,1,!1,null,null,a,c,null,p,y,k,um),e[Pn]=i.current,Vu(e),new ud(i)},Tr.hydrateRoot=function(e,i,a){if(!r(e))throw Error(n(299));var c=!1,p="",y=yg,k=vg,j=xg,V=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(k=a.onCaughtError),a.onRecoverableError!==void 0&&(j=a.onRecoverableError),a.formState!==void 0&&(V=a.formState)),i=Jp(e,1,!0,i,a??null,c,p,V,y,k,j,um),i.context=tm(null),a=i.current,c=xs(),c=tc(c),p=zi(c),p.callback=null,Li(a,p,c),a=c,i.current.lanes=a,La(i,a),Qs(i),e[Pn]=i.current,Vu(e),new oo(i)},Tr.version="19.2.4",Tr}var Am;function Ev(){if(Am)return gd.exports;Am=1;function f(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f)}catch(t){console.error(t)}}return f(),gd.exports=kv(),gd.exports}var Cv=Ev();const Tv=Xd(Cv);const c0=(...f)=>f.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim();const Nv=f=>f.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const Mv=f=>f.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase());const Sm=f=>{const t=Mv(f);return t.charAt(0).toUpperCase()+t.slice(1)};var Rv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const jv=f=>{for(const t in f)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const Dv=B.forwardRef(({color:f="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:r="",children:l,iconNode:o,...u},d)=>B.createElement("svg",{ref:d,...Rv,width:t,height:t,stroke:f,strokeWidth:n?Number(s)*24/Number(t):s,className:c0("lucide",r),...!l&&!jv(u)&&{"aria-hidden":"true"},...u},[...o.map(([h,g])=>B.createElement(h,g)),...Array.isArray(l)?l:[l]]));const Lt=(f,t)=>{const s=B.forwardRef(({className:n,...r},l)=>B.createElement(Dv,{ref:l,iconNode:t,className:c0(`lucide-${Nv(Sm(f))}`,`lucide-${f}`,n),...r}));return s.displayName=Sm(f),s};const Ov=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$d=Lt("arrow-left",Ov);const zv=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Lv=Lt("arrow-right",zv);const Pv=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Do=Lt("arrow-up-down",Pv);const Fv=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ko=Lt("check",Fv);const Bv=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],u0=Lt("chevron-down",Bv);const Iv=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],km=Lt("chevron-right",Iv);const Uv=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],d0=Lt("chevron-up",Uv);const Hv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],h0=Lt("circle-alert",Hv);const Gv=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qv=Lt("circle-check-big",Gv);const Vv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Xv=Lt("circle-question-mark",Vv);const Yv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],yd=Lt("circle-x",Yv);const $v=[["path",{d:"M14 3a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1",key:"1l7d7l"}],["path",{d:"M19 3a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1",key:"9955pe"}],["path",{d:"m7 15 3 3",key:"4hkfgk"}],["path",{d:"m7 21 3-3H5a2 2 0 0 1-2-2v-2",key:"1xljwe"}],["rect",{x:"14",y:"14",width:"7",height:"7",rx:"1",key:"1cdgtw"}],["rect",{x:"3",y:"3",width:"7",height:"7",rx:"1",key:"zi3rio"}]],Em=Lt("combine",$v);const Zv=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Cm=Lt("download",Zv);const Kv=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Wv=Lt("droplets",Kv);const Qv=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Eo=Lt("eye-off",Qv);const Jv=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Co=Lt("eye",Jv);const tx=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],f0=Lt("file-check",tx);const ex=[["path",{d:"M4.226 20.925A2 2 0 0 0 6 22h12a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v3.127",key:"wfxp4w"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]],Oo=Lt("file-output",ex);const sx=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],Na=Lt("file-plus",sx);const ix=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Xe=Lt("file-text",ix);const nx=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ax=Lt("grip-vertical",nx);const rx=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Gr=Lt("hash",rx);const lx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Zd=Lt("info",lx);const ox=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],qr=Lt("layers",ox);const cx=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ux=Lt("loader-circle",cx);const dx=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Ma=Lt("lock-open",dx);const hx=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ki=Lt("lock",hx);const fx=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Tm=Lt("maximize-2",fx);const gx=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],zo=Lt("maximize",gx);const px=[["path",{d:"M5 12h14",key:"1ays0h"}]],mx=Lt("minus",px);const bx=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],yx=Lt("monitor",bx);const vx=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],xx=Lt("moon",vx);const _x=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],g0=Lt("play",_x);const wx=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lr=Lt("refresh-cw",wx);const Ax=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],p0=Lt("rotate-ccw",Ax);const Sx=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Xs=Lt("rotate-cw",Sx);const kx=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],m0=Lt("scan-line",kx);const Ex=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Ra=Lt("scissors",Ex);const Cx=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],b0=Lt("shield-check",Cx);const Tx=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],ho=Lt("skip-forward",Tx);const Nx=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Mx=Lt("sun",Nx);const Rx=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Dn=Lt("trash-2",Rx);const jx=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ir=Lt("triangle-alert",jx);const Dx=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Lo=Lt("type",Dx);const Ox=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],y0=Lt("upload",Ox);const zx=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Nn=Lt("x",zx);function Lx(f){return f.replace(/[^a-zA-Z0-9_\-. ]/g,"").slice(0,200)}function Px(f){return f.replace(/\.pdf$/i,"")}function _s(f,t,s){const n=Px(t),l={split:`_pages_${s?.range||"selected"}`,merge:`merged_${s?.fileCount||2}_files`,reorder:"_reordered","delete-pages":`_${s?.deletedCount||0}_pages_removed`,"extract-pages":s?.pageNum?`_page_${s.pageNum}`:"_extracted","add-blank-pages":"_with_blanks",rotate:"_rotated",scale:`_resized_${s?.target||"custom"}`,"add-page-numbers":"_numbered","text-watermark":"_watermarked",encrypt:"_encrypted",unlock:"_unlocked","edit-metadata":"_edited"}[f]||"_processed",u=f==="merge"?`${l}.pdf`:`${n}${l}.pdf`;return Lx(u)}const Nm=f=>{let t;const s=new Set,n=(h,g)=>{const b=typeof h=="function"?h(t):h;if(!Object.is(b,t)){const v=t;t=g??(typeof b!="object"||b===null)?b:Object.assign({},t,b),s.forEach(x=>x(t,v))}},r=()=>t,u={setState:n,getState:r,getInitialState:()=>d,subscribe:h=>(s.add(h),()=>s.delete(h))},d=t=f(n,r,u);return u},Fx=(f=>f?Nm(f):Nm),Bx=f=>f;function Ix(f,t=Bx){const s=Dr.useSyncExternalStore(f.subscribe,Dr.useCallback(()=>t(f.getState()),[f,t]),Dr.useCallback(()=>t(f.getInitialState()),[f,t]));return Dr.useDebugValue(s),s}const Mm=f=>{const t=Fx(f),s=n=>Ix(t,n);return Object.assign(s,t),s},Vr=(f=>f?Mm(f):Mm),It=Vr()(f=>({status:"idle",progress:null,result:null,error:null,startTime:null,startProcessing:()=>{f({status:"processing",progress:null,result:null,error:null,startTime:Date.now()})},updateProgress:t=>{f({progress:t})},setResult:t=>{f({status:"done",result:t,progress:null})},setError:t=>{f({status:"error",error:t,progress:null})},cancel:()=>{f({status:"cancelled",progress:null})},reset:()=>{f({status:"idle",progress:null,result:null,error:null,startTime:null})}}));class Ux{worker;pending=new Map;constructor(){this.worker=new Worker(new URL("/projects/quire/assets/pdf-engine.worker-Cy-aNPfQ.js",import.meta.url),{type:"module"}),this.worker.onmessage=this.handleMessage.bind(this),this.worker.onerror=this.handleError.bind(this)}handleMessage(t){const{id:s,type:n,progress:r,result:l,error:o}=t.data,u=this.pending.get(s);if(!u)return;const d=It.getState();switch(n){case"progress":r&&d.updateProgress(r);break;case"result":if(l){const h={files:l.files.map(g=>({name:g.name,bytes:new Uint8Array(g.bytes),pageCount:g.pageCount??0})),processingTime:d.startTime?Date.now()-d.startTime:0};d.setResult(h),u.resolve(h)}this.pending.delete(s);break;case"error":d.setError(o??"Unknown error"),u.reject(o??"Unknown error"),this.pending.delete(s);break;case"cancelled":d.cancel(),u.reject("Operation cancelled"),this.pending.delete(s);break}}handleError(){It.getState().setError("Processing failed  this file may be too large. Try a smaller file or close other tabs.");for(const[s,n]of this.pending)n.reject("Worker crashed"),this.pending.delete(s)}process(t,s,n={}){const r=crypto.randomUUID();return It.getState().startProcessing(),new Promise((o,u)=>{this.pending.set(r,{resolve:o,reject:u});const d=s.map(h=>new Uint8Array(h).buffer);this.worker.postMessage({id:r,operation:t,pdfBytes:d,options:n},d)})}cancelAll(){for(const t of this.pending.keys())this.worker.postMessage({id:t,type:"cancel"})}}const Ye=new Ux;function Po(f,t){if(!f.trim())return{pages:[],error:"Please enter a page range"};const s=new Set,n=f.split(",").map(r=>r.trim()).filter(Boolean);for(const r of n)if(r.includes("-")){const[l,o]=r.split("-").map(h=>h.trim()),u=parseInt(l,10),d=o.toLowerCase()==="end"?t:parseInt(o,10);if(isNaN(u)||isNaN(d))return{pages:[],error:`Invalid range: "${r}"`};if(u<1||d<1)return{pages:[],error:"Page numbers must be at least 1"};if(u>t||d>t)return{pages:[],error:`Page number exceeds total (${t})`};if(u>d)return{pages:[],error:`Invalid range: ${u} > ${d}`};for(let h=u;h<=d;h++)s.add(h)}else{const l=r.toLowerCase()==="end"?t:parseInt(r,10);if(isNaN(l))return{pages:[],error:`Invalid page number: "${r}"`};if(l<1||l>t)return{pages:[],error:`Page ${l} out of range (1-${t})`};s.add(l)}return{pages:Array.from(s).sort((r,l)=>r-l)}}function Hx(f){if(f.length===0)return"";const t=[...f].sort((l,o)=>l-o),s=[];let n=t[0],r=t[0];for(let l=1;l<=t.length;l++)l<t.length&&t[l]===r+1?r=t[l]:(s.push(n===r?`${n}`:`${n}-${r}`),l<t.length&&(n=t[l],r=t[l]));return s.join(", ")}const Gx="modulepreload",qx=function(f){return"/projects/quire/"+f},Rm={},jm=function(t,s,n){let r=Promise.resolve();if(s&&s.length>0){let d=function(h){return Promise.all(h.map(g=>Promise.resolve(g).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");r=d(s.map(h=>{if(h=qx(h),h in Rm)return;Rm[h]=!0;const g=h.endsWith(".css"),b=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":Gx,g||(v.as="script"),v.crossOrigin="",v.href=h,u&&v.setAttribute("nonce",u),document.head.appendChild(v),g)return new Promise((x,_)=>{v.addEventListener("load",x),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return r.then(o=>{for(const u of o||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},Vx=5,zd=Vr()(f=>({recentFiles:[],currentFiles:[],addToCache:t=>{f(s=>{const n=s.recentFiles.filter(l=>l.id!==t.id);return{recentFiles:[t,...n].slice(0,Vx)}})},setCurrentFiles:t=>{f({currentFiles:t})},clearCurrentFiles:()=>{f({currentFiles:[]})},removeCurrentFile:t=>{f(s=>({currentFiles:s.currentFiles.filter(n=>n.id!==t)}))}})),ja={INVALID_PDF:"This file is not a valid PDF.",ENCRYPTED_NEEDS_PASSWORD:"This PDF is password-protected. Please enter the password.",WRONG_PASSWORD:"Incorrect password. Please try again.",FILE_TOO_LARGE:"This file may be too large for your browser. Try a smaller file or close other tabs.",WORKER_CRASHED:"Processing failed unexpectedly. Try again with a smaller file.",OPERATION_CANCELLED:"Operation cancelled.",CANNOT_DELETE_ALL:"Cannot delete all pages. At least one page must remain.",MERGE_MIN_FILES:"Merge requires at least 2 PDF files.",NON_LATIN_WARNING:"Your text contains non-Latin characters. These may not display correctly with the standard font.",ANNOTATIONS_WARNING:"Note: Annotations and form fields may not be preserved."};var xo={exports:{}},Xx=xo.exports,Dm;function Yx(){return Dm||(Dm=1,(function(f,t){(function(s,n){n()})(Xx,function(){function s(h,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,g,b){var v=new XMLHttpRequest;v.open("GET",h),v.responseType="blob",v.onload=function(){d(v.response,g,b)},v.onerror=function(){console.error("could not download file")},v.send()}function r(h){var g=new XMLHttpRequest;g.open("HEAD",h,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function l(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(g)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof tn=="object"&&tn.global===tn?tn:void 0,u=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,g,b){var v=o.URL||o.webkitURL,x=document.createElement("a");g=g||h.name||"download",x.download=g,x.rel="noopener",typeof h=="string"?(x.href=h,x.origin===location.origin?l(x):r(x.href)?n(h,g,b):l(x,x.target="_blank")):(x.href=v.createObjectURL(h),setTimeout(function(){v.revokeObjectURL(x.href)},4e4),setTimeout(function(){l(x)},0))}:"msSaveOrOpenBlob"in navigator?function(h,g,b){if(g=g||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(s(h,b),g);else if(r(h))n(h,g,b);else{var v=document.createElement("a");v.href=h,v.target="_blank",setTimeout(function(){l(v)})}}:function(h,g,b,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof h=="string")return n(h,g,b);var x=h.type==="application/octet-stream",_=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||x&&_||u)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var N=S.result;N=w?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=N:location=N,v=null},S.readAsDataURL(h)}else{var A=o.URL||o.webkitURL,E=A.createObjectURL(h);v?v.location=E:location.href=E,v=null,setTimeout(function(){A.revokeObjectURL(E)},4e4)}});o.saveAs=d.saveAs=d,f.exports=d})})(xo)),xo.exports}var v0=Yx();function fo(f){throw new Error('Could not dynamically require "'+f+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vd={exports:{}};var Om;function $x(){return Om||(Om=1,(function(f,t){(function(s){f.exports=s()})(function(){return(function s(n,r,l){function o(h,g){if(!r[h]){if(!n[h]){var b=typeof fo=="function"&&fo;if(!g&&b)return b(h,!0);if(u)return u(h,!0);var v=new Error("Cannot find module '"+h+"'");throw v.code="MODULE_NOT_FOUND",v}var x=r[h]={exports:{}};n[h][0].call(x.exports,function(_){var w=n[h][1][_];return o(w||_)},x,x.exports,s,n,r,l)}return r[h].exports}for(var u=typeof fo=="function"&&fo,d=0;d<l.length;d++)o(l[d]);return o})({1:[function(s,n,r){var l=s("./utils"),o=s("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(d){for(var h,g,b,v,x,_,w,S=[],A=0,E=d.length,N=E,R=l.getTypeOf(d)!=="string";A<d.length;)N=E-A,b=R?(h=d[A++],g=A<E?d[A++]:0,A<E?d[A++]:0):(h=d.charCodeAt(A++),g=A<E?d.charCodeAt(A++):0,A<E?d.charCodeAt(A++):0),v=h>>2,x=(3&h)<<4|g>>4,_=1<N?(15&g)<<2|b>>6:64,w=2<N?63&b:64,S.push(u.charAt(v)+u.charAt(x)+u.charAt(_)+u.charAt(w));return S.join("")},r.decode=function(d){var h,g,b,v,x,_,w=0,S=0,A="data:";if(d.substr(0,A.length)===A)throw new Error("Invalid base64 input, it looks like a data url.");var E,N=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&N--,d.charAt(d.length-2)===u.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(E=o.uint8array?new Uint8Array(0|N):new Array(0|N);w<d.length;)h=u.indexOf(d.charAt(w++))<<2|(v=u.indexOf(d.charAt(w++)))>>4,g=(15&v)<<4|(x=u.indexOf(d.charAt(w++)))>>2,b=(3&x)<<6|(_=u.indexOf(d.charAt(w++))),E[S++]=h,x!==64&&(E[S++]=g),_!==64&&(E[S++]=b);return E}},{"./support":30,"./utils":32}],2:[function(s,n,r){var l=s("./external"),o=s("./stream/DataWorker"),u=s("./stream/Crc32Probe"),d=s("./stream/DataLengthProbe");function h(g,b,v,x,_){this.compressedSize=g,this.uncompressedSize=b,this.crc32=v,this.compression=x,this.compressedContent=_}h.prototype={getContentWorker:function(){var g=new o(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),b=this;return g.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),g},getCompressedWorker:function(){return new o(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(g,b,v){return g.pipe(new u).pipe(new d("uncompressedSize")).pipe(b.compressWorker(v)).pipe(new d("compressedSize")).withStreamInfo("compression",b)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,n,r){var l=s("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},r.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,n,r){var l=s("./utils"),o=(function(){for(var u,d=[],h=0;h<256;h++){u=h;for(var g=0;g<8;g++)u=1&u?3988292384^u>>>1:u>>>1;d[h]=u}return d})();n.exports=function(u,d){return u!==void 0&&u.length?l.getTypeOf(u)!=="string"?(function(h,g,b,v){var x=o,_=v+b;h^=-1;for(var w=v;w<_;w++)h=h>>>8^x[255&(h^g[w])];return-1^h})(0|d,u,u.length,0):(function(h,g,b,v){var x=o,_=v+b;h^=-1;for(var w=v;w<_;w++)h=h>>>8^x[255&(h^g.charCodeAt(w))];return-1^h})(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(s,n,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(s,n,r){var l=null;l=typeof Promise<"u"?Promise:s("lie"),n.exports={Promise:l}},{lie:37}],7:[function(s,n,r){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=s("pako"),u=s("./utils"),d=s("./stream/GenericWorker"),h=l?"uint8array":"array";function g(b,v){d.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=v,this.meta={}}r.magic="\b\0",u.inherits(g,d),g.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(h,b.data),!1)},g.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},g.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},g.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(v){b.push({data:v,meta:b.meta})}},r.compressWorker=function(b){return new g("Deflate",b)},r.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,n,r){function l(x,_){var w,S="";for(w=0;w<_;w++)S+=String.fromCharCode(255&x),x>>>=8;return S}function o(x,_,w,S,A,E){var N,R,O=x.file,G=x.compression,I=E!==h.utf8encode,P=u.transformTo("string",E(O.name)),Y=u.transformTo("string",h.utf8encode(O.name)),W=O.comment,gt=u.transformTo("string",E(W)),z=u.transformTo("string",h.utf8encode(W)),Q=Y.length!==O.name.length,T=z.length!==W.length,lt="",H="",D="",X=O.dir,q=O.date,ut={crc32:0,compressedSize:0,uncompressedSize:0};_&&!w||(ut.crc32=x.crc32,ut.compressedSize=x.compressedSize,ut.uncompressedSize=x.uncompressedSize);var M=0;_&&(M|=8),I||!Q&&!T||(M|=2048);var L=0,J=0;X&&(L|=16),A==="UNIX"?(J=798,L|=(function(nt,_t){var xt=nt;return nt||(xt=_t?16893:33204),(65535&xt)<<16})(O.unixPermissions,X)):(J=20,L|=(function(nt){return 63&(nt||0)})(O.dosPermissions)),N=q.getUTCHours(),N<<=6,N|=q.getUTCMinutes(),N<<=5,N|=q.getUTCSeconds()/2,R=q.getUTCFullYear()-1980,R<<=4,R|=q.getUTCMonth()+1,R<<=5,R|=q.getUTCDate(),Q&&(H=l(1,1)+l(g(P),4)+Y,lt+="up"+l(H.length,2)+H),T&&(D=l(1,1)+l(g(gt),4)+z,lt+="uc"+l(D.length,2)+D);var rt="";return rt+=`
\0`,rt+=l(M,2),rt+=G.magic,rt+=l(N,2),rt+=l(R,2),rt+=l(ut.crc32,4),rt+=l(ut.compressedSize,4),rt+=l(ut.uncompressedSize,4),rt+=l(P.length,2),rt+=l(lt.length,2),{fileRecord:b.LOCAL_FILE_HEADER+rt+P+lt,dirRecord:b.CENTRAL_FILE_HEADER+l(J,2)+rt+l(gt.length,2)+"\0\0\0\0"+l(L,4)+l(S,4)+P+lt+gt}}var u=s("../utils"),d=s("../stream/GenericWorker"),h=s("../utf8"),g=s("../crc32"),b=s("../signature");function v(x,_,w,S){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=w,this.encodeFileName=S,this.streamFiles=x,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(v,d),v.prototype.push=function(x){var _=x.meta.percent||0,w=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(x):(this.bytesWritten+=x.data.length,d.prototype.push.call(this,{data:x.data,meta:{currentFile:this.currentFile,percent:w?(_+100*(w-S-1))/w:100}}))},v.prototype.openedSource=function(x){this.currentSourceOffset=this.bytesWritten,this.currentFile=x.file.name;var _=this.streamFiles&&!x.file.dir;if(_){var w=o(x,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(x){this.accumulate=!1;var _=this.streamFiles&&!x.file.dir,w=o(x,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),_)this.push({data:(function(S){return b.DATA_DESCRIPTOR+l(S.crc32,4)+l(S.compressedSize,4)+l(S.uncompressedSize,4)})(x),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var x=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var w=this.bytesWritten-x,S=(function(A,E,N,R,O){var G=u.transformTo("string",O(R));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(A,2)+l(A,2)+l(E,4)+l(N,4)+l(G.length,2)+G})(this.dirRecords.length,w,x,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(x){this._sources.push(x);var _=this;return x.on("data",function(w){_.processChunk(w)}),x.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),x.on("error",function(w){_.error(w)}),this},v.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(x){var _=this._sources;if(!d.prototype.error.call(this,x))return!1;for(var w=0;w<_.length;w++)try{_[w].error(x)}catch{}return!0},v.prototype.lock=function(){d.prototype.lock.call(this);for(var x=this._sources,_=0;_<x.length;_++)x[_].lock()},n.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,n,r){var l=s("../compressions"),o=s("./ZipFileWorker");r.generateWorker=function(u,d,h){var g=new o(d.streamFiles,h,d.platform,d.encodeFileName),b=0;try{u.forEach(function(v,x){b++;var _=(function(E,N){var R=E||N,O=l[R];if(!O)throw new Error(R+" is not a valid compression method !");return O})(x.options.compression,d.compression),w=x.options.compressionOptions||d.compressionOptions||{},S=x.dir,A=x.date;x._compressWorker(_,w).withStreamInfo("file",{name:v,dir:S,date:A,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(g)}),g.entriesCount=b}catch(v){g.error(v)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,n,r){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new l;for(var u in this)typeof this[u]!="function"&&(o[u]=this[u]);return o}}(l.prototype=s("./object")).loadAsync=s("./load"),l.support=s("./support"),l.defaults=s("./defaults"),l.version="3.10.1",l.loadAsync=function(o,u){return new l().loadAsync(o,u)},l.external=s("./external"),n.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,n,r){var l=s("./utils"),o=s("./external"),u=s("./utf8"),d=s("./zipEntries"),h=s("./stream/Crc32Probe"),g=s("./nodejsUtils");function b(v){return new o.Promise(function(x,_){var w=v.decompressed.getContentWorker().pipe(new h);w.on("error",function(S){_(S)}).on("end",function(){w.streamInfo.crc32!==v.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):x()}).resume()})}n.exports=function(v,x){var _=this;return x=l.extend(x||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),g.isNode&&g.isStream(v)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",v,!0,x.optimizedBinaryString,x.base64).then(function(w){var S=new d(x);return S.load(w),S}).then(function(w){var S=[o.Promise.resolve(w)],A=w.files;if(x.checkCRC32)for(var E=0;E<A.length;E++)S.push(b(A[E]));return o.Promise.all(S)}).then(function(w){for(var S=w.shift(),A=S.files,E=0;E<A.length;E++){var N=A[E],R=N.fileNameStr,O=l.resolve(N.fileNameStr);_.file(O,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:x.createFolders}),N.dir||(_.file(O).unsafeOriginalName=R)}return S.zipComment.length&&(_.comment=S.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,n,r){var l=s("../utils"),o=s("../stream/GenericWorker");function u(d,h){o.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(h)}l.inherits(u,o),u.prototype._bindStream=function(d){var h=this;(this._stream=d).pause(),d.on("data",function(g){h.push({data:g,meta:{percent:0}})}).on("error",function(g){h.isPaused?this.generatedError=g:h.error(g)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},u.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,n,r){var l=s("readable-stream").Readable;function o(u,d,h){l.call(this,d),this._helper=u;var g=this;u.on("data",function(b,v){g.push(b)||g._helper.pause(),h&&h(v)}).on("error",function(b){g.emit("error",b)}).on("end",function(){g.push(null)})}s("../utils").inherits(o,l),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(s,n,r){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,o);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,o)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var o=new Buffer(l);return o.fill(0),o},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(s,n,r){function l(O,G,I){var P,Y=u.getTypeOf(G),W=u.extend(I||{},g);W.date=W.date||new Date,W.compression!==null&&(W.compression=W.compression.toUpperCase()),typeof W.unixPermissions=="string"&&(W.unixPermissions=parseInt(W.unixPermissions,8)),W.unixPermissions&&16384&W.unixPermissions&&(W.dir=!0),W.dosPermissions&&16&W.dosPermissions&&(W.dir=!0),W.dir&&(O=A(O)),W.createFolders&&(P=S(O))&&E.call(this,P,!0);var gt=Y==="string"&&W.binary===!1&&W.base64===!1;I&&I.binary!==void 0||(W.binary=!gt),(G instanceof b&&G.uncompressedSize===0||W.dir||!G||G.length===0)&&(W.base64=!1,W.binary=!0,G="",W.compression="STORE",Y="string");var z=null;z=G instanceof b||G instanceof d?G:_.isNode&&_.isStream(G)?new w(O,G):u.prepareContent(O,G,W.binary,W.optimizedBinaryString,W.base64);var Q=new v(O,z,W);this.files[O]=Q}var o=s("./utf8"),u=s("./utils"),d=s("./stream/GenericWorker"),h=s("./stream/StreamHelper"),g=s("./defaults"),b=s("./compressedObject"),v=s("./zipObject"),x=s("./generate"),_=s("./nodejsUtils"),w=s("./nodejs/NodejsStreamInputAdapter"),S=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var G=O.lastIndexOf("/");return 0<G?O.substring(0,G):""},A=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},E=function(O,G){return G=G!==void 0?G:g.createFolders,O=A(O),this.files[O]||l.call(this,O,null,{dir:!0,createFolders:G}),this.files[O]};function N(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var R={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var G,I,P;for(G in this.files)P=this.files[G],(I=G.slice(this.root.length,G.length))&&G.slice(0,this.root.length)===this.root&&O(I,P)},filter:function(O){var G=[];return this.forEach(function(I,P){O(I,P)&&G.push(P)}),G},file:function(O,G,I){if(arguments.length!==1)return O=this.root+O,l.call(this,O,G,I),this;if(N(O)){var P=O;return this.filter(function(W,gt){return!gt.dir&&P.test(W)})}var Y=this.files[this.root+O];return Y&&!Y.dir?Y:null},folder:function(O){if(!O)return this;if(N(O))return this.filter(function(Y,W){return W.dir&&O.test(Y)});var G=this.root+O,I=E.call(this,G),P=this.clone();return P.root=I.name,P},remove:function(O){O=this.root+O;var G=this.files[O];if(G||(O.slice(-1)!=="/"&&(O+="/"),G=this.files[O]),G&&!G.dir)delete this.files[O];else for(var I=this.filter(function(Y,W){return W.name.slice(0,O.length)===O}),P=0;P<I.length;P++)delete this.files[I[P].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var G,I={};try{if((I=u.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");u.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var P=I.comment||this.comment||"";G=x.generateWorker(this,I,P)}catch(Y){(G=new d("error")).error(Y)}return new h(G,I.type||"string",I.mimeType)},generateAsync:function(O,G){return this.generateInternalStream(O).accumulate(G)},generateNodeStream:function(O,G){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(G)}};n.exports=R},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,n,r){n.exports=s("stream")},{stream:void 0}],17:[function(s,n,r){var l=s("./DataReader");function o(u){l.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}s("../utils").inherits(o,l),o.prototype.byteAt=function(u){return this.data[this.zero+u]},o.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),h=u.charCodeAt(1),g=u.charCodeAt(2),b=u.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===d&&this.data[v+1]===h&&this.data[v+2]===g&&this.data[v+3]===b)return v-this.zero;return-1},o.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),h=u.charCodeAt(1),g=u.charCodeAt(2),b=u.charCodeAt(3),v=this.readData(4);return d===v[0]&&h===v[1]&&g===v[2]&&b===v[3]},o.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(s,n,r){var l=s("../utils");function o(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,h=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=u,h},readString:function(u){return l.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},n.exports=o},{"../utils":32}],19:[function(s,n,r){var l=s("./Uint8ArrayReader");function o(u){l.call(this,u)}s("../utils").inherits(o,l),o.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,n,r){var l=s("./DataReader");function o(u){l.call(this,u)}s("../utils").inherits(o,l),o.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},o.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},o.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},o.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(s,n,r){var l=s("./ArrayReader");function o(u){l.call(this,u)}s("../utils").inherits(o,l),o.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(s,n,r){var l=s("../utils"),o=s("../support"),u=s("./ArrayReader"),d=s("./StringReader"),h=s("./NodeBufferReader"),g=s("./Uint8ArrayReader");n.exports=function(b){var v=l.getTypeOf(b);return l.checkSupport(v),v!=="string"||o.uint8array?v==="nodebuffer"?new h(b):o.uint8array?new g(l.transformTo("uint8array",b)):new u(l.transformTo("array",b)):new d(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,n,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,n,r){var l=s("./GenericWorker"),o=s("../utils");function u(d){l.call(this,"ConvertWorker to "+d),this.destType=d}o.inherits(u,l),u.prototype.processChunk=function(d){this.push({data:o.transformTo(this.destType,d.data),meta:d.meta})},n.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(s,n,r){var l=s("./GenericWorker"),o=s("../crc32");function u(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(u,l),u.prototype.processChunk=function(d){this.streamInfo.crc32=o(d.data,this.streamInfo.crc32||0),this.push(d)},n.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,n,r){var l=s("../utils"),o=s("./GenericWorker");function u(d){o.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}l.inherits(u,o),u.prototype.processChunk=function(d){if(d){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+d.data.length}o.prototype.processChunk.call(this,d)},n.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(s,n,r){var l=s("../utils"),o=s("./GenericWorker");function u(d){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(g){h.dataIsReady=!0,h.data=g,h.max=g&&g.length||0,h.type=l.getTypeOf(g),h.isPaused||h._tickAndRepeat()},function(g){h.error(g)})}l.inherits(u,o),u.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,h);break;case"uint8array":d=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":d=this.data.slice(this.index,h)}return this.index=h,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(s,n,r){function l(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,u){return this._listeners[o].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,u){if(this._listeners[o])for(var d=0;d<this._listeners[o].length;d++)this._listeners[o][d].call(this,u)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var u=this;return o.on("data",function(d){u.processChunk(d)}),o.on("end",function(){u.end()}),o.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,u){return this.extraStreamInfo[o]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=l},{}],29:[function(s,n,r){var l=s("../utils"),o=s("./ConvertWorker"),u=s("./GenericWorker"),d=s("../base64"),h=s("../support"),g=s("../external"),b=null;if(h.nodestream)try{b=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(_,w){return new g.Promise(function(S,A){var E=[],N=_._internalType,R=_._outputType,O=_._mimeType;_.on("data",function(G,I){E.push(G),w&&w(I)}).on("error",function(G){E=[],A(G)}).on("end",function(){try{var G=(function(I,P,Y){switch(I){case"blob":return l.newBlob(l.transformTo("arraybuffer",P),Y);case"base64":return d.encode(P);default:return l.transformTo(I,P)}})(R,(function(I,P){var Y,W=0,gt=null,z=0;for(Y=0;Y<P.length;Y++)z+=P[Y].length;switch(I){case"string":return P.join("");case"array":return Array.prototype.concat.apply([],P);case"uint8array":for(gt=new Uint8Array(z),Y=0;Y<P.length;Y++)gt.set(P[Y],W),W+=P[Y].length;return gt;case"nodebuffer":return Buffer.concat(P);default:throw new Error("concat : unsupported type '"+I+"'")}})(N,E),O);S(G)}catch(I){A(I)}E=[]}).resume()})}function x(_,w,S){var A=w;switch(w){case"blob":case"arraybuffer":A="uint8array";break;case"base64":A="string"}try{this._internalType=A,this._outputType=w,this._mimeType=S,l.checkSupport(A),this._worker=_.pipe(new o(A)),_.lock()}catch(E){this._worker=new u("error"),this._worker.error(E)}}x.prototype={accumulate:function(_){return v(this,_)},on:function(_,w){var S=this;return _==="data"?this._worker.on(_,function(A){w.call(S,A.data,A.meta)}):this._worker.on(_,function(){l.delay(w,arguments,S)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},_)}},n.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,n,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var l=new ArrayBuffer(0);try{r.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(l),r.blob=o.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!s("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(s,n,r){for(var l=s("./utils"),o=s("./support"),u=s("./nodejsUtils"),d=s("./stream/GenericWorker"),h=new Array(256),g=0;g<256;g++)h[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;h[254]=h[254]=1;function b(){d.call(this,"utf-8 decode"),this.leftOver=null}function v(){d.call(this,"utf-8 encode")}r.utf8encode=function(x){return o.nodebuffer?u.newBufferFrom(x,"utf-8"):(function(_){var w,S,A,E,N,R=_.length,O=0;for(E=0;E<R;E++)(64512&(S=_.charCodeAt(E)))==55296&&E+1<R&&(64512&(A=_.charCodeAt(E+1)))==56320&&(S=65536+(S-55296<<10)+(A-56320),E++),O+=S<128?1:S<2048?2:S<65536?3:4;for(w=o.uint8array?new Uint8Array(O):new Array(O),E=N=0;N<O;E++)(64512&(S=_.charCodeAt(E)))==55296&&E+1<R&&(64512&(A=_.charCodeAt(E+1)))==56320&&(S=65536+(S-55296<<10)+(A-56320),E++),S<128?w[N++]=S:(S<2048?w[N++]=192|S>>>6:(S<65536?w[N++]=224|S>>>12:(w[N++]=240|S>>>18,w[N++]=128|S>>>12&63),w[N++]=128|S>>>6&63),w[N++]=128|63&S);return w})(x)},r.utf8decode=function(x){return o.nodebuffer?l.transformTo("nodebuffer",x).toString("utf-8"):(function(_){var w,S,A,E,N=_.length,R=new Array(2*N);for(w=S=0;w<N;)if((A=_[w++])<128)R[S++]=A;else if(4<(E=h[A]))R[S++]=65533,w+=E-1;else{for(A&=E===2?31:E===3?15:7;1<E&&w<N;)A=A<<6|63&_[w++],E--;1<E?R[S++]=65533:A<65536?R[S++]=A:(A-=65536,R[S++]=55296|A>>10&1023,R[S++]=56320|1023&A)}return R.length!==S&&(R.subarray?R=R.subarray(0,S):R.length=S),l.applyFromCharCode(R)})(x=l.transformTo(o.uint8array?"uint8array":"array",x))},l.inherits(b,d),b.prototype.processChunk=function(x){var _=l.transformTo(o.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var w=_;(_=new Uint8Array(w.length+this.leftOver.length)).set(this.leftOver,0),_.set(w,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var S=(function(E,N){var R;for((N=N||E.length)>E.length&&(N=E.length),R=N-1;0<=R&&(192&E[R])==128;)R--;return R<0||R===0?N:R+h[E[R]]>N?R:N})(_),A=_;S!==_.length&&(o.uint8array?(A=_.subarray(0,S),this.leftOver=_.subarray(S,_.length)):(A=_.slice(0,S),this.leftOver=_.slice(S,_.length))),this.push({data:r.utf8decode(A),meta:x.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=b,l.inherits(v,d),v.prototype.processChunk=function(x){this.push({data:r.utf8encode(x.data),meta:x.meta})},r.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,n,r){var l=s("./support"),o=s("./base64"),u=s("./nodejsUtils"),d=s("./external");function h(w){return w}function g(w,S){for(var A=0;A<w.length;++A)S[A]=255&w.charCodeAt(A);return S}s("setimmediate"),r.newBlob=function(w,S){r.checkSupport("blob");try{return new Blob([w],{type:S})}catch{try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return A.append(w),A.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(w,S,A){var E=[],N=0,R=w.length;if(R<=A)return String.fromCharCode.apply(null,w);for(;N<R;)S==="array"||S==="nodebuffer"?E.push(String.fromCharCode.apply(null,w.slice(N,Math.min(N+A,R)))):E.push(String.fromCharCode.apply(null,w.subarray(N,Math.min(N+A,R)))),N+=A;return E.join("")},stringifyByChar:function(w){for(var S="",A=0;A<w.length;A++)S+=String.fromCharCode(w[A]);return S},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function v(w){var S=65536,A=r.getTypeOf(w),E=!0;if(A==="uint8array"?E=b.applyCanBeUsed.uint8array:A==="nodebuffer"&&(E=b.applyCanBeUsed.nodebuffer),E)for(;1<S;)try{return b.stringifyByChunk(w,A,S)}catch{S=Math.floor(S/2)}return b.stringifyByChar(w)}function x(w,S){for(var A=0;A<w.length;A++)S[A]=w[A];return S}r.applyFromCharCode=v;var _={};_.string={string:h,array:function(w){return g(w,new Array(w.length))},arraybuffer:function(w){return _.string.uint8array(w).buffer},uint8array:function(w){return g(w,new Uint8Array(w.length))},nodebuffer:function(w){return g(w,u.allocBuffer(w.length))}},_.array={string:v,array:h,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return u.newBufferFrom(w)}},_.arraybuffer={string:function(w){return v(new Uint8Array(w))},array:function(w){return x(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:h,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return u.newBufferFrom(new Uint8Array(w))}},_.uint8array={string:v,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:h,nodebuffer:function(w){return u.newBufferFrom(w)}},_.nodebuffer={string:v,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return _.nodebuffer.uint8array(w).buffer},uint8array:function(w){return x(w,new Uint8Array(w.length))},nodebuffer:h},r.transformTo=function(w,S){if(S=S||"",!w)return S;r.checkSupport(w);var A=r.getTypeOf(S);return _[A][w](S)},r.resolve=function(w){for(var S=w.split("/"),A=[],E=0;E<S.length;E++){var N=S[E];N==="."||N===""&&E!==0&&E!==S.length-1||(N===".."?A.pop():A.push(N))}return A.join("/")},r.getTypeOf=function(w){return typeof w=="string"?"string":Object.prototype.toString.call(w)==="[object Array]"?"array":l.nodebuffer&&u.isBuffer(w)?"nodebuffer":l.uint8array&&w instanceof Uint8Array?"uint8array":l.arraybuffer&&w instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(w){if(!l[w.toLowerCase()])throw new Error(w+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(w){var S,A,E="";for(A=0;A<(w||"").length;A++)E+="\\x"+((S=w.charCodeAt(A))<16?"0":"")+S.toString(16).toUpperCase();return E},r.delay=function(w,S,A){setImmediate(function(){w.apply(A||null,S||[])})},r.inherits=function(w,S){function A(){}A.prototype=S.prototype,w.prototype=new A},r.extend=function(){var w,S,A={};for(w=0;w<arguments.length;w++)for(S in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],S)&&A[S]===void 0&&(A[S]=arguments[w][S]);return A},r.prepareContent=function(w,S,A,E,N){return d.Promise.resolve(S).then(function(R){return l.blob&&(R instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(R))!==-1)&&typeof FileReader<"u"?new d.Promise(function(O,G){var I=new FileReader;I.onload=function(P){O(P.target.result)},I.onerror=function(P){G(P.target.error)},I.readAsArrayBuffer(R)}):R}).then(function(R){var O=r.getTypeOf(R);return O?(O==="arraybuffer"?R=r.transformTo("uint8array",R):O==="string"&&(N?R=o.decode(R):A&&E!==!0&&(R=(function(G){return g(G,l.uint8array?new Uint8Array(G.length):new Array(G.length))})(R))),R):d.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,n,r){var l=s("./reader/readerFor"),o=s("./utils"),u=s("./signature"),d=s("./zipEntry"),h=s("./support");function g(b){this.files=[],this.loadOptions=b}g.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(v)+", expected "+o.pretty(b)+")")}},isSignature:function(b,v){var x=this.reader.index;this.reader.setIndex(b);var _=this.reader.readString(4)===v;return this.reader.setIndex(x),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),v=h.uint8array?"uint8array":"array",x=o.transformTo(v,b);this.zipComment=this.loadOptions.decodeFileName(x)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,v,x,_=this.zip64EndOfCentralSize-44;0<_;)b=this.reader.readInt(2),v=this.reader.readInt(4),x=this.reader.readData(v),this.zip64ExtensibleData[b]={id:b,length:v,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,v;for(b=0;b<this.files.length;b++)v=this.files[b],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(b=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var v=b;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var _=v-x;if(0<_)this.isSignature(v,u.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(b){this.reader=l(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,n,r){var l=s("./reader/readerFor"),o=s("./utils"),u=s("./compressedObject"),d=s("./crc32"),h=s("./utf8"),g=s("./compressions"),b=s("./support");function v(x,_){this.options=x,this.loadOptions=_}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(x){var _,w;if(x.skip(22),this.fileNameLength=x.readInt(2),w=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(w),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=(function(S){for(var A in g)if(Object.prototype.hasOwnProperty.call(g,A)&&g[A].magic===S)return g[A];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,_,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var _=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(_),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),x==0&&(this.dosPermissions=63&this.externalFileAttributes),x==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=l(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var _,w,S,A=x.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});x.index+4<A;)_=x.readInt(2),w=x.readInt(2),S=x.readData(w),this.extraFields[_]={id:_,length:w,value:S};x.setIndex(A)},handleUTF8:function(){var x=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var w=o.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(w)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var A=o.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(A)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var _=l(x.value);return _.readInt(1)!==1||d(this.fileName)!==_.readInt(4)?null:h.utf8decode(_.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var _=l(x.value);return _.readInt(1)!==1||d(this.fileComment)!==_.readInt(4)?null:h.utf8decode(_.readData(x.length-5))}return null}},n.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,n,r){function l(_,w,S){this.name=_,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=w,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var o=s("./stream/StreamHelper"),u=s("./stream/DataWorker"),d=s("./utf8"),h=s("./compressedObject"),g=s("./stream/GenericWorker");l.prototype={internalStream:function(_){var w=null,S="string";try{if(!_)throw new Error("No output type specified.");var A=(S=_.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),w=this._decompressWorker();var E=!this._dataBinary;E&&!A&&(w=w.pipe(new d.Utf8EncodeWorker)),!E&&A&&(w=w.pipe(new d.Utf8DecodeWorker))}catch(N){(w=new g("error")).error(N)}return new o(w,S,"")},async:function(_,w){return this.internalStream(_).accumulate(w)},nodeStream:function(_,w){return this.internalStream(_||"nodebuffer").toNodejsStream(w)},_compressWorker:function(_,w){if(this._data instanceof h&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new d.Utf8EncodeWorker)),h.createWorkerFrom(S,_,w)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof g?this._data:new u(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},x=0;x<b.length;x++)l.prototype[b[x]]=v;n.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,n,r){(function(l){var o,u,d=l.MutationObserver||l.WebKitMutationObserver;if(d){var h=0,g=new d(_),b=l.document.createTextNode("");g.observe(b,{characterData:!0}),o=function(){b.data=h=++h%2}}else if(l.setImmediate||l.MessageChannel===void 0)o="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var w=l.document.createElement("script");w.onreadystatechange=function(){_(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},l.document.documentElement.appendChild(w)}:function(){setTimeout(_,0)};else{var v=new l.MessageChannel;v.port1.onmessage=_,o=function(){v.port2.postMessage(0)}}var x=[];function _(){var w,S;u=!0;for(var A=x.length;A;){for(S=x,x=[],w=-1;++w<A;)S[w]();A=x.length}u=!1}n.exports=function(w){x.push(w)!==1||u||o()}}).call(this,typeof tn<"u"?tn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,n,r){var l=s("immediate");function o(){}var u={},d=["REJECTED"],h=["FULFILLED"],g=["PENDING"];function b(A){if(typeof A!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,A!==o&&w(this,A)}function v(A,E,N){this.promise=A,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function x(A,E,N){l(function(){var R;try{R=E(N)}catch(O){return u.reject(A,O)}R===A?u.reject(A,new TypeError("Cannot resolve promise with itself")):u.resolve(A,R)})}function _(A){var E=A&&A.then;if(A&&(typeof A=="object"||typeof A=="function")&&typeof E=="function")return function(){E.apply(A,arguments)}}function w(A,E){var N=!1;function R(I){N||(N=!0,u.reject(A,I))}function O(I){N||(N=!0,u.resolve(A,I))}var G=S(function(){E(O,R)});G.status==="error"&&R(G.value)}function S(A,E){var N={};try{N.value=A(E),N.status="success"}catch(R){N.status="error",N.value=R}return N}(n.exports=b).prototype.finally=function(A){if(typeof A!="function")return this;var E=this.constructor;return this.then(function(N){return E.resolve(A()).then(function(){return N})},function(N){return E.resolve(A()).then(function(){throw N})})},b.prototype.catch=function(A){return this.then(null,A)},b.prototype.then=function(A,E){if(typeof A!="function"&&this.state===h||typeof E!="function"&&this.state===d)return this;var N=new this.constructor(o);return this.state!==g?x(N,this.state===h?A:E,this.outcome):this.queue.push(new v(N,A,E)),N},v.prototype.callFulfilled=function(A){u.resolve(this.promise,A)},v.prototype.otherCallFulfilled=function(A){x(this.promise,this.onFulfilled,A)},v.prototype.callRejected=function(A){u.reject(this.promise,A)},v.prototype.otherCallRejected=function(A){x(this.promise,this.onRejected,A)},u.resolve=function(A,E){var N=S(_,E);if(N.status==="error")return u.reject(A,N.value);var R=N.value;if(R)w(A,R);else{A.state=h,A.outcome=E;for(var O=-1,G=A.queue.length;++O<G;)A.queue[O].callFulfilled(E)}return A},u.reject=function(A,E){A.state=d,A.outcome=E;for(var N=-1,R=A.queue.length;++N<R;)A.queue[N].callRejected(E);return A},b.resolve=function(A){return A instanceof this?A:u.resolve(new this(o),A)},b.reject=function(A){var E=new this(o);return u.reject(E,A)},b.all=function(A){var E=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=A.length,R=!1;if(!N)return this.resolve([]);for(var O=new Array(N),G=0,I=-1,P=new this(o);++I<N;)Y(A[I],I);return P;function Y(W,gt){E.resolve(W).then(function(z){O[gt]=z,++G!==N||R||(R=!0,u.resolve(P,O))},function(z){R||(R=!0,u.reject(P,z))})}},b.race=function(A){var E=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=A.length,R=!1;if(!N)return this.resolve([]);for(var O=-1,G=new this(o);++O<N;)I=A[O],E.resolve(I).then(function(P){R||(R=!0,u.resolve(G,P))},function(P){R||(R=!0,u.reject(G,P))});var I;return G}},{immediate:36}],38:[function(s,n,r){var l={};(0,s("./lib/utils/common").assign)(l,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),n.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,n,r){var l=s("./zlib/deflate"),o=s("./utils/common"),u=s("./utils/strings"),d=s("./zlib/messages"),h=s("./zlib/zstream"),g=Object.prototype.toString,b=0,v=-1,x=0,_=8;function w(A){if(!(this instanceof w))return new w(A);this.options=o.assign({level:v,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:x,to:""},A||{});var E=this.options;E.raw&&0<E.windowBits?E.windowBits=-E.windowBits:E.gzip&&0<E.windowBits&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var N=l.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(N!==b)throw new Error(d[N]);if(E.header&&l.deflateSetHeader(this.strm,E.header),E.dictionary){var R;if(R=typeof E.dictionary=="string"?u.string2buf(E.dictionary):g.call(E.dictionary)==="[object ArrayBuffer]"?new Uint8Array(E.dictionary):E.dictionary,(N=l.deflateSetDictionary(this.strm,R))!==b)throw new Error(d[N]);this._dict_set=!0}}function S(A,E){var N=new w(E);if(N.push(A,!0),N.err)throw N.msg||d[N.err];return N.result}w.prototype.push=function(A,E){var N,R,O=this.strm,G=this.options.chunkSize;if(this.ended)return!1;R=E===~~E?E:E===!0?4:0,typeof A=="string"?O.input=u.string2buf(A):g.call(A)==="[object ArrayBuffer]"?O.input=new Uint8Array(A):O.input=A,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new o.Buf8(G),O.next_out=0,O.avail_out=G),(N=l.deflate(O,R))!==1&&N!==b)return this.onEnd(N),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||R!==4&&R!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(o.shrinkBuf(O.output,O.next_out))):this.onData(o.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&N!==1);return R===4?(N=l.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===b):R!==2||(this.onEnd(b),!(O.avail_out=0))},w.prototype.onData=function(A){this.chunks.push(A)},w.prototype.onEnd=function(A){A===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg},r.Deflate=w,r.deflate=S,r.deflateRaw=function(A,E){return(E=E||{}).raw=!0,S(A,E)},r.gzip=function(A,E){return(E=E||{}).gzip=!0,S(A,E)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,n,r){var l=s("./zlib/inflate"),o=s("./utils/common"),u=s("./utils/strings"),d=s("./zlib/constants"),h=s("./zlib/messages"),g=s("./zlib/zstream"),b=s("./zlib/gzheader"),v=Object.prototype.toString;function x(w){if(!(this instanceof x))return new x(w);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},w||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||w&&w.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&(15&S.windowBits)==0&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var A=l.inflateInit2(this.strm,S.windowBits);if(A!==d.Z_OK)throw new Error(h[A]);this.header=new b,l.inflateGetHeader(this.strm,this.header)}function _(w,S){var A=new x(S);if(A.push(w,!0),A.err)throw A.msg||h[A.err];return A.result}x.prototype.push=function(w,S){var A,E,N,R,O,G,I=this.strm,P=this.options.chunkSize,Y=this.options.dictionary,W=!1;if(this.ended)return!1;E=S===~~S?S:S===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof w=="string"?I.input=u.binstring2buf(w):v.call(w)==="[object ArrayBuffer]"?I.input=new Uint8Array(w):I.input=w,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new o.Buf8(P),I.next_out=0,I.avail_out=P),(A=l.inflate(I,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&Y&&(G=typeof Y=="string"?u.string2buf(Y):v.call(Y)==="[object ArrayBuffer]"?new Uint8Array(Y):Y,A=l.inflateSetDictionary(this.strm,G)),A===d.Z_BUF_ERROR&&W===!0&&(A=d.Z_OK,W=!1),A!==d.Z_STREAM_END&&A!==d.Z_OK)return this.onEnd(A),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&A!==d.Z_STREAM_END&&(I.avail_in!==0||E!==d.Z_FINISH&&E!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=u.utf8border(I.output,I.next_out),R=I.next_out-N,O=u.buf2string(I.output,N),I.next_out=R,I.avail_out=P-R,R&&o.arraySet(I.output,I.output,N,R,0),this.onData(O)):this.onData(o.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(W=!0)}while((0<I.avail_in||I.avail_out===0)&&A!==d.Z_STREAM_END);return A===d.Z_STREAM_END&&(E=d.Z_FINISH),E===d.Z_FINISH?(A=l.inflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===d.Z_OK):E!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(I.avail_out=0))},x.prototype.onData=function(w){this.chunks.push(w)},x.prototype.onEnd=function(w){w===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},r.Inflate=x,r.inflate=_,r.inflateRaw=function(w,S){return(S=S||{}).raw=!0,_(w,S)},r.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,n,r){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(d){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var g=h.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var b in g)g.hasOwnProperty(b)&&(d[b]=g[b])}}return d},r.shrinkBuf=function(d,h){return d.length===h?d:d.subarray?d.subarray(0,h):(d.length=h,d)};var o={arraySet:function(d,h,g,b,v){if(h.subarray&&d.subarray)d.set(h.subarray(g,g+b),v);else for(var x=0;x<b;x++)d[v+x]=h[g+x]},flattenChunks:function(d){var h,g,b,v,x,_;for(h=b=0,g=d.length;h<g;h++)b+=d[h].length;for(_=new Uint8Array(b),h=v=0,g=d.length;h<g;h++)x=d[h],_.set(x,v),v+=x.length;return _}},u={arraySet:function(d,h,g,b,v){for(var x=0;x<b;x++)d[v+x]=h[g+x]},flattenChunks:function(d){return[].concat.apply([],d)}};r.setTyped=function(d){d?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,u))},r.setTyped(l)},{}],42:[function(s,n,r){var l=s("./common"),o=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new l.Buf8(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function g(b,v){if(v<65537&&(b.subarray&&u||!b.subarray&&o))return String.fromCharCode.apply(null,l.shrinkBuf(b,v));for(var x="",_=0;_<v;_++)x+=String.fromCharCode(b[_]);return x}d[254]=d[254]=1,r.string2buf=function(b){var v,x,_,w,S,A=b.length,E=0;for(w=0;w<A;w++)(64512&(x=b.charCodeAt(w)))==55296&&w+1<A&&(64512&(_=b.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(_-56320),w++),E+=x<128?1:x<2048?2:x<65536?3:4;for(v=new l.Buf8(E),w=S=0;S<E;w++)(64512&(x=b.charCodeAt(w)))==55296&&w+1<A&&(64512&(_=b.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(_-56320),w++),x<128?v[S++]=x:(x<2048?v[S++]=192|x>>>6:(x<65536?v[S++]=224|x>>>12:(v[S++]=240|x>>>18,v[S++]=128|x>>>12&63),v[S++]=128|x>>>6&63),v[S++]=128|63&x);return v},r.buf2binstring=function(b){return g(b,b.length)},r.binstring2buf=function(b){for(var v=new l.Buf8(b.length),x=0,_=v.length;x<_;x++)v[x]=b.charCodeAt(x);return v},r.buf2string=function(b,v){var x,_,w,S,A=v||b.length,E=new Array(2*A);for(x=_=0;x<A;)if((w=b[x++])<128)E[_++]=w;else if(4<(S=d[w]))E[_++]=65533,x+=S-1;else{for(w&=S===2?31:S===3?15:7;1<S&&x<A;)w=w<<6|63&b[x++],S--;1<S?E[_++]=65533:w<65536?E[_++]=w:(w-=65536,E[_++]=55296|w>>10&1023,E[_++]=56320|1023&w)}return g(E,_)},r.utf8border=function(b,v){var x;for((v=v||b.length)>b.length&&(v=b.length),x=v-1;0<=x&&(192&b[x])==128;)x--;return x<0||x===0?v:x+d[b[x]]>v?x:v}},{"./common":41}],43:[function(s,n,r){n.exports=function(l,o,u,d){for(var h=65535&l|0,g=l>>>16&65535|0,b=0;u!==0;){for(u-=b=2e3<u?2e3:u;g=g+(h=h+o[d++]|0)|0,--b;);h%=65521,g%=65521}return h|g<<16|0}},{}],44:[function(s,n,r){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,n,r){var l=(function(){for(var o,u=[],d=0;d<256;d++){o=d;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;u[d]=o}return u})();n.exports=function(o,u,d,h){var g=l,b=h+d;o^=-1;for(var v=h;v<b;v++)o=o>>>8^g[255&(o^u[v])];return-1^o}},{}],46:[function(s,n,r){var l,o=s("../utils/common"),u=s("./trees"),d=s("./adler32"),h=s("./crc32"),g=s("./messages"),b=0,v=4,x=0,_=-2,w=-1,S=4,A=2,E=8,N=9,R=286,O=30,G=19,I=2*R+1,P=15,Y=3,W=258,gt=W+Y+1,z=42,Q=113,T=1,lt=2,H=3,D=4;function X(C,dt){return C.msg=g[dt],dt}function q(C){return(C<<1)-(4<C?9:0)}function ut(C){for(var dt=C.length;0<=--dt;)C[dt]=0}function M(C){var dt=C.state,at=dt.pending;at>C.avail_out&&(at=C.avail_out),at!==0&&(o.arraySet(C.output,dt.pending_buf,dt.pending_out,at,C.next_out),C.next_out+=at,dt.pending_out+=at,C.total_out+=at,C.avail_out-=at,dt.pending-=at,dt.pending===0&&(dt.pending_out=0))}function L(C,dt){u._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,dt),C.block_start=C.strstart,M(C.strm)}function J(C,dt){C.pending_buf[C.pending++]=dt}function rt(C,dt){C.pending_buf[C.pending++]=dt>>>8&255,C.pending_buf[C.pending++]=255&dt}function nt(C,dt){var at,U,F=C.max_chain_length,Z=C.strstart,mt=C.prev_length,bt=C.nice_match,st=C.strstart>C.w_size-gt?C.strstart-(C.w_size-gt):0,yt=C.window,wt=C.w_mask,vt=C.prev,Nt=C.strstart+W,se=yt[Z+mt-1],Vt=yt[Z+mt];C.prev_length>=C.good_match&&(F>>=2),bt>C.lookahead&&(bt=C.lookahead);do if(yt[(at=dt)+mt]===Vt&&yt[at+mt-1]===se&&yt[at]===yt[Z]&&yt[++at]===yt[Z+1]){Z+=2,at++;do;while(yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&yt[++Z]===yt[++at]&&Z<Nt);if(U=W-(Nt-Z),Z=Nt-W,mt<U){if(C.match_start=dt,bt<=(mt=U))break;se=yt[Z+mt-1],Vt=yt[Z+mt]}}while((dt=vt[dt&wt])>st&&--F!=0);return mt<=C.lookahead?mt:C.lookahead}function _t(C){var dt,at,U,F,Z,mt,bt,st,yt,wt,vt=C.w_size;do{if(F=C.window_size-C.lookahead-C.strstart,C.strstart>=vt+(vt-gt)){for(o.arraySet(C.window,C.window,vt,vt,0),C.match_start-=vt,C.strstart-=vt,C.block_start-=vt,dt=at=C.hash_size;U=C.head[--dt],C.head[dt]=vt<=U?U-vt:0,--at;);for(dt=at=vt;U=C.prev[--dt],C.prev[dt]=vt<=U?U-vt:0,--at;);F+=vt}if(C.strm.avail_in===0)break;if(mt=C.strm,bt=C.window,st=C.strstart+C.lookahead,yt=F,wt=void 0,wt=mt.avail_in,yt<wt&&(wt=yt),at=wt===0?0:(mt.avail_in-=wt,o.arraySet(bt,mt.input,mt.next_in,wt,st),mt.state.wrap===1?mt.adler=d(mt.adler,bt,wt,st):mt.state.wrap===2&&(mt.adler=h(mt.adler,bt,wt,st)),mt.next_in+=wt,mt.total_in+=wt,wt),C.lookahead+=at,C.lookahead+C.insert>=Y)for(Z=C.strstart-C.insert,C.ins_h=C.window[Z],C.ins_h=(C.ins_h<<C.hash_shift^C.window[Z+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[Z+Y-1])&C.hash_mask,C.prev[Z&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=Z,Z++,C.insert--,!(C.lookahead+C.insert<Y)););}while(C.lookahead<gt&&C.strm.avail_in!==0)}function xt(C,dt){for(var at,U;;){if(C.lookahead<gt){if(_t(C),C.lookahead<gt&&dt===b)return T;if(C.lookahead===0)break}if(at=0,C.lookahead>=Y&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+Y-1])&C.hash_mask,at=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),at!==0&&C.strstart-at<=C.w_size-gt&&(C.match_length=nt(C,at)),C.match_length>=Y)if(U=u._tr_tally(C,C.strstart-C.match_start,C.match_length-Y),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=Y){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+Y-1])&C.hash_mask,at=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else U=u._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(U&&(L(C,!1),C.strm.avail_out===0))return T}return C.insert=C.strstart<Y-1?C.strstart:Y-1,dt===v?(L(C,!0),C.strm.avail_out===0?H:D):C.last_lit&&(L(C,!1),C.strm.avail_out===0)?T:lt}function Et(C,dt){for(var at,U,F;;){if(C.lookahead<gt){if(_t(C),C.lookahead<gt&&dt===b)return T;if(C.lookahead===0)break}if(at=0,C.lookahead>=Y&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+Y-1])&C.hash_mask,at=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=Y-1,at!==0&&C.prev_length<C.max_lazy_match&&C.strstart-at<=C.w_size-gt&&(C.match_length=nt(C,at),C.match_length<=5&&(C.strategy===1||C.match_length===Y&&4096<C.strstart-C.match_start)&&(C.match_length=Y-1)),C.prev_length>=Y&&C.match_length<=C.prev_length){for(F=C.strstart+C.lookahead-Y,U=u._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-Y),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=F&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+Y-1])&C.hash_mask,at=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=Y-1,C.strstart++,U&&(L(C,!1),C.strm.avail_out===0))return T}else if(C.match_available){if((U=u._tr_tally(C,0,C.window[C.strstart-1]))&&L(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return T}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(U=u._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<Y-1?C.strstart:Y-1,dt===v?(L(C,!0),C.strm.avail_out===0?H:D):C.last_lit&&(L(C,!1),C.strm.avail_out===0)?T:lt}function ot(C,dt,at,U,F){this.good_length=C,this.max_lazy=dt,this.nice_length=at,this.max_chain=U,this.func=F}function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*I),this.dyn_dtree=new o.Buf16(2*(2*O+1)),this.bl_tree=new o.Buf16(2*(2*G+1)),ut(this.dyn_ltree),ut(this.dyn_dtree),ut(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(P+1),this.heap=new o.Buf16(2*R+1),ut(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*R+1),ut(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ot(C){var dt;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=A,(dt=C.state).pending=0,dt.pending_out=0,dt.wrap<0&&(dt.wrap=-dt.wrap),dt.status=dt.wrap?z:Q,C.adler=dt.wrap===2?0:1,dt.last_flush=b,u._tr_init(dt),x):X(C,_)}function zt(C){var dt=Ot(C);return dt===x&&(function(at){at.window_size=2*at.w_size,ut(at.head),at.max_lazy_match=l[at.level].max_lazy,at.good_match=l[at.level].good_length,at.nice_match=l[at.level].nice_length,at.max_chain_length=l[at.level].max_chain,at.strstart=0,at.block_start=0,at.lookahead=0,at.insert=0,at.match_length=at.prev_length=Y-1,at.match_available=0,at.ins_h=0})(C.state),dt}function Ft(C,dt,at,U,F,Z){if(!C)return _;var mt=1;if(dt===w&&(dt=6),U<0?(mt=0,U=-U):15<U&&(mt=2,U-=16),F<1||N<F||at!==E||U<8||15<U||dt<0||9<dt||Z<0||S<Z)return X(C,_);U===8&&(U=9);var bt=new At;return(C.state=bt).strm=C,bt.wrap=mt,bt.gzhead=null,bt.w_bits=U,bt.w_size=1<<bt.w_bits,bt.w_mask=bt.w_size-1,bt.hash_bits=F+7,bt.hash_size=1<<bt.hash_bits,bt.hash_mask=bt.hash_size-1,bt.hash_shift=~~((bt.hash_bits+Y-1)/Y),bt.window=new o.Buf8(2*bt.w_size),bt.head=new o.Buf16(bt.hash_size),bt.prev=new o.Buf16(bt.w_size),bt.lit_bufsize=1<<F+6,bt.pending_buf_size=4*bt.lit_bufsize,bt.pending_buf=new o.Buf8(bt.pending_buf_size),bt.d_buf=1*bt.lit_bufsize,bt.l_buf=3*bt.lit_bufsize,bt.level=dt,bt.strategy=Z,bt.method=at,zt(C)}l=[new ot(0,0,0,0,function(C,dt){var at=65535;for(at>C.pending_buf_size-5&&(at=C.pending_buf_size-5);;){if(C.lookahead<=1){if(_t(C),C.lookahead===0&&dt===b)return T;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var U=C.block_start+at;if((C.strstart===0||C.strstart>=U)&&(C.lookahead=C.strstart-U,C.strstart=U,L(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-gt&&(L(C,!1),C.strm.avail_out===0))return T}return C.insert=0,dt===v?(L(C,!0),C.strm.avail_out===0?H:D):(C.strstart>C.block_start&&(L(C,!1),C.strm.avail_out),T)}),new ot(4,4,8,4,xt),new ot(4,5,16,8,xt),new ot(4,6,32,32,xt),new ot(4,4,16,16,Et),new ot(8,16,32,32,Et),new ot(8,16,128,128,Et),new ot(8,32,128,256,Et),new ot(32,128,258,1024,Et),new ot(32,258,258,4096,Et)],r.deflateInit=function(C,dt){return Ft(C,dt,E,15,8,0)},r.deflateInit2=Ft,r.deflateReset=zt,r.deflateResetKeep=Ot,r.deflateSetHeader=function(C,dt){return C&&C.state?C.state.wrap!==2?_:(C.state.gzhead=dt,x):_},r.deflate=function(C,dt){var at,U,F,Z;if(!C||!C.state||5<dt||dt<0)return C?X(C,_):_;if(U=C.state,!C.output||!C.input&&C.avail_in!==0||U.status===666&&dt!==v)return X(C,C.avail_out===0?-5:_);if(U.strm=C,at=U.last_flush,U.last_flush=dt,U.status===z)if(U.wrap===2)C.adler=0,J(U,31),J(U,139),J(U,8),U.gzhead?(J(U,(U.gzhead.text?1:0)+(U.gzhead.hcrc?2:0)+(U.gzhead.extra?4:0)+(U.gzhead.name?8:0)+(U.gzhead.comment?16:0)),J(U,255&U.gzhead.time),J(U,U.gzhead.time>>8&255),J(U,U.gzhead.time>>16&255),J(U,U.gzhead.time>>24&255),J(U,U.level===9?2:2<=U.strategy||U.level<2?4:0),J(U,255&U.gzhead.os),U.gzhead.extra&&U.gzhead.extra.length&&(J(U,255&U.gzhead.extra.length),J(U,U.gzhead.extra.length>>8&255)),U.gzhead.hcrc&&(C.adler=h(C.adler,U.pending_buf,U.pending,0)),U.gzindex=0,U.status=69):(J(U,0),J(U,0),J(U,0),J(U,0),J(U,0),J(U,U.level===9?2:2<=U.strategy||U.level<2?4:0),J(U,3),U.status=Q);else{var mt=E+(U.w_bits-8<<4)<<8;mt|=(2<=U.strategy||U.level<2?0:U.level<6?1:U.level===6?2:3)<<6,U.strstart!==0&&(mt|=32),mt+=31-mt%31,U.status=Q,rt(U,mt),U.strstart!==0&&(rt(U,C.adler>>>16),rt(U,65535&C.adler)),C.adler=1}if(U.status===69)if(U.gzhead.extra){for(F=U.pending;U.gzindex<(65535&U.gzhead.extra.length)&&(U.pending!==U.pending_buf_size||(U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),M(C),F=U.pending,U.pending!==U.pending_buf_size));)J(U,255&U.gzhead.extra[U.gzindex]),U.gzindex++;U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),U.gzindex===U.gzhead.extra.length&&(U.gzindex=0,U.status=73)}else U.status=73;if(U.status===73)if(U.gzhead.name){F=U.pending;do{if(U.pending===U.pending_buf_size&&(U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),M(C),F=U.pending,U.pending===U.pending_buf_size)){Z=1;break}Z=U.gzindex<U.gzhead.name.length?255&U.gzhead.name.charCodeAt(U.gzindex++):0,J(U,Z)}while(Z!==0);U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),Z===0&&(U.gzindex=0,U.status=91)}else U.status=91;if(U.status===91)if(U.gzhead.comment){F=U.pending;do{if(U.pending===U.pending_buf_size&&(U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),M(C),F=U.pending,U.pending===U.pending_buf_size)){Z=1;break}Z=U.gzindex<U.gzhead.comment.length?255&U.gzhead.comment.charCodeAt(U.gzindex++):0,J(U,Z)}while(Z!==0);U.gzhead.hcrc&&U.pending>F&&(C.adler=h(C.adler,U.pending_buf,U.pending-F,F)),Z===0&&(U.status=103)}else U.status=103;if(U.status===103&&(U.gzhead.hcrc?(U.pending+2>U.pending_buf_size&&M(C),U.pending+2<=U.pending_buf_size&&(J(U,255&C.adler),J(U,C.adler>>8&255),C.adler=0,U.status=Q)):U.status=Q),U.pending!==0){if(M(C),C.avail_out===0)return U.last_flush=-1,x}else if(C.avail_in===0&&q(dt)<=q(at)&&dt!==v)return X(C,-5);if(U.status===666&&C.avail_in!==0)return X(C,-5);if(C.avail_in!==0||U.lookahead!==0||dt!==b&&U.status!==666){var bt=U.strategy===2?(function(st,yt){for(var wt;;){if(st.lookahead===0&&(_t(st),st.lookahead===0)){if(yt===b)return T;break}if(st.match_length=0,wt=u._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++,wt&&(L(st,!1),st.strm.avail_out===0))return T}return st.insert=0,yt===v?(L(st,!0),st.strm.avail_out===0?H:D):st.last_lit&&(L(st,!1),st.strm.avail_out===0)?T:lt})(U,dt):U.strategy===3?(function(st,yt){for(var wt,vt,Nt,se,Vt=st.window;;){if(st.lookahead<=W){if(_t(st),st.lookahead<=W&&yt===b)return T;if(st.lookahead===0)break}if(st.match_length=0,st.lookahead>=Y&&0<st.strstart&&(vt=Vt[Nt=st.strstart-1])===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]){se=st.strstart+W;do;while(vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&vt===Vt[++Nt]&&Nt<se);st.match_length=W-(se-Nt),st.match_length>st.lookahead&&(st.match_length=st.lookahead)}if(st.match_length>=Y?(wt=u._tr_tally(st,1,st.match_length-Y),st.lookahead-=st.match_length,st.strstart+=st.match_length,st.match_length=0):(wt=u._tr_tally(st,0,st.window[st.strstart]),st.lookahead--,st.strstart++),wt&&(L(st,!1),st.strm.avail_out===0))return T}return st.insert=0,yt===v?(L(st,!0),st.strm.avail_out===0?H:D):st.last_lit&&(L(st,!1),st.strm.avail_out===0)?T:lt})(U,dt):l[U.level].func(U,dt);if(bt!==H&&bt!==D||(U.status=666),bt===T||bt===H)return C.avail_out===0&&(U.last_flush=-1),x;if(bt===lt&&(dt===1?u._tr_align(U):dt!==5&&(u._tr_stored_block(U,0,0,!1),dt===3&&(ut(U.head),U.lookahead===0&&(U.strstart=0,U.block_start=0,U.insert=0))),M(C),C.avail_out===0))return U.last_flush=-1,x}return dt!==v?x:U.wrap<=0?1:(U.wrap===2?(J(U,255&C.adler),J(U,C.adler>>8&255),J(U,C.adler>>16&255),J(U,C.adler>>24&255),J(U,255&C.total_in),J(U,C.total_in>>8&255),J(U,C.total_in>>16&255),J(U,C.total_in>>24&255)):(rt(U,C.adler>>>16),rt(U,65535&C.adler)),M(C),0<U.wrap&&(U.wrap=-U.wrap),U.pending!==0?x:1)},r.deflateEnd=function(C){var dt;return C&&C.state?(dt=C.state.status)!==z&&dt!==69&&dt!==73&&dt!==91&&dt!==103&&dt!==Q&&dt!==666?X(C,_):(C.state=null,dt===Q?X(C,-3):x):_},r.deflateSetDictionary=function(C,dt){var at,U,F,Z,mt,bt,st,yt,wt=dt.length;if(!C||!C.state||(Z=(at=C.state).wrap)===2||Z===1&&at.status!==z||at.lookahead)return _;for(Z===1&&(C.adler=d(C.adler,dt,wt,0)),at.wrap=0,wt>=at.w_size&&(Z===0&&(ut(at.head),at.strstart=0,at.block_start=0,at.insert=0),yt=new o.Buf8(at.w_size),o.arraySet(yt,dt,wt-at.w_size,at.w_size,0),dt=yt,wt=at.w_size),mt=C.avail_in,bt=C.next_in,st=C.input,C.avail_in=wt,C.next_in=0,C.input=dt,_t(at);at.lookahead>=Y;){for(U=at.strstart,F=at.lookahead-(Y-1);at.ins_h=(at.ins_h<<at.hash_shift^at.window[U+Y-1])&at.hash_mask,at.prev[U&at.w_mask]=at.head[at.ins_h],at.head[at.ins_h]=U,U++,--F;);at.strstart=U,at.lookahead=Y-1,_t(at)}return at.strstart+=at.lookahead,at.block_start=at.strstart,at.insert=at.lookahead,at.lookahead=0,at.match_length=at.prev_length=Y-1,at.match_available=0,C.next_in=bt,C.input=st,C.avail_in=mt,at.wrap=Z,x},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,n,r){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,n,r){n.exports=function(l,o){var u,d,h,g,b,v,x,_,w,S,A,E,N,R,O,G,I,P,Y,W,gt,z,Q,T,lt;u=l.state,d=l.next_in,T=l.input,h=d+(l.avail_in-5),g=l.next_out,lt=l.output,b=g-(o-l.avail_out),v=g+(l.avail_out-257),x=u.dmax,_=u.wsize,w=u.whave,S=u.wnext,A=u.window,E=u.hold,N=u.bits,R=u.lencode,O=u.distcode,G=(1<<u.lenbits)-1,I=(1<<u.distbits)-1;t:do{N<15&&(E+=T[d++]<<N,N+=8,E+=T[d++]<<N,N+=8),P=R[E&G];e:for(;;){if(E>>>=Y=P>>>24,N-=Y,(Y=P>>>16&255)===0)lt[g++]=65535&P;else{if(!(16&Y)){if((64&Y)==0){P=R[(65535&P)+(E&(1<<Y)-1)];continue e}if(32&Y){u.mode=12;break t}l.msg="invalid literal/length code",u.mode=30;break t}W=65535&P,(Y&=15)&&(N<Y&&(E+=T[d++]<<N,N+=8),W+=E&(1<<Y)-1,E>>>=Y,N-=Y),N<15&&(E+=T[d++]<<N,N+=8,E+=T[d++]<<N,N+=8),P=O[E&I];s:for(;;){if(E>>>=Y=P>>>24,N-=Y,!(16&(Y=P>>>16&255))){if((64&Y)==0){P=O[(65535&P)+(E&(1<<Y)-1)];continue s}l.msg="invalid distance code",u.mode=30;break t}if(gt=65535&P,N<(Y&=15)&&(E+=T[d++]<<N,(N+=8)<Y&&(E+=T[d++]<<N,N+=8)),x<(gt+=E&(1<<Y)-1)){l.msg="invalid distance too far back",u.mode=30;break t}if(E>>>=Y,N-=Y,(Y=g-b)<gt){if(w<(Y=gt-Y)&&u.sane){l.msg="invalid distance too far back",u.mode=30;break t}if(Q=A,(z=0)===S){if(z+=_-Y,Y<W){for(W-=Y;lt[g++]=A[z++],--Y;);z=g-gt,Q=lt}}else if(S<Y){if(z+=_+S-Y,(Y-=S)<W){for(W-=Y;lt[g++]=A[z++],--Y;);if(z=0,S<W){for(W-=Y=S;lt[g++]=A[z++],--Y;);z=g-gt,Q=lt}}}else if(z+=S-Y,Y<W){for(W-=Y;lt[g++]=A[z++],--Y;);z=g-gt,Q=lt}for(;2<W;)lt[g++]=Q[z++],lt[g++]=Q[z++],lt[g++]=Q[z++],W-=3;W&&(lt[g++]=Q[z++],1<W&&(lt[g++]=Q[z++]))}else{for(z=g-gt;lt[g++]=lt[z++],lt[g++]=lt[z++],lt[g++]=lt[z++],2<(W-=3););W&&(lt[g++]=lt[z++],1<W&&(lt[g++]=lt[z++]))}break}}break}}while(d<h&&g<v);d-=W=N>>3,E&=(1<<(N-=W<<3))-1,l.next_in=d,l.next_out=g,l.avail_in=d<h?h-d+5:5-(d-h),l.avail_out=g<v?v-g+257:257-(g-v),u.hold=E,u.bits=N}},{}],49:[function(s,n,r){var l=s("../utils/common"),o=s("./adler32"),u=s("./crc32"),d=s("./inffast"),h=s("./inftrees"),g=1,b=2,v=0,x=-2,_=1,w=852,S=592;function A(z){return(z>>>24&255)+(z>>>8&65280)+((65280&z)<<8)+((255&z)<<24)}function E(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(z){var Q;return z&&z.state?(Q=z.state,z.total_in=z.total_out=Q.total=0,z.msg="",Q.wrap&&(z.adler=1&Q.wrap),Q.mode=_,Q.last=0,Q.havedict=0,Q.dmax=32768,Q.head=null,Q.hold=0,Q.bits=0,Q.lencode=Q.lendyn=new l.Buf32(w),Q.distcode=Q.distdyn=new l.Buf32(S),Q.sane=1,Q.back=-1,v):x}function R(z){var Q;return z&&z.state?((Q=z.state).wsize=0,Q.whave=0,Q.wnext=0,N(z)):x}function O(z,Q){var T,lt;return z&&z.state?(lt=z.state,Q<0?(T=0,Q=-Q):(T=1+(Q>>4),Q<48&&(Q&=15)),Q&&(Q<8||15<Q)?x:(lt.window!==null&&lt.wbits!==Q&&(lt.window=null),lt.wrap=T,lt.wbits=Q,R(z))):x}function G(z,Q){var T,lt;return z?(lt=new E,(z.state=lt).window=null,(T=O(z,Q))!==v&&(z.state=null),T):x}var I,P,Y=!0;function W(z){if(Y){var Q;for(I=new l.Buf32(512),P=new l.Buf32(32),Q=0;Q<144;)z.lens[Q++]=8;for(;Q<256;)z.lens[Q++]=9;for(;Q<280;)z.lens[Q++]=7;for(;Q<288;)z.lens[Q++]=8;for(h(g,z.lens,0,288,I,0,z.work,{bits:9}),Q=0;Q<32;)z.lens[Q++]=5;h(b,z.lens,0,32,P,0,z.work,{bits:5}),Y=!1}z.lencode=I,z.lenbits=9,z.distcode=P,z.distbits=5}function gt(z,Q,T,lt){var H,D=z.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new l.Buf8(D.wsize)),lt>=D.wsize?(l.arraySet(D.window,Q,T-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(lt<(H=D.wsize-D.wnext)&&(H=lt),l.arraySet(D.window,Q,T-lt,H,D.wnext),(lt-=H)?(l.arraySet(D.window,Q,T-lt,lt,0),D.wnext=lt,D.whave=D.wsize):(D.wnext+=H,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=H))),0}r.inflateReset=R,r.inflateReset2=O,r.inflateResetKeep=N,r.inflateInit=function(z){return G(z,15)},r.inflateInit2=G,r.inflate=function(z,Q){var T,lt,H,D,X,q,ut,M,L,J,rt,nt,_t,xt,Et,ot,At,Ot,zt,Ft,C,dt,at,U,F=0,Z=new l.Buf8(4),mt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!z||!z.state||!z.output||!z.input&&z.avail_in!==0)return x;(T=z.state).mode===12&&(T.mode=13),X=z.next_out,H=z.output,ut=z.avail_out,D=z.next_in,lt=z.input,q=z.avail_in,M=T.hold,L=T.bits,J=q,rt=ut,dt=v;t:for(;;)switch(T.mode){case _:if(T.wrap===0){T.mode=13;break}for(;L<16;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(2&T.wrap&&M===35615){Z[T.check=0]=255&M,Z[1]=M>>>8&255,T.check=u(T.check,Z,2,0),L=M=0,T.mode=2;break}if(T.flags=0,T.head&&(T.head.done=!1),!(1&T.wrap)||(((255&M)<<8)+(M>>8))%31){z.msg="incorrect header check",T.mode=30;break}if((15&M)!=8){z.msg="unknown compression method",T.mode=30;break}if(L-=4,C=8+(15&(M>>>=4)),T.wbits===0)T.wbits=C;else if(C>T.wbits){z.msg="invalid window size",T.mode=30;break}T.dmax=1<<C,z.adler=T.check=1,T.mode=512&M?10:12,L=M=0;break;case 2:for(;L<16;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(T.flags=M,(255&T.flags)!=8){z.msg="unknown compression method",T.mode=30;break}if(57344&T.flags){z.msg="unknown header flags set",T.mode=30;break}T.head&&(T.head.text=M>>8&1),512&T.flags&&(Z[0]=255&M,Z[1]=M>>>8&255,T.check=u(T.check,Z,2,0)),L=M=0,T.mode=3;case 3:for(;L<32;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.head&&(T.head.time=M),512&T.flags&&(Z[0]=255&M,Z[1]=M>>>8&255,Z[2]=M>>>16&255,Z[3]=M>>>24&255,T.check=u(T.check,Z,4,0)),L=M=0,T.mode=4;case 4:for(;L<16;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.head&&(T.head.xflags=255&M,T.head.os=M>>8),512&T.flags&&(Z[0]=255&M,Z[1]=M>>>8&255,T.check=u(T.check,Z,2,0)),L=M=0,T.mode=5;case 5:if(1024&T.flags){for(;L<16;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.length=M,T.head&&(T.head.extra_len=M),512&T.flags&&(Z[0]=255&M,Z[1]=M>>>8&255,T.check=u(T.check,Z,2,0)),L=M=0}else T.head&&(T.head.extra=null);T.mode=6;case 6:if(1024&T.flags&&(q<(nt=T.length)&&(nt=q),nt&&(T.head&&(C=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),l.arraySet(T.head.extra,lt,D,nt,C)),512&T.flags&&(T.check=u(T.check,lt,nt,D)),q-=nt,D+=nt,T.length-=nt),T.length))break t;T.length=0,T.mode=7;case 7:if(2048&T.flags){if(q===0)break t;for(nt=0;C=lt[D+nt++],T.head&&C&&T.length<65536&&(T.head.name+=String.fromCharCode(C)),C&&nt<q;);if(512&T.flags&&(T.check=u(T.check,lt,nt,D)),q-=nt,D+=nt,C)break t}else T.head&&(T.head.name=null);T.length=0,T.mode=8;case 8:if(4096&T.flags){if(q===0)break t;for(nt=0;C=lt[D+nt++],T.head&&C&&T.length<65536&&(T.head.comment+=String.fromCharCode(C)),C&&nt<q;);if(512&T.flags&&(T.check=u(T.check,lt,nt,D)),q-=nt,D+=nt,C)break t}else T.head&&(T.head.comment=null);T.mode=9;case 9:if(512&T.flags){for(;L<16;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(M!==(65535&T.check)){z.msg="header crc mismatch",T.mode=30;break}L=M=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),z.adler=T.check=0,T.mode=12;break;case 10:for(;L<32;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}z.adler=T.check=A(M),L=M=0,T.mode=11;case 11:if(T.havedict===0)return z.next_out=X,z.avail_out=ut,z.next_in=D,z.avail_in=q,T.hold=M,T.bits=L,2;z.adler=T.check=1,T.mode=12;case 12:if(Q===5||Q===6)break t;case 13:if(T.last){M>>>=7&L,L-=7&L,T.mode=27;break}for(;L<3;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}switch(T.last=1&M,L-=1,3&(M>>>=1)){case 0:T.mode=14;break;case 1:if(W(T),T.mode=20,Q!==6)break;M>>>=2,L-=2;break t;case 2:T.mode=17;break;case 3:z.msg="invalid block type",T.mode=30}M>>>=2,L-=2;break;case 14:for(M>>>=7&L,L-=7&L;L<32;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if((65535&M)!=(M>>>16^65535)){z.msg="invalid stored block lengths",T.mode=30;break}if(T.length=65535&M,L=M=0,T.mode=15,Q===6)break t;case 15:T.mode=16;case 16:if(nt=T.length){if(q<nt&&(nt=q),ut<nt&&(nt=ut),nt===0)break t;l.arraySet(H,lt,D,nt,X),q-=nt,D+=nt,ut-=nt,X+=nt,T.length-=nt;break}T.mode=12;break;case 17:for(;L<14;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(T.nlen=257+(31&M),M>>>=5,L-=5,T.ndist=1+(31&M),M>>>=5,L-=5,T.ncode=4+(15&M),M>>>=4,L-=4,286<T.nlen||30<T.ndist){z.msg="too many length or distance symbols",T.mode=30;break}T.have=0,T.mode=18;case 18:for(;T.have<T.ncode;){for(;L<3;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.lens[mt[T.have++]]=7&M,M>>>=3,L-=3}for(;T.have<19;)T.lens[mt[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,at={bits:T.lenbits},dt=h(0,T.lens,0,19,T.lencode,0,T.work,at),T.lenbits=at.bits,dt){z.msg="invalid code lengths set",T.mode=30;break}T.have=0,T.mode=19;case 19:for(;T.have<T.nlen+T.ndist;){for(;ot=(F=T.lencode[M&(1<<T.lenbits)-1])>>>16&255,At=65535&F,!((Et=F>>>24)<=L);){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(At<16)M>>>=Et,L-=Et,T.lens[T.have++]=At;else{if(At===16){for(U=Et+2;L<U;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(M>>>=Et,L-=Et,T.have===0){z.msg="invalid bit length repeat",T.mode=30;break}C=T.lens[T.have-1],nt=3+(3&M),M>>>=2,L-=2}else if(At===17){for(U=Et+3;L<U;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}L-=Et,C=0,nt=3+(7&(M>>>=Et)),M>>>=3,L-=3}else{for(U=Et+7;L<U;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}L-=Et,C=0,nt=11+(127&(M>>>=Et)),M>>>=7,L-=7}if(T.have+nt>T.nlen+T.ndist){z.msg="invalid bit length repeat",T.mode=30;break}for(;nt--;)T.lens[T.have++]=C}}if(T.mode===30)break;if(T.lens[256]===0){z.msg="invalid code -- missing end-of-block",T.mode=30;break}if(T.lenbits=9,at={bits:T.lenbits},dt=h(g,T.lens,0,T.nlen,T.lencode,0,T.work,at),T.lenbits=at.bits,dt){z.msg="invalid literal/lengths set",T.mode=30;break}if(T.distbits=6,T.distcode=T.distdyn,at={bits:T.distbits},dt=h(b,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,at),T.distbits=at.bits,dt){z.msg="invalid distances set",T.mode=30;break}if(T.mode=20,Q===6)break t;case 20:T.mode=21;case 21:if(6<=q&&258<=ut){z.next_out=X,z.avail_out=ut,z.next_in=D,z.avail_in=q,T.hold=M,T.bits=L,d(z,rt),X=z.next_out,H=z.output,ut=z.avail_out,D=z.next_in,lt=z.input,q=z.avail_in,M=T.hold,L=T.bits,T.mode===12&&(T.back=-1);break}for(T.back=0;ot=(F=T.lencode[M&(1<<T.lenbits)-1])>>>16&255,At=65535&F,!((Et=F>>>24)<=L);){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(ot&&(240&ot)==0){for(Ot=Et,zt=ot,Ft=At;ot=(F=T.lencode[Ft+((M&(1<<Ot+zt)-1)>>Ot)])>>>16&255,At=65535&F,!(Ot+(Et=F>>>24)<=L);){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}M>>>=Ot,L-=Ot,T.back+=Ot}if(M>>>=Et,L-=Et,T.back+=Et,T.length=At,ot===0){T.mode=26;break}if(32&ot){T.back=-1,T.mode=12;break}if(64&ot){z.msg="invalid literal/length code",T.mode=30;break}T.extra=15&ot,T.mode=22;case 22:if(T.extra){for(U=T.extra;L<U;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.length+=M&(1<<T.extra)-1,M>>>=T.extra,L-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=23;case 23:for(;ot=(F=T.distcode[M&(1<<T.distbits)-1])>>>16&255,At=65535&F,!((Et=F>>>24)<=L);){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if((240&ot)==0){for(Ot=Et,zt=ot,Ft=At;ot=(F=T.distcode[Ft+((M&(1<<Ot+zt)-1)>>Ot)])>>>16&255,At=65535&F,!(Ot+(Et=F>>>24)<=L);){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}M>>>=Ot,L-=Ot,T.back+=Ot}if(M>>>=Et,L-=Et,T.back+=Et,64&ot){z.msg="invalid distance code",T.mode=30;break}T.offset=At,T.extra=15&ot,T.mode=24;case 24:if(T.extra){for(U=T.extra;L<U;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}T.offset+=M&(1<<T.extra)-1,M>>>=T.extra,L-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){z.msg="invalid distance too far back",T.mode=30;break}T.mode=25;case 25:if(ut===0)break t;if(nt=rt-ut,T.offset>nt){if((nt=T.offset-nt)>T.whave&&T.sane){z.msg="invalid distance too far back",T.mode=30;break}_t=nt>T.wnext?(nt-=T.wnext,T.wsize-nt):T.wnext-nt,nt>T.length&&(nt=T.length),xt=T.window}else xt=H,_t=X-T.offset,nt=T.length;for(ut<nt&&(nt=ut),ut-=nt,T.length-=nt;H[X++]=xt[_t++],--nt;);T.length===0&&(T.mode=21);break;case 26:if(ut===0)break t;H[X++]=T.length,ut--,T.mode=21;break;case 27:if(T.wrap){for(;L<32;){if(q===0)break t;q--,M|=lt[D++]<<L,L+=8}if(rt-=ut,z.total_out+=rt,T.total+=rt,rt&&(z.adler=T.check=T.flags?u(T.check,H,rt,X-rt):o(T.check,H,rt,X-rt)),rt=ut,(T.flags?M:A(M))!==T.check){z.msg="incorrect data check",T.mode=30;break}L=M=0}T.mode=28;case 28:if(T.wrap&&T.flags){for(;L<32;){if(q===0)break t;q--,M+=lt[D++]<<L,L+=8}if(M!==(4294967295&T.total)){z.msg="incorrect length check",T.mode=30;break}L=M=0}T.mode=29;case 29:dt=1;break t;case 30:dt=-3;break t;case 31:return-4;default:return x}return z.next_out=X,z.avail_out=ut,z.next_in=D,z.avail_in=q,T.hold=M,T.bits=L,(T.wsize||rt!==z.avail_out&&T.mode<30&&(T.mode<27||Q!==4))&&gt(z,z.output,z.next_out,rt-z.avail_out)?(T.mode=31,-4):(J-=z.avail_in,rt-=z.avail_out,z.total_in+=J,z.total_out+=rt,T.total+=rt,T.wrap&&rt&&(z.adler=T.check=T.flags?u(T.check,H,rt,z.next_out-rt):o(T.check,H,rt,z.next_out-rt)),z.data_type=T.bits+(T.last?64:0)+(T.mode===12?128:0)+(T.mode===20||T.mode===15?256:0),(J==0&&rt===0||Q===4)&&dt===v&&(dt=-5),dt)},r.inflateEnd=function(z){if(!z||!z.state)return x;var Q=z.state;return Q.window&&(Q.window=null),z.state=null,v},r.inflateGetHeader=function(z,Q){var T;return z&&z.state?(2&(T=z.state).wrap)==0?x:((T.head=Q).done=!1,v):x},r.inflateSetDictionary=function(z,Q){var T,lt=Q.length;return z&&z.state?(T=z.state).wrap!==0&&T.mode!==11?x:T.mode===11&&o(1,Q,lt,0)!==T.check?-3:gt(z,Q,lt,lt)?(T.mode=31,-4):(T.havedict=1,v):x},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,n,r){var l=s("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(g,b,v,x,_,w,S,A){var E,N,R,O,G,I,P,Y,W,gt=A.bits,z=0,Q=0,T=0,lt=0,H=0,D=0,X=0,q=0,ut=0,M=0,L=null,J=0,rt=new l.Buf16(16),nt=new l.Buf16(16),_t=null,xt=0;for(z=0;z<=15;z++)rt[z]=0;for(Q=0;Q<x;Q++)rt[b[v+Q]]++;for(H=gt,lt=15;1<=lt&&rt[lt]===0;lt--);if(lt<H&&(H=lt),lt===0)return _[w++]=20971520,_[w++]=20971520,A.bits=1,0;for(T=1;T<lt&&rt[T]===0;T++);for(H<T&&(H=T),z=q=1;z<=15;z++)if(q<<=1,(q-=rt[z])<0)return-1;if(0<q&&(g===0||lt!==1))return-1;for(nt[1]=0,z=1;z<15;z++)nt[z+1]=nt[z]+rt[z];for(Q=0;Q<x;Q++)b[v+Q]!==0&&(S[nt[b[v+Q]]++]=Q);if(I=g===0?(L=_t=S,19):g===1?(L=o,J-=257,_t=u,xt-=257,256):(L=d,_t=h,-1),z=T,G=w,X=Q=M=0,R=-1,O=(ut=1<<(D=H))-1,g===1&&852<ut||g===2&&592<ut)return 1;for(;;){for(P=z-X,W=S[Q]<I?(Y=0,S[Q]):S[Q]>I?(Y=_t[xt+S[Q]],L[J+S[Q]]):(Y=96,0),E=1<<z-X,T=N=1<<D;_[G+(M>>X)+(N-=E)]=P<<24|Y<<16|W|0,N!==0;);for(E=1<<z-1;M&E;)E>>=1;if(E!==0?(M&=E-1,M+=E):M=0,Q++,--rt[z]==0){if(z===lt)break;z=b[v+S[Q]]}if(H<z&&(M&O)!==R){for(X===0&&(X=H),G+=T,q=1<<(D=z-X);D+X<lt&&!((q-=rt[D+X])<=0);)D++,q<<=1;if(ut+=1<<D,g===1&&852<ut||g===2&&592<ut)return 1;_[R=M&O]=H<<24|D<<16|G-w|0}}return M!==0&&(_[G+M]=z-X<<24|64<<16|0),A.bits=H,0}},{"../utils/common":41}],51:[function(s,n,r){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,n,r){var l=s("../utils/common"),o=0,u=1;function d(F){for(var Z=F.length;0<=--Z;)F[Z]=0}var h=0,g=29,b=256,v=b+1+g,x=30,_=19,w=2*v+1,S=15,A=16,E=7,N=256,R=16,O=17,G=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],gt=new Array(2*(v+2));d(gt);var z=new Array(2*x);d(z);var Q=new Array(512);d(Q);var T=new Array(256);d(T);var lt=new Array(g);d(lt);var H,D,X,q=new Array(x);function ut(F,Z,mt,bt,st){this.static_tree=F,this.extra_bits=Z,this.extra_base=mt,this.elems=bt,this.max_length=st,this.has_stree=F&&F.length}function M(F,Z){this.dyn_tree=F,this.max_code=0,this.stat_desc=Z}function L(F){return F<256?Q[F]:Q[256+(F>>>7)]}function J(F,Z){F.pending_buf[F.pending++]=255&Z,F.pending_buf[F.pending++]=Z>>>8&255}function rt(F,Z,mt){F.bi_valid>A-mt?(F.bi_buf|=Z<<F.bi_valid&65535,J(F,F.bi_buf),F.bi_buf=Z>>A-F.bi_valid,F.bi_valid+=mt-A):(F.bi_buf|=Z<<F.bi_valid&65535,F.bi_valid+=mt)}function nt(F,Z,mt){rt(F,mt[2*Z],mt[2*Z+1])}function _t(F,Z){for(var mt=0;mt|=1&F,F>>>=1,mt<<=1,0<--Z;);return mt>>>1}function xt(F,Z,mt){var bt,st,yt=new Array(S+1),wt=0;for(bt=1;bt<=S;bt++)yt[bt]=wt=wt+mt[bt-1]<<1;for(st=0;st<=Z;st++){var vt=F[2*st+1];vt!==0&&(F[2*st]=_t(yt[vt]++,vt))}}function Et(F){var Z;for(Z=0;Z<v;Z++)F.dyn_ltree[2*Z]=0;for(Z=0;Z<x;Z++)F.dyn_dtree[2*Z]=0;for(Z=0;Z<_;Z++)F.bl_tree[2*Z]=0;F.dyn_ltree[2*N]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function ot(F){8<F.bi_valid?J(F,F.bi_buf):0<F.bi_valid&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function At(F,Z,mt,bt){var st=2*Z,yt=2*mt;return F[st]<F[yt]||F[st]===F[yt]&&bt[Z]<=bt[mt]}function Ot(F,Z,mt){for(var bt=F.heap[mt],st=mt<<1;st<=F.heap_len&&(st<F.heap_len&&At(Z,F.heap[st+1],F.heap[st],F.depth)&&st++,!At(Z,bt,F.heap[st],F.depth));)F.heap[mt]=F.heap[st],mt=st,st<<=1;F.heap[mt]=bt}function zt(F,Z,mt){var bt,st,yt,wt,vt=0;if(F.last_lit!==0)for(;bt=F.pending_buf[F.d_buf+2*vt]<<8|F.pending_buf[F.d_buf+2*vt+1],st=F.pending_buf[F.l_buf+vt],vt++,bt===0?nt(F,st,Z):(nt(F,(yt=T[st])+b+1,Z),(wt=I[yt])!==0&&rt(F,st-=lt[yt],wt),nt(F,yt=L(--bt),mt),(wt=P[yt])!==0&&rt(F,bt-=q[yt],wt)),vt<F.last_lit;);nt(F,N,Z)}function Ft(F,Z){var mt,bt,st,yt=Z.dyn_tree,wt=Z.stat_desc.static_tree,vt=Z.stat_desc.has_stree,Nt=Z.stat_desc.elems,se=-1;for(F.heap_len=0,F.heap_max=w,mt=0;mt<Nt;mt++)yt[2*mt]!==0?(F.heap[++F.heap_len]=se=mt,F.depth[mt]=0):yt[2*mt+1]=0;for(;F.heap_len<2;)yt[2*(st=F.heap[++F.heap_len]=se<2?++se:0)]=1,F.depth[st]=0,F.opt_len--,vt&&(F.static_len-=wt[2*st+1]);for(Z.max_code=se,mt=F.heap_len>>1;1<=mt;mt--)Ot(F,yt,mt);for(st=Nt;mt=F.heap[1],F.heap[1]=F.heap[F.heap_len--],Ot(F,yt,1),bt=F.heap[1],F.heap[--F.heap_max]=mt,F.heap[--F.heap_max]=bt,yt[2*st]=yt[2*mt]+yt[2*bt],F.depth[st]=(F.depth[mt]>=F.depth[bt]?F.depth[mt]:F.depth[bt])+1,yt[2*mt+1]=yt[2*bt+1]=st,F.heap[1]=st++,Ot(F,yt,1),2<=F.heap_len;);F.heap[--F.heap_max]=F.heap[1],(function(Vt,Je){var Ci,Es,ln,oe,Oe,Cs,me=Je.dyn_tree,Kr=Je.max_code,Wo=Je.stat_desc.static_tree,Qo=Je.stat_desc.has_stree,Ln=Je.stat_desc.extra_bits,on=Je.stat_desc.extra_base,$s=Je.stat_desc.max_length,Ts=0;for(oe=0;oe<=S;oe++)Vt.bl_count[oe]=0;for(me[2*Vt.heap[Vt.heap_max]+1]=0,Ci=Vt.heap_max+1;Ci<w;Ci++)$s<(oe=me[2*me[2*(Es=Vt.heap[Ci])+1]+1]+1)&&(oe=$s,Ts++),me[2*Es+1]=oe,Kr<Es||(Vt.bl_count[oe]++,Oe=0,on<=Es&&(Oe=Ln[Es-on]),Cs=me[2*Es],Vt.opt_len+=Cs*(oe+Oe),Qo&&(Vt.static_len+=Cs*(Wo[2*Es+1]+Oe)));if(Ts!==0){do{for(oe=$s-1;Vt.bl_count[oe]===0;)oe--;Vt.bl_count[oe]--,Vt.bl_count[oe+1]+=2,Vt.bl_count[$s]--,Ts-=2}while(0<Ts);for(oe=$s;oe!==0;oe--)for(Es=Vt.bl_count[oe];Es!==0;)Kr<(ln=Vt.heap[--Ci])||(me[2*ln+1]!==oe&&(Vt.opt_len+=(oe-me[2*ln+1])*me[2*ln],me[2*ln+1]=oe),Es--)}})(F,Z),xt(yt,se,F.bl_count)}function C(F,Z,mt){var bt,st,yt=-1,wt=Z[1],vt=0,Nt=7,se=4;for(wt===0&&(Nt=138,se=3),Z[2*(mt+1)+1]=65535,bt=0;bt<=mt;bt++)st=wt,wt=Z[2*(bt+1)+1],++vt<Nt&&st===wt||(vt<se?F.bl_tree[2*st]+=vt:st!==0?(st!==yt&&F.bl_tree[2*st]++,F.bl_tree[2*R]++):vt<=10?F.bl_tree[2*O]++:F.bl_tree[2*G]++,yt=st,se=(vt=0)===wt?(Nt=138,3):st===wt?(Nt=6,3):(Nt=7,4))}function dt(F,Z,mt){var bt,st,yt=-1,wt=Z[1],vt=0,Nt=7,se=4;for(wt===0&&(Nt=138,se=3),bt=0;bt<=mt;bt++)if(st=wt,wt=Z[2*(bt+1)+1],!(++vt<Nt&&st===wt)){if(vt<se)for(;nt(F,st,F.bl_tree),--vt!=0;);else st!==0?(st!==yt&&(nt(F,st,F.bl_tree),vt--),nt(F,R,F.bl_tree),rt(F,vt-3,2)):vt<=10?(nt(F,O,F.bl_tree),rt(F,vt-3,3)):(nt(F,G,F.bl_tree),rt(F,vt-11,7));yt=st,se=(vt=0)===wt?(Nt=138,3):st===wt?(Nt=6,3):(Nt=7,4)}}d(q);var at=!1;function U(F,Z,mt,bt){rt(F,(h<<1)+(bt?1:0),3),(function(st,yt,wt,vt){ot(st),J(st,wt),J(st,~wt),l.arraySet(st.pending_buf,st.window,yt,wt,st.pending),st.pending+=wt})(F,Z,mt)}r._tr_init=function(F){at||((function(){var Z,mt,bt,st,yt,wt=new Array(S+1);for(st=bt=0;st<g-1;st++)for(lt[st]=bt,Z=0;Z<1<<I[st];Z++)T[bt++]=st;for(T[bt-1]=st,st=yt=0;st<16;st++)for(q[st]=yt,Z=0;Z<1<<P[st];Z++)Q[yt++]=st;for(yt>>=7;st<x;st++)for(q[st]=yt<<7,Z=0;Z<1<<P[st]-7;Z++)Q[256+yt++]=st;for(mt=0;mt<=S;mt++)wt[mt]=0;for(Z=0;Z<=143;)gt[2*Z+1]=8,Z++,wt[8]++;for(;Z<=255;)gt[2*Z+1]=9,Z++,wt[9]++;for(;Z<=279;)gt[2*Z+1]=7,Z++,wt[7]++;for(;Z<=287;)gt[2*Z+1]=8,Z++,wt[8]++;for(xt(gt,v+1,wt),Z=0;Z<x;Z++)z[2*Z+1]=5,z[2*Z]=_t(Z,5);H=new ut(gt,I,b+1,v,S),D=new ut(z,P,0,x,S),X=new ut(new Array(0),Y,0,_,E)})(),at=!0),F.l_desc=new M(F.dyn_ltree,H),F.d_desc=new M(F.dyn_dtree,D),F.bl_desc=new M(F.bl_tree,X),F.bi_buf=0,F.bi_valid=0,Et(F)},r._tr_stored_block=U,r._tr_flush_block=function(F,Z,mt,bt){var st,yt,wt=0;0<F.level?(F.strm.data_type===2&&(F.strm.data_type=(function(vt){var Nt,se=4093624447;for(Nt=0;Nt<=31;Nt++,se>>>=1)if(1&se&&vt.dyn_ltree[2*Nt]!==0)return o;if(vt.dyn_ltree[18]!==0||vt.dyn_ltree[20]!==0||vt.dyn_ltree[26]!==0)return u;for(Nt=32;Nt<b;Nt++)if(vt.dyn_ltree[2*Nt]!==0)return u;return o})(F)),Ft(F,F.l_desc),Ft(F,F.d_desc),wt=(function(vt){var Nt;for(C(vt,vt.dyn_ltree,vt.l_desc.max_code),C(vt,vt.dyn_dtree,vt.d_desc.max_code),Ft(vt,vt.bl_desc),Nt=_-1;3<=Nt&&vt.bl_tree[2*W[Nt]+1]===0;Nt--);return vt.opt_len+=3*(Nt+1)+5+5+4,Nt})(F),st=F.opt_len+3+7>>>3,(yt=F.static_len+3+7>>>3)<=st&&(st=yt)):st=yt=mt+5,mt+4<=st&&Z!==-1?U(F,Z,mt,bt):F.strategy===4||yt===st?(rt(F,2+(bt?1:0),3),zt(F,gt,z)):(rt(F,4+(bt?1:0),3),(function(vt,Nt,se,Vt){var Je;for(rt(vt,Nt-257,5),rt(vt,se-1,5),rt(vt,Vt-4,4),Je=0;Je<Vt;Je++)rt(vt,vt.bl_tree[2*W[Je]+1],3);dt(vt,vt.dyn_ltree,Nt-1),dt(vt,vt.dyn_dtree,se-1)})(F,F.l_desc.max_code+1,F.d_desc.max_code+1,wt+1),zt(F,F.dyn_ltree,F.dyn_dtree)),Et(F),bt&&ot(F)},r._tr_tally=function(F,Z,mt){return F.pending_buf[F.d_buf+2*F.last_lit]=Z>>>8&255,F.pending_buf[F.d_buf+2*F.last_lit+1]=255&Z,F.pending_buf[F.l_buf+F.last_lit]=255&mt,F.last_lit++,Z===0?F.dyn_ltree[2*mt]++:(F.matches++,Z--,F.dyn_ltree[2*(T[mt]+b+1)]++,F.dyn_dtree[2*L(Z)]++),F.last_lit===F.lit_bufsize-1},r._tr_align=function(F){rt(F,2,3),nt(F,N,gt),(function(Z){Z.bi_valid===16?(J(Z,Z.bi_buf),Z.bi_buf=0,Z.bi_valid=0):8<=Z.bi_valid&&(Z.pending_buf[Z.pending++]=255&Z.bi_buf,Z.bi_buf>>=8,Z.bi_valid-=8)})(F)}},{"../utils/common":41}],53:[function(s,n,r){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,n,r){(function(l){(function(o,u){if(!o.setImmediate){var d,h,g,b,v=1,x={},_=!1,w=o.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(o);S=S&&S.setTimeout?S:o,d={}.toString.call(o.process)==="[object process]"?function(R){process.nextTick(function(){E(R)})}:(function(){if(o.postMessage&&!o.importScripts){var R=!0,O=o.onmessage;return o.onmessage=function(){R=!1},o.postMessage("","*"),o.onmessage=O,R}})()?(b="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",N,!1):o.attachEvent("onmessage",N),function(R){o.postMessage(b+R,"*")}):o.MessageChannel?((g=new MessageChannel).port1.onmessage=function(R){E(R.data)},function(R){g.port2.postMessage(R)}):w&&"onreadystatechange"in w.createElement("script")?(h=w.documentElement,function(R){var O=w.createElement("script");O.onreadystatechange=function(){E(R),O.onreadystatechange=null,h.removeChild(O),O=null},h.appendChild(O)}):function(R){setTimeout(E,0,R)},S.setImmediate=function(R){typeof R!="function"&&(R=new Function(""+R));for(var O=new Array(arguments.length-1),G=0;G<O.length;G++)O[G]=arguments[G+1];var I={callback:R,args:O};return x[v]=I,d(v),v++},S.clearImmediate=A}function A(R){delete x[R]}function E(R){if(_)setTimeout(E,0,R);else{var O=x[R];if(O){_=!0;try{(function(G){var I=G.callback,P=G.args;switch(P.length){case 0:I();break;case 1:I(P[0]);break;case 2:I(P[0],P[1]);break;case 3:I(P[0],P[1],P[2]);break;default:I.apply(u,P)}})(O)}finally{A(R),_=!1}}}}function N(R){R.source===o&&typeof R.data=="string"&&R.data.indexOf(b)===0&&E(+R.data.slice(b.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof tn<"u"?tn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(vd)),vd.exports}var Zx=$x();const Kx=Xd(Zx);async function zm(f){const t=new Blob([f.bytes],{type:"application/pdf"});v0.saveAs(t,f.name)}async function Wx(f,t){const s=new Kx;for(const r of f)s.file(r.name,r.bytes);const n=await s.generateAsync({type:"blob"});v0.saveAs(n,t)}function Mn(f){return f<1024?`${f} B`:f<1024*1024?`${(f/1024).toFixed(1)} KB`:`${(f/(1024*1024)).toFixed(1)} MB`}function us({onFilesLoaded:f,multiple:t=!1}){const[s,n]=B.useState(!1),[r,l]=B.useState(null),[o,u]=B.useState(!1),[d,h]=B.useState([]),[g,b]=B.useState(!1),[v,x]=B.useState(""),[_,w]=B.useState(null),[S,A]=B.useState(""),E=B.useRef(null),N=B.useId(),R=zd(z=>z.recentFiles),O=zd(z=>z.addToCache),G=!o&&!r&&!g,I=B.useCallback(async(z,Q)=>{u(!0),l(null);try{const T=new Uint8Array(await z.arrayBuffer());if(new TextDecoder().decode(T.slice(0,5))!=="%PDF-"){l(ja.INVALID_PDF),u(!1);return}T.length>50*1024*1024&&console.warn("Large file detected:",Mn(T.length));let H=0,D=!1;try{const{PDFDocument:q}=await jm(async()=>{const{PDFDocument:M}=await import("./index-CdgvfbeZ.js");return{PDFDocument:M}},[]);H=(await q.load(T,{password:Q,ignoreEncryption:!Q})).getPageCount()}catch(q){const ut=q instanceof Error?q.message:"";if((ut.includes("password")||ut.includes("encrypted")||ut.includes("decrypt"))&&(D=!0,!Q)){b(!0),w(T),A(z.name),u(!1);return}if(H===0)try{const{getPageCount:M}=await jm(async()=>{const{getPageCount:L}=await Promise.resolve().then(()=>iw);return{getPageCount:L}},void 0);H=await M(T)}catch{}}const X={id:crypto.randomUUID(),name:z.name,bytes:T,pageCount:H,fileSize:T.length,isEncrypted:D,password:Q};O({id:X.id,name:X.name,bytes:T,pageCount:H,cachedAt:Date.now(),isEncrypted:D}),t?h(q=>{const ut=[...q,X];return f(ut),ut}):(h([X]),f([X])),b(!1),w(null)}catch{l("Failed to process file.")}finally{u(!1)}},[t,f,O]),P=B.useCallback(z=>{const Q=Array.from(z).filter(T=>T.type==="application/pdf"||T.name.endsWith(".pdf"));if(Q.length===0){l("Please select PDF files.");return}!t&&Q.length>1?I(Q[0]):Q.forEach(T=>I(T))},[t,I]),Y=B.useCallback(z=>{z.preventDefault(),n(!1),P(z.dataTransfer.files)},[P]),W=()=>{if(_&&v){const z=new File([_],S,{type:"application/pdf"});I(z,v)}},gt=z=>{h(Q=>{const T=Q.filter(lt=>lt.id!==z);return f(T),T})};if(d.length>0&&!t){const z=d[0];return m.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-xl p-4",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(Xe,{size:20,className:"text-indigo-500 dark:text-indigo-400"}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:z.name}),m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Mn(z.fileSize),"  ",z.pageCount," page",z.pageCount!==1?"s":""]})]}),m.jsx("button",{onClick:()=>{h([]),f([])},className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Remove file",children:m.jsx(Nn,{size:16,className:"text-gray-400 dark:text-gray-500"})})]})})}return d.length>0&&t?m.jsxs("div",{className:"space-y-2",children:[d.map(z=>m.jsxs("div",{className:"flex items-center gap-3 border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:[m.jsx(Xe,{size:16,className:"text-indigo-500 dark:text-indigo-400"}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:z.name}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[z.pageCount," pages"]})]}),m.jsx("button",{onClick:()=>gt(z.id),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Remove file",children:m.jsx(Nn,{size:14,className:"text-gray-400 dark:text-gray-500"})})]},z.id)),m.jsx("label",{htmlFor:N,className:"block w-full p-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-sm text-gray-500 dark:text-gray-400 hover:border-indigo-300 dark:hover:border-indigo-700 hover:text-indigo-500 dark:hover:text-indigo-400 transition-colors text-center cursor-pointer",children:"+ Add more files"}),m.jsx("input",{id:N,ref:E,type:"file",accept:".pdf",multiple:!0,tabIndex:-1,className:"hidden",onChange:z=>z.target.files&&P(z.target.files)})]}):m.jsxs("div",{className:"space-y-4",children:[m.jsx("input",{id:N,ref:E,type:"file",accept:".pdf",multiple:t,tabIndex:-1,className:"hidden",onChange:z=>{z.target.files&&P(z.target.files),z.target.value=""}}),m.jsx("label",{htmlFor:G?N:void 0,className:`relative border-2 border-dashed rounded-xl min-h-[200px] flex flex-col items-center justify-center gap-3 p-8 transition-colors cursor-pointer ${s?"border-indigo-400 dark:border-indigo-600 bg-indigo-50 dark:bg-indigo-950":r?"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-950":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,onDragOver:z=>{z.preventDefault(),n(!0)},onDragLeave:()=>n(!1),onDrop:Y,tabIndex:0,role:"button","aria-label":"Upload PDF file",children:o?m.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 dark:border-gray-600 border-t-indigo-500 rounded-full animate-spin"}):r?m.jsxs(m.Fragment,{children:[m.jsx(h0,{size:32,className:"text-red-400"}),m.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:r}),m.jsx("button",{onClick:z=>{z.preventDefault(),l(null)},className:"text-xs text-red-500 dark:text-red-400 underline",children:"Try again"})]}):g?m.jsxs("div",{className:"text-center",onClick:z=>z.preventDefault(),children:[m.jsx(ki,{size:32,className:"text-amber-500 mx-auto mb-2"}),m.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:ja.ENCRYPTED_NEEDS_PASSWORD}),m.jsxs("div",{className:"flex gap-2 max-w-xs mx-auto",children:[m.jsx("input",{type:"password",value:v,onChange:z=>x(z.target.value),onKeyDown:z=>{z.key==="Enter"&&W()},placeholder:"Enter password",className:"flex-1 px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",autoFocus:!0}),m.jsx("button",{onClick:W,className:"px-4 py-2 bg-indigo-600 dark:bg-indigo-500 text-white text-sm rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600",children:"Unlock"})]})]}):m.jsxs(m.Fragment,{children:[m.jsx(y0,{size:32,className:"text-gray-400 dark:text-gray-500"}),m.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Drop your PDF",t?"s":""," here or ",m.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-medium",children:"click to browse"})]})]})}),R.length>0&&d.length===0&&m.jsxs("div",{children:[m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Recent files"}),m.jsx("div",{className:"flex gap-2 flex-wrap",children:R.map(z=>m.jsx("button",{onClick:()=>{const Q={id:z.id,name:z.name,bytes:z.bytes,pageCount:z.pageCount,fileSize:z.bytes.length,isEncrypted:z.isEncrypted};h([Q]),f([Q])},className:"px-3 py-1.5 text-xs bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors truncate max-w-[200px]",children:z.name},z.id))})]})]})}function Qx({pageCount:f,selectedCount:t,onSelectAll:s,onSelectEven:n,onSelectOdd:r,onInvert:l,onClear:o}){const u="px-2.5 py-1 text-xs font-medium rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors focus-ring";return m.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[m.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:[t," of ",f," selected"]}),m.jsx("button",{onClick:s,className:u,children:"All"}),m.jsx("button",{onClick:n,className:u,children:"Even"}),m.jsx("button",{onClick:r,className:u,children:"Odd"}),m.jsx("button",{onClick:l,className:u,children:"Invert"}),m.jsx("button",{onClick:o,className:u,children:"Clear"})]})}var Pr={};Pr.d=(f,t)=>{for(var s in t)Pr.o(t,s)&&!Pr.o(f,s)&&Object.defineProperty(f,s,{enumerable:!0,get:t[s]})};Pr.o=(f,t)=>Object.prototype.hasOwnProperty.call(f,t);var Pt=globalThis.pdfjsLib={};Pr.d(Pt,{AbortException:()=>sn,AnnotationEditorLayer:()=>Si,AnnotationEditorParamsType:()=>Qt,AnnotationEditorType:()=>Gt,AnnotationEditorUIManager:()=>nn,AnnotationLayer:()=>Y_,AnnotationMode:()=>Qi,ColorPicker:()=>Is,DOMSVGFactory:()=>lh,DrawLayer:()=>Ze,FeatureTest:()=>We,GlobalWorkerOptions:()=>Br,ImageKind:()=>_o,InvalidPDFException:()=>Pd,MissingPDFException:()=>Ur,OPS:()=>Vs,OutputScale:()=>Fd,PDFDataRangeTransport:()=>F0,PDFDateString:()=>w0,PDFWorker:()=>Ea,PasswordResponses:()=>s1,PermissionFlag:()=>e1,PixelsPerInch:()=>Da,RenderingCancelledException:()=>Qd,TextLayer:()=>Ke,TouchManager:()=>qo,UnexpectedResponseException:()=>To,Util:()=>Tt,VerbosityLevel:()=>Fo,XfaLayer:()=>I0,build:()=>C_,createValidAbsoluteUrl:()=>r1,fetchData:()=>Ho,getDocument:()=>y_,getFilenameFromUrl:()=>p1,getPdfFilenameFromUrl:()=>m1,getXfaPageViewport:()=>b1,isDataScheme:()=>Go,isPdfFile:()=>Jd,noContextMenu:()=>Ys,normalizeUnicode:()=>h1,setLayerDimensions:()=>Rn,shadow:()=>Xt,stopEvent:()=>Ss,version:()=>E_});const Ve=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),x0=[1,0,0,1,0,0],Ld=[.001,0,0,.001,0,0],Jx=1e7,xd=1.35,As={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Qi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},t1="pdfjs_internal_editor_",Gt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Qt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},e1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ge={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},_o={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Nr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Fo={ERRORS:0,WARNINGS:1,INFOS:5},Vs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},s1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Bo=Fo.WARNINGS;function i1(f){Number.isInteger(f)&&(Bo=f)}function n1(){return Bo}function Io(f){Bo>=Fo.INFOS&&console.log(`Info: ${f}`)}function qt(f){Bo>=Fo.WARNINGS&&console.log(`Warning: ${f}`)}function ue(f){throw new Error(f)}function Te(f,t){f||ue(t)}function a1(f){switch(f?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function r1(f,t=null,s=null){if(!f)return null;try{if(s&&typeof f=="string"&&(s.addDefaultProtocol&&f.startsWith("www.")&&f.match(/\./g)?.length>=2&&(f=`http://${f}`),s.tryConvertEncoding))try{f=d1(f)}catch{}const n=t?new URL(f,t):new URL(f);if(a1(n))return n}catch{}return null}function Xt(f,t,s,n=!1){return Object.defineProperty(f,t,{value:s,enumerable:!n,configurable:!0,writable:!1}),s}const an=(function(){function t(s,n){this.message=s,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class Lm extends an{constructor(t,s){super(t,"PasswordException"),this.code=s}}class _d extends an{constructor(t,s){super(t,"UnknownErrorException"),this.details=s}}class Pd extends an{constructor(t){super(t,"InvalidPDFException")}}class Ur extends an{constructor(t){super(t,"MissingPDFException")}}class To extends an{constructor(t,s){super(t,"UnexpectedResponseException"),this.status=s}}class l1 extends an{constructor(t){super(t,"FormatError")}}class sn extends an{constructor(t){super(t,"AbortException")}}function _0(f){(typeof f!="object"||f?.length===void 0)&&ue("Invalid argument for bytesToString");const t=f.length,s=8192;if(t<s)return String.fromCharCode.apply(null,f);const n=[];for(let r=0;r<t;r+=s){const l=Math.min(r+s,t),o=f.subarray(r,l);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function Uo(f){typeof f!="string"&&ue("Invalid argument for stringToBytes");const t=f.length,s=new Uint8Array(t);for(let n=0;n<t;++n)s[n]=f.charCodeAt(n)&255;return s}function o1(f){return String.fromCharCode(f>>24&255,f>>16&255,f>>8&255,f&255)}function Kd(f){const t=Object.create(null);for(const[s,n]of f)t[s]=n;return t}function c1(){const f=new Uint8Array(4);return f[0]=1,new Uint32Array(f.buffer,0,1)[0]===1}function u1(){try{return new Function(""),!0}catch{return!1}}class We{static get isLittleEndian(){return Xt(this,"isLittleEndian",c1())}static get isEvalSupported(){return Xt(this,"isEvalSupported",u1())}static get isOffscreenCanvasSupported(){return Xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Xt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Xt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Xt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Xt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const wd=Array.from(Array(256).keys(),f=>f.toString(16).padStart(2,"0"));class Tt{static makeHexColor(t,s,n){return`#${wd[t]}${wd[s]}${wd[n]}`}static scaleMinMax(t,s){let n;t[0]?(t[0]<0&&(n=s[0],s[0]=s[2],s[2]=n),s[0]*=t[0],s[2]*=t[0],t[3]<0&&(n=s[1],s[1]=s[3],s[3]=n),s[1]*=t[3],s[3]*=t[3]):(n=s[0],s[0]=s[1],s[1]=n,n=s[2],s[2]=s[3],s[3]=n,t[1]<0&&(n=s[1],s[1]=s[3],s[3]=n),s[1]*=t[1],s[3]*=t[1],t[2]<0&&(n=s[0],s[0]=s[2],s[2]=n),s[0]*=t[2],s[2]*=t[2]),s[0]+=t[4],s[1]+=t[5],s[2]+=t[4],s[3]+=t[5]}static transform(t,s){return[t[0]*s[0]+t[2]*s[1],t[1]*s[0]+t[3]*s[1],t[0]*s[2]+t[2]*s[3],t[1]*s[2]+t[3]*s[3],t[0]*s[4]+t[2]*s[5]+t[4],t[1]*s[4]+t[3]*s[5]+t[5]]}static applyTransform(t,s){const n=t[0]*s[0]+t[1]*s[2]+s[4],r=t[0]*s[1]+t[1]*s[3]+s[5];return[n,r]}static applyInverseTransform(t,s){const n=s[0]*s[3]-s[1]*s[2],r=(t[0]*s[3]-t[1]*s[2]+s[2]*s[5]-s[4]*s[3])/n,l=(-t[0]*s[1]+t[1]*s[0]+s[4]*s[1]-s[5]*s[0])/n;return[r,l]}static getAxialAlignedBoundingBox(t,s){const n=this.applyTransform(t,s),r=this.applyTransform(t.slice(2,4),s),l=this.applyTransform([t[0],t[3]],s),o=this.applyTransform([t[2],t[1]],s);return[Math.min(n[0],r[0],l[0],o[0]),Math.min(n[1],r[1],l[1],o[1]),Math.max(n[0],r[0],l[0],o[0]),Math.max(n[1],r[1],l[1],o[1])]}static inverseTransform(t){const s=t[0]*t[3]-t[1]*t[2];return[t[3]/s,-t[1]/s,-t[2]/s,t[0]/s,(t[2]*t[5]-t[4]*t[3])/s,(t[4]*t[1]-t[5]*t[0])/s]}static singularValueDecompose2dScale(t){const s=[t[0],t[2],t[1],t[3]],n=t[0]*s[0]+t[1]*s[2],r=t[0]*s[1]+t[1]*s[3],l=t[2]*s[0]+t[3]*s[2],o=t[2]*s[1]+t[3]*s[3],u=(n+o)/2,d=Math.sqrt((n+o)**2-4*(n*o-l*r))/2,h=u+d||1,g=u-d||1;return[Math.sqrt(h),Math.sqrt(g)]}static normalizeRect(t){const s=t.slice(0);return t[0]>t[2]&&(s[0]=t[2],s[2]=t[0]),t[1]>t[3]&&(s[1]=t[3],s[3]=t[1]),s}static intersect(t,s){const n=Math.max(Math.min(t[0],t[2]),Math.min(s[0],s[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(s[0],s[2]));if(n>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(s[1],s[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(s[1],s[3]));return l>o?null:[n,l,r,o]}static#t(t,s,n,r,l,o,u,d,h,g){if(h<=0||h>=1)return;const b=1-h,v=h*h,x=v*h,_=b*(b*(b*t+3*h*s)+3*v*n)+x*r,w=b*(b*(b*l+3*h*o)+3*v*u)+x*d;g[0]=Math.min(g[0],_),g[1]=Math.min(g[1],w),g[2]=Math.max(g[2],_),g[3]=Math.max(g[3],w)}static#e(t,s,n,r,l,o,u,d,h,g,b,v){if(Math.abs(h)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,s,n,r,l,o,u,d,-b/g,v);return}const x=g**2-4*b*h;if(x<0)return;const _=Math.sqrt(x),w=2*h;this.#t(t,s,n,r,l,o,u,d,(-g+_)/w,v),this.#t(t,s,n,r,l,o,u,d,(-g-_)/w,v)}static bezierBoundingBox(t,s,n,r,l,o,u,d,h){return h?(h[0]=Math.min(h[0],t,u),h[1]=Math.min(h[1],s,d),h[2]=Math.max(h[2],t,u),h[3]=Math.max(h[3],s,d)):h=[Math.min(t,u),Math.min(s,d),Math.max(t,u),Math.max(s,d)],this.#e(t,n,l,u,s,r,o,d,3*(-t+3*(n-l)+u),6*(t-2*n+l),3*(n-t),h),this.#e(t,n,l,u,s,r,o,d,3*(-s+3*(r-o)+d),6*(s-2*r+o),3*(r-s),h),h}}function d1(f){return decodeURIComponent(escape(f))}let Ad=null,Pm=null;function h1(f){return Ad||(Ad=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pm=new Map([["","t"]])),f.replaceAll(Ad,(t,s,n)=>s?s.normalize("NFKC"):Pm.get(n))}function f1(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const f=new Uint8Array(32);return crypto.getRandomValues(f),_0(f)}const Wd="pdfjs_internal_id_";function g1(f){return Uint8Array.prototype.toBase64?f.toBase64():btoa(_0(f))}typeof Promise.try!="function"&&(Promise.try=function(f,...t){return new Promise(s=>{s(f(...t))})});const Ai="http://www.w3.org/2000/svg";class Da{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Ho(f,t="text"){if(Or(f,document.baseURI)){const s=await fetch(f);if(!s.ok)throw new Error(s.statusText);switch(t){case"arraybuffer":return s.arrayBuffer();case"blob":return s.blob();case"json":return s.json()}return s.text()}return new Promise((s,n)=>{const r=new XMLHttpRequest;r.open("GET",f,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":s(r.response);return}s(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class Xr{constructor({viewBox:t,userUnit:s,scale:n,rotation:r,offsetX:l=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=s,this.scale=n,this.rotation=r,this.offsetX=l,this.offsetY=o,n*=s;const d=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let g,b,v,x;switch(r%=360,r<0&&(r+=360),r){case 180:g=-1,b=0,v=0,x=1;break;case 90:g=0,b=1,v=1,x=0;break;case 270:g=0,b=-1,v=-1,x=0;break;case 0:g=1,b=0,v=0,x=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,x=-x);let _,w,S,A;g===0?(_=Math.abs(h-t[1])*n+l,w=Math.abs(d-t[0])*n+o,S=(t[3]-t[1])*n,A=(t[2]-t[0])*n):(_=Math.abs(d-t[0])*n+l,w=Math.abs(h-t[1])*n+o,S=(t[2]-t[0])*n,A=(t[3]-t[1])*n),this.transform=[g*n,b*n,v*n,x*n,_-g*n*d-v*n*h,w-b*n*d-x*n*h],this.width=S,this.height=A}get rawDims(){const{userUnit:t,viewBox:s}=this,n=s.map(r=>r*t);return Xt(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:t=this.scale,rotation:s=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new Xr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:s,offsetX:n,offsetY:r,dontFlip:l})}convertToViewportPoint(t,s){return Tt.applyTransform([t,s],this.transform)}convertToViewportRectangle(t){const s=Tt.applyTransform([t[0],t[1]],this.transform),n=Tt.applyTransform([t[2],t[3]],this.transform);return[s[0],s[1],n[0],n[1]]}convertToPdfPoint(t,s){return Tt.applyInverseTransform([t,s],this.transform)}}class Qd extends an{constructor(t,s=0){super(t,"RenderingCancelledException"),this.extraDelay=s}}function Go(f){const t=f.length;let s=0;for(;s<t&&f[s].trim()==="";)s++;return f.substring(s,s+5).toLowerCase()==="data:"}function Jd(f){return typeof f=="string"&&/\.pdf$/i.test(f)}function p1(f){return[f]=f.split(/[#?]/,1),f.substring(f.lastIndexOf("/")+1)}function m1(f,t="document.pdf"){if(typeof f!="string")return t;if(Go(f))return qt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=s.exec(f);let l=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(l&&(l=l[0],l.includes("%")))try{l=n.exec(decodeURIComponent(l))[0]}catch{}return l||t}class Fm{started=Object.create(null);times=[];time(t){t in this.started&&qt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||qt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let s=0;for(const{name:n}of this.times)s=Math.max(n.length,s);for(const{name:n,start:r,end:l}of this.times)t.push(`${n.padEnd(s)} ${l-r}ms
`);return t.join("")}}function Or(f,t){try{const{protocol:s}=t?new URL(f,t):new URL(f);return s==="http:"||s==="https:"}catch{return!1}}function Ys(f){f.preventDefault()}function Ss(f){f.preventDefault(),f.stopPropagation()}class w0{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const s=this.#t.exec(t);if(!s)return null;const n=parseInt(s[1],10);let r=parseInt(s[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(s[3],10);l=l>=1&&l<=31?l:1;let o=parseInt(s[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(s[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(s[6],10);d=d>=0&&d<=59?d:0;const h=s[7]||"Z";let g=parseInt(s[8],10);g=g>=0&&g<=23?g:0;let b=parseInt(s[9],10)||0;return b=b>=0&&b<=59?b:0,h==="-"?(o+=g,u+=b):h==="+"&&(o-=g,u-=b),new Date(Date.UTC(n,r,l,o,u,d))}}function b1(f,{scale:t=1,rotation:s=0}){const{width:n,height:r}=f.attributes.style,l=[0,0,parseInt(n),parseInt(r)];return new Xr({viewBox:l,userUnit:1,scale:t,rotation:s})}function th(f){if(f.startsWith("#")){const t=parseInt(f.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return f.startsWith("rgb(")?f.slice(4,-1).split(",").map(t=>parseInt(t)):f.startsWith("rgba(")?f.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(qt(`Not a valid color format: "${f}"`),[0,0,0])}function y1(f){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const s of f.keys()){t.style.color=s;const n=window.getComputedStyle(t).color;f.set(s,th(n))}t.remove()}function pe(f){const{a:t,b:s,c:n,d:r,e:l,f:o}=f.getTransform();return[t,s,n,r,l,o]}function Js(f){const{a:t,b:s,c:n,d:r,e:l,f:o}=f.getTransform().invertSelf();return[t,s,n,r,l,o]}function Rn(f,t,s=!1,n=!0){if(t instanceof Xr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:o}=f,u=We.isCSSRoundSupported,d=`var(--scale-factor) * ${r}px`,h=`var(--scale-factor) * ${l}px`,g=u?`round(down, ${d}, var(--scale-round-x, 1px))`:`calc(${d})`,b=u?`round(down, ${h}, var(--scale-round-y, 1px))`:`calc(${h})`;!s||t.rotation%180===0?(o.width=g,o.height=b):(o.width=b,o.height=g)}n&&f.setAttribute("data-main-rotation",t.rotation)}class Fd{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Fr{#t=null;#e=null;#s;#i=null;#a=null;static#n=null;constructor(t){this.#s=t,Fr.#n||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const s=this.#s._uiManager._signal;t.addEventListener("contextmenu",Ys,{signal:s}),t.addEventListener("pointerdown",Fr.#o,{signal:s});const n=this.#i=document.createElement("div");n.className="buttons",t.append(n);const r=this.#s.toolbarPosition;if(r){const{style:l}=t,o=this.#s._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*o}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),t}get div(){return this.#t}static#o(t){t.stopPropagation()}#l(t){this.#s._focusEventsAllowed=!1,Ss(t)}#u(t){this.#s._focusEventsAllowed=!0,Ss(t)}#c(t){const s=this.#s._uiManager._signal;t.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:s}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:s}),t.addEventListener("contextmenu",Ys,{signal:s})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown()}#h(){const{editorType:t,_uiManager:s}=this.#s,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Fr.#n[t]),this.#c(n),n.addEventListener("click",r=>{s.delete()},{signal:s._signal}),this.#i.append(n)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const s=await t.render();this.#c(s),this.#i.prepend(s,this.#d),this.#a=t}addColorPicker(t){this.#e=t;const s=t.renderButton();this.#c(s),this.#i.prepend(s,this.#d)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class v1{#t=null;#e=null;#s;constructor(t){this.#s=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ys,{signal:this.#s._signal});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n(),t}#a(t,s){let n=0,r=0;for(const l of t){const o=l.y+l.height;if(o<n)continue;const u=l.x+(s?l.width:0);if(o>n){r=u,n=o;continue}s?u>r&&(r=u):u<r&&(r=u)}return[s?1-r:r,n]}show(t,s,n){const[r,l]=this.#a(s,n),{style:o}=this.#e||=this.#i();t.append(this.#e),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const s=document.createElement("span");t.append(s),s.className="visuallyHidden",s.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#s._signal;t.addEventListener("contextmenu",Ys,{signal:n}),t.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:n}),this.#t.append(t)}}function No(f,t,s){for(const n of s)t.addEventListener(n,f[n].bind(f))}class x1{#t=0;get id(){return`${t1}${this.#t++}`}}class eh{#t=f1();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Xt(this,"_isSVGFittingCanvas",l)}async#i(t,s){this.#s||=new Map;let n=this.#s.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof s=="string"?(n.url=s,r=await Ho(s,"blob")):s instanceof File?r=n.file=s:s instanceof Blob&&(r=s),r.type==="image/svg+xml"){const l=eh._isSVGFittingCanvas,o=new FileReader,u=new Image,d=new Promise((h,g)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,h()},o.onload=async()=>{const b=n.svgUrl=o.result;u.src=await l?`${b}#svgView(preserveAspectRatio(none))`:b},u.onerror=o.onerror=g});o.readAsDataURL(r),await d}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){qt(r),n=null}return this.#s.set(t,n),n&&this.#s.set(n.id,n),n}async getFromFile(t){const{lastModified:s,name:n,size:r,type:l}=t;return this.#i(`${s}_${n}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,s){const n=await s;return this.#i(t,n)}async getFromId(t){this.#s||=new Map;const s=this.#s.get(t);if(!s)return null;if(s.bitmap)return s.refCounter+=1,s;if(s.file)return this.getFromFile(s.file);if(s.blobPromise){const{blobPromise:n}=s;return delete s.blobPromise,this.getFromBlob(s.id,n)}return this.getFromUrl(s.url)}getFromCanvas(t,s){this.#s||=new Map;let n=this.#s.get(t);if(n?.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(s.width,s.height);return r.getContext("2d").drawImage(s,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,n),this.#s.set(n.id,n),n}getSvgUrl(t){const s=this.#s.get(t);return s?.isSvg?s.svgUrl:null}deleteId(t){this.#s||=new Map;const s=this.#s.get(t);if(!s||(s.refCounter-=1,s.refCounter!==0))return;const{bitmap:n}=s;if(!s.url&&!s.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),s.blobPromise=r.convertToBlob()}n.close?.(),s.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class _1{#t=[];#e=!1;#s;#i=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:s,post:n,mustExec:r,type:l=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const d={cmd:t,undo:s,post:n,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(o&&this.#t[this.#i].type===l){u&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const h=this.#i+1;h===this.#s?this.#t.splice(0,1):(this.#i=h,h<this.#t.length&&this.#t.splice(h)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:s}=this.#t[this.#i];t(),s?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:s}=this.#t[this.#i];t(),s?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let s=this.#i;s>=0;s--)if(this.#t[s].type!==t){this.#t.splice(s+1,this.#i-s),this.#i=s;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Yr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:s}=We.platform;for(const[n,r,l={}]of t)for(const o of n){const u=o.startsWith("mac+");s&&u?(this.callbacks.set(o.slice(4),{callback:r,options:l}),this.allKeys.add(o.split("+").at(-1))):!s&&!u&&(this.callbacks.set(o,{callback:r,options:l}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const s=this.buffer.join("+");return this.buffer.length=0,s}exec(t,s){if(!this.allKeys.has(s.key))return;const n=this.callbacks.get(this.#t(s));if(!n)return;const{callback:r,options:{bubbles:l=!1,args:o=[],checker:u=null}}=n;u&&!u(t,s)||(r.bind(t,...o,s)(),l||Ss(s))}}class sh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return y1(t),Xt(this,"_colors",t)}convert(t){const s=th(t);if(!window.matchMedia("(forced-colors: active)").matches)return s;for(const[n,r]of this._colors)if(r.every((l,o)=>l===s[o]))return sh._colorsMapping.get(n);return s}getHexCode(t){const s=this._colors.get(t);return s?Tt.makeHexColor(...s):t}}class nn{#t=new AbortController;#e=null;#s=new Map;#i=new Map;#a=null;#n=null;#o=null;#l=new _1;#u=null;#c=null;#h=0;#d=new Set;#f=null;#r=null;#g=new Set;_editorUndoBar=null;#m=!1;#p=!1;#b=!1;#x=null;#y=null;#_=null;#A=null;#k=!1;#C=null;#N=new x1;#w=!1;#T=!1;#E=null;#R=null;#O=null;#L=null;#S=Gt.NONE;#v=new Set;#D=null;#U=null;#H=null;#G={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#P=[0,0];#z=null;#F=null;#q=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=nn.prototype,s=o=>o.#F.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return Xt(this,"_keyboardManager",new Yr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#F.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#F.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:s}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:s}]]))}constructor(t,s,n,r,l,o,u,d,h,g,b,v,x){const _=this._signal=this.#t.signal;this.#F=t,this.#q=s,this.#a=n,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:_}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),r._on("setpreference",this.onSetPreference.bind(this),{signal:_}),r._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:_}),this.#et(),this.#at(),this.#$(),this.#n=l.annotationStorage,this.#x=l.filterFactory,this.#U=o,this.#A=u||null,this.#m=d,this.#p=h,this.#b=g,this.#L=b||null,this.viewParameters={realScale:Da.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=x!==!1}destroy(){this.#j?.resolve(),this.#j=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#s.clear(),this.#g.clear(),this.#e=null,this.#v.clear(),this.#l.destroy(),this.#a?.destroy(),this.#C?.hide(),this.#C=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#L}get useNewAltTextFlow(){return this.#p}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return Xt(this,"hcmFilter",this.#U?this.#x.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return Xt(this,"direction",getComputedStyle(this.#F).direction)}get highlightColors(){return Xt(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(t=>t.split("=").map(s=>s.trim()))):null)}get highlightColorNames(){return Xt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#O=t}editAltText(t,s=!1){this.#a?.editAltText(this,t,s)}switchToMode(t,s){this._eventBus.on("annotationeditormodechanged",s,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,s){this._eventBus.dispatch("setpreference",{source:this,name:t,value:s})}onSetPreference({name:t,value:s}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=s)}onPageChanging({pageNumber:t}){this.#h=t-1}focusMainContainer(){this.#F.focus()}findParent(t,s){for(const n of this.#i.values()){const{x:r,y:l,width:o,height:u}=n.div.getBoundingClientRect();if(t>=r&&t<=r+o&&s>=l&&s<=l+u)return n}return null}disableUserSelect(t=!1){this.#q.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Da.PDF_TO_CSS_UNITS;for(const s of this.#g)s.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#B({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#Y(t){const{currentLayer:s}=this;if(s.hasTextLayer(t))return s;for(const n of this.#i.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t=""){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:l,focusOffset:o}=s,u=s.toString(),h=this.#B(s).closest(".textLayer"),g=this.getSelectionBoxes(h);if(!g)return;s.empty();const b=this.#Y(h),v=this.#S===Gt.NONE,x=()=>{b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:g,anchorNode:n,anchorOffset:r,focusNode:l,focusOffset:o,text:u}),v&&this.showAllEditors("highlight",!0,!0)};if(v){this.switchToMode(Gt.HIGHLIGHT,x);return}x()}#J(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#B(t).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(this.#C||=new v1(this),this.#C.show(n,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#n&&!this.#n.has(t.id)&&this.#n.setValue(t.id,t)}#tt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#D&&(this.#C?.hide(),this.#D=null,this.#M({hasSelectedText:!1}));return}const{anchorNode:s}=t;if(s===this.#D)return;const r=this.#B(t).closest(".textLayer");if(!r){this.#D&&(this.#C?.hide(),this.#D=null,this.#M({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#D=s,this.#M({hasSelectedText:!0}),!(this.#S!==Gt.HIGHLIGHT&&this.#S!==Gt.NONE)&&(this.#S===Gt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#k=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#S===Gt.HIGHLIGHT?this.#Y(r):null;l?.toggleDrawing();const o=new AbortController,u=this.combinedSignal(o),d=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),l?.toggleDrawing(!0),h.type==="pointerup"&&this.#X("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}}#X(t=""){this.#S===Gt.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#J()}#et(){document.addEventListener("selectionchange",this.#tt.bind(this),{signal:this._signal})}#st(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#it(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#k&&(this.#k=!1,this.#X("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const s of this.#v)if(s.div.contains(t)){this.#R=[s,t],s._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[t,s]=this.#R;this.#R=null,s.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),s.focus()}#$(){if(this.#E)return;this.#E=new AbortController;const t=this.combinedSignal(this.#E);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#nt(){this.#E?.abort(),this.#E=null}#Z(){if(this.#u)return;this.#u=new AbortController;const t=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#K(){this.#u?.abort(),this.#u=null}#at(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#$(),this.#Z()}removeEditListeners(){this.#nt(),this.#K()}dragOver(t){for(const{type:s}of t.dataTransfer.items)for(const n of this.#r)if(n.isHandlingMimeForPasting(s)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const s of t.dataTransfer.items)for(const n of this.#r)if(n.isHandlingMimeForPasting(s.type)){n.paste(s,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const s=[];for(const n of this.#v){const r=n.serialize(!0);r&&s.push(r)}s.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(s))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:s}=t;for(const l of s.items)for(const o of this.#r)if(o.isHandlingMimeForPasting(l.type)){o.paste(l,this.currentLayer);return}let n=s.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(l){qt(`paste: "${l.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const d of n){const h=await r.deserialize(d);if(!h)return;l.push(h)}const o=()=>{for(const d of l)this.#W(d);this.#Q(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(l){qt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==Gt.NONE&&!this.isEditorHandlingKeyboard&&nn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#k&&(this.#k=!1,this.#X("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#M(t){Object.entries(t).some(([n,r])=>this.#G[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#G,t)}),this.#S===Gt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#I([[Qt.HIGHLIGHT_FREE,!0]]))}#I(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#st(),this.#Z(),this.#M({isEditing:this.#S!==Gt.NONE,isEmpty:this.#V(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#it(),this.#K(),this.#M({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#r){this.#r=t;for(const s of this.#r)this.#I(s.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#i.get(this.#h)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#h}addLayer(t){this.#i.set(t.pageIndex,t),this.#w?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}async updateMode(t,s=null,n=!1){if(this.#S!==t&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#S=t,t===Gt.NONE){this.setEditingState(!1),this.#lt(),this._editorUndoBar?.hide(),this.#j.resolve();return}this.setEditingState(!0),await this.#rt(),this.unselectAll();for(const r of this.#i.values())r.updateMode(t);if(!s){n&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const r of this.#s.values())r.annotationElementId===s?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,s){if(this.#r){switch(t){case Qt.CREATE:this.currentLayer.addNewEditor();return;case Qt.HIGHLIGHT_DEFAULT_COLOR:this.#O?.updateColor(s);break;case Qt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#H||=new Map).set(t,s),this.showAllEditors("highlight",s);break}for(const n of this.#v)n.updateParams(t,s);for(const n of this.#r)n.updateDefaultParams(t,s)}}showAllEditors(t,s,n=!1){for(const l of this.#s.values())l.editorType===t&&l.show(s);(this.#H?.get(Qt.HIGHLIGHT_SHOW_ALL)??!0)!==s&&this.#I([[Qt.HIGHLIGHT_SHOW_ALL,s]])}enableWaiting(t=!1){if(this.#T!==t){this.#T=t;for(const s of this.#i.values())t?s.disableClick():s.enableClick(),s.div.classList.toggle("waiting",t)}}async#rt(){if(!this.#w){this.#w=!0;const t=[];for(const s of this.#i.values())t.push(s.enable());await Promise.all(t);for(const s of this.#s.values())s.enable()}}#lt(){if(this.unselectAll(),this.#w){this.#w=!1;for(const t of this.#i.values())t.disable();for(const t of this.#s.values())t.disable()}}getEditors(t){const s=[];for(const n of this.#s.values())n.pageIndex===t&&s.push(n);return s}getEditor(t){return this.#s.get(t)}addEditor(t){this.#s.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#s.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#d.has(t.annotationElementId))&&this.#n?.remove(t.id)}addDeletedAnnotationElement(t){this.#d.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#d.has(t)}removeDeletedAnnotationElement(t){this.#d.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#W(t){const s=this.#i.get(t.pageIndex);s?s.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#I(t.propertiesToUpdate))}get#ot(){let t=null;for(t of this.#v);return t}updateUI(t){this.#ot===t&&this.#I(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#I(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#v.has(t)){this.#v.delete(t),t.unselect(),this.#M({hasSelectedEditor:this.hasSelection});return}this.#v.add(t),t.select(),this.#I(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const s of this.#v)s!==t&&s.unselect();this.#v.clear(),this.#v.add(t),t.select(),this.#I(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}isSelected(t){return this.#v.has(t)}get firstSelectedEditor(){return this.#v.values().next().value}unselect(t){t.unselect(),this.#v.delete(t),this.#M({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#v.size!==0}get isEnterHandled(){return this.#v.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#M({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#V()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#V()})}addCommands(t){this.#l.add(t),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#V()})}cleanUndoStack(t){this.#l.cleanType(t)}#V(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const t of this.#s.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const s=t?[t]:[...this.#v],n=()=>{this._editorUndoBar?.show(r,s.length===1?s[0].editorType:s.length);for(const l of s)l.remove()},r=()=>{for(const l of s)this.#W(l)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#Q(t){for(const s of this.#v)s.unselect();this.#v.clear();for(const s of t)s.isEmpty()||(this.#v.add(s),s.select());this.#M({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#v)t.commit();this.#Q(this.#s.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#S!==Gt.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#v)t.unselect();this.#v.clear(),this.#M({hasSelectedEditor:!1})}}translateSelectedEditors(t,s,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#P[0]+=t,this.#P[1]+=s;const[r,l]=this.#P,o=[...this.#v],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#P[0]=this.#P[1]=0,this.addCommands({cmd:()=>{for(const d of o)this.#s.has(d.id)&&d.translateInPage(r,l)},undo:()=>{for(const d of o)this.#s.has(d.id)&&d.translateInPage(-r,-l)},mustExec:!1})},u);for(const d of o)d.translateInPage(t,s)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const t of this.#v)this.#f.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const t=this.#f;this.#f=null;let s=!1;for(const[{x:r,y:l,pageIndex:o},u]of t)u.newX=r,u.newY=l,u.newPageIndex=o,s||=r!==u.savedX||l!==u.savedY||o!==u.savedPageIndex;if(!s)return!1;const n=(r,l,o,u)=>{if(this.#s.has(r.id)){const d=this.#i.get(u);d?r._setParentAndPosition(d,l,o):(r.pageIndex=u,r.x=l,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:o,newPageIndex:u}]of t)n(r,l,o,u)},undo:()=>{for(const[r,{savedX:l,savedY:o,savedPageIndex:u}]of t)n(r,l,o,u)},mustExec:!0}),!0}dragSelectedEditors(t,s){if(this.#f)for(const n of this.#f.keys())n.drag(t,s)}rebuild(t){if(t.parent===null){const s=this.getLayer(t.pageIndex);s?(s.changeParent(t),s.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#v.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#S}get imageManager(){return Xt(this,"imageManager",new eh)}getSelectionBoxes(t){if(!t)return null;const s=document.getSelection();for(let h=0,g=s.rangeCount;h<g;h++)if(!t.contains(s.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:r,width:l,height:o}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(h,g,b,v)=>({x:(g-r)/o,y:1-(h+b-n)/l,width:v/o,height:b/l});break;case"180":u=(h,g,b,v)=>({x:1-(h+b-n)/l,y:1-(g+v-r)/o,width:b/l,height:v/o});break;case"270":u=(h,g,b,v)=>({x:1-(g+v-r)/o,y:(h-n)/l,width:v/o,height:b/l});break;default:u=(h,g,b,v)=>({x:(h-n)/l,y:(g-r)/o,width:b/l,height:v/o});break}const d=[];for(let h=0,g=s.rangeCount;h<g;h++){const b=s.getRangeAt(h);if(!b.collapsed)for(const{x:v,y:x,width:_,height:w}of b.getClientRects())_===0||w===0||d.push(u(v,x,_,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:s}){(this.#o||=new Map).set(t,s)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const s=this.#o?.get(t.data.id);if(!s)return;const n=this.#n.getRawValue(s);n&&(this.#S===Gt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}}class ei{#t=null;#e=!1;#s=null;#i=null;#a=null;#n=null;#o=!1;#l=null;#u=null;#c=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(t){this.#u=t,this.#d=t._uiManager.useNewAltTextFlow,ei.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ei._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const s=this.#i=document.createElement("span");t.append(s),this.#d?(t.classList.add("new"),t.setAttribute("data-l10n-id",ei.#f.missing),s.setAttribute("data-l10n-id",ei.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#u._uiManager._signal;t.addEventListener("contextmenu",Ys,{signal:n}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:n});const r=l=>{l.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#d&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#r}})};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#o=!0,r(l))},{signal:n}),await this.#g(),t}get#r(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#o}),this.#o=!1)}isEmpty(){return this.#d?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#d?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#h=await ei._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#d||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const s=this.#l=document.createElement("div");s.className="noAltTextBadge",this.#u.div.append(s)}this.#l.classList.toggle("hidden",!t)}serialize(t){let s=this.#t;return!t&&this.#c===s&&(s=this.#h),{altText:s,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:s,guessedText:n,textWithDisclaimer:r,cancel:l=!1}){n&&(this.#c=n,this.#h=r),!(this.#t===t&&this.#e===s)&&(l||(this.#t=t,this.#e=s),this.#g())}toggle(t=!1){this.#s&&(!t&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#s.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#r}})}destroy(){this.#s?.remove(),this.#s=null,this.#i=null,this.#a=null,this.#l?.remove(),this.#l=null}async#g(){const t=this.#s;if(!t)return;if(this.#d){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ei.#f[this.#r]),this.#i?.setAttribute("data-l10n-id",ei.#f[`${this.#r}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let s=this.#a;if(!s){this.#a=s=document.createElement("span"),s.className="tooltip",s.setAttribute("role","tooltip"),s.id=`alt-text-tooltip-${this.#u.id}`;const r=100,l=this.#u._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#a.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#a?.classList.remove("show")},{signal:l})}this.#e?s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(s.removeAttribute("data-l10n-id"),s.textContent=this.#t),s.parentNode||t.append(s),this.#u.getImageForAltText()?.setAttribute("aria-describedby",s.id)}}class qo{#t;#e=!1;#s=null;#i;#a;#n;#o;#l;#u=null;#c;#h=null;constructor({container:t,isPinchingDisabled:s=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:o=null,signal:u}){this.#t=t,this.#s=n,this.#i=s,this.#a=r,this.#n=l,this.#o=o,this.#c=new AbortController,this.#l=AbortSignal.any([u,this.#c.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Xt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#d(t){if(this.#i?.()||t.touches.length<2)return;if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#l,this.#h.signal]),l=this.#t,o={signal:r,passive:!1};l.addEventListener("touchmove",this.#f.bind(this),o),l.addEventListener("touchend",this.#r.bind(this),o),l.addEventListener("touchcancel",this.#r.bind(this),o),this.#a?.()}if(Ss(t),t.touches.length!==2||this.#s?.()){this.#u=null;return}let[s,n]=t.touches;s.identifier>n.identifier&&([s,n]=[n,s]),this.#u={touch0X:s.screenX,touch0Y:s.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#f(t){if(!this.#u||t.touches.length!==2)return;let[s,n]=t.touches;s.identifier>n.identifier&&([s,n]=[n,s]);const{screenX:r,screenY:l}=s,{screenX:o,screenY:u}=n,d=this.#u,{touch0X:h,touch0Y:g,touch1X:b,touch1Y:v}=d,x=b-h,_=v-g,w=o-r,S=u-l,A=Math.hypot(w,S)||1,E=Math.hypot(x,_)||1;if(!this.#e&&Math.abs(E-A)<=qo.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=r,d.touch0Y=l,d.touch1X=o,d.touch1Y=u,t.preventDefault(),!this.#e){this.#e=!0;return}const N=[(r+o)/2,(l+u)/2];this.#n?.(N,E,A)}#r(t){this.#h.abort(),this.#h=null,this.#o?.(),this.#u&&(t.preventDefault(),this.#u=null,this.#e=!1)}destroy(){this.#c?.abort(),this.#c=null}}class Dt{#t=null;#e=null;#s=null;#i=!1;#a=null;#n="";#o=!1;#l=null;#u=null;#c=null;#h=null;#d="";#f=!1;#r=null;#g=!1;#m=!1;#p=!1;#b=null;#x=0;#y=0;#_=null;#A=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#k=!1;#C=Dt._zIndex++;static _borderLineWidth=-1;static _colorManager=new sh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Dt.prototype._resizeWithKeyboard,s=nn.TRANSLATE_SMALL,n=nn.TRANSLATE_BIG;return Xt(this,"_resizerKeyboardManager",new Yr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-s,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[s,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-s]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,s]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Dt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:s,rawDims:{pageWidth:n,pageHeight:r,pageX:l,pageY:o}}=this.parent.viewport;this.rotation=s,this.pageRotation=(360+s-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[l,o];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Xt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const s=new w1({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});s.annotationElementId=t.annotationElementId,s.deleted=!0,s._uiManager.addToAnnotationStorage(s)}static initialize(t,s){if(Dt._l10n??=t,Dt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Dt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Dt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,s){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,s){ue("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#k}set _isDraggable(t){this.#k=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,s]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*s/(t*2),this.y+=this.width*t/(s*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*s/(t*2),this.y-=this.width*t/(s*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#B(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,s,n,r){const[l,o]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(t+n)/l,this.y=(s+r)/o,this.fixAndSetPosition()}#N([t,s],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/t,this.y+=r/s,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,s){this.#N(this.parentDimensions,t,s)}translateInPage(t,s){this.#r||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,s),this.div.scrollIntoView({block:"nearest"})}drag(t,s){this.#r||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=s/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[d,h]=this.getBaseTranslation();o+=d,u+=h;const{style:g}=n;g.left=`${(100*o).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,s){}_onTranslated(t,s){}get _hasBeenMoved(){return!!this.#r&&(this.#r[0]!==this.x||this.#r[1]!==this.y)}get _hasBeenResized(){return!!this.#r&&(this.#r[2]!==this.width||this.#r[3]!==this.height)}getBaseTranslation(){const[t,s]=this.parentDimensions,{_borderLineWidth:n}=Dt,r=n/t,l=n/s;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:s},pageDimensions:[n,r]}=this;let{x:l,y:o,width:u,height:d}=this;if(u*=n,d*=r,l*=n,o*=r,this._mustFixPosition)switch(t){case 0:l=Math.max(0,Math.min(n-u,l)),o=Math.max(0,Math.min(r-d,o));break;case 90:l=Math.max(0,Math.min(n-d,l)),o=Math.min(r,Math.max(u,o));break;case 180:l=Math.min(n,Math.max(u,l)),o=Math.min(r,Math.max(d,o));break;case 270:l=Math.min(n,Math.max(d,l)),o=Math.max(0,Math.min(r-u,o));break}this.x=l/=n,this.y=o/=r;const[h,g]=this.getBaseTranslation();l+=h,o+=g,s.left=`${(100*l).toFixed(2)}%`,s.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#w(t,s,n){switch(n){case 90:return[s,-t];case 180:return[-t,-s];case 270:return[-s,t];default:return[t,s]}}screenToPageTranslation(t,s){return Dt.#w(t,s,this.parentRotation)}pageTranslationToScreen(t,s){return Dt.#w(t,s,360-this.parentRotation)}#T(t){switch(t){case 90:{const[s,n]=this.pageDimensions;return[0,-s/n,n/s,0]}case 180:return[-1,0,0,-1];case 270:{const[s,n]=this.pageDimensions;return[0,s/n,-n/s,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[s,n]}=this;return[s*t,n*t]}setDims(t,s){const[n,r]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*t/n).toFixed(2)}%`,this.#o||(l.height=`${(100*s/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:s,width:n}=t,r=n.endsWith("%"),l=!this.#o&&s.endsWith("%");if(r&&l)return;const[o,u]=this.parentDimensions;r||(t.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!this.#o&&!l&&(t.height=`${(100*parseFloat(s)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#E(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],s=this._uiManager._signal;for(const n of t){const r=document.createElement("div");this.#l.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#R.bind(this,n),{signal:s}),r.addEventListener("contextmenu",Ys,{signal:s}),r.tabIndex=-1}this.div.prepend(this.#l)}#R(t,s){s.preventDefault();const{isMac:n}=We.platform;if(s.button!==0||s.ctrlKey&&n)return;this.#s?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#u=[s.screenX,s.screenY];const l=new AbortController,o=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#S.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Ss,{passive:!1,signal:o}),window.addEventListener("contextmenu",Ys,{signal:o}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(s.target).cursor;const h=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#L()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#O(t,s,n,r){this.width=n,this.height=r,this.x=t,this.y=s;const[l,o]=this.parentDimensions;this.setDims(l*n,o*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#c)return;const{savedX:t,savedY:s,savedWidth:n,savedHeight:r}=this.#c;this.#c=null;const l=this.x,o=this.y,u=this.width,d=this.height;l===t&&o===s&&u===n&&d===r||this.addCommands({cmd:this.#O.bind(this,l,o,u,d),undo:this.#O.bind(this,t,s,n,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#S(t,s){const[n,r]=this.parentDimensions,l=this.x,o=this.y,u=this.width,d=this.height,h=Dt.MIN_SIZE/n,g=Dt.MIN_SIZE/r,b=this.#T(this.rotation),v=(H,D)=>[b[0]*H+b[2]*D,b[1]*H+b[3]*D],x=this.#T(360-this.rotation),_=(H,D)=>[x[0]*H+x[2]*D,x[1]*H+x[3]*D];let w,S,A=!1,E=!1;switch(t){case"topLeft":A=!0,w=(H,D)=>[0,0],S=(H,D)=>[H,D];break;case"topMiddle":w=(H,D)=>[H/2,0],S=(H,D)=>[H/2,D];break;case"topRight":A=!0,w=(H,D)=>[H,0],S=(H,D)=>[0,D];break;case"middleRight":E=!0,w=(H,D)=>[H,D/2],S=(H,D)=>[0,D/2];break;case"bottomRight":A=!0,w=(H,D)=>[H,D],S=(H,D)=>[0,0];break;case"bottomMiddle":w=(H,D)=>[H/2,D],S=(H,D)=>[H/2,0];break;case"bottomLeft":A=!0,w=(H,D)=>[0,D],S=(H,D)=>[H,0];break;case"middleLeft":E=!0,w=(H,D)=>[0,D/2],S=(H,D)=>[H,D/2];break}const N=w(u,d),R=S(u,d);let O=v(...R);const G=Dt._round(l+O[0]),I=Dt._round(o+O[1]);let P=1,Y=1,W,gt;if(s.fromKeyboard)({deltaX:W,deltaY:gt}=s);else{const{screenX:H,screenY:D}=s,[X,q]=this.#u;[W,gt]=this.screenToPageTranslation(H-X,D-q),this.#u[0]=H,this.#u[1]=D}if([W,gt]=_(W/n,gt/r),A){const H=Math.hypot(u,d);P=Y=Math.max(Math.min(Math.hypot(R[0]-N[0]-W,R[1]-N[1]-gt)/H,1/u,1/d),h/u,g/d)}else E?P=Math.max(h,Math.min(1,Math.abs(R[0]-N[0]-W)))/u:Y=Math.max(g,Math.min(1,Math.abs(R[1]-N[1]-gt)))/d;const z=Dt._round(u*P),Q=Dt._round(d*Y);O=v(...S(z,Q));const T=G-O[0],lt=I-O[1];this.#r||=[this.x,this.y,this.width,this.height],this.width=z,this.height=Q,this.x=T,this.y=lt,this.setDims(n*z,r*Q),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new Fr(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(t){const s=this._editToolbar?.div;s?s.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(ei.initialize(Dt._l10n),this.#s=new ei(this),this.#t&&(this.#s.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#P();const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*s/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),No(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new qo({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#v.bind(this),onPinching:this.#D.bind(this),onPinchEnd:this.#U.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#v(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#D(t,s,n){let l=.7*(n/s)+1-.7;if(l===1)return;const o=this.#T(this.rotation),u=(G,I)=>[o[0]*G+o[2]*I,o[1]*G+o[3]*I],[d,h]=this.parentDimensions,g=this.x,b=this.y,v=this.width,x=this.height,_=Dt.MIN_SIZE/d,w=Dt.MIN_SIZE/h;l=Math.max(Math.min(l,1/v,1/x),_/v,w/x);const S=Dt._round(v*l),A=Dt._round(x*l);if(S===v&&A===x)return;this.#r||=[g,b,v,x];const E=u(v/2,x/2),N=Dt._round(g+E[0]),R=Dt._round(b+E[1]),O=u(S/2,A/2);this.x=N-O[0],this.y=R-O[1],this.width=S,this.height=A,this.setDims(d*S,h*A),this.fixAndSetPosition(),this._onResizing()}#U(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(t){const{isMac:s}=We.platform;if(t.button!==0||t.ctrlKey&&s){t.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#G(t);return}this.#H(t)}get isSelected(){return this._uiManager.isSelected(this)}#H(t){const{isMac:s}=We.platform;t.ctrlKey&&!s||t.shiftKey||t.metaKey&&s?this.parent.toggleSelected(this):this.parent.setSelected(this)}#G(t){const{isSelected:s}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:l},u=h=>{r.abort(),this.#a=null,this.#f=!1,this._uiManager.endDragSession()||this.#H(h),n&&this._onStopDragging()};s&&(this.#x=t.clientX,this.#y=t.clientY,this.#a=t.pointerId,this.#n=t.pointerType,window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:g,clientY:b,pointerId:v}=h;if(v!==this.#a){Ss(h);return}const[x,_]=this.screenToPageTranslation(g-this.#x,b-this.#y);this.#x=g,this.#y=b,this._uiManager.dragSelectedEditors(x,_)},o),window.addEventListener("touchmove",Ss,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#n&&(this.#A||h.isPrimary)&&u(h),Ss(h)},o));const d=h=>{if(!this.#a||this.#a===h.pointerId){u(h);return}Ss(h)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,s,n){t.changeParent(this),this.x=s,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,s,n=this.rotation){const r=this.parentScale,[l,o]=this.pageDimensions,[u,d]=this.pageTranslation,h=t/r,g=s/r,b=this.x*l,v=this.y*o,x=this.width*l,_=this.height*o;switch(n){case 0:return[b+h+u,o-v-g-_+d,b+h+x+u,o-v-g+d];case 90:return[b+g+u,o-v+h+d,b+g+_+u,o-v+h+x+d];case 180:return[b-h-x+u,o-v+g+d,b-h+u,o-v+g+_+d];case 270:return[b-g-_+u,o-v-h-x+d,b-g+u,o-v-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,s){const[n,r,l,o]=t,u=l-n,d=o-r;switch(this.rotation){case 0:return[n,s-o,u,d];case 90:return[n,s-r,d,u];case 180:return[l,s-r,u,d];case 270:return[l,s-o,d,u];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:s,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:o}=window;return s<o&&r>0&&t<l&&n>0}#P(){if(this.#h||!this.div)return;this.#h=new AbortController;const t=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#P()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,s=null){ue("An editor must be serializable")}static async deserialize(t,s,n){const r=new this.prototype.constructor({parent:s,id:s.getNextId(),uiManager:n});r.rotation=t.rotation,r.#t=t.accessibilityData;const[l,o]=r.pageDimensions,[u,d,h,g]=r.getRectInCurrentCoords(t.rect,o);return r.x=u/l,r.y=d/o,r.width=h/l,r.height=g/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#B(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#E(),this.#l.classList.remove("hidden"),No(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const s=this.#l.children;if(!this.#e){this.#e=Array.from(s);const o=this.#z.bind(this),u=this.#F.bind(this),d=this._uiManager._signal;for(const h of this.#e){const g=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:d}),h.addEventListener("blur",u,{signal:d}),h.addEventListener("focus",this.#q.bind(this,g),{signal:d}),h.setAttribute("data-l10n-id",Dt._l10nResizer[g])}}const n=this.#e[0];let r=0;for(const o of s){if(o===n)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#l.append(this.#l.firstChild);else if(l>r)for(let u=0;u<l-r;u++)this.#l.firstChild.before(this.#l.lastChild);let o=0;for(const u of s){const h=this.#e[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Dt._l10nResizer[h])}}this.#j(0),this.#p=!0,this.#l.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#z(t){Dt._resizerKeyboardManager.exec(this,t)}#F(t){this.#p&&t.relatedTarget?.parentNode!==this.#l&&this.#B()}#q(t){this.#d=this.#p?t:""}#j(t){if(this.#e)for(const s of this.#e)s.tabIndex=t}_resizeWithKeyboard(t,s){this.#p&&this.#S(this.#d,{deltaX:t,deltaY:s,fromKeyboard:!0})}#B(){this.#p=!1,this.#j(-1),this.#L()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(t,s){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,s){this.#o=!0;const n=t/s,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,s=!1){if(s){this.#_||=new Map;const{action:n}=t;let r=this.#_.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(n),this.#_.size===0&&(this.#_=null)},Dt._telemetryTimeout),this.#_.set(n,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let s=t.container.querySelector(".annotationContent");if(!s)s=document.createElement("div"),s.classList.add("annotationContent",this.editorType),t.container.prepend(s);else if(s.nodeName==="CANVAS"){const n=s;s=document.createElement("div"),s.classList.add("annotationContent",this.editorType),n.before(s)}return s}resetAnnotationElement(t){const{firstChild:s}=t.container;s?.nodeName==="DIV"&&s.classList.contains("annotationContent")&&s.remove()}}class w1 extends Dt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Bm=3285377520,Bs=4294901760,ti=65535;class A0{constructor(t){this.h1=t?t&4294967295:Bm,this.h2=t?t&4294967295:Bm}update(t){let s,n;if(typeof t=="string"){s=new Uint8Array(t.length*2),n=0;for(let w=0,S=t.length;w<S;w++){const A=t.charCodeAt(w);A<=255?s[n++]=A:(s[n++]=A>>>8,s[n++]=A&255)}}else if(ArrayBuffer.isView(t))s=t.slice(),n=s.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,l=n-r*4,o=new Uint32Array(s.buffer,0,r);let u=0,d=0,h=this.h1,g=this.h2;const b=3432918353,v=461845907,x=b&ti,_=v&ti;for(let w=0;w<r;w++)w&1?(u=o[w],u=u*b&Bs|u*x&ti,u=u<<15|u>>>17,u=u*v&Bs|u*_&ti,h^=u,h=h<<13|h>>>19,h=h*5+3864292196):(d=o[w],d=d*b&Bs|d*x&ti,d=d<<15|d>>>17,d=d*v&Bs|d*_&ti,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,l){case 3:u^=s[r*4+2]<<16;case 2:u^=s[r*4+1]<<8;case 1:u^=s[r*4],u=u*b&Bs|u*x&ti,u=u<<15|u>>>17,u=u*v&Bs|u*_&ti,r&1?h^=u:g^=u}this.h1=h,this.h2=g}hexdigest(){let t=this.h1,s=this.h2;return t^=s>>>1,t=t*3981806797&Bs|t*36045&ti,s=s*4283543511&Bs|((s<<16|t>>>16)*2950163797&Bs)>>>16,t^=s>>>1,t=t*444984403&Bs|t*60499&ti,s=s*3301882366&Bs|((s<<16|t>>>16)*3120437893&Bs)>>>16,t^=s>>>1,(t>>>0).toString(16).padStart(8,"0")+(s>>>0).toString(16).padStart(8,"0")}}const Bd=Object.freeze({map:null,hash:"",transfer:void 0});class ih{#t=!1;#e=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,s){const n=this.#s.get(t);return n===void 0?s:Object.assign(s,n)}getRawValue(t){return this.#s.get(t)}remove(t){if(this.#s.delete(t),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const s of this.#s.values())if(s instanceof Dt)return;this.onAnnotationEditor(null)}}setValue(t,s){const n=this.#s.get(t);let r=!1;if(n!==void 0)for(const[l,o]of Object.entries(s))n[l]!==o&&(r=!0,n[l]=o);else r=!0,this.#s.set(t,s);r&&this.#i(),s instanceof Dt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(s.constructor._type)}has(t){return this.#s.has(t)}getAll(){return this.#s.size>0?Kd(this.#s):null}setAll(t){for(const[s,n]of Object.entries(t))this.setValue(s,n)}get size(){return this.#s.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S0(this)}get serializable(){if(this.#s.size===0)return Bd;const t=new Map,s=new A0,n=[],r=Object.create(null);let l=!1;for(const[o,u]of this.#s){const d=u instanceof Dt?u.serialize(!1,r):u;d&&(t.set(o,d),s.update(`${o}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const o of t.values())o.bitmap&&n.push(o.bitmap);return t.size>0?{map:t,hash:s.hexdigest(),transfer:n}:Bd}get editorStats(){let t=null;const s=new Map;for(const n of this.#s.values()){if(!(n instanceof Dt))continue;const r=n.telemetryFinalData;if(!r)continue;const{type:l}=r;s.has(l)||s.set(l,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const o=t[l]||=new Map;for(const[u,d]of Object.entries(r)){if(u==="type")continue;let h=o.get(u);h||(h=new Map,o.set(u,h));const g=h.get(d)??0;h.set(d,g+1)}}for(const[n,r]of s)t[n]=r.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const s of this.#s.values())!(s instanceof Dt)||!s.annotationElementId||!s.serialize()||t.push(s.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}}class S0 extends ih{#t;constructor(t){super();const{map:s,hash:n,transfer:r}=t.serializable,l=structuredClone(s,r?{transfer:r}:null);this.#t={map:l,hash:n,transfer:r}}get print(){ue("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Xt(this,"modifiedIds",{ids:new Set,hash:""})}}class A1{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:s=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const s=this.styleElement.sheet;s.insertRule(t,s.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Te(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:l}=t,o=new FontFace(n,r,l);this.addNativeFontFace(o);try{await o.load(),this.#t.add(n),s?.(t)}catch{qt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}ue("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw qt(`Failed to load font '${n.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const s=t.createFontFaceRule();if(s){if(this.insertRule(s),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Xt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ve||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Xt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function s(){for(Te(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const l=n.shift();setTimeout(l.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:s,callback:t};return n.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Xt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,s){function n(R,O){return R.charCodeAt(O)<<24|R.charCodeAt(O+1)<<16|R.charCodeAt(O+2)<<8|R.charCodeAt(O+3)&255}function r(R,O,G,I){const P=R.substring(0,O),Y=R.substring(O+G);return P+I+Y}let l,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let h=0;function g(R,O){if(++h>30){qt("Load test font never loaded."),O();return}if(d.font="30px "+R,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,R,O))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=r(v,976,b.length,b);const _=16,w=1482184792;let S=n(v,_);for(l=0,o=b.length-3;l<o;l+=4)S=S-w+n(b,l)|0;l<b.length&&(S=S-w+n(b+"XXX",l)|0),v=r(v,_,4,o1(S));const A=`url(data:font/opentype;base64,${btoa(v)});`,E=`@font-face {font-family:"${b}";src:${A}}`;this.insertRule(E);const N=this._document.createElement("div");N.style.visibility="hidden",N.style.width=N.style.height="10px",N.style.position="absolute",N.style.top=N.style.left="0px";for(const R of[t.loadedName,b]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=R,N.append(O)}this._document.body.append(N),g(b,()=>{N.remove(),s.complete()})}}class S1{constructor(t,{disableFontFace:s=!1,fontExtraProperties:n=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const l in t)this[l]=t[l];this.disableFontFace=s===!0,this.fontExtraProperties=n===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${g1(this.data)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),s}getPathGenerator(t,s){if(this.compiledGlyphs[s]!==void 0)return this.compiledGlyphs[s];const n=this.loadedName+"_path_"+s;let r;try{r=t.get(n)}catch(o){qt(`getPathGenerator - ignoring character: "${o}".`)}const l=new Path2D(r||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[s]=l}}const go={DATA:1,ERROR:2},Ce={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Im(){}function os(f){if(f instanceof sn||f instanceof Pd||f instanceof Ur||f instanceof Lm||f instanceof To||f instanceof _d)return f;switch(f instanceof Error||typeof f=="object"&&f!==null||ue('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),f.name){case"AbortException":return new sn(f.message);case"InvalidPDFException":return new Pd(f.message);case"MissingPDFException":return new Ur(f.message);case"PasswordException":return new Lm(f.message,f.code);case"UnexpectedResponseException":return new To(f.message,f.status);case"UnknownErrorException":return new _d(f.message,f.details)}return new _d(f.message,f.toString())}class zr{#t=new AbortController;constructor(t,s,n){this.sourceName=t,this.targetName=s,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const n=t.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===go.DATA)r.resolve(t.data);else if(t.callback===go.ERROR)r.reject(os(t.reason));else throw new Error("Unexpected callback case");return}const s=this.actionHandler[t.action];if(!s)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(s,t.data).then(function(o){l.postMessage({sourceName:n,targetName:r,callback:go.DATA,callbackId:t.callbackId,data:o})},function(o){l.postMessage({sourceName:n,targetName:r,callback:go.ERROR,callbackId:t.callbackId,reason:os(o)})});return}if(t.streamId){this.#s(t);return}s(t.data)}on(t,s){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=s}send(t,s,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:s},n)}sendWithPromise(t,s,n){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:s},n)}catch(o){l.reject(o)}return l.promise}sendWithStream(t,s,n,r){const l=this.streamId++,o=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const g=Promise.withResolvers();return this.streamControllers[l]={controller:h,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:u,action:t,streamId:l,data:s,desiredSize:h.desiredSize},r),g.promise},pull:h=>{const g=Promise.withResolvers();return this.streamControllers[l].pullCall=g,d.postMessage({sourceName:o,targetName:u,stream:Ce.PULL,streamId:l,desiredSize:h.desiredSize}),g.promise},cancel:h=>{Te(h instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[l].cancelCall=g,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:o,targetName:u,stream:Ce.CANCEL,streamId:l,reason:os(h)}),g.promise}},n)}#s(t){const s=t.streamId,n=this.sourceName,r=t.sourceName,l=this.comObj,o=this,u=this.actionHandler[t.action],d={enqueue(h,g=1,b){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=g,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:n,targetName:r,stream:Ce.ENQUEUE,streamId:s,chunk:h},b)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:r,stream:Ce.CLOSE,streamId:s}),delete o.streamSinks[s])},error(h){Te(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:r,stream:Ce.ERROR,streamId:s,reason:os(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[s]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:n,targetName:r,stream:Ce.START_COMPLETE,streamId:s,success:!0})},function(h){l.postMessage({sourceName:n,targetName:r,stream:Ce.START_COMPLETE,streamId:s,reason:os(h)})})}#i(t){const s=t.streamId,n=this.sourceName,r=t.sourceName,l=this.comObj,o=this.streamControllers[s],u=this.streamSinks[s];switch(t.stream){case Ce.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(os(t.reason));break;case Ce.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(os(t.reason));break;case Ce.PULL:if(!u){l.postMessage({sourceName:n,targetName:r,stream:Ce.PULL_COMPLETE,streamId:s,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Im).then(function(){l.postMessage({sourceName:n,targetName:r,stream:Ce.PULL_COMPLETE,streamId:s,success:!0})},function(h){l.postMessage({sourceName:n,targetName:r,stream:Ce.PULL_COMPLETE,streamId:s,reason:os(h)})});break;case Ce.ENQUEUE:if(Te(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Ce.CLOSE:if(Te(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,s);break;case Ce.ERROR:Te(o,"error should have stream controller"),o.controller.error(os(t.reason)),this.#a(o,s);break;case Ce.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(os(t.reason)),this.#a(o,s);break;case Ce.CANCEL:if(!u)break;const d=os(t.reason);Promise.try(u.onCancel||Im,d).then(function(){l.postMessage({sourceName:n,targetName:r,stream:Ce.CANCEL_COMPLETE,streamId:s,success:!0})},function(h){l.postMessage({sourceName:n,targetName:r,stream:Ce.CANCEL_COMPLETE,streamId:s,reason:os(h)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[s];break;default:throw new Error("Unexpected stream case")}}async#a(t,s){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[s]}destroy(){this.#t?.abort(),this.#t=null}}class k0{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,s){if(t<=0||s<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,s);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,s,n){if(!t.canvas)throw new Error("Canvas is not specified");if(s<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=s,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,s){ue("Abstract method `_createCanvas` called.")}}class k1 extends k0{constructor({ownerDocument:t=globalThis.document,enableHWA:s=!1}){super({enableHWA:s}),this._document=t}_createCanvas(t,s){const n=this._document.createElement("canvas");return n.width=t,n.height=s,n}}class E0{constructor({baseUrl:t=null,isCompressed:s=!0}){this.baseUrl=t,this.isCompressed=s}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const s=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(s).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)})}async _fetch(t){ue("Abstract method `_fetch` called.")}}class C0 extends E0{async _fetch(t){const s=await Ho(t,this.isCompressed?"arraybuffer":"text");return s instanceof ArrayBuffer?new Uint8Array(s):Uo(s)}}class T0{addFilter(t){return"none"}addHCMFilter(t,s){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,s,n,r,l){return"none"}destroy(t=!1){}}class E1 extends T0{#t;#e;#s;#i;#a;#n;#o=0;constructor({docId:t,ownerDocument:s=globalThis.document}){super(),this.#i=t,this.#a=s}get#l(){return this.#e||=new Map}get#u(){return this.#n||=new Map}get#c(){if(!this.#s){const t=this.#a.createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const n=this.#a.createElementNS(Ai,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#s=this.#a.createElementNS(Ai,"defs"),t.append(n),n.append(this.#s),this.#a.body.append(t)}return this.#s}#h(t){if(t.length===1){const d=t[0],h=new Array(256);for(let b=0;b<256;b++)h[b]=d[b]/255;const g=h.join(",");return[g,g,g]}const[s,n,r]=t,l=new Array(256),o=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=s[d]/255,o[d]=n[d]/255,u[d]=r[d]/255;return[l.join(","),o.join(","),u.join(",")]}#d(t){if(this.#t===void 0){this.#t="";const s=this.#a.URL;s!==this.#a.baseURI&&(Go(s)?qt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=s.split("#",1)[0])}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let s=this.#l.get(t);if(s)return s;const[n,r,l]=this.#h(t),o=t.length===1?n:`${n}${r}${l}`;if(s=this.#l.get(o),s)return this.#l.set(t,s),s;const u=`g_${this.#i}_transfer_map_${this.#o++}`,d=this.#d(u);this.#l.set(t,d),this.#l.set(o,d);const h=this.#g(u);return this.#p(n,r,l,h),d}addHCMFilter(t,s){const n=`${t}-${s}`,r="base";let l=this.#u.get(r);if(l?.key===n||(l?(l.filter?.remove(),l.key=n,l.url="none",l.filter=null):(l={key:n,url:"none",filter:null},this.#u.set(r,l)),!t||!s))return l.url;const o=this.#x(t);t=Tt.makeHexColor(...o);const u=this.#x(s);if(s=Tt.makeHexColor(...u),this.#c.style.color="",t==="#000000"&&s==="#ffffff"||t===s)return l.url;const d=new Array(256);for(let x=0;x<=255;x++){const _=x/255;d[x]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=d.join(","),g=`g_${this.#i}_hcm_filter`,b=l.filter=this.#g(g);this.#p(h,h,h,b),this.#r(b);const v=(x,_)=>{const w=o[x]/255,S=u[x]/255,A=new Array(_+1);for(let E=0;E<=_;E++)A[E]=w+E/_*(S-w);return A.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),b),l.url=this.#d(g),l.url}addAlphaFilter(t){let s=this.#l.get(t);if(s)return s;const[n]=this.#h([t]),r=`alpha_${n}`;if(s=this.#l.get(r),s)return this.#l.set(t,s),s;const l=`g_${this.#i}_alpha_map_${this.#o++}`,o=this.#d(l);this.#l.set(t,o),this.#l.set(r,o);const u=this.#g(l);return this.#b(n,u),o}addLuminosityFilter(t){let s=this.#l.get(t||"luminosity");if(s)return s;let n,r;if(t?([n]=this.#h([t]),r=`luminosity_${n}`):r="luminosity",s=this.#l.get(r),s)return this.#l.set(t,s),s;const l=`g_${this.#i}_luminosity_map_${this.#o++}`,o=this.#d(l);this.#l.set(t,o),this.#l.set(r,o);const u=this.#g(l);return this.#f(u),t&&this.#b(n,u),o}addHighlightHCMFilter(t,s,n,r,l){const o=`${s}-${n}-${r}-${l}`;let u=this.#u.get(t);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#u.set(t,u)),!s||!n))return u.url;const[d,h]=[s,n].map(this.#x.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),b=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[v,x]=[r,l].map(this.#x.bind(this));b<g&&([g,b,v,x]=[b,g,x,v]),this.#c.style.color="";const _=(A,E,N)=>{const R=new Array(256),O=(b-g)/N,G=A/255,I=(E-A)/(255*N);let P=0;for(let Y=0;Y<=N;Y++){const W=Math.round(g+Y*O),gt=G+Y*I;for(let z=P;z<=W;z++)R[z]=gt;P=W+1}for(let Y=P;Y<256;Y++)R[Y]=R[P-1];return R.join(",")},w=`g_${this.#i}_hcm_${t}_filter`,S=u.filter=this.#g(w);return this.#r(S),this.#p(_(v[0],x[0],5),_(v[1],x[1],5),_(v[2],x[2],5),S),u.url=this.#d(w),u.url}destroy(t=!1){t&&this.#n?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#n?.clear(),this.#n=null,this.#o=0)}#f(t){const s=this.#a.createElementNS(Ai,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)}#r(t){const s=this.#a.createElementNS(Ai,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)}#g(t){const s=this.#a.createElementNS(Ai,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),this.#c.append(s),s}#m(t,s,n){const r=this.#a.createElementNS(Ai,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),t.append(r)}#p(t,s,n,r){const l=this.#a.createElementNS(Ai,"feComponentTransfer");r.append(l),this.#m(l,"feFuncR",t),this.#m(l,"feFuncG",s),this.#m(l,"feFuncB",n)}#b(t,s){const n=this.#a.createElementNS(Ai,"feComponentTransfer");s.append(n),this.#m(n,"feFuncA",t)}#x(t){return this.#c.style.color=t,th(getComputedStyle(this.#c).getPropertyValue("color"))}}class N0{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const s=`${this.baseUrl}${t}`;return this._fetch(s).catch(n=>{throw new Error(`Unable to load font data at: ${s}`)})}async _fetch(t){ue("Abstract method `_fetch` called.")}}class M0 extends N0{async _fetch(t){const s=await Ho(t,"arraybuffer");return new Uint8Array(s)}}Ve&&qt("Please use the `legacy` build in Node.js environments.");async function R0(f){const s=await process.getBuiltinModule("fs").promises.readFile(f);return new Uint8Array(s)}class C1 extends T0{}class T1 extends k0{_createCanvas(t,s){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,s)}}class N1 extends E0{async _fetch(t){return R0(t)}}class M1 extends N0{async _fetch(t){return R0(t)}}const qe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Id(f,t){if(!t)return;const s=t[2]-t[0],n=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],s,n),f.clip(r)}class nh{getPattern(){ue("Abstract method `getPattern` called.")}}class R1 extends nh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let s;this._type==="axial"?s=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(s=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)s.addColorStop(n[0],n[1]);return s}getPattern(t,s,n,r){let l;if(r===qe.STROKE||r===qe.FILL){const o=s.current.getClippedPathBoundingBox(r,pe(t))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,d=Math.ceil(o[3]-o[1])||1,h=s.cachedCanvases.getCanvas("pattern",u,d),g=h.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-o[0],-o[1]),n=Tt.transform(n,[1,0,0,1,o[0],o[1]]),g.transform(...s.baseTransform),this.matrix&&g.transform(...this.matrix),Id(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),l=t.createPattern(h.canvas,"no-repeat");const b=new DOMMatrix(n);l.setTransform(b)}else Id(t,this._bbox),l=this._createGradient(t);return l}}function Sd(f,t,s,n,r,l,o,u){const d=t.coords,h=t.colors,g=f.data,b=f.width*4;let v;d[s+1]>d[n+1]&&(v=s,s=n,n=v,v=l,l=o,o=v),d[n+1]>d[r+1]&&(v=n,n=r,r=v,v=o,o=u,u=v),d[s+1]>d[n+1]&&(v=s,s=n,n=v,v=l,l=o,o=v);const x=(d[s]+t.offsetX)*t.scaleX,_=(d[s+1]+t.offsetY)*t.scaleY,w=(d[n]+t.offsetX)*t.scaleX,S=(d[n+1]+t.offsetY)*t.scaleY,A=(d[r]+t.offsetX)*t.scaleX,E=(d[r+1]+t.offsetY)*t.scaleY;if(_>=E)return;const N=h[l],R=h[l+1],O=h[l+2],G=h[o],I=h[o+1],P=h[o+2],Y=h[u],W=h[u+1],gt=h[u+2],z=Math.round(_),Q=Math.round(E);let T,lt,H,D,X,q,ut,M;for(let L=z;L<=Q;L++){if(L<S){const xt=L<_?0:(_-L)/(_-S);T=x-(x-w)*xt,lt=N-(N-G)*xt,H=R-(R-I)*xt,D=O-(O-P)*xt}else{let xt;L>E?xt=1:S===E?xt=0:xt=(S-L)/(S-E),T=w-(w-A)*xt,lt=G-(G-Y)*xt,H=I-(I-W)*xt,D=P-(P-gt)*xt}let J;L<_?J=0:L>E?J=1:J=(_-L)/(_-E),X=x-(x-A)*J,q=N-(N-Y)*J,ut=R-(R-W)*J,M=O-(O-gt)*J;const rt=Math.round(Math.min(T,X)),nt=Math.round(Math.max(T,X));let _t=b*L+rt*4;for(let xt=rt;xt<=nt;xt++)J=(T-xt)/(T-X),J<0?J=0:J>1&&(J=1),g[_t++]=lt-(lt-q)*J|0,g[_t++]=H-(H-ut)*J|0,g[_t++]=D-(D-M)*J|0,g[_t++]=255}}function j1(f,t,s){const n=t.coords,r=t.colors;let l,o;switch(t.type){case"lattice":const u=t.verticesPerRow,d=Math.floor(n.length/u)-1,h=u-1;for(l=0;l<d;l++){let g=l*u;for(let b=0;b<h;b++,g++)Sd(f,s,n[g],n[g+1],n[g+u],r[g],r[g+1],r[g+u]),Sd(f,s,n[g+u+1],n[g+1],n[g+u],r[g+u+1],r[g+1],r[g+u])}break;case"triangles":for(l=0,o=n.length;l<o;l+=3)Sd(f,s,n[l],n[l+1],n[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class D1 extends nh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,s,n){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-d,b=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),x=h/b,_=g/v,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/x,scaleY:1/_},S=b+4,A=v+4,E=n.getCanvas("mesh",S,A),N=E.context,R=N.createImageData(b,v);if(s){const G=R.data;for(let I=0,P=G.length;I<P;I+=4)G[I]=s[0],G[I+1]=s[1],G[I+2]=s[2],G[I+3]=255}for(const G of this._figures)j1(R,G,w);return N.putImageData(R,2,2),{canvas:E.canvas,offsetX:u-2*x,offsetY:d-2*_,scaleX:x,scaleY:_}}getPattern(t,s,n,r){Id(t,this._bbox);let l;if(r===qe.SHADING)l=Tt.singularValueDecompose2dScale(pe(t));else if(l=Tt.singularValueDecompose2dScale(s.baseTransform),this.matrix){const u=Tt.singularValueDecompose2dScale(this.matrix);l=[l[0]*u[0],l[1]*u[1]]}const o=this._createMeshCanvas(l,r===qe.SHADING?null:this._background,s.cachedCanvases);return r!==qe.SHADING&&(t.setTransform(...s.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class O1 extends nh{getPattern(){return"hotpink"}}function z1(f){switch(f[0]){case"RadialAxial":return new R1(f);case"Mesh":return new D1(f);case"Dummy":return new O1}throw new Error(`Unknown IR type: ${f[0]}`)}const Um={COLORED:1,UNCOLORED:2};class ah{static MAX_PATTERN_SIZE=3e3;constructor(t,s,n,r,l){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=s,this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=l}createPatternCanvas(t){const{bbox:s,operatorList:n,paintType:r,tilingType:l,color:o,canvasGraphicsFactory:u}=this;let{xstep:d,ystep:h}=this;d=Math.abs(d),h=Math.abs(h),Io("TilingType: "+l);const g=s[0],b=s[1],v=s[2],x=s[3],_=v-g,w=x-b,S=Tt.singularValueDecompose2dScale(this.matrix),A=Tt.singularValueDecompose2dScale(this.baseTransform),E=S[0]*A[0],N=S[1]*A[1];let R=_,O=w,G=!1,I=!1;const P=Math.ceil(d*E),Y=Math.ceil(h*N),W=Math.ceil(_*E),gt=Math.ceil(w*N);P>=W?R=d:G=!0,Y>=gt?O=h:I=!0;const z=this.getSizeAndScale(R,this.ctx.canvas.width,E),Q=this.getSizeAndScale(O,this.ctx.canvas.height,N),T=t.cachedCanvases.getCanvas("pattern",z.size,Q.size),lt=T.context,H=u.createCanvasGraphics(lt);if(H.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(H,r,o),lt.translate(-z.scale*g,-Q.scale*b),H.transform(z.scale,0,0,Q.scale,0,0),lt.save(),this.clipBbox(H,g,b,v,x),H.baseTransform=pe(H.ctx),H.executeOperatorList(n),H.endDrawing(),lt.restore(),G||I){const D=T.canvas;G&&(R=d),I&&(O=h);const X=this.getSizeAndScale(R,this.ctx.canvas.width,E),q=this.getSizeAndScale(O,this.ctx.canvas.height,N),ut=X.size,M=q.size,L=t.cachedCanvases.getCanvas("pattern-workaround",ut,M),J=L.context,rt=G?Math.floor(_/d):0,nt=I?Math.floor(w/h):0;for(let _t=0;_t<=rt;_t++)for(let xt=0;xt<=nt;xt++)J.drawImage(D,ut*_t,M*xt,ut,M,0,0,ut,M);return{canvas:L.canvas,scaleX:X.scale,scaleY:q.scale,offsetX:g,offsetY:b}}return{canvas:T.canvas,scaleX:z.scale,scaleY:Q.scale,offsetX:g,offsetY:b}}getSizeAndScale(t,s,n){const r=Math.max(ah.MAX_PATTERN_SIZE,s);let l=Math.ceil(t*n);return l>=r?l=r:n=l/t,{scale:n,size:l}}clipBbox(t,s,n,r,l){const o=r-s,u=l-n;t.ctx.rect(s,n,o,u),t.current.updateRectMinMax(pe(t.ctx),[s,n,r,l]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,s,n){const r=t.ctx,l=t.current;switch(s){case Um.COLORED:const o=this.ctx;r.fillStyle=o.fillStyle,r.strokeStyle=o.strokeStyle,l.fillColor=o.fillStyle,l.strokeColor=o.strokeStyle;break;case Um.UNCOLORED:const u=Tt.makeHexColor(n[0],n[1],n[2]);r.fillStyle=u,r.strokeStyle=u,l.fillColor=u,l.strokeColor=u;break;default:throw new l1(`Unsupported paint type: ${s}`)}}getPattern(t,s,n,r){let l=n;r!==qe.SHADING&&(l=Tt.transform(l,s.baseTransform),this.matrix&&(l=Tt.transform(l,this.matrix)));const o=this.createPatternCanvas(s);let u=new DOMMatrix(l);u=u.translate(o.offsetX,o.offsetY),u=u.scale(1/o.scaleX,1/o.scaleY);const d=t.createPattern(o.canvas,"repeat");return d.setTransform(u),d}}function L1({src:f,srcPos:t=0,dest:s,width:n,height:r,nonBlackColor:l=4294967295,inverseDecode:o=!1}){const u=We.isLittleEndian?4278190080:255,[d,h]=o?[l,u]:[u,l],g=n>>3,b=n&7,v=f.length;s=new Uint32Array(s.buffer);let x=0;for(let _=0;_<r;_++){for(const S=t+g;t<S;t++){const A=t<v?f[t]:255;s[x++]=A&128?h:d,s[x++]=A&64?h:d,s[x++]=A&32?h:d,s[x++]=A&16?h:d,s[x++]=A&8?h:d,s[x++]=A&4?h:d,s[x++]=A&2?h:d,s[x++]=A&1?h:d}if(b===0)continue;const w=t<v?f[t++]:255;for(let S=0;S<b;S++)s[x++]=w&1<<7-S?h:d}return{srcPos:t,destPos:x}}const Hm=16,Gm=100,P1=15,qm=10,Vm=1e3,cs=16;function F1(f,t){if(f._removeMirroring)throw new Error("Context is already forwarding operations.");f.__originalSave=f.save,f.__originalRestore=f.restore,f.__originalRotate=f.rotate,f.__originalScale=f.scale,f.__originalTranslate=f.translate,f.__originalTransform=f.transform,f.__originalSetTransform=f.setTransform,f.__originalResetTransform=f.resetTransform,f.__originalClip=f.clip,f.__originalMoveTo=f.moveTo,f.__originalLineTo=f.lineTo,f.__originalBezierCurveTo=f.bezierCurveTo,f.__originalRect=f.rect,f.__originalClosePath=f.closePath,f.__originalBeginPath=f.beginPath,f._removeMirroring=()=>{f.save=f.__originalSave,f.restore=f.__originalRestore,f.rotate=f.__originalRotate,f.scale=f.__originalScale,f.translate=f.__originalTranslate,f.transform=f.__originalTransform,f.setTransform=f.__originalSetTransform,f.resetTransform=f.__originalResetTransform,f.clip=f.__originalClip,f.moveTo=f.__originalMoveTo,f.lineTo=f.__originalLineTo,f.bezierCurveTo=f.__originalBezierCurveTo,f.rect=f.__originalRect,f.closePath=f.__originalClosePath,f.beginPath=f.__originalBeginPath,delete f._removeMirroring},f.save=function(){t.save(),this.__originalSave()},f.restore=function(){t.restore(),this.__originalRestore()},f.translate=function(n,r){t.translate(n,r),this.__originalTranslate(n,r)},f.scale=function(n,r){t.scale(n,r),this.__originalScale(n,r)},f.transform=function(n,r,l,o,u,d){t.transform(n,r,l,o,u,d),this.__originalTransform(n,r,l,o,u,d)},f.setTransform=function(n,r,l,o,u,d){t.setTransform(n,r,l,o,u,d),this.__originalSetTransform(n,r,l,o,u,d)},f.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},f.rotate=function(n){t.rotate(n),this.__originalRotate(n)},f.clip=function(n){t.clip(n),this.__originalClip(n)},f.moveTo=function(s,n){t.moveTo(s,n),this.__originalMoveTo(s,n)},f.lineTo=function(s,n){t.lineTo(s,n),this.__originalLineTo(s,n)},f.bezierCurveTo=function(s,n,r,l,o,u){t.bezierCurveTo(s,n,r,l,o,u),this.__originalBezierCurveTo(s,n,r,l,o,u)},f.rect=function(s,n,r,l){t.rect(s,n,r,l),this.__originalRect(s,n,r,l)},f.closePath=function(){t.closePath(),this.__originalClosePath()},f.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class B1{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,s,n){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,s,n)):(r=this.canvasFactory.create(s,n),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const s=this.cache[t];this.canvasFactory.destroy(s),delete this.cache[t]}}}function po(f,t,s,n,r,l,o,u,d,h){const[g,b,v,x,_,w]=pe(f);if(b===0&&v===0){const E=o*g+_,N=Math.round(E),R=u*x+w,O=Math.round(R),G=(o+d)*g+_,I=Math.abs(Math.round(G)-N)||1,P=(u+h)*x+w,Y=Math.abs(Math.round(P)-O)||1;return f.setTransform(Math.sign(g),0,0,Math.sign(x),N,O),f.drawImage(t,s,n,r,l,0,0,I,Y),f.setTransform(g,b,v,x,_,w),[I,Y]}if(g===0&&x===0){const E=u*v+_,N=Math.round(E),R=o*b+w,O=Math.round(R),G=(u+h)*v+_,I=Math.abs(Math.round(G)-N)||1,P=(o+d)*b+w,Y=Math.abs(Math.round(P)-O)||1;return f.setTransform(0,Math.sign(b),Math.sign(v),0,N,O),f.drawImage(t,s,n,r,l,0,0,Y,I),f.setTransform(g,b,v,x,_,w),[Y,I]}f.drawImage(t,s,n,r,l,o,u,d,h);const S=Math.hypot(g,b),A=Math.hypot(v,x);return[S*d,A*h]}function I1(f){const{width:t,height:s}=f;if(t>Vm||s>Vm)return null;const n=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=t+1;let o=new Uint8Array(l*(s+1)),u,d,h;const g=t+7&-8;let b=new Uint8Array(g*s),v=0;for(const A of f.data){let E=128;for(;E>0;)b[v++]=A&E?0:255,E>>=1}let x=0;for(v=0,b[v]!==0&&(o[0]=1,++x),d=1;d<t;d++)b[v]!==b[v+1]&&(o[d]=b[v]?2:1,++x),v++;for(b[v]!==0&&(o[d]=2,++x),u=1;u<s;u++){v=u*g,h=u*l,b[v-g]!==b[v]&&(o[h]=b[v]?1:8,++x);let A=(b[v]?4:0)+(b[v-g]?8:0);for(d=1;d<t;d++)A=(A>>2)+(b[v+1]?4:0)+(b[v-g+1]?8:0),r[A]&&(o[h+d]=r[A],++x),v++;if(b[v-g]!==b[v]&&(o[h+d]=b[v]?2:4,++x),x>n)return null}for(v=g*(s-1),h=u*l,b[v]!==0&&(o[h]=8,++x),d=1;d<t;d++)b[v]!==b[v+1]&&(o[h+d]=b[v]?4:8,++x),v++;if(b[v]!==0&&(o[h+d]=4,++x),x>n)return null;const _=new Int32Array([0,l,-1,0,-l,0,0,0,1]),w=new Path2D;for(u=0;x&&u<=s;u++){let A=u*l;const E=A+t;for(;A<E&&!o[A];)A++;if(A===E)continue;w.moveTo(A%l,u);const N=A;let R=o[A];do{const O=_[R];do A+=O;while(!o[A]);const G=o[A];G!==5&&G!==10?(R=G,o[A]=0):(R=G&51*R>>4,o[A]&=R>>2|R<<2),w.lineTo(A%l,A/l|0),o[A]||--x}while(N!==A);--u}return b=null,o=null,function(A){A.save(),A.scale(1/t,-1/s),A.translate(0,-s),A.fill(w),A.beginPath(),A.restore()}}class Xm{constructor(t,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=x0,this.textMatrixScale=1,this.fontMatrix=Ld,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ge.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,s])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,s){this.x=t,this.y=s}updatePathMinMax(t,s,n){[s,n]=Tt.applyTransform([s,n],t),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,s){const n=Tt.applyTransform(s,t),r=Tt.applyTransform(s.slice(2),t),l=Tt.applyTransform([s[0],s[3]],t),o=Tt.applyTransform([s[2],s[1]],t);this.minX=Math.min(this.minX,n[0],r[0],l[0],o[0]),this.minY=Math.min(this.minY,n[1],r[1],l[1],o[1]),this.maxX=Math.max(this.maxX,n[0],r[0],l[0],o[0]),this.maxY=Math.max(this.maxY,n[1],r[1],l[1],o[1])}updateScalingPathMinMax(t,s){Tt.scaleMinMax(t,s),this.minX=Math.min(this.minX,s[0]),this.minY=Math.min(this.minY,s[1]),this.maxX=Math.max(this.maxX,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(t,s,n,r,l,o,u,d,h,g){const b=Tt.bezierBoundingBox(s,n,r,l,o,u,d,h,g);g||this.updateRectMinMax(t,b)}getPathBoundingBox(t=qe.FILL,s=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===qe.STROKE){s||ue("Stroke bounding box must include transform.");const r=Tt.singularValueDecompose2dScale(s),l=r[0]*this.lineWidth/2,o=r[1]*this.lineWidth/2;n[0]-=l,n[1]-=o,n[2]+=l,n[3]+=o}return n}updateClipFromPath(){const t=Tt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=qe.FILL,s=null){return Tt.intersect(this.clipBox,this.getPathBoundingBox(t,s))}}function Ym(f,t){if(t instanceof ImageData){f.putImageData(t,0,0);return}const s=t.height,n=t.width,r=s%cs,l=(s-r)/cs,o=r===0?l:l+1,u=f.createImageData(n,cs);let d=0,h;const g=t.data,b=u.data;let v,x,_,w;if(t.kind===_o.GRAYSCALE_1BPP){const S=g.byteLength,A=new Uint32Array(b.buffer,0,b.byteLength>>2),E=A.length,N=n+7>>3,R=4294967295,O=We.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(_=v<l?cs:r,h=0,x=0;x<_;x++){const G=S-d;let I=0;const P=G>N?n:G*8-7,Y=P&-8;let W=0,gt=0;for(;I<Y;I+=8)gt=g[d++],A[h++]=gt&128?R:O,A[h++]=gt&64?R:O,A[h++]=gt&32?R:O,A[h++]=gt&16?R:O,A[h++]=gt&8?R:O,A[h++]=gt&4?R:O,A[h++]=gt&2?R:O,A[h++]=gt&1?R:O;for(;I<P;I++)W===0&&(gt=g[d++],W=128),A[h++]=gt&W?R:O,W>>=1}for(;h<E;)A[h++]=0;f.putImageData(u,0,v*cs)}}else if(t.kind===_o.RGBA_32BPP){for(x=0,w=n*cs*4,v=0;v<l;v++)b.set(g.subarray(d,d+w)),d+=w,f.putImageData(u,0,x),x+=cs;v<o&&(w=n*r*4,b.set(g.subarray(d,d+w)),f.putImageData(u,0,x))}else if(t.kind===_o.RGB_24BPP)for(_=cs,w=n*_,v=0;v<o;v++){for(v>=l&&(_=r,w=n*_),h=0,x=w;x--;)b[h++]=g[d++],b[h++]=g[d++],b[h++]=g[d++],b[h++]=255;f.putImageData(u,0,v*cs)}else throw new Error(`bad image kind: ${t.kind}`)}function $m(f,t){if(t.bitmap){f.drawImage(t.bitmap,0,0);return}const s=t.height,n=t.width,r=s%cs,l=(s-r)/cs,o=r===0?l:l+1,u=f.createImageData(n,cs);let d=0;const h=t.data,g=u.data;for(let b=0;b<o;b++){const v=b<l?cs:r;({srcPos:d}=L1({src:h,srcPos:d,dest:g,width:n,height:v,nonBlackColor:0})),f.putImageData(u,0,b*cs)}}function Mr(f,t){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of s)f[n]!==void 0&&(t[n]=f[n]);f.setLineDash!==void 0&&(t.setLineDash(f.getLineDash()),t.lineDashOffset=f.lineDashOffset)}function mo(f){if(f.strokeStyle=f.fillStyle="#000000",f.fillRule="nonzero",f.globalAlpha=1,f.lineWidth=1,f.lineCap="butt",f.lineJoin="miter",f.miterLimit=10,f.globalCompositeOperation="source-over",f.font="10px sans-serif",f.setLineDash!==void 0&&(f.setLineDash([]),f.lineDashOffset=0),!Ve){const{filter:t}=f;t!=="none"&&t!==""&&(f.filter="none")}}function Zm(f,t){if(t)return!0;const s=Tt.singularValueDecompose2dScale(f);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*Da.PDF_TO_CSS_UNITS);return s[0]<=n&&s[1]<=n}const U1=["butt","round","square"],H1=["miter","round","bevel"],G1={},Km={};class ka{constructor(t,s,n,r,l,{optionalContentConfig:o,markedContentStack:u=null},d,h){this.ctx=t,this.current=new Xm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=n,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new B1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,s=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):s}beginDrawing({transform:t,viewport:s,transparency:n=!1,background:r=null}){const l=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,o),this.ctx.fillStyle=u,n){const d=this.cachedCanvases.getCanvas("transparent",l,o);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...pe(this.compositeCtx))}this.ctx.save(),mo(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=pe(this.ctx)}executeOperatorList(t,s,n,r){const l=t.argsArray,o=t.fnArray;let u=s||0;const d=l.length;if(d===u)return u;const h=d-u>qm&&typeof n=="function",g=h?Date.now()+P1:0;let b=0;const v=this.commonObjs,x=this.objs;let _;for(;;){if(r!==void 0&&u===r.nextBreakPoint)return r.breakIt(u,n),u;if(_=o[u],_!==Vs.dependency)this[_].apply(this,l[u]);else for(const w of l[u]){const S=w.startsWith("g_")?v:x;if(!S.has(w))return S.get(w,n),u}if(u++,u===d)return u;if(h&&++b>qm){if(Date.now()>g)return n(),u;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const s of t.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const s=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=s}}}_scaleImage(t,s){const n=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(s[0],s[1]),1),o=Math.max(Math.hypot(s[2],s[3]),1),u=n,d=r,h="prescale1",g,b;for(;l>2&&u>1||o>2&&d>1;){let v=u,x=d;l>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/v),o>2&&d>1&&(x=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/x),g=this.cachedCanvases.getCanvas(h,v,x),b=g.context,b.clearRect(0,0,v,x),b.drawImage(t,0,0,u,d,0,0,v,x),t=g.canvas,u=v,d=x,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t){const s=this.ctx,{width:n,height:r}=t,l=this.current.fillColor,o=this.current.patternFill,u=pe(s);let d,h,g,b;if((t.bitmap||t.data)&&t.count>1){const P=t.bitmap||t.data.buffer;h=JSON.stringify(o?u:[u.slice(0,4),l]),d=this._cachedBitmapsMap.get(P),d||(d=new Map,this._cachedBitmapsMap.set(P,d));const Y=d.get(h);if(Y&&!o){const W=Math.round(Math.min(u[0],u[2])+u[4]),gt=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:Y,offsetX:W,offsetY:gt}}g=Y}g||(b=this.cachedCanvases.getCanvas("maskCanvas",n,r),$m(b.context,t));let v=Tt.transform(u,[1/n,0,0,-1/r,0,0]);v=Tt.transform(v,[1,0,0,1,0,-r]);const[x,_,w,S]=Tt.getAxialAlignedBoundingBox([0,0,n,r],v),A=Math.round(w-x)||1,E=Math.round(S-_)||1,N=this.cachedCanvases.getCanvas("fillCanvas",A,E),R=N.context,O=x,G=_;R.translate(-O,-G),R.transform(...v),g||(g=this._scaleImage(b.canvas,Js(R)),g=g.img,d&&o&&d.set(h,g)),R.imageSmoothingEnabled=Zm(pe(R),t.interpolate),po(R,g,0,0,g.width,g.height,0,0,n,r),R.globalCompositeOperation="source-in";const I=Tt.transform(Js(R),[1,0,0,1,-O,-G]);return R.fillStyle=o?l.getPattern(s,this,I,qe.FILL):l,R.fillRect(0,0,n,r),d&&!o&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,N.canvas)),{canvas:N.canvas,offsetX:Math.round(O),offsetY:Math.round(G)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=U1[t]}setLineJoin(t){this.ctx.lineJoin=H1[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,s){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=s)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[s,n]of t)switch(s){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,t,s);this.suspendedCtx=this.ctx,this.ctx=r.context;const l=this.ctx;l.setTransform(...pe(this.suspendedCtx)),Mr(this.suspendedCtx,l),F1(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Mr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,s,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,s,n,r){const l=r[0],o=r[1],u=r[2]-l,d=r[3]-o;u===0||d===0||(this.genericComposeSMask(s.context,n,u,d,s.subtype,s.backdrop,s.transferMap,l,o,s.offsetX,s.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,s,n,r,l,o,u,d,h,g,b){let v=t.canvas,x=d-g,_=h-b;if(o){const S=Tt.makeHexColor(...o);if(x<0||_<0||x+n>v.width||_+r>v.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,r),E=A.context;E.drawImage(v,-x,-_),E.globalCompositeOperation="destination-atop",E.fillStyle=S,E.fillRect(0,0,n,r),E.globalCompositeOperation="source-over",v=A.canvas,x=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(x,_,n,r),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=S,t.fillRect(x,_,n,r),t.restore()}}s.save(),s.globalAlpha=1,s.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?s.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(s.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,h,n,r),s.clip(w),s.globalCompositeOperation="destination-in",s.drawImage(v,x,_,n,r,d,h,n,r),s.restore()}save(){this.inSMaskMode?(Mr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Mr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,s,n,r,l,o){this.ctx.transform(t,s,n,r,l,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,s,n){const r=this.ctx,l=this.current;let o=l.x,u=l.y,d,h;const g=pe(r),b=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,v=b?n.slice(0):null;for(let x=0,_=0,w=t.length;x<w;x++)switch(t[x]|0){case Vs.rectangle:o=s[_++],u=s[_++];const S=s[_++],A=s[_++],E=o+S,N=u+A;r.moveTo(o,u),S===0||A===0?r.lineTo(E,N):(r.lineTo(E,u),r.lineTo(E,N),r.lineTo(o,N)),b||l.updateRectMinMax(g,[o,u,E,N]),r.closePath();break;case Vs.moveTo:o=s[_++],u=s[_++],r.moveTo(o,u),b||l.updatePathMinMax(g,o,u);break;case Vs.lineTo:o=s[_++],u=s[_++],r.lineTo(o,u),b||l.updatePathMinMax(g,o,u);break;case Vs.curveTo:d=o,h=u,o=s[_+4],u=s[_+5],r.bezierCurveTo(s[_],s[_+1],s[_+2],s[_+3],o,u),l.updateCurvePathMinMax(g,d,h,s[_],s[_+1],s[_+2],s[_+3],o,u,v),_+=6;break;case Vs.curveTo2:d=o,h=u,r.bezierCurveTo(o,u,s[_],s[_+1],s[_+2],s[_+3]),l.updateCurvePathMinMax(g,d,h,o,u,s[_],s[_+1],s[_+2],s[_+3],v),o=s[_+2],u=s[_+3],_+=4;break;case Vs.curveTo3:d=o,h=u,o=s[_+2],u=s[_+3],r.bezierCurveTo(s[_],s[_+1],o,u,o,u),l.updateCurvePathMinMax(g,d,h,s[_],s[_+1],o,u,o,u,v),_+=4;break;case Vs.closePath:r.closePath();break}b&&l.updateScalingPathMinMax(g,v),l.setCurrentPoint(o,u)}closePath(){this.ctx.closePath()}stroke(t=!0){const s=this.ctx,n=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(s.save(),s.strokeStyle=n.getPattern(s,this,Js(s),qe.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const s=this.ctx,n=this.current.fillColor,r=this.current.patternFill;let l=!1;r&&(s.save(),s.fillStyle=n.getPattern(s,this,Js(s),qe.FILL),l=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),l&&s.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G1}eoClip(){this.pendingClip=Km}beginText(){this.current.textMatrix=x0,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,s=this.ctx;if(t===void 0){s.beginPath();return}const n=new Path2D,r=s.getTransform().invertSelf();for(const{transform:l,x:o,y:u,fontSize:d,path:h}of t)n.addPath(h,new DOMMatrix(l).preMultiplySelf(r).translate(o,u).scale(d,-d));s.clip(n),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,s){const n=this.commonObjs.get(t),r=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=n.fontMatrix||Ld,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&qt("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=s,n.isType3Font)return;const l=n.loadedName||"sans-serif",o=n.systemFontInfo?.css||`"${l}", ${n.fallbackName}`;let u="normal";n.black?u="900":n.bold&&(u="bold");const d=n.italic?"italic":"normal";let h=s;s<Hm?h=Hm:s>Gm&&(h=Gm),this.current.fontSizeScale=s/h,this.ctx.font=`${d} ${u} ${h}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,s){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,s){this.setLeading(-s),this.moveText(t,s)}setTextMatrix(t,s,n,r,l,o){this.current.textMatrix=[t,s,n,r,l,o],this.current.textMatrixScale=Math.hypot(t,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(t,s,n){const r=new Path2D;return r.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(s)),r}paintChar(t,s,n,r,l){const o=this.ctx,u=this.current,d=u.font,h=u.textRenderingMode,g=u.fontSize/u.fontSizeScale,b=h&Ge.FILL_STROKE_MASK,v=!!(h&Ge.ADD_TO_PATH_FLAG),x=u.patternFill&&!d.missingFile,_=u.patternStroke&&!d.missingFile;let w;if((d.disableFontFace||v||x||_)&&(w=d.getPathGenerator(this.commonObjs,t)),d.disableFontFace||x||_){if(o.save(),o.translate(s,n),o.scale(g,-g),b===Ge.FILL||b===Ge.FILL_STROKE)if(r){const S=o.getTransform();o.setTransform(...r),o.fill(this.#s(w,S,r))}else o.fill(w);if(b===Ge.STROKE||b===Ge.FILL_STROKE)if(l){const S=o.getTransform();o.setTransform(...l),o.stroke(this.#s(w,S,l))}else o.lineWidth/=g,o.stroke(w);o.restore()}else(b===Ge.FILL||b===Ge.FILL_STROKE)&&o.fillText(t,s,n),(b===Ge.STROKE||b===Ge.FILL_STROKE)&&o.strokeText(t,s,n);v&&(this.pendingTextPaths||=[]).push({transform:pe(o),x:s,y:n,fontSize:g,path:w})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const s=t.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<s.length;r+=4)if(s[r]>0&&s[r]<255){n=!0;break}return Xt(this,"isFontSubpixelAAEnabled",n)}showText(t){const s=this.current,n=s.font;if(n.isType3Font)return this.showType3Text(t);const r=s.fontSize;if(r===0)return;const l=this.ctx,o=s.fontSizeScale,u=s.charSpacing,d=s.wordSpacing,h=s.fontDirection,g=s.textHScale*h,b=t.length,v=n.vertical,x=v?1:-1,_=n.defaultVMetrics,w=r*s.fontMatrix[0],S=s.textRenderingMode===Ge.FILL&&!n.disableFontFace&&!s.patternFill;l.save(),l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),h>0?l.scale(g,-1):l.scale(g,1);let A,E;if(s.patternFill){l.save();const I=s.fillColor.getPattern(l,this,Js(l),qe.FILL);A=pe(l),l.restore(),l.fillStyle=I}if(s.patternStroke){l.save();const I=s.strokeColor.getPattern(l,this,Js(l),qe.STROKE);E=pe(l),l.restore(),l.strokeStyle=I}let N=s.lineWidth;const R=s.textMatrixScale;if(R===0||N===0){const I=s.textRenderingMode&Ge.FILL_STROKE_MASK;(I===Ge.STROKE||I===Ge.FILL_STROKE)&&(N=this.getSinglePixelWidth())}else N/=R;if(o!==1&&(l.scale(o,o),N/=o),l.lineWidth=N,n.isInvalidPDFjsFont){const I=[];let P=0;for(const Y of t)I.push(Y.unicode),P+=Y.width;l.fillText(I.join(""),0,0),s.x+=P*w*g,l.restore(),this.compose();return}let O=0,G;for(G=0;G<b;++G){const I=t[G];if(typeof I=="number"){O+=x*I*r/1e3;continue}let P=!1;const Y=(I.isSpace?d:0)+u,W=I.fontChar,gt=I.accent;let z,Q,T=I.width;if(v){const H=I.vmetric||_,D=-(I.vmetric?H[1]:T*.5)*w,X=H[2]*w;T=H?-H[0]:T,z=D/o,Q=(O+X)/o}else z=O/o,Q=0;if(n.remeasure&&T>0){const H=l.measureText(W).width*1e3/r*o;if(T<H&&this.isFontSubpixelAAEnabled){const D=T/H;P=!0,l.save(),l.scale(D,1),z/=D}else T!==H&&(z+=(T-H)/2e3*r/o)}if(this.contentVisible&&(I.isInFont||n.missingFile)){if(S&&!gt)l.fillText(W,z,Q);else if(this.paintChar(W,z,Q,A,E),gt){const H=z+r*gt.offset.x/o,D=Q-r*gt.offset.y/o;this.paintChar(gt.fontChar,H,D,A,E)}}const lt=v?T*w-Y*h:T*w+Y*h;O+=lt,P&&l.restore()}v?s.y-=O:s.x+=O*g,l.restore(),this.compose()}showType3Text(t){const s=this.ctx,n=this.current,r=n.font,l=n.fontSize,o=n.fontDirection,u=r.vertical?1:-1,d=n.charSpacing,h=n.wordSpacing,g=n.textHScale*o,b=n.fontMatrix||Ld,v=t.length,x=n.textRenderingMode===Ge.INVISIBLE;let _,w,S,A;if(!(x||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),s.transform(...n.textMatrix),s.translate(n.x,n.y),s.scale(g,o),_=0;_<v;++_){if(w=t[_],typeof w=="number"){A=u*w*l/1e3,this.ctx.translate(A,0),n.x+=A*g;continue}const E=(w.isSpace?h:0)+d,N=r.charProcOperatorList[w.operatorListId];if(!N){qt(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),s.scale(l,l),s.transform(...b),this.executeOperatorList(N),this.restore()),S=Tt.applyTransform([w.width,0],b)[0]*l+E,s.translate(S,0),n.x+=S*g}s.restore(),this.processingType3=null}}setCharWidth(t,s){}setCharWidthAndBounds(t,s,n,r,l,o){this.ctx.rect(n,r,l-n,o-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let s;if(t[0]==="TilingPattern"){const n=t[1],r=this.baseTransform||pe(this.ctx),l={createCanvasGraphics:o=>new ka(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};s=new ah(t,n,this.ctx,l,r)}else s=this._getPattern(t[1],t[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,s,n){this.ctx.strokeStyle=this.current.strokeColor=Tt.makeHexColor(t,s,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,s,n){this.ctx.fillStyle=this.current.fillColor=Tt.makeHexColor(t,s,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,s=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=z1(this.getObject(t)),this.cachedPatterns.set(t,n)),s&&(n.matrix=s),n}shadingFill(t){if(!this.contentVisible)return;const s=this.ctx;this.save();const n=this._getPattern(t);s.fillStyle=n.getPattern(s,this,Js(s),qe.SHADING);const r=Js(s);if(r){const{width:l,height:o}=s.canvas,[u,d,h,g]=Tt.getAxialAlignedBoundingBox([0,0,l,o],r);this.ctx.fillRect(u,d,h-u,g-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ue("Should not call beginInlineImage")}beginImageData(){ue("Should not call beginImageData")}paintFormXObjectBegin(t,s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=pe(this.ctx),s)){const n=s[2]-s[0],r=s[3]-s[1];this.ctx.rect(s[0],s[1],n,r),this.current.updateRectMinMax(pe(this.ctx),s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||Io("TODO: Support non-isolated groups."),t.knockout&&qt("Knockout groups not supported.");const n=pe(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Tt.getAxialAlignedBoundingBox(t.bbox,pe(s));const l=[0,0,s.canvas.width,s.canvas.height];r=Tt.intersect(r,l)||[0,0,0,0];const o=Math.floor(r[0]),u=Math.floor(r[1]),d=Math.max(Math.ceil(r[2])-o,1),h=Math.max(Math.ceil(r[3])-u,1);this.current.startNewPathAndClipBox([0,0,d,h]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(g,d,h),v=b.context;v.translate(-o,-u),v.transform(...n),t.smask?this.smaskStack.push({canvas:b.canvas,context:v,offsetX:o,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(o,u),s.save()),Mr(s,v),this.ctx=v,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=pe(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const l=Tt.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],r);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,s,n,r,l){if(this.#t(),mo(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const o=s[2]-s[0],u=s[3]-s[1];if(l&&this.annotationCanvasMap){n=n.slice(),n[4]-=s[0],n[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=o,s[3]=u;const[d,h]=Tt.singularValueDecompose2dScale(pe(this.ctx)),{viewportScale:g}=this,b=Math.ceil(o*this.outputScaleX*g),v=Math.ceil(u*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(b,v);const{canvas:x,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(d,0,0,-h,0,u*h),mo(this.ctx)}else mo(this.ctx),this.endPath(),this.ctx.rect(s[0],s[1],o,u),this.ctx.clip(),this.ctx.beginPath()}this.current=new Xm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const s=t.count;t=this.getObject(t.data,t),t.count=s;const n=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=I1(t)),r.compiled)){r.compiled(n);return}const l=this._createMaskCanvas(t),o=l.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,l.offsetX,l.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,s,n=0,r=0,l,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const u=this.ctx;u.save();const d=pe(u);u.transform(s,n,r,l,0,0);const h=this._createMaskCanvas(t);u.setTransform(1,0,0,1,h.offsetX-d[4],h.offsetY-d[5]);for(let g=0,b=o.length;g<b;g+=2){const v=Tt.transform(d,[s,n,r,l,o[g],o[g+1]]),[x,_]=Tt.applyTransform([0,0],v);u.drawImage(h.canvas,x,_)}u.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const s=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(const l of t){const{data:o,width:u,height:d,transform:h}=l,g=this.cachedCanvases.getCanvas("maskCanvas",u,d),b=g.context;b.save();const v=this.getObject(o,l);$m(b,v),b.globalCompositeOperation="source-in",b.fillStyle=r?n.getPattern(b,this,Js(s),qe.FILL):n,b.fillRect(0,0,u,d),b.restore(),s.save(),s.transform(...h),s.scale(1,-1),po(s,g.canvas,0,0,u,d,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){qt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(t,s,n,r){if(!this.contentVisible)return;const l=this.getObject(t);if(!l){qt("Dependent image isn't ready yet");return}const o=l.width,u=l.height,d=[];for(let h=0,g=r.length;h<g;h+=2)d.push({transform:[s,0,0,n,r[h],r[h+1]],x:0,y:0,w:o,h:u});this.paintInlineImageXObjectGroup(l,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:s,width:n,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",n,r),o=l.context;return o.filter=this.current.transferMaps,o.drawImage(s,0,0),o.filter="none",l.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const s=t.width,n=t.height,r=this.ctx;if(this.save(),!Ve){const{filter:u}=r;u!=="none"&&u!==""&&(r.filter="none")}r.scale(1/s,-1/n);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,n).context;Ym(d,t),l=this.applyTransferMapsToCanvas(d)}const o=this._scaleImage(l,Js(r));r.imageSmoothingEnabled=Zm(pe(r),t.interpolate),po(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,s,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,s){if(!this.contentVisible)return;const n=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const l=t.width,o=t.height,d=this.cachedCanvases.getCanvas("inlineImage",l,o).context;Ym(d,t),r=this.applyTransferMapsToCanvas(d)}for(const l of s)n.save(),n.transform(...l.transform),n.scale(1,-1),po(n,r,l.x,l.y,l.w,l.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,s){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,s){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(s||(this.pendingClip===Km?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=pe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const s=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:s,b:n,c:r,d:l}=this.ctx.getTransform();let o,u;if(n===0&&r===0){const d=Math.abs(s),h=Math.abs(l);if(d===h)if(t===0)o=u=1/d;else{const g=d*t;o=u=g<1?1/g:1}else if(t===0)o=1/d,u=1/h;else{const g=d*t,b=h*t;o=g<1?1/g:1,u=b<1?1/b:1}}else{const d=Math.abs(s*l-n*r),h=Math.hypot(s,n),g=Math.hypot(r,l);if(t===0)o=g/d,u=h/d;else{const b=t*d;o=g>b?g/b:1,u=h>b?h/b:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:s}=this,{lineWidth:n}=this.current,[r,l]=this.getScaleForStroking();if(s.lineWidth=n||1,r===1&&l===1){s.stroke();return}const o=s.getLineDash();if(t&&s.save(),s.scale(r,l),o.length>0){const u=Math.max(r,l);s.setLineDash(o.map(d=>d/u)),s.lineDashOffset/=u}s.stroke(),t&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const f in Vs)ka.prototype[f]!==void 0&&(ka.prototype[Vs[f]]=ka.prototype[f]);class Br{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class q1{#t;#e;constructor({parsedData:t,rawData:s}){this.#t=t,this.#e=s}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}getAll(){return Kd(this.#t)}has(t){return this.#t.has(t)}}const wa=Symbol("INTERNAL");class V1{#t=!1;#e=!1;#s=!1;#i=!0;constructor(t,{name:s,intent:n,usage:r,rbGroups:l}){this.#t=!!(t&As.DISPLAY),this.#e=!!(t&As.PRINT),this.name=s,this.intent=n,this.usage=r,this.rbGroups=l}get visible(){if(this.#s)return this.#i;if(!this.#i)return!1;const{print:t,view:s}=this.usage;return this.#t?s?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,s,n=!1){t!==wa&&ue("Internal method `_setVisible` called."),this.#s=n,this.#i=s}}class X1{#t=null;#e=new Map;#s=null;#i=null;constructor(t,s=As.DISPLAY){if(this.renderingIntent=s,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const n of t.groups)this.#e.set(n.id,new V1(s,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(wa,!1);for(const n of t.on)this.#e.get(n)._setVisible(wa,!0);for(const n of t.off)this.#e.get(n)._setVisible(wa,!1);this.#s=this.getHash()}}#a(t){const s=t.length;if(s<2)return!0;const n=t[0];for(let r=1;r<s;r++){const l=t[r];let o;if(Array.isArray(l))o=this.#a(l);else if(this.#e.has(l))o=this.#e.get(l).visible;else return qt(`Optional content group not found: ${l}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Io("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(qt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!this.#e.has(s))return qt(`Optional content group not found: ${s}`),!0;if(this.#e.get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!this.#e.has(s))return qt(`Optional content group not found: ${s}`),!0;if(!this.#e.get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!this.#e.has(s))return qt(`Optional content group not found: ${s}`),!0;if(!this.#e.get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!this.#e.has(s))return qt(`Optional content group not found: ${s}`),!0;if(this.#e.get(s).visible)return!1}return!0}return qt(`Unknown optional content policy ${t.policy}.`),!0}return qt(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0,n=!0){const r=this.#e.get(t);if(!r){qt(`Optional content group not found: ${t}`);return}if(n&&s&&r.rbGroups.length)for(const l of r.rbGroups)for(const o of l)o!==t&&this.#e.get(o)?._setVisible(wa,!1,!0);r._setVisible(wa,!!s,!0),this.#t=null}setOCGState({state:t,preserveRB:s}){let n;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const l=this.#e.get(r);if(l)switch(n){case"ON":this.setVisibility(r,!0,s);break;case"OFF":this.setVisibility(r,!1,s);break;case"Toggle":this.setVisibility(r,!l.visible,s);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?Kd(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new A0;for(const[s,n]of this.#e)t.update(`${s}:${n.visible}`);return this.#t=t.hexdigest()}}class Y1{constructor(t,{disableRange:s=!1,disableStream:n=!1}){Te(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:o,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,l?.length>0){const d=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!s,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,h)=>{this._onReceiveData({begin:d,chunk:h})}),t.addProgressListener((d,h)=>{this._onProgress({loaded:d,total:h})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:s}){const n=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(n),!0)});Te(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const s=this._rangeReaders.indexOf(t);s>=0&&this._rangeReaders.splice(s,1)}getFullReader(){Te(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new $1(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const n=new Z1(this,t,s);return this._pdfDataRangeTransport.requestDataRange(t,s),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const s of this._rangeReaders.slice(0))s.cancel(t);this._pdfDataRangeTransport.abort()}}class $1{constructor(t,s,n=!1,r=null){this._stream=t,this._done=n||!1,this._filename=Jd(r)?r:null,this._queuedChunks=s||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Z1{constructor(t,s,n){this._stream=t,this._begin=s,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function K1(f){let t=!0,s=n("filename\\*","i").exec(f);if(s){s=s[1];let g=u(s);return g=unescape(g),g=d(g),g=h(g),l(g)}if(s=o(f),s){const g=h(s);return l(g)}if(s=n("filename","i").exec(f),s){s=s[1];let g=u(s);return g=h(g),l(g)}function n(g,b){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function r(g,b){if(g){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const v=new TextDecoder(g,{fatal:!0}),x=Uo(b);b=v.decode(x),t=!1}catch{}}return b}function l(g){return t&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),t&&(g=r("iso-8859-1",g))),g}function o(g){const b=[];let v;const x=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=x.exec(g))!==null;){let[,w,S,A]=v;if(w=parseInt(w,10),w in b){if(w===0)break;continue}b[w]=[S,A]}const _=[];for(let w=0;w<b.length&&w in b;++w){let[S,A]=b[w];A=u(A),S&&(A=unescape(A),w===0&&(A=d(A))),_.push(A)}return _.join("")}function u(g){if(g.startsWith('"')){const b=g.slice(1).split('\\"');for(let v=0;v<b.length;++v){const x=b[v].indexOf('"');x!==-1&&(b[v]=b[v].slice(0,x),b.length=v+1),b[v]=b[v].replaceAll(/\\(.)/g,"$1")}g=b.join('"')}return g}function d(g){const b=g.indexOf("'");if(b===-1)return g;const v=g.slice(0,b),_=g.slice(b+1).replace(/^[^']*'/,"");return r(v,_)}function h(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,v,x,_){if(x==="q"||x==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,S){return String.fromCharCode(parseInt(S,16))}),r(v,_);try{_=atob(_)}catch{}return r(v,_)})}return""}function j0(f,t){const s=new Headers;if(!f||!t||typeof t!="object")return s;for(const n in t){const r=t[n];r!==void 0&&s.append(n,r)}return s}function Vo(f){try{return new URL(f).origin}catch{}return null}function D0({responseHeaders:f,isHttp:t,rangeChunkSize:s,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(f.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*s)||n||!t||f.get("Accept-Ranges")!=="bytes"||(f.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function O0(f){const t=f.get("Content-Disposition");if(t){let s=K1(t);if(s.includes("%"))try{s=decodeURIComponent(s)}catch{}if(Jd(s))return s}return null}function Xo(f,t){return f===404||f===0&&t.startsWith("file:")?new Ur('Missing PDF "'+t+'".'):new To(`Unexpected server response (${f}) while retrieving PDF "${t}".`,f)}function z0(f){return f===200||f===206}function L0(f,t,s){return{method:"GET",headers:f,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function P0(f){return f instanceof Uint8Array?f.buffer:f instanceof ArrayBuffer?f:(qt(`getArrayBuffer - unexpected data format: ${f}`),new Uint8Array(f).buffer)}class Wm{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=j0(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Te(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new W1(this),this._fullRequestReader}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const n=new Q1(this,t,s);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class W1{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const s=t.source;this._withCredentials=s.withCredentials||!1,this._contentLength=s.length,this._headersCapability=Promise.withResolvers(),this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange;const n=new Headers(t.headers),r=s.url;fetch(r,L0(n,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=Vo(l.url),!z0(l.status))throw Xo(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const o=l.headers,{allowRangeRequests:u,suggestedLength:d}=D0({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=O0(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new sn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:P0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Q1{constructor(t,s,n){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${s}-${n-1}`);const o=r.url;fetch(o,L0(l,this._withCredentials,this._abortController)).then(u=>{const d=Vo(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!z0(u.status))throw Xo(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:P0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const kd=200,Ed=206;function J1(f){const t=f.response;return typeof t!="string"?t:Uo(t).buffer}class t_{_responseOrigin=null;constructor({url:t,httpHeaders:s,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=j0(this.isHttp,s),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const s=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:s};s.open("GET",this.url),s.withCredentials=this.withCredentials;for(const[l,o]of this.headers)s.setRequestHeader(l,o);return this.isHttp&&"begin"in t&&"end"in t?(s.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=Ed):r.expectedStatus=kd,s.responseType="arraybuffer",Te(t.onError,"Expected `onError` callback to be provided."),s.onerror=()=>{t.onError(s.status)},s.onreadystatechange=this.onStateChange.bind(this,n),s.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,s.send(null),n}onProgress(t,s){const n=this.pendingRequests[t];n&&n.onProgress?.(s)}onStateChange(t,s){const n=this.pendingRequests[t];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){n.onError(r.status);return}const l=r.status||kd;if(!(l===kd&&n.expectedStatus===Ed)&&l!==n.expectedStatus){n.onError(r.status);return}const u=J1(r);if(l===Ed){const d=r.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);h?n.onDone({begin:parseInt(h[1],10),chunk:u}):(qt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const s=this.pendingRequests[t].xhr;delete this.pendingRequests[t],s.abort()}}class e_{constructor(t){this._source=t,this._manager=new t_(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const s=this._rangeRequestReaders.indexOf(t);s>=0&&this._rangeRequestReaders.splice(s,1)}getFullReader(){return Te(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new s_(this._manager,this._source),this._fullRequestReader}getRangeReader(t,s){const n=new i_(this._manager,t,s);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class s_{constructor(t,s){this._manager=t,this._url=s.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=s.disableRange||!1,this._contentLength=s.length,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,s=this._manager.getRequestXhr(t);this._manager._responseOrigin=Vo(s.responseURL);const n=s.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...h]=u.split(": ");return[d,h.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:o}=D0({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=O0(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Xo(t,this._url),this._headersCapability.reject(this._storedError);for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class i_{constructor(t,s,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:s,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Vo(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const s=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:s,done:!1}):this._queuedChunk=s,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Xo(t,this._url);for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const n_=/^[a-z][a-z0-9\-+.]+:/i;function a_(f){if(n_.test(f))return new URL(f);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(f))}class r_{constructor(t){this.source=t,this.url=a_(t.url),Te(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Te(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new l_(this),this._fullRequestReader}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const n=new o_(this,t,s);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class l_{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const s=t.source;this._contentLength=s.length,this._loaded=0,this._filename=null,this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new Ur(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",s=>{this._error(s)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new sn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class o_{constructor(t,s,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:s,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",s=>{this._error(s)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const c_=1e5,ls=30,u_=.8;class Ke{#t=Promise.withResolvers();#e=null;#s=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#n=null;#o=0;#l=0;#u=null;#c=null;#h=0;#d=0;#f=Object.create(null);#r=[];#g=null;#m=[];#p=new WeakMap;#b=null;static#x=new Map;static#y=new Map;static#_=new WeakMap;static#A=null;static#k=new Set;constructor({textContentSource:t,container:s,viewport:n}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=s,this.#d=n.scale*(globalThis.devicePixelRatio||1),this.#h=n.rotation,this.#n={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:o,pageY:u}=n.rawDims;this.#b=[1,0,0,-1,-o,u+l],this.#l=r,this.#o=l,Ke.#R(),Rn(s,n),this.#t.promise.finally(()=>{Ke.#k.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:s}=We.platform;return Xt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&s?"Calibri, ":""}sans-serif`],["monospace",`${t&&s?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#u.read().then(({value:s,done:n})=>{if(n){this.#t.resolve();return}this.#a??=s.lang,Object.assign(this.#f,s.styles),this.#C(s.items),t()},this.#t.reject)};return this.#u=this.#g.getReader(),Ke.#k.add(this),t(),this.#t.promise}update({viewport:t,onBefore:s=null}){const n=t.scale*(globalThis.devicePixelRatio||1),r=t.rotation;if(r!==this.#h&&(s?.(),this.#h=r,Rn(this.#c,{rotation:r})),n!==this.#d){s?.(),this.#d=n;const l={div:null,properties:null,ctx:Ke.#T(this.#a)};for(const o of this.#m)l.properties=this.#p.get(o),l.div=o,this.#w(l)}}cancel(){const t=new sn("TextLayer task cancelled.");this.#u?.cancel(t).catch(()=>{}),this.#u=null,this.#t.reject(t)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#r}#C(t){if(this.#s)return;this.#n.ctx??=Ke.#T(this.#a);const s=this.#m,n=this.#r;for(const r of t){if(s.length>c_){qt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id!==null&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(r.str),this.#N(r)}}#N(t){const s=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#m.push(s);const r=Tt.transform(this.#b,t.transform);let l=Math.atan2(r[1],r[0]);const o=this.#f[t.fontName];o.vertical&&(l+=Math.PI/2);let u=this.#i&&o.fontSubstitution||o.fontFamily;u=Ke.fontFamilyMap.get(u)||u;const d=Math.hypot(r[2],r[3]),h=d*Ke.#O(u,this.#a);let g,b;l===0?(g=r[4],b=r[5]-h):(g=r[4]+h*Math.sin(l),b=r[5]-h*Math.cos(l));const v="calc(var(--scale-factor)*",x=s.style;this.#e===this.#c?(x.left=`${(100*g/this.#l).toFixed(2)}%`,x.top=`${(100*b/this.#o).toFixed(2)}%`):(x.left=`${v}${g.toFixed(2)}px)`,x.top=`${v}${b.toFixed(2)}px)`),x.fontSize=`${v}${(Ke.#A*d).toFixed(2)}px)`,x.fontFamily=u,n.fontSize=d,s.setAttribute("role","presentation"),s.textContent=t.str,s.dir=t.dir,this.#i&&(s.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),l!==0&&(n.angle=l*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);w!==S&&Math.max(w,S)/Math.min(w,S)>1.5&&(_=!0)}if(_&&(n.canvasWidth=o.vertical?t.height:t.width),this.#p.set(s,n),this.#n.div=s,this.#n.properties=n,this.#w(this.#n),n.hasText&&this.#e.append(s),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#w(t){const{div:s,properties:n,ctx:r}=t,{style:l}=s;let o="";if(Ke.#A>1&&(o=`scale(${1/Ke.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=l,{canvasWidth:d,fontSize:h}=n;Ke.#E(r,h*this.#d,u);const{width:g}=r.measureText(s.textContent);g>0&&(o=`scaleX(${d*this.#d/g}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(l.transform=o)}static cleanup(){if(!(this.#k.size>0)){this.#x.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#T(t=null){let s=this.#y.get(t||="");if(!s){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),s=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,s),this.#_.set(s,{size:0,family:""})}return s}static#E(t,s,n){const r=this.#_.get(t);s===r.size&&n===r.family||(t.font=`${s}px ${n}`,r.size=s,r.family=n)}static#R(){if(this.#A!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#A=t.getBoundingClientRect().height,t.remove()}static#O(t,s){const n=this.#x.get(t);if(n)return n;const r=this.#T(s);r.canvas.width=r.canvas.height=ls,this.#E(r,ls,t);const l=r.measureText("");let o=l.fontBoundingBoxAscent,u=Math.abs(l.fontBoundingBoxDescent);if(o){const g=o/(o+u);return this.#x.set(t,g),r.canvas.width=r.canvas.height=0,g}r.strokeStyle="red",r.clearRect(0,0,ls,ls),r.strokeText("g",0,0);let d=r.getImageData(0,0,ls,ls).data;u=0;for(let g=d.length-1-3;g>=0;g-=4)if(d[g]>0){u=Math.ceil(g/4/ls);break}r.clearRect(0,0,ls,ls),r.strokeText("A",0,ls),d=r.getImageData(0,0,ls,ls).data,o=0;for(let g=0,b=d.length;g<b;g+=4)if(d[g]>0){o=ls-Math.floor(g/4/ls);break}r.canvas.width=r.canvas.height=0;const h=o?o/(o+u):u_;return this.#x.set(t,h),h}}class Hr{static textContent(t){const s=[],n={items:s,styles:Object.create(null)};function r(l){if(!l)return;let o=null;const u=l.name;if(u==="#text")o=l.value;else if(Hr.shouldBuildText(u))l?.attributes?.textContent?o=l.attributes.textContent:l.value&&(o=l.value);else return;if(o!==null&&s.push({str:o}),!!l.children)for(const d of l.children)r(d)}return r(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const d_=65536,h_=100,f_=5e3,g_=Ve?T1:k1,p_=Ve?N1:C0,m_=Ve?C1:E1,b_=Ve?M1:M0;function y_(f={}){typeof f=="string"||f instanceof URL?f={url:f}:(f instanceof ArrayBuffer||ArrayBuffer.isView(f))&&(f={data:f});const t=new rh,{docId:s}=t,n=f.url?v_(f.url):null,r=f.data?x_(f.data):null,l=f.httpHeaders||null,o=f.withCredentials===!0,u=f.password??null,d=f.range instanceof F0?f.range:null,h=Number.isInteger(f.rangeChunkSize)&&f.rangeChunkSize>0?f.rangeChunkSize:d_;let g=f.worker instanceof Ea?f.worker:null;const b=f.verbosity,v=typeof f.docBaseUrl=="string"&&!Go(f.docBaseUrl)?f.docBaseUrl:null,x=typeof f.cMapUrl=="string"?f.cMapUrl:null,_=f.cMapPacked!==!1,w=f.CMapReaderFactory||p_,S=typeof f.standardFontDataUrl=="string"?f.standardFontDataUrl:null,A=f.StandardFontDataFactory||b_,E=f.stopAtErrors!==!0,N=Number.isInteger(f.maxImageSize)&&f.maxImageSize>-1?f.maxImageSize:-1,R=f.isEvalSupported!==!1,O=typeof f.isOffscreenCanvasSupported=="boolean"?f.isOffscreenCanvasSupported:!Ve,G=typeof f.isImageDecoderSupported=="boolean"?f.isImageDecoderSupported:!Ve&&(We.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(f.canvasMaxAreaInBytes)?f.canvasMaxAreaInBytes:-1,P=typeof f.disableFontFace=="boolean"?f.disableFontFace:Ve,Y=f.fontExtraProperties===!0,W=f.enableXfa===!0,gt=f.ownerDocument||globalThis.document,z=f.disableRange===!0,Q=f.disableStream===!0,T=f.disableAutoFetch===!0,lt=f.pdfBug===!0,H=f.CanvasFactory||g_,D=f.FilterFactory||m_,X=f.enableHWA===!0,q=d?d.length:f.length??NaN,ut=typeof f.useSystemFonts=="boolean"?f.useSystemFonts:!Ve&&!P,M=typeof f.useWorkerFetch=="boolean"?f.useWorkerFetch:w===C0&&A===M0&&x&&S&&Or(x,document.baseURI)&&Or(S,document.baseURI),L=null;i1(b);const J={canvasFactory:new H({ownerDocument:gt,enableHWA:X}),filterFactory:new D({docId:s,ownerDocument:gt}),cMapReaderFactory:M?null:new w({baseUrl:x,isCompressed:_}),standardFontDataFactory:M?null:new A({baseUrl:S})};if(!g){const _t={verbosity:b,port:Br.workerPort};g=_t.port?Ea.fromPort(_t):new Ea(_t),t._worker=g}const rt={docId:s,apiVersion:"4.10.38",data:r,password:u,disableAutoFetch:T,rangeChunkSize:h,length:q,docBaseUrl:v,enableXfa:W,evaluatorOptions:{maxImageSize:N,disableFontFace:P,ignoreErrors:E,isEvalSupported:R,isOffscreenCanvasSupported:O,isImageDecoderSupported:G,canvasMaxAreaInBytes:I,fontExtraProperties:Y,useSystemFonts:ut,cMapUrl:M?x:null,standardFontDataUrl:M?S:null}},nt={disableFontFace:P,fontExtraProperties:Y,ownerDocument:gt,pdfBug:lt,styleElement:L,loadingParams:{disableAutoFetch:T,enableXfa:W}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const _t=g.messageHandler.sendWithPromise("GetDocRequest",rt,r?[r.buffer]:null);let xt;if(d)xt=new Y1(d,{disableRange:z,disableStream:Q});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");let Et;if(Ve)if(Or(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Et=Wm}else Et=r_;else Et=Or(n)?Wm:e_;xt=new Et({url:n,length:q,httpHeaders:l,withCredentials:o,rangeChunkSize:h,disableRange:z,disableStream:Q})}return _t.then(Et=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ot=new zr(s,Et,g.port),At=new S_(ot,t,xt,nt,J);t._transport=At,ot.send("Ready",null)})}).catch(t._capability.reject),t}function v_(f){if(f instanceof URL)return f.href;try{return new URL(f,window.location).href}catch{if(Ve&&typeof f=="string")return f}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function x_(f){if(Ve&&typeof Buffer<"u"&&f instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength)return f;if(typeof f=="string")return Uo(f);if(f instanceof ArrayBuffer||ArrayBuffer.isView(f)||typeof f=="object"&&!isNaN(f?.length))return new Uint8Array(f);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Qm(f){return typeof f=="object"&&Number.isInteger(f?.num)&&f.num>=0&&Number.isInteger(f?.gen)&&f.gen>=0}class rh{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${rh.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}}class F0{constructor(t,s,n=!1,r=null){this.length=t,this.initialData=s,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const n of this._rangeListeners)n(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){ue("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class __{constructor(t,s){this._pdfInfo=t,this._transport=s}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Xt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:s}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(s)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class w_{#t=null;#e=!1;constructor(t,s,n,r=!1){this._pageIndex=t,this._pageInfo=s,this._transport=n,this._stats=r?new Fm:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new B0,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:l=!1}={}){return new Xr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:s,offsetX:n,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:s}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,s)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Xt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:s,intent:n="display",annotationMode:r=Qi.ENABLE,transform:l=null,background:o=null,optionalContentConfigPromise:u=null,annotationCanvasMap:d=null,pageColors:h=null,printAnnotationStorage:g=null,isEditing:b=!1}){this._stats?.time("Overall");const v=this._transport.getRenderingIntent(n,r,g,b),{renderingIntent:x,cacheKey:_}=v;this.#e=!1,this.#i(),u||=this._transport.getOptionalContentConfig(x);let w=this._intentStates.get(_);w||(w=Object.create(null),this._intentStates.set(_,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const S=!!(x&As.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(v));const A=R=>{w.renderTasks.delete(E),(this._maybeCleanupAfterRender||S)&&(this.#e=!0),this.#s(!S),R?(E.capability.reject(R),this._abortOperatorList({intentState:w,reason:R instanceof Error?R:new Error(R)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new Aa({callback:A,params:{canvasContext:t,viewport:s,transform:l,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:h});(w.renderTasks||=new Set).add(E);const N=E.task;return Promise.all([w.displayReadyCapability.promise,u]).then(([R,O])=>{if(this.destroyed){A();return}if(this._stats?.time("Rendering"),!(O.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:R,optionalContentConfig:O}),E.operatorListChanged()}).catch(A),N}getOperatorList({intent:t="display",annotationMode:s=Qi.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const o=this._transport.getRenderingIntent(t,s,n,r,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:s===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Hr.textContent(n));const s=this.streamTextContent(t);return new Promise(function(n,r){function l(){o.read().then(function({value:d,done:h}){if(h){n(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},r)}const o=s.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const n of s.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const s=this.#s(!1);return t&&s&&(this._stats&&=new Fm),s}#s(t=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#s(!1)},f_),!1;for(const{renderTasks:s,operatorList:n}of this._intentStates.values())if(s.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,s){const n=this._intentStates.get(s);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,s){for(let n=0,r=t.length;n<r;n++)s.operatorList.fnArray.push(t.fnArray[n]),s.operatorList.argsArray.push(t.argsArray[n]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const n of s.renderTasks)n.operatorListChanged();t.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageSerializable:n,modifiedIds:r}){const{map:l,transfer:o}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:l,modifiedIds:r},o).getReader(),h=this._intentStates.get(s);h.streamReader=d;const g=()=>{d.read().then(({value:b,done:v})=>{if(v){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,h),g())},b=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const v of h.renderTasks)v.operatorListChanged();this.#s(!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(b);else if(h.opListReadCapability)h.opListReadCapability.reject(b);else throw b}})};g()}_abortOperatorList({intentState:t,reason:s,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(s instanceof Qd){let r=h_;s.extraDelay>0&&s.extraDelay<1e3&&(r+=s.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:s,force:!0})},r);return}}if(t.streamReader.cancel(new sn(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class A_{#t=new Map;#e=Promise.resolve();postMessage(t,s){const n={data:structuredClone(t,s?{transfer:s}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,n)})}addEventListener(t,s,n=null){let r=null;if(n?.signal instanceof AbortSignal){const{signal:l}=n;if(l.aborted){qt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,s);r=()=>l.removeEventListener("abort",o),l.addEventListener("abort",o)}this.#t.set(s,r)}removeEventListener(t,s){this.#t.get(s)?.(),this.#t.delete(s)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}var jo,Cn,Tn,Ca,wo,Ta,Ao;const ge=class ge{constructor({name:t=null,port:s=null,verbosity:n=n1()}={}){_a(this,Ca);if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,s){if(qs(ge,Tn)?.has(s))throw new Error("Cannot use more than one PDFWorker per port.");(qs(ge,Tn)||Er(ge,Tn,new WeakMap)).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new zr("main","worker",t),this._messageHandler.on("ready",function(){}),uo(this,Ca,wo).call(this)}_initialize(){if(qs(ge,Cn)||qs(ge,Ta,Ao)){this._setupFakeWorker();return}let{workerSrc:t}=ge;try{ge._isSameOrigin(window.location.href,t)||(t=ge._createCDNWrapper(new URL(t,window.location).href));const s=new Worker(t,{type:"module"}),n=new zr("main","worker",s),r=()=>{l.abort(),n.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},l=new AbortController;s.addEventListener("error",()=>{this._webWorker||r()},{signal:l.signal}),n.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}this._messageHandler=n,this._port=s,this._webWorker=s,uo(this,Ca,wo).call(this)}),n.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};o();return}catch{Io("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){qs(ge,Cn)||(qt("Setting up fake worker."),Er(ge,Cn,!0)),ge._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new A_;this._port=s;const n=`fake${fm(ge,jo)._++}`,r=new zr(n+"_worker",n,s);t.setup(r,s),this._messageHandler=new zr(n,n+"_worker",s),uo(this,Ca,wo).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,qs(ge,Tn)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const s=qs(this,Tn)?.get(t.port);if(s){if(s._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return s}return new ge(t)}static get workerSrc(){if(Br.workerSrc)return Br.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Xt(this,"_setupFakeWorkerGlobal",(async()=>qs(this,Ta,Ao)?qs(this,Ta,Ao):(await import(this.workerSrc)).WorkerMessageHandler)())}};jo=new WeakMap,Cn=new WeakMap,Tn=new WeakMap,Ca=new WeakSet,wo=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ta=new WeakSet,Ao=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},_a(ge,Ta),_a(ge,jo,0),_a(ge,Cn,!1),_a(ge,Tn),Ve&&(Er(ge,Cn,!0),Br.workerSrc||="./pdf.worker.mjs"),ge._isSameOrigin=(t,s)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const r=new URL(s,n);return n.origin===r.origin},ge._createCDNWrapper=t=>{const s=`await import("${t}");`;return URL.createObjectURL(new Blob([s],{type:"text/javascript"}))};let Ea=ge;class S_{#t=new Map;#e=new Map;#s=new Map;#i=new Map;#a=null;constructor(t,s,n,r,l){this.messageHandler=t,this.loadingTask=s,this.commonObjs=new B0,this.fontLoader=new A1({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#n(t,s=null){const n=this.#t.get(t);if(n)return n;const r=this.messageHandler.sendWithPromise(t,s);return this.#t.set(t,r),r}get annotationStorage(){return Xt(this,"annotationStorage",new ih)}getRenderingIntent(t,s=Qi.ENABLE,n=null,r=!1,l=!1){let o=As.DISPLAY,u=Bd;switch(t){case"any":o=As.ANY;break;case"display":break;case"print":o=As.PRINT;break;default:qt(`getRenderingIntent - invalid intent: ${t}`)}const d=o&As.PRINT&&n instanceof S0?n:this.annotationStorage;switch(s){case Qi.DISABLE:o+=As.ANNOTATIONS_DISABLE;break;case Qi.ENABLE:break;case Qi.ENABLE_FORMS:o+=As.ANNOTATIONS_FORMS;break;case Qi.ENABLE_STORAGE:o+=As.ANNOTATIONS_STORAGE,u=d.serializable;break;default:qt(`getRenderingIntent - invalid annotationMode: ${s}`)}r&&(o+=As.IS_EDITING),l&&(o+=As.OPLIST);const{ids:h,hash:g}=d.modifiedIds,b=[o,u.hash,g];return{renderingIntent:o,cacheKey:b.join("_"),annotationStorageSerializable:u,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#s.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return t.push(s),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Ke.cleanup(),this._networkStream?.cancelAllRequests(new sn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(n,r)=>{Te(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:o}){if(o){r.close();return}Te(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:o}=this._fullReader;return(!r||!l)&&(this._lastProgress&&s.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{s.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:o}}),t.on("GetRangeReader",(n,r)=>{Te(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(n.begin,n.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:o,done:u}){if(u){r.close();return}Te(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{l.cancel(o),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,s._capability.resolve(new __(n,this))}),t.on("DocException",n=>{s._capability.reject(os(n))}),t.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!s.onPassword)throw os(n);const r=l=>{l instanceof Error?this.#a.reject(l):this.#a.resolve({password:l})};s.onPassword(r,n.code)}catch(r){this.#a.reject(r)}return this.#a.promise}),t.on("DataLoaded",n=>{s.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,r,l])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":const{disableFontFace:o,fontExtraProperties:u,pdfBug:d}=this._params;if("error"in l){const v=l.error;qt(`Error during font loading: ${v}`),this.commonObjs.resolve(n,v);break}const h=d&&globalThis.FontInspector?.enabled?(v,x)=>globalThis.FontInspector.fontAdded(v,x):null,g=new S1(l,{disableFontFace:o,fontExtraProperties:u,inspectFont:h});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u&&g.data&&(g.data=null),this.commonObjs.resolve(n,g)});break;case"CopyLocalImage":const{imageRef:b}=l;Te(b,"The imageRef must be defined.");for(const v of this.#e.values())for(const[,x]of v.objs)if(x?.ref===b)return x.dataLen?(this.commonObjs.resolve(n,structuredClone(x)),x.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,l);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([n,r,l,o])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(n)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(l){case"Image":u.objs.resolve(n,o),o?.dataLen>Jx&&(u._maybeCleanupAfterRender=!0);break;case"Pattern":u.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",n=>{this.destroyed||s.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),t.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&qt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:s}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},s).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,n=this.#s.get(s);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const o=new w_(s,l,this,this._params.pdfBug);return this.#e.set(s,o),o});return this.#s.set(s,r),r}getPageIndex(t){return Qm(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#n("GetOptionalContentConfig").then(s=>new X1(s,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",s=this.#t.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new q1(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const s of this.#e.values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Ke.cleanup()}}cachedPageNumber(t){if(!Qm(t))return null;const s=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(s)??null}}const Rr=Symbol("INITIAL_DATA");class B0{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Rr}}get(t,s=null){if(s){const r=this.#e(t);return r.promise.then(()=>s(r.data)),null}const n=this.#t[t];if(!n||n.data===Rr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const s=this.#t[t];return!!s&&s.data!==Rr}delete(t){const s=this.#t[t];return!s||s.data===Rr?!1:(delete this.#t[t],!0)}resolve(t,s=null){const n=this.#e(t);n.data=s,n.resolve()}clear(){for(const t in this.#t){const{data:s}=this.#t[t];s?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:s}=this.#t[t];s!==Rr&&(yield[t,s])}}}class k_{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:s}=this.#t;return t.form||t.canvas&&s?.size>0}}class Aa{#t=null;static#e=new WeakSet;constructor({callback:t,params:s,objs:n,commonObjs:r,annotationCanvasMap:l,operatorList:o,pageIndex:u,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:g=!1,pdfBug:b=!1,pageColors:v=null}){this.callback=t,this.params=s,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=b,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new k_(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){if(this.cancelled)return;if(this._canvas){if(Aa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Aa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:r,transform:l,background:o}=this.params;this.gfx=new ka(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:r,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,s=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Aa.#e.delete(this._canvas),this.callback(t||new Qd(`Rendering cancelled, page ${this._pageIndex+1}`,s))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Aa.#e.delete(this._canvas),this.callback())))}}const E_="4.10.38",C_="f9bea397f";function Jm(f){return Math.floor(Math.max(0,Math.min(1,f))*255).toString(16).padStart(2,"0")}function jr(f){return Math.max(0,Math.min(255,255*f))}class t0{static CMYK_G([t,s,n,r]){return["G",1-Math.min(1,.3*t+.59*n+.11*s+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=jr(t),[t,t,t]}static G_HTML([t]){const s=Jm(t);return`#${s}${s}${s}`}static RGB_G([t,s,n]){return["G",.3*t+.59*s+.11*n]}static RGB_rgb(t){return t.map(jr)}static RGB_HTML(t){return`#${t.map(Jm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,s,n,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,n+r),1-Math.min(1,s+r)]}static CMYK_rgb([t,s,n,r]){return[jr(1-Math.min(1,t+r)),jr(1-Math.min(1,n+r)),jr(1-Math.min(1,s+r))]}static CMYK_HTML(t){const s=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(s)}static RGB_CMYK([t,s,n]){const r=1-t,l=1-s,o=1-n,u=Math.min(r,l,o);return["CMYK",r,l,o,u]}}class T_{create(t,s,n=!1){if(t<=0||s<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${s}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${s}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ue("Abstract method `_createSVG` called.")}}class lh extends T_{_createSVG(t){return document.createElementNS(Ai,t)}}class I0{static setupStorage(t,s,n,r,l){const o=r.getValue(s,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(s,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?t.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(s,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(s,{value:u.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const u of n.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;r.setValue(s,{value:h})});break}}static setAttributes({html:t,element:s,storage:n=null,intent:r,linkService:l}){const{attributes:o}=s,u=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[d,h]of Object.entries(o))if(h!=null)switch(d){case"class":h.length&&t.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,h)}u&&l.addLinkAttributes(t,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(t,o.dataId,s,n)}static render(t){const s=t.annotationStorage,n=t.linkService,r=t.xfaHtml,l=t.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:l,linkService:n});const u=l!=="richText",d=t.div;if(d.append(o),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=b}u&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(r.children.length===0){if(r.value){const b=document.createTextNode(r.value);o.append(b),u&&Hr.shouldBuildText(r.name)&&h.push(b)}return{textDivs:h}}const g=[[r,-1,o]];for(;g.length>0;){const[b,v,x]=g.at(-1);if(v+1===b.children.length){g.pop();continue}const _=b.children[++g.at(-1)[1]];if(_===null)continue;const{name:w}=_;if(w==="#text"){const A=document.createTextNode(_.value);h.push(A),x.append(A);continue}const S=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,w):document.createElement(w);if(x.append(S),_.attributes&&this.setAttributes({html:S,element:_,storage:s,intent:l,linkService:n}),_.children?.length>0)g.push([_,-1,S]);else if(_.value){const A=document.createTextNode(_.value);u&&Hr.shouldBuildText(w)&&h.push(A),S.append(A)}}for(const b of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const s=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=s,t.div.hidden=!1}}const $r=1e3,N_=9,jn=new WeakSet;function en(f){return{width:f[2]-f[0],height:f[3]-f[1]}}class M_{static create(t){switch(t.data.annotationType){case Me.LINK:return new U0(t);case Me.TEXT:return new R_(t);case Me.WIDGET:switch(t.data.fieldType){case"Tx":return new j_(t);case"Btn":return t.data.radioButton?new H0(t):t.data.checkBox?new O_(t):new z_(t);case"Ch":return new L_(t);case"Sig":return new D_(t)}return new On(t);case Me.POPUP:return new Ud(t);case Me.FREETEXT:return new G0(t);case Me.LINE:return new F_(t);case Me.SQUARE:return new B_(t);case Me.CIRCLE:return new I_(t);case Me.POLYLINE:return new q0(t);case Me.CARET:return new H_(t);case Me.INK:return new oh(t);case Me.POLYGON:return new U_(t);case Me.HIGHLIGHT:return new V0(t);case Me.UNDERLINE:return new G_(t);case Me.SQUIGGLY:return new q_(t);case Me.STRIKEOUT:return new V_(t);case Me.STAMP:return new X0(t);case Me.FILEATTACHMENT:return new X_(t);default:return new we(t)}}}class we{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:s=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=s,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,s&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:s,richText:n}){return!!(t?.str||s?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return we._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:s}=t;s&&this.#i(s),this.#s?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:s},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:o,pageX:u,pageY:d}}}}=this;n?.splice(0,4,...t);const{width:h,height:g}=en(t);s.left=`${100*(t[0]-u)/l}%`,s.top=`${100*(o-t[3]+d)/o}%`,r===0?(s.width=`${100*h/l}%`,s.height=`${100*g/o}%`):this.setRotation(r)}_createContainer(t){const{data:s,parent:{page:n,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",s.id),this instanceof On||(l.tabIndex=$r);const{style:o}=l;if(o.zIndex=this.parent.zIndex++,s.alternativeText&&(l.title=s.alternativeText),s.noRotate&&l.classList.add("norotate"),!s.rect||this instanceof Ud){const{rotation:w}=s;return!s.hasOwnCanvas&&w!==0&&this.setRotation(w,l),l}const{width:u,height:d}=en(s.rect);if(!t&&s.borderStyle.width>0){o.borderWidth=`${s.borderStyle.width}px`;const w=s.borderStyle.horizontalCornerRadius,S=s.borderStyle.verticalCornerRadius;if(w>0||S>0){const E=`calc(${w}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;o.borderRadius=E}else if(this instanceof H0){const E=`calc(${u}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;o.borderRadius=E}switch(s.borderStyle.style){case Nr.SOLID:o.borderStyle="solid";break;case Nr.DASHED:o.borderStyle="dashed";break;case Nr.BEVELED:qt("Unimplemented border style: beveled");break;case Nr.INSET:qt("Unimplemented border style: inset");break;case Nr.UNDERLINE:o.borderBottomStyle="solid";break}const A=s.borderColor||null;A?(this.#e=!0,o.borderColor=Tt.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):o.borderWidth=0}const h=Tt.normalizeRect([s.rect[0],n.view[3]-s.rect[1]+n.view[1],s.rect[2],n.view[3]-s.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:b,pageX:v,pageY:x}=r.rawDims;o.left=`${100*(h[0]-v)/g}%`,o.top=`${100*(h[1]-x)/b}%`;const{rotation:_}=s;return s.hasOwnCanvas||_===0?(o.width=`${100*u/g}%`,o.height=`${100*d/b}%`):this.setRotation(_,l),l}setRotation(t,s=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:l,height:o}=en(this.data.rect);let u,d;t%180===0?(u=100*l/n,d=100*o/r):(u=100*o/n,d=100*l/r),s.style.width=`${u}%`,s.style.height=`${d}%`,s.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(s,n,r)=>{const l=r.detail[s],o=l[0],u=l.slice(1);r.target.style[n]=t0[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:t0[`${o}_rgb`](u)})};return Xt(this,"_commonActions",{display:s=>{const{display:n}=s.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:n}=s.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{t("bgColor","backgroundColor",s)},fillColor:s=>{t("fillColor","backgroundColor",s)},fgColor:s=>{t("fgColor","color",s)},textColor:s=>{t("textColor","color",s)},borderColor:s=>{t("borderColor","borderColor",s)},strokeColor:s=>{t("strokeColor","borderColor",s)},rotation:s=>{const n=s.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,s){const n=this._commonActions;for(const r of Object.keys(s.detail))(t[r]||n[r])?.(s)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const n=this._commonActions;for(const[r,l]of Object.entries(s)){const o=n[r];if(o){const u={detail:{[r]:l},target:t};o(u),delete s[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[s,n,r,l]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,S,A,E]=t.subarray(2,6);if(r===w&&l===S&&s===A&&n===E)return}const{style:o}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:S}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const d=r-s,h=l-n,{svgFactory:g}=this,b=g.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0);const v=g.createElement("defs");b.append(v);const x=g.createElement("clipPath"),_=`clippath_${this.data.id}`;x.setAttribute("id",_),x.setAttribute("clipPathUnits","objectBoundingBox"),v.append(x);for(let w=2,S=t.length;w<S;w+=8){const A=t[w],E=t[w+1],N=t[w+2],R=t[w+3],O=g.createElement("rect"),G=(N-s)/d,I=(l-E)/h,P=(A-N)/d,Y=(E-R)/h;O.setAttribute("x",G),O.setAttribute("y",I),O.setAttribute("width",P),O.setAttribute("height",Y),x.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${G}" y="${I}" width="${P}" height="${Y}"/>`)}this.#e&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(b),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,s=this.#s=new Ud({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(s.render())}render(){ue("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,s=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:o,exportValues:u}of r){if(l===-1||o===s)continue;const d=typeof u=="string"?u:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!jn.has(h)){qt(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:d,domElement:h})}return n}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,o=r.getAttribute("data-element-id");o!==s&&jn.has(r)&&n.push({id:o,exportValue:l,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const s of t)s.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:s})})}}class U0 extends we{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!s?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(n,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(n,t.action),r=!0):t.attachment?(this.#e(n,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(this.#s(n,t.setOCGState),r=!0):t.dest?(this._bindLink(n,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),r=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&this.#t()}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),this.#t()}#e(t,s,n=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(s.content,s.filename,n),!1),this.#t()}#s(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),this.#t()}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const l=n.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,s){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){qt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:r,refs:l,include:o}=s,u=[];if(r.length!==0||l.length!==0){const g=new Set(l);for(const b of r){const v=this._fieldObjects[b]||[];for(const{id:x}of v)g.add(x)}for(const b of Object.values(this._fieldObjects))for(const v of b)g.has(v.id)===o&&u.push(v)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const d=this.annotationStorage,h=[];for(const g of u){const{id:b}=g;switch(h.push(b),g.type){case"text":{const x=g.defaultValue||"";d.setValue(b,{value:x});break}case"checkbox":case"radiobutton":{const x=g.defaultValue===g.exportValues;d.setValue(b,{value:x});break}case"combobox":case"listbox":{const x=g.defaultValue||"";d.setValue(b,{value:x});break}default:continue}const v=document.querySelector(`[data-element-id="${b}"]`);if(v){if(!jn.has(v)){qt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class R_ extends we{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class On extends we{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return We.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,s,n,r,l){n.includes("mouse")?t.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(n,o=>{if(n==="blur"){if(!s.focused||!o.relatedTarget)return;s.focused=!1}else if(n==="focus"){if(s.focused)return;s.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(o)}})})}_setEventListeners(t,s,n,r){for(const[l,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(s||={focused:!1}),this._setEventListener(t,s,l,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,s,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,s,"focus","Focus",null))}_setBackgroundColor(t){const s=this.data.backgroundColor||null;t.style.backgroundColor=s===null?"transparent":Tt.makeHexColor(s[0],s[1],s[2])}_setTextStyle(t){const s=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||N_,l=t.style;let o;const u=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(h/(xd*r))||1,b=h/g;o=Math.min(r,d(b/xd))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(r,d(h/xd))}l.fontSize=`calc(${o}px * var(--scale-factor))`,l.color=Tt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(l.textAlign=s[this.data.textAlignment])}_setRequired(t,s){s?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",s)}}class j_ extends On{constructor(t){const s=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:s})}setPropertyOnSiblings(t,s,n,r){const l=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[s]=n),l.setValue(o.id,{[r]:n})}render(){const t=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=t.getValue(s,{value:this.data.fieldValue});let l=r.value||"";const o=t.getValue(s,{charLimit:this.data.maxLen}).charLimit;o&&l.length>o&&(l=l.slice(0,o));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",u??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),jn.add(n),n.setAttribute("data-element-id",s),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=$r,this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",g=>{t.setValue(s,{value:g.target.value}),this.setPropertyOnSiblings(n,"value",g.target.value,"value"),d.formattedValue=null}),n.addEventListener("resetform",g=>{const b=this.data.defaultFieldValue??"";n.value=d.userValue=b,d.formattedValue=null});let h=g=>{const{formattedValue:b}=d;b!=null&&(g.target.value=b),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{if(d.focused)return;const{target:v}=b;d.userValue&&(v.value=d.userValue),d.lastCommittedValue=v.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const v={value(x){d.userValue=x.detail.value??"",t.setValue(s,{value:d.userValue.toString()}),x.target.value=d.userValue},formattedValue(x){const{formattedValue:_}=x.detail;d.formattedValue=_,_!=null&&x.target!==document.activeElement&&(x.target.value=_),t.setValue(s,{formattedValue:_})},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{const{charLimit:_}=x.detail,{target:w}=x;if(_===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",_);let S=d.userValue;!S||S.length<=_||(S=S.slice(0,_),w.value=d.userValue=S,t.setValue(s,{value:S}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:S,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(v,b)}),n.addEventListener("keydown",b=>{d.commitKey=1;let v=-1;if(b.key==="Escape"?v=0:b.key==="Enter"&&!this.data.multiLine?v=2:b.key==="Tab"&&(d.commitKey=3),v===-1)return;const{value:x}=b.target;d.lastCommittedValue!==x&&(d.lastCommittedValue=x,d.userValue=x,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:x,willCommit:!0,commitKey:v,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const g=h;h=null,n.addEventListener("blur",b=>{if(!d.focused||!b.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{value:v}=b.target;d.userValue=v,d.lastCommittedValue!==v&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:v,willCommit:!0,commitKey:d.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}),g(b)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",b=>{d.lastCommittedValue=null;const{data:v,target:x}=b,{value:_,selectionStart:w,selectionEnd:S}=x;let A=w,E=S;switch(b.inputType){case"deleteWordBackward":{const N=_.substring(0,w).match(/\w*[^\w]*$/);N&&(A-=N[0].length);break}case"deleteWordForward":{const N=_.substring(w).match(/^[^\w]*\w*/);N&&(E+=N[0].length);break}case"deleteContentBackward":w===S&&(A-=1);break;case"deleteContentForward":w===S&&(E+=1);break}b.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:_,change:v||"",willCommit:!1,selStart:A,selEnd:E}})}),this._setEventListeners(n,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(h&&n.addEventListener("blur",h),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class D_ extends On{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class O_ extends On{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,s=this.data,n=s.id;let r=t.getValue(n,{value:s.exportValue===s.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return jn.add(l),l.setAttribute("data-element-id",n),l.disabled=s.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=s.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",s.exportValue),l.tabIndex=$r,l.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,n)){const g=d&&h.exportValue===s.exportValue;h.domElement&&(h.domElement.checked=g),t.setValue(h.id,{value:g})}t.setValue(n,{value:d})}),l.addEventListener("resetform",o=>{const u=s.defaultFieldValue||"Off";o.target.checked=u===s.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",o=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class H0 extends On{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,s=this.data,n=s.id;let r=t.getValue(n,{value:s.fieldValue===s.buttonValue}).value;if(typeof r=="string"&&(r=r!==s.buttonValue,t.setValue(n,{value:r})),r)for(const o of this._getElementsByName(s.fieldName,n))t.setValue(o.id,{value:!1});const l=document.createElement("input");if(jn.add(l),l.setAttribute("data-element-id",n),l.disabled=s.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=s.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=$r,l.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,n))t.setValue(h.id,{value:!1});t.setValue(n,{value:d})}),l.addEventListener("resetform",o=>{const u=s.defaultFieldValue;o.target.checked=u!=null&&u===s.buttonValue}),this.enableScripting&&this.hasJSActions){const o=s.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:h=>{const g=o===h.detail.value;for(const b of this._getElementsByName(h.target.name)){const v=g&&b.id===n;b.domElement&&(b.domElement.checked=v),t.setValue(b.id,{value:v})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class z_ extends U0{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const s=t.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class L_ extends On{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,s=this.data.id,n=t.getValue(s,{value:this.data.fieldValue}),r=document.createElement("select");jn.add(r),r.setAttribute("data-element-id",s),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=$r;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",g=>{const b=this.data.defaultFieldValue;for(const v of r.options)v.selected=v.value===b});for(const g of this.data.options){const b=document.createElement("option");b.textContent=g.displayValue,b.value=g.exportValue,n.value.includes(g.exportValue)&&(b.setAttribute("selected",!0),l=!1),r.append(b)}let o=null;if(l){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),r.prepend(g),o=()=>{g.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const u=g=>{const b=g?"value":"textContent",{options:v,multiple:x}=r;return x?Array.prototype.filter.call(v,_=>_.selected).map(_=>_[b]):v.selectedIndex===-1?null:v[v.selectedIndex][b]};let d=u(!1);const h=g=>{const b=g.target.options;return Array.prototype.map.call(b,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",g=>{const b={value(v){o?.();const x=v.detail.value,_=new Set(Array.isArray(x)?x:[x]);for(const w of r.options)w.selected=_.has(w.value);t.setValue(s,{value:u(!0)}),d=u(!1)},multipleSelection(v){r.multiple=!0},remove(v){const x=r.options,_=v.detail.remove;x[_].selected=!1,r.remove(_),x.length>0&&Array.prototype.findIndex.call(x,S=>S.selected)===-1&&(x[0].selected=!0),t.setValue(s,{value:u(!0),items:h(v)}),d=u(!1)},clear(v){for(;r.length!==0;)r.remove(0);t.setValue(s,{value:null,items:[]}),d=u(!1)},insert(v){const{index:x,displayValue:_,exportValue:w}=v.detail.insert,S=r.children[x],A=document.createElement("option");A.textContent=_,A.value=w,S?S.before(A):r.append(A),t.setValue(s,{value:u(!0),items:h(v)}),d=u(!1)},items(v){const{items:x}=v.detail;for(;r.length!==0;)r.remove(0);for(const _ of x){const{displayValue:w,exportValue:S}=_,A=document.createElement("option");A.textContent=w,A.value=S,r.append(A)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(s,{value:u(!0),items:h(v)}),d=u(!1)},indices(v){const x=new Set(v.detail.indices);for(const _ of v.target.options)_.selected=x.has(_.index);t.setValue(s,{value:u(!0)}),d=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(b,g)}),r.addEventListener("input",g=>{const b=u(!0),v=u(!1);t.setValue(s,{value:b}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:d,change:v,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):r.addEventListener("input",function(g){t.setValue(s,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ud extends we{constructor(t){const{data:s,elements:n}=t;super(t,{isRenderable:we._hasPopupData(s)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new P_({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",s.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(n=>`${Wd}${n}`).join(",")),this.container}}class P_{#t=this.#C.bind(this);#e=this.#E.bind(this);#s=this.#T.bind(this);#i=this.#w.bind(this);#a=null;#n=null;#o=null;#l=null;#u=null;#c=null;#h=null;#d=!1;#f=null;#r=null;#g=null;#m=null;#p=null;#b=null;#x=!1;constructor({container:t,color:s,elements:n,titleObj:r,modificationDate:l,contentsObj:o,richText:u,parent:d,rect:h,parentRect:g,open:b}){this.#n=t,this.#p=r,this.#o=o,this.#m=u,this.#c=d,this.#a=s,this.#g=h,this.#h=g,this.#u=n,this.#l=w0.toDateObject(l),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup());for(const v of this.trigger)v.addEventListener("click",this.#i),v.addEventListener("mouseenter",this.#s),v.addEventListener("mouseleave",this.#e),v.classList.add("popupTriggerArea");for(const v of n)v.container?.addEventListener("keydown",this.#t);this.#n.hidden=!0,b&&this.#w()}render(){if(this.#f)return;const t=this.#f=document.createElement("div");if(t.className="popup",this.#a){const l=t.style.outlineColor=Tt.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`:t.style.backgroundColor=Tt.makeHexColor(...this.#a.map(u=>Math.floor(.7*(255-u)+u)))}const s=document.createElement("span");s.className="header";const n=document.createElement("h1");if(s.append(n),{dir:n.dir,str:n.textContent}=this.#p,t.append(s),this.#l){const l=document.createElement("span");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),s.append(l)}const r=this.#y;if(r)I0.render({xfaHtml:r,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(this.#o);t.append(l)}this.#n.append(t)}get#y(){const t=this.#m,s=this.#o;return t?.str&&(!s?.str||s.str===t.str)&&this.#m.html||null}get#_(){return this.#y?.attributes?.style?.fontSize||0}get#A(){return this.#y?.attributes?.style?.color||null}#k(t){const s=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:s}]}},r={style:{color:this.#A,fontSize:this.#_?`calc(${this.#_}px * var(--scale-factor))`:""}};for(const l of t.split(`
`))s.push({name:"span",value:l,attributes:r});return n}_formatContents({str:t,dir:s}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=s;const r=t.split(/(?:\r\n?|\n)/);for(let l=0,o=r.length;l<o;++l){const u=r[l];n.append(document.createTextNode(u)),l<o-1&&n.append(document.createElement("br"))}return n}#C(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#d)&&this.#w()}updateEdited({rect:t,popupContent:s}){this.#b||={contentsObj:this.#o,richText:this.#m},t&&(this.#r=null),s&&(this.#m=this.#k(s),this.#o=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#b&&({contentsObj:this.#o,richText:this.#m}=this.#b,this.#b=null,this.#f?.remove(),this.#f=null,this.#r=null)}#N(){if(this.#r!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:l}}}=this.#c;let o=!!this.#h,u=o?this.#h:this.#g;for(const _ of this.#u)if(!u||Tt.intersect(_.data.rect,u)!==null){u=_.data.rect,o=!0;break}const d=Tt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=o?u[2]-u[0]+5:0,b=d[0]+g,v=d[1];this.#r=[100*(b-r)/s,100*(v-l)/n];const{style:x}=this.#n;x.left=`${this.#r[0]}%`,x.top=`${this.#r[1]}%`}#w(){this.#d=!this.#d,this.#d?(this.#T(),this.#n.addEventListener("click",this.#i),this.#n.addEventListener("keydown",this.#t)):(this.#E(),this.#n.removeEventListener("click",this.#i),this.#n.removeEventListener("keydown",this.#t))}#T(){this.#f||this.render(),this.isVisible?this.#d&&this.#n.classList.add("focused"):(this.#N(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#E(){this.#n.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#n.hidden=!0)}maybeShow(){this.#x&&(this.#f||this.#T(),this.#x=!1,this.#n.hidden=!1)}get isVisible(){return this.#n.hidden===!1}}class G0 extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Gt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const s of this.textContent){const n=document.createElement("span");n.textContent=s,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class F_ extends we{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:n}=en(t.rect),r=this.svgFactory.create(s,n,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class B_ extends we{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:n}=en(t.rect),r=this.svgFactory.create(s,n,!0),l=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",l/2),o.setAttribute("y",l/2),o.setAttribute("width",s-l),o.setAttribute("height",n-l),o.setAttribute("stroke-width",l||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class I_ extends we{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:n}=en(t.rect),r=this.svgFactory.create(s,n,!0),l=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",s/2),o.setAttribute("cy",n/2),o.setAttribute("rx",s/2-l/2),o.setAttribute("ry",n/2-l/2),o.setAttribute("stroke-width",l||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class q0 extends we{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:n,popupRef:r}}=this;if(!s)return this.container;const{width:l,height:o}=en(t),u=this.svgFactory.create(l,o,!0);let d=[];for(let g=0,b=s.length;g<b;g+=2){const v=s[g]-t[0],x=t[3]-s[g+1];d.push(`${v},${x}`)}d=d.join(" ");const h=this.#t=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",d),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),u.append(h),this.container.append(u),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class U_ extends q0{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class H_ extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class oh extends we{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Gt.HIGHLIGHT:Gt.INK}#s(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:n,borderStyle:r,popupRef:l}}=this,{transform:o,width:u,height:d}=this.#s(s,t),h=this.svgFactory.create(u,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");h.append(g),g.setAttribute("stroke-width",r.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",o);for(let b=0,v=n.length;b<v;b++){const x=this.svgFactory.createElement(this.svgElementName);this.#e.push(x),x.setAttribute("points",n[b].join(",")),g.append(x)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:n,rect:r}=t,l=this.#t;if(s>=0&&l.setAttribute("stroke-width",s||1),n)for(let o=0,u=this.#e.length;o<u;o++)this.#e[o].setAttribute("points",n[o].join(","));if(r){const{transform:o,width:u,height:d}=this.#s(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class V0 extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Gt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class G_ extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class q_ extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class V_ extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class X0 extends we{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Gt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class X_ extends we{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:s}=this.data;this.filename=s.filename,this.content=s.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let n;s.hasAppearance||s.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:r}=We.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!s.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Y_{#t=null;#e=null;#s=new Map;#i=null;constructor({div:t,accessibilityManager:s,annotationCanvasMap:n,annotationEditorUIManager:r,page:l,viewport:o,structTreeLayer:u}){this.div=t,this.#t=s,this.#e=n,this.#i=u||null,this.page=l,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#s.size>0}async#a(t,s){const n=t.firstChild||t,r=n.id=`${Wd}${s}`,l=await this.#i?.getAriaAttributes(r);if(l)for(const[o,u]of l)n.setAttribute(o,u);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,n,!1)}async render(t){const{annotations:s}=t,n=this.div;Rn(n,this.viewport);const r=new Map,l={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new lh,annotationStorage:t.annotationStorage||new ih,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of s){if(o.noHTML)continue;const u=o.annotationType===Me.POPUP;if(u){const g=r.get(o.id);if(!g)continue;l.elements=g}else{const{width:g,height:b}=en(o.rect);if(g<=0||b<=0)continue}l.data=o;const d=M_.create(l);if(!d.isRenderable)continue;if(!u&&o.popupRef){const g=r.get(o.popupRef);g?g.push(d):r.set(o.popupRef,[d])}const h=d.render();o.hidden&&(h.style.visibility="hidden"),await this.#a(h,o.id),d._isEditable&&(this.#s.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#n()}update({viewport:t}){const s=this.div;this.viewport=t,Rn(s,{rotation:t.rotation}),this.#n(),s.hidden=!1}#n(){if(!this.#e)return;const t=this.div;for(const[s,n]of this.#e){const r=t.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(n):l.classList.contains("annotationContent")?l.after(n):l.before(n):r.append(n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(t){return this.#s.get(t)}}const bo=/\r\n?|\n/g;class Re extends Dt{#t;#e="";#s=`${this.id}-editor`;#i=null;#a;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Re.prototype,s=l=>l.isEmpty(),n=nn.TRANSLATE_SMALL,r=nn.TRANSLATE_BIG;return Xt(this,"_keyboardManager",new Yr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static _type="freetext";static _editorType=Gt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||Re._defaultColor||Dt._defaultLineColor,this.#a=t.fontSize||Re._defaultFontSize}static initialize(t,s){Dt.initialize(t,s);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Qt.FREETEXT_SIZE:Re._defaultFontSize=s;break;case Qt.FREETEXT_COLOR:Re._defaultColor=s;break}}updateParams(t,s){switch(t){case Qt.FREETEXT_SIZE:this.#n(s);break;case Qt.FREETEXT_COLOR:this.#o(s);break}}static get defaultPropertiesToUpdate(){return[[Qt.FREETEXT_SIZE,Re._defaultFontSize],[Qt.FREETEXT_COLOR,Re._defaultColor||Dt._defaultLineColor]]}get propertiesToUpdate(){return[[Qt.FREETEXT_SIZE,this.#a],[Qt.FREETEXT_COLOR,this.#t]]}#n(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#a)*this.parentScale),this.#a=r,this.#u()},n=this.#a;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#o(t){const s=r=>{this.#t=this.editorDiv.style.color=r},n=this.#t;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Re._internalPadding*t,-(Re._internalPadding+this.#a)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Gt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#l(){const t=[];this.editorDiv.normalize();let s=null;for(const n of this.editorDiv.childNodes)s?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(Re.#c(n)),s=n);return t.join(`
`)}#u(){const[t,s]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,o=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),n=l.getBoundingClientRect(),l.remove(),l.style.display=o,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/s):(this.width=n.height/t,this.height=n.width/s),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,s=this.#e=this.#l().trimEnd();if(t===s)return;const n=r=>{if(this.#e=r,!r){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{n(s)},undo:()=>{n(t)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Re._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#a}px * var(--scale-factor))`,n.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),No(this,this.div,["dblclick","keydown"]),this.width){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[h,g]=this.pageDimensions,[b,v]=this.pageTranslation;let x,_;switch(this.rotation){case 0:x=t+(o[0]-b)/h,_=s+this.height-(o[1]-v)/g;break;case 90:x=t+(o[0]-b)/h,_=s-(o[1]-v)/g,[u,d]=[d,-u];break;case 180:x=t-this.width+(o[0]-b)/h,_=s-(o[1]-v)/g,[u,d]=[-u,-d];break;case 270:x=t+(o[0]-b-this.height*g)/h,_=s+(o[1]-v-this.width*h)/g,[u,d]=[-d,u];break}this.setAt(x*r,_*l,u,d)}else this.setAt(t*r,s*l,this.width*r,this.height*l);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(bo,"")}editorDivPaste(t){const s=t.clipboardData||window.clipboardData,{types:n}=s;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const r=Re.#f(s.getData("text")||"").replaceAll(bo,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const o=l.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=o,h=[],g=[];if(u.nodeType===Node.TEXT_NODE){const x=u.parentElement;if(g.push(u.nodeValue.slice(d).replaceAll(bo,"")),x!==this.editorDiv){let _=h;for(const w of this.editorDiv.childNodes){if(w===x){_=g;continue}_.push(Re.#c(w))}}h.push(u.nodeValue.slice(0,d).replaceAll(bo,""))}else if(u===this.editorDiv){let x=h,_=0;for(const w of this.editorDiv.childNodes)_++===d&&(x=g),x.push(Re.#c(w))}this.#e=`${h.join(`
`)}${r}${g.join(`
`)}`,this.#h();const b=new Range;let v=h.reduce((x,_)=>x+_.length,0);for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const _=x.nodeValue.length;if(v<=_){b.setStart(x,v),b.setEnd(x,v);break}v-=_}l.removeAllRanges(),l.addRange(b)}#h(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}}#d(){return this.#e.replaceAll(""," ")}static#f(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,s,n){let r=null;if(t instanceof G0){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:d,rotation:h,id:g,popupRef:b},textContent:v,textPosition:x,parent:{page:{pageNumber:_}}}=t;if(!v||v.length===0)return null;r=t={annotationType:Gt.FREETEXT,color:Array.from(u),fontSize:o,value:v.join(`
`),position:x,pageIndex:_-1,rect:d.slice(0),rotation:h,id:g,deleted:!1,popupRef:b}}const l=await super.deserialize(t,s,n);return l.#a=t.fontSize,l.#t=Tt.makeHexColor(...t.color),l.#e=Re.#f(t.value),l.annotationElementId=t.id||null,l._initialData=r,l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Re._internalPadding*this.parentScale,n=this.getRect(s,s),r=Dt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),l={annotationType:Gt.FREETEXT,color:r,fontSize:this.#a,value:this.#d(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?l:this.annotationElementId&&!this.#r(l)?null:(l.id=this.annotationElementId,l)}#r(t){const{value:s,fontSize:n,color:r,pageIndex:l}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==n||t.color.some((o,u)=>o!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:n}=s;n.fontSize=`calc(${this.#a}px * var(--scale-factor))`,n.color=this.#t,s.replaceChildren();for(const l of this.#e.split(`
`)){const o=document.createElement("div");o.append(l?document.createTextNode(l):document.createElement("br")),s.append(o)}const r=Re._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:this.#e}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class kt{static PRECISION=1e-4;toSVGPath(){ue("Abstract method `toSVGPath` must be implemented.")}get box(){ue("Abstract getter `box` must be implemented.")}serialize(t,s){ue("Abstract method `serialize` must be implemented.")}static _rescale(t,s,n,r,l,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=s+t[u]*r,o[u+1]=n+t[u+1]*l;return o}static _rescaleAndSwap(t,s,n,r,l,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=s+t[u+1]*r,o[u+1]=n+t[u]*l;return o}static _translate(t,s,n,r){r||=new Float32Array(t.length);for(let l=0,o=t.length;l<o;l+=2)r[l]=s+t[l],r[l+1]=n+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,s,n,r,l){switch(l){case 90:return[1-s/n,t/r];case 180:return[1-t/n,1-s/r];case 270:return[s/n,1-t/r];default:return[t/n,s/r]}}static _normalizePagePoint(t,s,n){switch(n){case 90:return[1-s,t];case 180:return[1-t,1-s];case 270:return[s,1-t];default:return[t,s]}}static createBezierPoints(t,s,n,r,l,o){return[(t+5*n)/6,(s+5*r)/6,(5*n+l)/6,(5*r+o)/6,(n+l)/2,(r+o)/2]}}class En{#t;#e=[];#s;#i;#a=[];#n=new Float32Array(18);#o;#l;#u;#c;#h;#d;#f=[];static#r=8;static#g=2;static#m=En.#r+En.#g;constructor({x:t,y:s},n,r,l,o,u=0){this.#t=n,this.#d=l*r,this.#i=o,this.#n.set([NaN,NaN,NaN,NaN,t,s],6),this.#s=u,this.#c=En.#r*r,this.#u=En.#m*r,this.#h=r,this.#f.push(t,s)}isEmpty(){return isNaN(this.#n[8])}#p(){const t=this.#n.subarray(4,6),s=this.#n.subarray(16,18),[n,r,l,o]=this.#t;return[(this.#o+(t[0]-s[0])/2-n)/l,(this.#l+(t[1]-s[1])/2-r)/o,(this.#o+(s[0]-t[0])/2-n)/l,(this.#l+(s[1]-t[1])/2-r)/o]}add({x:t,y:s}){this.#o=t,this.#l=s;const[n,r,l,o]=this.#t;let[u,d,h,g]=this.#n.subarray(8,12);const b=t-h,v=s-g,x=Math.hypot(b,v);if(x<this.#u)return!1;const _=x-this.#c,w=_/x,S=w*b,A=w*v;let E=u,N=d;u=h,d=g,h+=S,g+=A,this.#f?.push(t,s);const R=-A/_,O=S/_,G=R*this.#d,I=O*this.#d;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([h+G,g+I],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([h-G,g-I],16),isNaN(this.#n[6])?(this.#a.length===0&&(this.#n.set([u+G,d+I],2),this.#a.push(NaN,NaN,NaN,NaN,(u+G-n)/l,(d+I-r)/o),this.#n.set([u-G,d-I],14),this.#e.push(NaN,NaN,NaN,NaN,(u-G-n)/l,(d-I-r)/o)),this.#n.set([E,N,u,d,h,g],6),!this.isEmpty()):(this.#n.set([E,N,u,d,h,g],6),Math.abs(Math.atan2(N-d,E-u)-Math.atan2(A,S))<Math.PI/2?([u,d,h,g]=this.#n.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+h)/2-n)/l,((d+g)/2-r)/o),[u,d,E,N]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((E+u)/2-n)/l,((N+d)/2-r)/o),!0):([E,N,u,d,h,g]=this.#n.subarray(0,6),this.#a.push(((E+5*u)/6-n)/l,((N+5*d)/6-r)/o,((5*u+h)/6-n)/l,((5*d+g)/6-r)/o,((u+h)/2-n)/l,((d+g)/2-r)/o),[h,g,u,d,E,N]=this.#n.subarray(12,18),this.#e.push(((E+5*u)/6-n)/l,((N+5*d)/6-r)/o,((5*u+h)/6-n)/l,((5*d+g)/6-r)/o,((u+h)/2-n)/l,((d+g)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,s=this.#e;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#b();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(n);for(let r=s.length-6;r>=6;r-=6)isNaN(s[r])?n.push(`L${s[r+4]} ${s[r+5]}`):n.push(`C${s[r]} ${s[r+1]} ${s[r+2]} ${s[r+3]} ${s[r+4]} ${s[r+5]}`);return this.#x(n),n.join(" ")}#b(){const[t,s,n,r]=this.#t,[l,o,u,d]=this.#p();return`M${(this.#n[2]-t)/n} ${(this.#n[3]-s)/r} L${(this.#n[4]-t)/n} ${(this.#n[5]-s)/r} L${l} ${o} L${u} ${d} L${(this.#n[16]-t)/n} ${(this.#n[17]-s)/r} L${(this.#n[14]-t)/n} ${(this.#n[15]-s)/r} Z`}#x(t){const s=this.#e;t.push(`L${s[4]} ${s[5]} Z`)}#y(t){const[s,n,r,l]=this.#t,o=this.#n.subarray(4,6),u=this.#n.subarray(16,18),[d,h,g,b]=this.#p();t.push(`L${(o[0]-s)/r} ${(o[1]-n)/l} L${d} ${h} L${g} ${b} L${(u[0]-s)/r} ${(u[1]-n)/l}`)}newFreeDrawOutline(t,s,n,r,l,o){return new Y0(t,s,n,r,l,o)}getOutlines(){const t=this.#a,s=this.#e,n=this.#n,[r,l,o,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let b=0,v=d.length-2;b<v;b+=2)d[b]=(this.#f[b]-r)/o,d[b+1]=(this.#f[b+1]-l)/u;if(d[d.length-2]=(this.#o-r)/o,d[d.length-1]=(this.#l-l)/u,isNaN(n[6])&&!this.isEmpty())return this.#_(d);const h=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let b=0;b<g;b+=2){if(isNaN(t[b])){h[b]=h[b+1]=NaN;continue}h[b]=t[b],h[b+1]=t[b+1]}g=this.#k(h,g);for(let b=s.length-6;b>=6;b-=6)for(let v=0;v<6;v+=2){if(isNaN(s[b+v])){h[g]=h[g+1]=NaN,g+=2;continue}h[g]=s[b+v],h[g+1]=s[b+v+1],g+=2}return this.#A(h,g),this.newFreeDrawOutline(h,d,this.#t,this.#h,this.#s,this.#i)}#_(t){const s=this.#n,[n,r,l,o]=this.#t,[u,d,h,g]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(s[2]-n)/l,(s[3]-r)/o,NaN,NaN,NaN,NaN,(s[4]-n)/l,(s[5]-r)/o,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,g,NaN,NaN,NaN,NaN,(s[16]-n)/l,(s[17]-r)/o,NaN,NaN,NaN,NaN,(s[14]-n)/l,(s[15]-r)/o],0),this.newFreeDrawOutline(b,t,this.#t,this.#h,this.#s,this.#i)}#A(t,s){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],s),s+=6}#k(t,s){const n=this.#n.subarray(4,6),r=this.#n.subarray(16,18),[l,o,u,d]=this.#t,[h,g,b,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(n[0]-l)/u,(n[1]-o)/d,NaN,NaN,NaN,NaN,h,g,NaN,NaN,NaN,NaN,b,v,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-o)/d],s),s+=24}}class Y0 extends kt{#t;#e=new Float32Array(4);#s;#i;#a;#n;#o;constructor(t,s,n,r,l,o){super(),this.#o=t,this.#a=s,this.#t=n,this.#n=r,this.#s=l,this.#i=o,this.lastPoint=[NaN,NaN],this.#l(o);const[u,d,h,g]=this.#e;for(let b=0,v=t.length;b<v;b+=2)t[b]=(t[b]-u)/h,t[b+1]=(t[b+1]-d)/g;for(let b=0,v=s.length;b<v;b+=2)s[b]=(s[b]-u)/h,s[b+1]=(s[b+1]-d)/g}toSVGPath(){const t=[`M${this.#o[4]} ${this.#o[5]}`];for(let s=6,n=this.#o.length;s<n;s+=6){if(isNaN(this.#o[s])){t.push(`L${this.#o[s+4]} ${this.#o[s+5]}`);continue}t.push(`C${this.#o[s]} ${this.#o[s+1]} ${this.#o[s+2]} ${this.#o[s+3]} ${this.#o[s+4]} ${this.#o[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,n,r],l){const o=n-t,u=r-s;let d,h;switch(l){case 0:d=kt._rescale(this.#o,t,r,o,-u),h=kt._rescale(this.#a,t,r,o,-u);break;case 90:d=kt._rescaleAndSwap(this.#o,t,s,o,u),h=kt._rescaleAndSwap(this.#a,t,s,o,u);break;case 180:d=kt._rescale(this.#o,n,s,-o,u),h=kt._rescale(this.#a,n,s,-o,u);break;case 270:d=kt._rescaleAndSwap(this.#o,n,r,-o,-u),h=kt._rescaleAndSwap(this.#a,n,r,-o,-u);break}return{outline:Array.from(d),points:[Array.from(h)]}}#l(t){const s=this.#o;let n=s[4],r=s[5],l=n,o=r,u=n,d=r,h=n,g=r;const b=t?Math.max:Math.min;for(let x=6,_=s.length;x<_;x+=6){if(isNaN(s[x]))l=Math.min(l,s[x+4]),o=Math.min(o,s[x+5]),u=Math.max(u,s[x+4]),d=Math.max(d,s[x+5]),g<s[x+5]?(h=s[x+4],g=s[x+5]):g===s[x+5]&&(h=b(h,s[x+4]));else{const w=Tt.bezierBoundingBox(n,r,...s.slice(x,x+6));l=Math.min(l,w[0]),o=Math.min(o,w[1]),u=Math.max(u,w[2]),d=Math.max(d,w[3]),g<w[3]?(h=w[2],g=w[3]):g===w[3]&&(h=b(h,w[2]))}n=s[x+4],r=s[x+5]}const v=this.#e;v[0]=l-this.#s,v[1]=o-this.#s,v[2]=u-l+2*this.#s,v[3]=d-o+2*this.#s,this.lastPoint=[h,g]}get box(){return this.#e}newOutliner(t,s,n,r,l,o=0){return new En(t,s,n,r,l,o)}getNewOutline(t,s){const[n,r,l,o]=this.#e,[u,d,h,g]=this.#t,b=l*h,v=o*g,x=n*h+u,_=r*g+d,w=this.newOutliner({x:this.#a[0]*b+x,y:this.#a[1]*v+_},this.#t,this.#n,t,this.#i,s??this.#s);for(let S=2;S<this.#a.length;S+=2)w.add({x:this.#a[S]*b+x,y:this.#a[S+1]*v+_});return w.getOutlines()}}class Hd{#t;#e;#s=[];#i=[];constructor(t,s=0,n=0,r=!0){let l=1/0,o=-1/0,u=1/0,d=-1/0;const h=10**-4;for(const{x:S,y:A,width:E,height:N}of t){const R=Math.floor((S-s)/h)*h,O=Math.ceil((S+E+s)/h)*h,G=Math.floor((A-s)/h)*h,I=Math.ceil((A+N+s)/h)*h,P=[R,G,I,!0],Y=[O,G,I,!1];this.#s.push(P,Y),l=Math.min(l,R),o=Math.max(o,O),u=Math.min(u,G),d=Math.max(d,I)}const g=o-l+2*n,b=d-u+2*n,v=l-n,x=u-n,_=this.#s.at(r?-1:-2),w=[_[0],_[2]];for(const S of this.#s){const[A,E,N]=S;S[0]=(A-v)/g,S[1]=(E-x)/b,S[2]=(N-x)/b}this.#t=new Float32Array([v,x,g,b]),this.#e=w}getOutlines(){this.#s.sort((s,n)=>s[0]-n[0]||s[1]-n[1]||s[2]-n[2]);const t=[];for(const s of this.#s)s[3]?(t.push(...this.#u(s)),this.#o(s)):(this.#l(s),t.push(...this.#u(s)));return this.#a(t)}#a(t){const s=[],n=new Set;for(const o of t){const[u,d,h]=o;s.push([u,d,o],[u,h,o])}s.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=s.length;o<u;o+=2){const d=s[o][2],h=s[o+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const r=[];let l;for(;n.size>0;){const o=n.values().next().value;let[u,d,h,g,b]=o;n.delete(o);let v=u,x=d;for(l=[u,h],r.push(l);;){let _;if(n.has(g))_=g;else if(n.has(b))_=b;else break;n.delete(_),[u,d,h,g,b]=_,v!==u&&(l.push(v,x,u,x===d?d:h),v=u),x=x===d?h:d}l.push(v,x)}return new $_(r,this.#t,this.#e)}#n(t){const s=this.#i;let n=0,r=s.length-1;for(;n<=r;){const l=n+r>>1,o=s[l][0];if(o===t)return l;o<t?n=l+1:r=l-1}return r+1}#o([,t,s]){const n=this.#n(t);this.#i.splice(n,0,[t,s])}#l([,t,s]){const n=this.#n(t);for(let r=n;r<this.#i.length;r++){const[l,o]=this.#i[r];if(l!==t)break;if(l===t&&o===s){this.#i.splice(r,1);return}}for(let r=n-1;r>=0;r--){const[l,o]=this.#i[r];if(l!==t)break;if(l===t&&o===s){this.#i.splice(r,1);return}}}#u(t){const[s,n,r]=t,l=[[s,n,r]],o=this.#n(r);for(let u=0;u<o;u++){const[d,h]=this.#i[u];for(let g=0,b=l.length;g<b;g++){const[,v,x]=l[g];if(!(h<=v||x<=d)){if(v>=d){if(x>h)l[g][1]=h;else{if(b===1)return[];l.splice(g,1),g--,b--}continue}l[g][2]=d,x>h&&l.push([s,h,x])}}}return l}}class $_ extends kt{#t;#e;constructor(t,s,n){super(),this.#e=t,this.#t=s,this.lastPoint=n}toSVGPath(){const t=[];for(const s of this.#e){let[n,r]=s;t.push(`M${n} ${r}`);for(let l=2;l<s.length;l+=2){const o=s[l],u=s[l+1];o===n?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${o}`),n=o)}t.push("Z")}return t.join(" ")}serialize([t,s,n,r],l){const o=[],u=n-t,d=r-s;for(const h of this.#e){const g=new Array(h.length);for(let b=0;b<h.length;b+=2)g[b]=t+h[b]*u,g[b+1]=r-h[b+1]*d;o.push(g)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Gd extends En{newFreeDrawOutline(t,s,n,r,l,o){return new Z_(t,s,n,r,l,o)}}class Z_ extends Y0{newOutliner(t,s,n,r,l,o=0){return new Gd(t,s,n,r,l,o)}}class Is{#t=null;#e=null;#s;#i=null;#a=!1;#n=!1;#o=null;#l;#u=null;#c=null;#h;static#d=null;static get _keyboardManager(){return Xt(this,"_keyboardManager",new Yr([[["Escape","mac+Escape"],Is.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Is.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Is.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Is.prototype._moveToPrevious],[["Home","mac+Home"],Is.prototype._moveToBeginning],[["End","mac+End"],Is.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:s=null}){t?(this.#n=!1,this.#h=Qt.HIGHLIGHT_COLOR,this.#o=t):(this.#n=!0,this.#h=Qt.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||s,this.#l=this.#c._eventBus,this.#s=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Is.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const s=this.#c._signal;t.addEventListener("click",this.#m.bind(this),{signal:s}),t.addEventListener("keydown",this.#g.bind(this),{signal:s});const n=this.#e=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#s,t.append(n),t}renderMainDropdown(){const t=this.#i=this.#f();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#f(){const t=document.createElement("div"),s=this.#c._signal;t.addEventListener("contextmenu",Ys,{signal:s}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,r]of this.#c.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=n,l.setAttribute("data-l10n-id",Is.#d[n]);const o=document.createElement("span");l.append(o),o.className="swatch",o.style.backgroundColor=r,l.setAttribute("aria-selected",r===this.#s),l.addEventListener("click",this.#r.bind(this,r),{signal:s}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:s}),t}#r(t,s){s.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const s=t.target.getAttribute("data-color");s&&this.#r(s,t)}_moveToNext(t){if(!this.#b){this.#m(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#b&&this._hideDropdownFromKeyboard();return}this.#b||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#b){this.#m(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#b){this.#m(t);return}this.#i.lastChild?.focus()}#g(t){Is._keyboardManager.exec(this,t)}#m(t){if(this.#b){this.hideDropdown();return}if(this.#a=t.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#p.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#i){this.#i.classList.remove("hidden");return}const s=this.#i=this.#f();this.#t.append(s)}#p(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#b(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#b){this.#o?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const s=this.#c.highlightColors.values();for(const n of this.#i.children)n.setAttribute("aria-selected",s.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class _e extends Dt{#t=null;#e=0;#s;#i=null;#a=null;#n=null;#o=null;#l=0;#u=null;#c=null;#h=null;#d=!1;#f=null;#r;#g=null;#m="";#p;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Gt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=_e.prototype;return Xt(this,"_keyboardManager",new Yr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||_e._defaultColor,this.#p=t.thickness||_e._defaultThickness,this.#r=t.opacity||_e._defaultOpacity,this.#s=t.boxes||null,this.#b=t.methodOfCreation||"",this.#m=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#d=!0,this.#y(t),this.#N()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#o=t.focusNode,this.#l=t.focusOffset,this.#x(),this.#N(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#p,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#x(){const t=new Hd(this.#s,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const s=new Hd(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#n=s.getOutlines();const{lastPoint:n}=this.#n;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:s,clipPathId:n}){this.#c=t;const r=1.5;if(this.#n=t.getNewOutline(this.#p/2+r,.0025),s>=0)this.#h=s,this.#i=n,this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:_e.#w(this.#c.box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:_e.#w(this.#n.box,g),path:{d:this.#n.toSVGPath()}})}const[l,o,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=o,this.width=u,this.height=d;break;case 90:{const[g,b]=this.parentDimensions;this.x=o,this.y=1-l,this.width=u*b/g,this.height=d*g/b;break}case 180:this.x=1-l,this.y=1-o,this.width=u,this.height=d;break;case 270:{const[g,b]=this.parentDimensions;this.x=1-o,this.y=l,this.width=u*b/g,this.height=d*g/b;break}}const{lastPoint:h}=this.#n;this.#f=[(h[0]-l)/u,(h[1]-o)/d]}static initialize(t,s){Dt.initialize(t,s),_e._defaultColor||=s.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,s){switch(t){case Qt.HIGHLIGHT_DEFAULT_COLOR:_e._defaultColor=s;break;case Qt.HIGHLIGHT_THICKNESS:_e._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return this.#f}updateParams(t,s){switch(t){case Qt.HIGHLIGHT_COLOR:this.#_(s);break;case Qt.HIGHLIGHT_THICKNESS:this.#A(s);break}}static get defaultPropertiesToUpdate(){return[[Qt.HIGHLIGHT_DEFAULT_COLOR,_e._defaultColor],[Qt.HIGHLIGHT_THICKNESS,_e._defaultThickness]]}get propertiesToUpdate(){return[[Qt.HIGHLIGHT_COLOR,this.color||_e._defaultColor],[Qt.HIGHLIGHT_THICKNESS,this.#p||_e._defaultThickness],[Qt.HIGHLIGHT_FREE,this.#d]]}#_(t){const s=(l,o)=>{this.color=l,this.#r=o,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:l,"fill-opacity":o}}),this.#a?.updateColor(l)},n=this.color,r=this.#r;this.addCommands({cmd:s.bind(this,t,_e._defaultOpacity),undo:s.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#A(t){const s=this.#p,n=r=>{this.#p=r,this.#k(r)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#a=new Is({editor:this}),t.addColorPicker(this.#a)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,this.#R())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#N(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let s=!1;this.parent&&!t?this.#C():t&&(this.#N(t),s=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),s&&this.select()}#k(t){if(!this.#d)return;this.#y({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#N(t=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#r},rootClass:{highlight:!0,free:this.#d},path:{d:this.#c.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#d),this.#u&&(this.#u.style.clipPath=this.#i))}static#w([t,s,n,r],l){switch(l){case 90:return[1-s-r,t,r,n];case 180:return[1-t-n,1-s-r,n,r];case 270:return[s,1-t-n,r,n]}return[t,s,n,r]}rotate(t){const{drawLayer:s}=this.parent;let n;this.#d?(t=(t-this.rotation+360)%360,n=_e.#w(this.#c.box,t)):n=_e.#w([this.x,this.y,this.width,this.height],t),s.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":t}}),s.updateProperties(this.#g,{bbox:_e.#w(this.#n.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#m&&(t.setAttribute("aria-label",this.#m),t.setAttribute("role","mark")),this.#d?t.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});const s=this.#u=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=this.#i;const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),No(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#T(t){_e._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#E(!0);break;case 1:case 3:this.#E(!1);break}}#E(t){if(!this.#t)return;const s=window.getSelection();t?s.setPosition(this.#t,this.#e):s.setPosition(this.#o,this.#l)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#d||this.#E(!1))}get _mustFixPosition(){return!this.#d}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#R(){return this.#d?this.rotation:0}#O(){if(this.#d)return null;const[t,s]=this.pageDimensions,[n,r]=this.pageTranslation,l=this.#s,o=new Float32Array(l.length*8);let u=0;for(const{x:d,y:h,width:g,height:b}of l){const v=d*t+n,x=(1-h)*s+r;o[u]=o[u+4]=v,o[u+1]=o[u+3]=x,o[u+2]=o[u+6]=v+g*t,o[u+5]=o[u+7]=x-b*s,u+=8}return o}#L(t){return this.#c.serialize(t,this.#R())}static startHighlighting(t,s,{target:n,x:r,y:l}){const{x:o,y:u,width:d,height:h}=n.getBoundingClientRect(),g=new AbortController,b=t.combinedSignal(g),v=x=>{g.abort(),this.#v(t,x)};window.addEventListener("blur",v,{signal:b}),window.addEventListener("pointerup",v,{signal:b}),window.addEventListener("pointerdown",Ss,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Ys,{signal:b}),n.addEventListener("pointermove",this.#S.bind(this,t),{signal:b}),this._freeHighlight=new Gd({x:r,y:l},[o,u,d,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#S(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#v(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,s,n){let r=null;if(t instanceof V0){const{data:{quadPoints:_,rect:w,rotation:S,id:A,color:E,opacity:N,popupRef:R},parent:{page:{pageNumber:O}}}=t;r=t={annotationType:Gt.HIGHLIGHT,color:Array.from(E),opacity:N,quadPoints:_,boxes:null,pageIndex:O-1,rect:w.slice(0),rotation:S,id:A,deleted:!1,popupRef:R}}else if(t instanceof oh){const{data:{inkLists:_,rect:w,rotation:S,id:A,color:E,borderStyle:{rawWidth:N},popupRef:R},parent:{page:{pageNumber:O}}}=t;r=t={annotationType:Gt.HIGHLIGHT,color:Array.from(E),thickness:N,inkLists:_,boxes:null,pageIndex:O-1,rect:w.slice(0),rotation:S,id:A,deleted:!1,popupRef:R}}const{color:l,quadPoints:o,inkLists:u,opacity:d}=t,h=await super.deserialize(t,s,n);h.color=Tt.makeHexColor(...l),h.#r=d||1,u&&(h.#p=t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[g,b]=h.pageDimensions,[v,x]=h.pageTranslation;if(o){const _=h.#s=[];for(let w=0;w<o.length;w+=8)_.push({x:(o[w]-v)/g,y:1-(o[w+1]-x)/b,width:(o[w+2]-o[w])/g,height:(o[w+1]-o[w+5])/b});h.#x(),h.#N(),h.rotate(h.rotation)}else if(u){h.#d=!0;const _=u[0],w={x:_[0]-v,y:b-(_[1]-x)},S=new Gd(w,[0,0,g,b],1,h.#p/2,!0,.001);for(let N=0,R=_.length;N<R;N+=2)w.x=_[N]-v,w.y=b-(_[N+1]-x),S.add(w);const{id:A,clipPathId:E}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);h.#y({highlightOutlines:S.getOutlines(),highlightId:A,clipPathId:E}),h.#N()}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),n=Dt._colorManager.convert(this.color),r={annotationType:Gt.HIGHLIGHT,color:n,opacity:this.#r,thickness:this.#p,quadPoints:this.#O(),outlines:this.#L(s),pageIndex:this.pageIndex,rect:s,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#D(r)?null:(r.id=this.annotationElementId,r)}#D(t){const{color:s}=this._initialData;return t.color.some((n,r)=>n!==s[r])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class K_{#t=Object.create(null);updateProperty(t,s){this[t]=s,this.updateSVGProperty(t,s)}updateProperties(t){if(t)for(const[s,n]of Object.entries(t))this.updateProperty(s,n)}updateSVGProperty(t,s){this.#t[t]=s}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){ue("Not implemented")}}class jt extends Dt{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#i=null;static#a=null;static#n=NaN;static#o=null;static#l=null;static#u=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:s,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=this.#h(t,this.parent),this.#m(t.box)}#h(t,s){const{id:n}=s.drawLayer.draw(jt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,s){const n=new Set(Object.keys(t));for(const[r,l]of Object.entries(s))n.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){ue("Not implemented")}static get typesMap(){ue("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,s),this._currentParent&&(jt.#s.updateProperty(n,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)t.push([n,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[n,r]of this.constructor.typesMap)t.push([n,s[r]]);return t}_updateProperty(t,s,n){const r=this._drawingOptions,l=r[s],o=u=>{r.updateProperty(s,u);const d=this.#t.updateProperty(s,u);d&&this.#m(d),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#g()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#g()),{bbox:this.#p()}))}_onTranslating(t,s){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p(t,s)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#g(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#d()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),s=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),s&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#t,t)}}#r([t,s,n,r]){const{parentDimensions:[l,o],rotation:u}=this;switch(u){case 90:return[s,1-t,n*(o/l),r*(l/o)];case 180:return[1-t,1-s,n,r];case 270:return[1-s,t,n*(o/l),r*(l/o)];default:return[t,s,n,r]}}#g(){const{x:t,y:s,width:n,height:r,parentDimensions:[l,o],rotation:u}=this;switch(u){case 90:return[1-s,t,n*(l/o),r*(o/l)];case 180:return[1-t,1-s,n,r];case 270:return[s,1-t,n*(l/o),r*(o/l)];default:return[t,s,n,r]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#r(t),this.div){this.fixAndSetPosition();const[s,n]=this.parentDimensions;this.setDims(this.width*s,this.height*n)}this._onResized()}#p(){const{x:t,y:s,width:n,height:r,rotation:l,parentRotation:o,parentDimensions:[u,d]}=this;switch((l*4+o)/90){case 1:return[1-s-r,t,r,n];case 2:return[1-t-n,1-s-r,n,r];case 3:return[s,1-t-n,r,n];case 4:return[t,s-n*(u/d),r*(d/u),n*(u/d)];case 5:return[1-s,t,n*(u/d),r*(d/u)];case 6:return[1-t-r*(d/u),1-s,r*(d/u),n*(u/d)];case 7:return[s-n*(u/d),1-t-r*(d/u),n*(u/d),r*(d/u)];case 8:return[t-n,s-r,n,r];case 9:return[1-s,t-n,r,n];case 10:return[1-t,1-s,n,r];case 11:return[s-r,1-t,r,n];case 12:return[t-r*(d/u),s,r*(d/u),n*(u/d)];case 13:return[1-s-n*(u/d),t-r*(d/u),n*(u/d),r*(d/u)];case 14:return[1-t,1-s-n*(u/d),r*(d/u),n*(u/d)];case 15:return[s,1-t,n*(u/d),r*(d/u)];default:return[t,s,n,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,jt._mergeSVGProperties({bbox:this.#p()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,n,r,l){ue("Not implemented")}static startDrawing(t,s,n,r){const{target:l,offsetX:o,offsetY:u,pointerId:d,pointerType:h}=r;if(jt.#o&&jt.#o!==h)return;const{viewport:{rotation:g}}=t,{width:b,height:v}=l.getBoundingClientRect(),x=jt.#i=new AbortController,_=t.combinedSignal(x);if(jt.#n||=d,jt.#o??=h,window.addEventListener("pointerup",w=>{jt.#n===w.pointerId?this._endDraw(w):jt.#l?.delete(w.pointerId)},{signal:_}),window.addEventListener("pointercancel",w=>{jt.#n===w.pointerId?this._currentParent.endDrawingSession():jt.#l?.delete(w.pointerId)},{signal:_}),window.addEventListener("pointerdown",w=>{jt.#o===w.pointerType&&((jt.#l||=new Set).add(w.pointerId),jt.#s.isCancellable()&&(jt.#s.removeLastElement(),jt.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ys,{signal:_}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),l.addEventListener("touchmove",w=>{w.timeStamp===jt.#u&&Ss(w)},{signal:_}),t.toggleDrawing(),s._editorUndoBar?.hide(),jt.#s){t.drawLayer.updateProperties(this._currentDrawId,jt.#s.startNew(o,u,b,v,g));return}s.updateUIForDefaultProperties(this),jt.#s=this.createDrawerInstance(o,u,b,v,g),jt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(jt.#a.toSVGProperties(),jt.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(jt.#u=-1,!jt.#s)return;const{offsetX:s,offsetY:n,pointerId:r}=t;if(jt.#n===r){if(jt.#l?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,jt.#s.add(s,n)),jt.#u=t.timeStamp,Ss(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,jt.#s=null,jt.#a=null,jt.#o=null,jt.#u=NaN),jt.#i&&(jt.#i.abort(),jt.#i=null,jt.#n=NaN,jt.#l=null)}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,jt.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=jt.#s,r=this._currentDrawId,l=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,n.setLastElement(l))},undo:()=>{s.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:Qt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Qt.DRAW_STEP),!jt.#s.isEmpty()){const{pageDimensions:[n,r],scale:l}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:jt.#s.getOutlines(n*l,r*l,l,this._INNER_MARGIN),drawingOptions:jt.#a,mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,n,r,l,o){ue("Not implemented")}static async deserialize(t,s,n){const{rawDims:{pageWidth:r,pageHeight:l,pageX:o,pageY:u}}=s.viewport,d=this.deserializeDraw(o,u,r,l,this._INNER_MARGIN,t),h=await super.deserialize(t,s,n);return h.createDrawingOptions(t),h.#c({drawOutlines:d}),h.#f(),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,n]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([s,n,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class W_{#t=new Float64Array(6);#e;#s;#i;#a;#n;#o="";#l=0;#u=new Yo;#c;#h;constructor(t,s,n,r,l,o){this.#c=n,this.#h=r,this.#i=l,this.#a=o,[t,s]=this.#d(t,s);const u=this.#e=[NaN,NaN,NaN,NaN,t,s];this.#n=[t,s],this.#s=[{line:u,points:this.#n}],this.#t.set(u,0)}updateProperty(t,s){t==="stroke-width"&&(this.#a=s)}#d(t,s){return kt._normalizePoint(t,s,this.#c,this.#h,this.#i)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#n.length<=10}add(t,s){[t,s]=this.#d(t,s);const[n,r,l,o]=this.#t.subarray(2,6),u=t-l,d=s-o;return Math.hypot(this.#c*u,this.#h*d)<=2?null:(this.#n.push(t,s),isNaN(n)?(this.#t.set([l,o,t,s],2),this.#e.push(NaN,NaN,NaN,NaN,t,s),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,r,l,o,t,s],0),this.#e.push(...kt.createBezierPoints(n,r,l,o,t,s)),{path:{d:this.toSVGPath()}}))}end(t,s){const n=this.add(t,s);return n||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,s,n,r,l){this.#c=n,this.#h=r,this.#i=l,[t,s]=this.#d(t,s);const o=this.#e=[NaN,NaN,NaN,NaN,t,s];this.#n=[t,s];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:o,points:this.#n}),this.#t.set(o,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#n=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#u.removeLastElement();this.#s.pop(),this.#o="";for(let t=0,s=this.#s.length;t<s;t++){const{line:n,points:r}=this.#s[t];this.#e=n,this.#n=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#o}}}toSVGPath(){const t=kt.svgRound(this.#e[4]),s=kt.svgRound(this.#e[5]);if(this.#n.length===2)return this.#o=`${this.#o} M ${t} ${s} Z`,this.#o;if(this.#n.length<=6){const r=this.#o.lastIndexOf("M");this.#o=`${this.#o.slice(0,r)} M ${t} ${s}`,this.#l=6}if(this.#n.length===4){const r=kt.svgRound(this.#e[10]),l=kt.svgRound(this.#e[11]);return this.#o=`${this.#o} L ${r} ${l}`,this.#l=12,this.#o}const n=[];this.#l===0&&(n.push(`M ${t} ${s}`),this.#l=6);for(let r=this.#l,l=this.#e.length;r<l;r+=6){const[o,u,d,h,g,b]=this.#e.slice(r,r+6).map(kt.svgRound);n.push(`C${o} ${u} ${d} ${h} ${g} ${b}`)}return this.#o+=n.join(" "),this.#l=this.#e.length,this.#o}getOutlines(t,s,n,r){const l=this.#s.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#u.build(this.#s,t,s,n,this.#i,this.#a,r),this.#t=null,this.#e=null,this.#s=null,this.#o=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Yo extends kt{#t;#e=0;#s;#i;#a;#n;#o;#l;#u;build(t,s,n,r,l,o,u){this.#a=s,this.#n=n,this.#o=r,this.#l=l,this.#u=o,this.#s=u??0,this.#i=t,this.#d()}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of this.#i){if(t.push(`M${kt.svgRound(s[4])} ${kt.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${kt.svgRound(s[10])} ${kt.svgRound(s[11])}`);continue}for(let n=6,r=s.length;n<r;n+=6){const[l,o,u,d,h,g]=s.subarray(n,n+6).map(kt.svgRound);t.push(`C${l} ${o} ${u} ${d} ${h} ${g}`)}}return t.join("")}serialize([t,s,n,r],l){const o=[],u=[],[d,h,g,b]=this.#h();let v,x,_,w,S,A,E,N,R;switch(this.#l){case 0:R=kt._rescale,v=t,x=s+r,_=n,w=-r,S=t+d*n,A=s+(1-h-b)*r,E=t+(d+g)*n,N=s+(1-h)*r;break;case 90:R=kt._rescaleAndSwap,v=t,x=s,_=n,w=r,S=t+h*n,A=s+d*r,E=t+(h+b)*n,N=s+(d+g)*r;break;case 180:R=kt._rescale,v=t+n,x=s,_=-n,w=r,S=t+(1-d-g)*n,A=s+h*r,E=t+(1-d)*n,N=s+(h+b)*r;break;case 270:R=kt._rescaleAndSwap,v=t+n,x=s+r,_=-n,w=-r,S=t+(1-h-b)*n,A=s+(1-d-g)*r,E=t+(1-h)*n,N=s+(1-d)*r;break}for(const{line:O,points:G}of this.#i)o.push(R(O,v,x,_,w,l?new Array(O.length):null)),u.push(R(G,v,x,_,w,l?new Array(G.length):null));return{lines:o,points:u,rect:[S,A,E,N]}}static deserialize(t,s,n,r,l,{paths:{lines:o,points:u},rotation:d,thickness:h}){const g=[];let b,v,x,_,w;switch(d){case 0:w=kt._rescale,b=-t/n,v=s/r+1,x=1/n,_=-1/r;break;case 90:w=kt._rescaleAndSwap,b=-s/r,v=-t/n,x=1/r,_=1/n;break;case 180:w=kt._rescale,b=t/n+1,v=-s/r,x=-1/n,_=1/r;break;case 270:w=kt._rescaleAndSwap,b=s/r+1,v=t/n+1,x=-1/r,_=-1/n;break}if(!o){o=[];for(const A of u){const E=A.length;if(E===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(E===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const N=new Float32Array(3*(E-2));o.push(N);let[R,O,G,I]=A.subarray(0,4);N.set([NaN,NaN,NaN,NaN,R,O],0);for(let P=4;P<E;P+=2){const Y=A[P],W=A[P+1];N.set(kt.createBezierPoints(R,O,G,I,Y,W),(P-2)*3),[R,O,G,I]=[G,I,Y,W]}}}for(let A=0,E=o.length;A<E;A++)g.push({line:w(o[A].map(N=>N??NaN),b,v,x,_),points:w(u[A].map(N=>N??NaN),b,v,x,_)});const S=new Yo;return S.build(g,n,r,1,d,h,l),S}#c(t=this.#u){const s=this.#s+t/2*this.#o;return this.#l%180===0?[s/this.#a,s/this.#n]:[s/this.#n,s/this.#a]}#h(){const[t,s,n,r]=this.#t,[l,o]=this.#c(0);return[t+l,s+o,n-2*l,r-2*o]}#d(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,d=r.length;u<d;u+=6){const[h,g]=r.subarray(u,u+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],g),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],g)}continue}let l=r[4],o=r[5];for(let u=6,d=r.length;u<d;u+=6){const[h,g,b,v,x,_]=r.subarray(u,u+6);Tt.bezierBoundingBox(l,o,h,g,b,v,x,_,t),l=x,o=_}}const[s,n]=this.#c();t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-n)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+n)),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,s){return t==="stroke-width"?this.#f(s):null}#f(t){const[s,n]=this.#c();this.#u=t;const[r,l]=this.#c(),[o,u]=[r-s,l-n],d=this.#t;return d[0]-=o,d[1]-=u,d[2]+=2*o,d[3]+=2*u,d}updateParentDimensions([t,s],n){const[r,l]=this.#c();this.#a=t,this.#n=s,this.#o=n;const[o,u]=this.#c(),d=o-r,h=u-l,g=this.#t;return g[0]-=d,g[1]-=h,g[2]+=2*d,g[3]+=2*h,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(kt.svgRound).join(" ")}get defaultProperties(){const[t,s]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${kt.svgRound(t)} ${kt.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=this.#t;let n=0,r=0,l=0,o=0,u=0,d=0;switch(this.#e){case 90:r=s/t,l=-t/s,u=t;break;case 180:n=-1,o=-1,u=t,d=s;break;case 270:r=-s/t,l=t/s,d=s;break;default:return""}return`matrix(${n} ${r} ${l} ${o} ${kt.svgRound(u)} ${kt.svgRound(d)})`}getPathResizingSVGProperties([t,s,n,r]){const[l,o]=this.#c(),[u,d,h,g]=this.#t;if(Math.abs(h-l)<=kt.PRECISION||Math.abs(g-o)<=kt.PRECISION){const w=t+n/2-(u+h/2),S=s+r/2-(d+g/2);return{path:{"transform-origin":`${kt.svgRound(t)} ${kt.svgRound(s)}`,transform:`${this.rotationTransform} translate(${w} ${S})`}}}const b=(n-2*l)/(h-2*l),v=(r-2*o)/(g-2*o),x=h/n,_=g/r;return{path:{"transform-origin":`${kt.svgRound(u)} ${kt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${x} ${_}) translate(${kt.svgRound(l)} ${kt.svgRound(o)}) scale(${b} ${v}) translate(${kt.svgRound(-l)} ${kt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,n,r]){const[l,o]=this.#c(),u=this.#t,[d,h,g,b]=u;if(u[0]=t,u[1]=s,u[2]=n,u[3]=r,Math.abs(g-l)<=kt.PRECISION||Math.abs(b-o)<=kt.PRECISION){const S=t+n/2-(d+g/2),A=s+r/2-(h+b/2);for(const{line:E,points:N}of this.#i)kt._translate(E,S,A,E),kt._translate(N,S,A,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${kt.svgRound(t)} ${kt.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*l)/(g-2*l),x=(r-2*o)/(b-2*o),_=-v*(d+l)+t+l,w=-x*(h+o)+s+o;if(v!==1||x!==1||_!==0||w!==0)for(const{line:S,points:A}of this.#i)kt._rescale(S,_,w,v,x,S),kt._rescale(A,_,w,v,x,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${kt.svgRound(t)} ${kt.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],n){const[r,l]=n,o=this.#t,u=t-o[0],d=s-o[1];if(this.#a===r&&this.#n===l)for(const{line:h,points:g}of this.#i)kt._translate(h,u,d,h),kt._translate(g,u,d,g);else{const h=this.#a/r,g=this.#n/l;this.#a=r,this.#n=l;for(const{line:b,points:v}of this.#i)kt._rescale(b,u,d,h,g,b),kt._rescale(v,u,d,h,g,v);o[2]*=h,o[3]*=g}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${kt.svgRound(t)} ${kt.svgRound(s)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${kt.svgRound(t[0])} ${kt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class ch extends K_{#t;constructor(t){super(),this.#t=t,super.updateProperties({fill:"none",stroke:Dt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??=this["stroke-width"],s*=this.#t.realScale),super.updateSVGProperty(t,s)}clone(){const t=new ch(this.#t);return t.updateAll(this),t}}class uh extends jt{static _type="ink";static _editorType=Gt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(t,s){Dt.initialize(t,s),this._defaultDrawingOptions=new ch(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return Xt(this,"typesMap",new Map([[Qt.INK_THICKNESS,"stroke-width"],[Qt.INK_COLOR,"stroke"],[Qt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,n,r,l){return new W_(t,s,n,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,n,r,l,o){return Yo.deserialize(t,s,n,r,l,o)}static async deserialize(t,s,n){let r=null;if(t instanceof oh){const{data:{inkLists:o,rect:u,rotation:d,id:h,color:g,opacity:b,borderStyle:{rawWidth:v},popupRef:x},parent:{page:{pageNumber:_}}}=t;r=t={annotationType:Gt.INK,color:Array.from(g),thickness:v,opacity:b,paths:{points:o},boxes:null,pageIndex:_-1,rect:u.slice(0),rotation:d,id:h,deleted:!1,popupRef:x}}const l=await super.deserialize(t,s,n);return l.annotationElementId=t.id||null,l._initialData=r,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:n}=this;s.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:n}){this._drawingOptions=uh.getDefaultDrawingOptions({stroke:Tt.makeHexColor(...t),"stroke-width":s,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:n,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":o,"stroke-width":u}}=this,d={annotationType:Gt.INK,color:Dt._colorManager.convert(l),opacity:o,thickness:u,paths:{lines:s,points:n},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?d:this.annotationElementId&&!this.#t(d)?null:(d.id=this.annotationElementId,d)}#t(t){const{color:s,thickness:n,opacity:r,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,u)=>o!==s[u])||t.thickness!==n||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){const{points:s,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:s}),null}}class dh extends Dt{#t=null;#e=null;#s=null;#i=null;#a=null;#n="";#o=null;#l=null;#u=!1;#c=!1;static _type="stamp";static _editorType=Gt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile}static initialize(t,s){Dt.initialize(t,s)}static get supportedTypes(){return Xt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return Xt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(Gt.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}#h(t,s=!1){if(!t){this.remove();return}this.#t=t.bitmap,s||(this.#e=t.id,this.#u=t.isSvg),t.file&&(this.#n=t.file.name),this.#r()}#d(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#o){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:o}=t||this.copyCanvas(null,null,!0).imageData,u=await n.guess({name:"altText",request:{data:r,width:l,height:o,channels:r.length/(l*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),s&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#f(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#h(n,!0)).finally(()=>this.#d());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#h(r)).finally(()=>this.#d());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(n).then(r=>this.#h(r)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=dh.supportedTypesStr;const s=this._uiManager._signal;this.#s=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}n()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#o?.remove(),this.#o=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#f();return}super.rebuild(),this.div!==null&&(this.#e&&this.#o===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#a||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#t?this.#r():this.#f(),this.width&&!this.annotationElementId){const[n,r]=this.parentDimensions;this.setAt(t*n,s*r,this.width*n,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#m()},t)}#r(){const{div:t}=this;let{width:s,height:n}=this.#t;const[r,l]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,n=this.height*l;else if(s>o*r||n>o*l){const g=Math.min(o*r/s,o*l/n);s*=g,n*=g}const[u,d]=this.parentDimensions;this.setDims(s*u/r,n*d/l),this._uiManager.enableWaiting(!1);const h=this.#o=document.createElement("canvas");h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=n/l,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&h.setAttribute("aria-label",this.#n)}copyCanvas(t,s,n=!1){t||(t=224);const{width:r,height:l}=this.#t,o=new Fd;let u=this.#t,d=r,h=l,g=null;if(s){if(r>s||l>s){const G=Math.min(s/r,s/l);d=Math.floor(r*G),h=Math.floor(l*G)}g=document.createElement("canvas");const v=g.width=Math.ceil(d*o.sx),x=g.height=Math.ceil(h*o.sy);this.#u||(u=this.#g(v,x));const _=g.getContext("2d");_.filter=this._uiManager.hcmFilter;let w="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",S="#42414d");const A=15,E=A*o.sx,N=A*o.sy,R=new OffscreenCanvas(E*2,N*2),O=R.getContext("2d");O.fillStyle=w,O.fillRect(0,0,E*2,N*2),O.fillStyle=S,O.fillRect(0,0,E,N),O.fillRect(E,N,E,N),_.fillStyle=_.createPattern(R,"repeat"),_.fillRect(0,0,v,x),_.drawImage(u,0,0,u.width,u.height,0,0,v,x)}let b=null;if(n){let v,x;if(o.symmetric&&u.width<t&&u.height<t)v=u.width,x=u.height;else if(u=this.#t,r>t||l>t){const S=Math.min(t/r,t/l);v=Math.floor(r*S),x=Math.floor(l*S),this.#u||(u=this.#g(v,x))}const w=new OffscreenCanvas(v,x).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,v,x),b={width:v,height:x,data:w.getImageData(0,0,v,x).data}}return{canvas:g,width:d,height:h,imageData:b}}#g(t,s){const{width:n,height:r}=this.#t;let l=n,o=r,u=this.#t;for(;l>2*t||o>2*s;){const d=l,h=o;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const g=new OffscreenCanvas(l,o);g.getContext("2d").drawImage(u,0,0,d,h,0,0,l,o),u=g.transferToImageBitmap()}return u}#m(){const[t,s]=this.parentDimensions,{width:n,height:r}=this,l=new Fd,o=Math.ceil(n*t*l.sx),u=Math.ceil(r*s*l.sy),d=this.#o;if(!d||d.width===o&&d.height===u)return;d.width=o,d.height=u;const h=this.#u?this.#t:this.#g(o,u),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(h,0,0,h.width,h.height,0,0,o,u)}getImageForAltText(){return this.#o}#p(t){if(t){if(this.#u){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=this.#t,s.getContext("2d").drawImage(this.#t,0,0),s.toDataURL()}if(this.#u){const[s,n]=this.pageDimensions,r=Math.round(this.width*s*Da.PDF_TO_CSS_UNITS),l=Math.round(this.height*n*Da.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,l);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,s,n){let r=null;if(t instanceof X0){const{data:{rect:_,rotation:w,id:S,structParent:A,popupRef:E},container:N,parent:{page:{pageNumber:R}}}=t,O=N.querySelector("canvas"),G=n.imageManager.getFromCanvas(N.id,O);O.remove();const I=(await s._structTree.getAriaAttributes(`${Wd}${S}`))?.get("aria-label")||"";r=t={annotationType:Gt.STAMP,bitmapId:G.id,bitmap:G.bitmap,pageIndex:R-1,rect:_.slice(0),rotation:w,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:A,popupRef:E}}const l=await super.deserialize(t,s,n),{rect:o,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:g,accessibilityData:b}=t;h&&n.imageManager.isValidId(h)?(l.#e=h,u&&(l.#t=u)):l.#i=d,l.#u=g;const[v,x]=l.pageDimensions;return l.width=(o[2]-o[0])/v,l.height=(o[3]-o[1])/x,l.annotationElementId=t.id||null,b&&(l.altTextData=b),l._initialData=r,l.#c=!!r,l}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Gt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#u,structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=this.#p(!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(n.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#b(n);if(u.isSame)return null;u.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,s===null)return n;s.stamps||=new Map;const o=this.#u?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!s.stamps.has(this.#e))s.stamps.set(this.#e,{area:o,serialized:n}),n.bitmap=this.#p(!1);else if(this.#u){const u=s.stamps.get(this.#e);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#p(!1))}return n}#b(t){const{pageIndex:s,accessibilityData:{altText:n}}=this._initialData,r=t.pageIndex===s,l=(t.accessibilityData?.alt||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class Si{#t;#e=!1;#s=null;#i=null;#a=null;#n=new Map;#o=!1;#l=!1;#u=!1;#c=null;#h=null;#d=null;#f=null;#r;static _initialized=!1;static#g=new Map([Re,uh,dh,_e].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:s,div:n,structTreeLayer:r,accessibilityManager:l,annotationLayer:o,drawLayer:u,textLayer:d,viewport:h,l10n:g}){const b=[...Si.#g.values()];if(!Si._initialized){Si._initialized=!0;for(const v of b)v.initialize(g,t)}t.registerEditorTypes(b),this.#r=t,this.pageIndex=s,this.div=n,this.#t=l,this.#s=o,this.viewport=h,this.#d=d,this.drawLayer=u,this._structTree=r,this.#r.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#r.getMode()===Gt.NONE}updateToolbar(t){this.#r.updateToolbar(t)}updateMode(t=this.#r.getMode()){switch(this.#y(),t){case Gt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Gt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Gt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:s}=this.div;for(const n of Si.#g.values())s.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#d?.div}setEditingState(t){this.#r.setEditingState(t)}addCommands(t){this.#r.addCommands(t)}cleanUndoStack(t){this.#r.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.div.classList.toggle("disabled",!t)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of this.#n.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#r.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!this.#s){this.#u=!1;return}const s=this.#s.getEditableAnnotations();for(const n of s){if(n.hide(),this.#r.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}this.#u=!1}disable(){this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,s=new Map;for(const r of this.#n.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else s.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#s){const r=this.#s.getEditableAnnotations();for(const l of r){const{id:o}=l.data;if(this.#r.isDeletedAnnotationElement(o))continue;let u=s.get(o);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=t.get(o),u&&(this.#r.addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of Si.#g.values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#l=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#r.getActive()!==t&&this.#r.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const t=this.#r.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#m(t){this.#r.unselectAll();const{target:s}=t;if(s===this.#d.div||(s.getAttribute("role")==="img"||s.classList.contains("endOfContent"))&&this.#d.div.contains(s)){const{isMac:n}=We.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#r.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),_e.startHighlighting(this,this.#r.direction==="ltr",{target:this.#d.div,x:t.x,y:t.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#r._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#r.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const s=this.pointerup.bind(this);this.div.addEventListener("pointerup",s,{signal:t}),this.div.addEventListener("pointercancel",s,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#n.set(t.id,t);const{annotationElementId:s}=t;s&&this.#r.isDeletedAnnotationElement(s)&&this.#r.removeDeletedAnnotationElement(t)}detach(t){this.#n.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#r.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#r.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#r.addDeletedAnnotationElement(t.annotationElementId),Dt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#r.addEditor(t),this.attach(t),!t.isAttachedToDOM){const s=t.render();this.div.append(s),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#u),this.#r.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:s}=document;t.div.contains(s)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#r._signal}),s.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const s=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:s,undo:n,mustExec:!1})}getNextId(){return this.#r.getId()}get#p(){return Si.#g.get(this.#r.getMode())}combinedSignal(t){return this.#r.combinedSignal(t)}#b(t){const s=this.#p;return s?new s.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#p?.canCreateNewEmptyEditor()}pasteEditor(t,s){this.#r.updateToolbar(t),this.#r.updateMode(t);const{offsetX:n,offsetY:r}=this.#x(),l=this.getNextId(),o=this.#b({parent:this,id:l,x:n,y:r,uiManager:this.#r,isCentered:!0,...s});o&&this.add(o)}async deserialize(t){return await Si.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#r)||null}createAndAddNewEditor(t,s,n={}){const r=this.getNextId(),l=this.#b({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#r,isCentered:s,...n});return l&&this.add(l),l}#x(){const{x:t,y:s,width:n,height:r}=this.div.getBoundingClientRect(),l=Math.max(0,t),o=Math.max(0,s),u=Math.min(window.innerWidth,t+n),d=Math.min(window.innerHeight,s+r),h=(l+u)/2-t,g=(o+d)/2-s,[b,v]=this.viewport.rotation%180===0?[h,g]:[g,h];return{offsetX:b,offsetY:v}}addNewEditor(){this.createAndAddNewEditor(this.#x(),!0)}setSelected(t){this.#r.setSelected(t)}toggleSelected(t){this.#r.toggleSelected(t)}unselect(t){this.#r.unselect(t)}pointerup(t){const{isMac:s}=We.platform;if(!(t.button!==0||t.ctrlKey&&s)&&t.target===this.div&&this.#o&&(this.#o=!1,!(this.#p?.isDrawer&&this.#p.supportMultipleDrawings))){if(!this.#e){this.#e=!0;return}if(this.#r.getMode()===Gt.STAMP){this.#r.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#r.getMode()===Gt.HIGHLIGHT&&this.enableTextSelection(),this.#o){this.#o=!1;return}const{isMac:s}=We.platform;if(t.button!==0||t.ctrlKey&&s||t.target!==this.div)return;if(this.#o=!0,this.#p?.isDrawer){this.startDrawingSession(t);return}const n=this.#r.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#c){this.#p.startDrawing(this,this.#r,!1,t);return}this.#r.setCurrentDrawingSession(this),this.#c=new AbortController;const s=this.#r.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:s}),this.#p.startDrawing(this,this.#r,!1,t)}pause(t){if(t){const{activeElement:s}=document;this.div.contains(s)&&(this.#h=s);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(t=!1){return this.#c?(this.#r.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#p.endDrawing(t)):null}findNewParent(t,s,n){const r=this.#r.findParent(s,n);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#p.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#r.getActive()?.parent===this&&(this.#r.commitOrRemove(),this.#r.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#n.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#n.clear(),this.#r.removeLayer(this)}#y(){for(const t of this.#n.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Rn(this.div,t);for(const s of this.#r.getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update({viewport:t}){this.#r.commitOrRemove(),this.#y();const s=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Rn(this.div,{rotation:n}),s!==n)for(const r of this.#n.values())r.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:s}=this.viewport.rawDims;return[t,s]}get scale(){return this.#r.viewParameters.realScale}}class Ze{#t=null;#e=0;#s=new Map;#i=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#s.size>0)for(const s of this.#s.values())s.remove(),t.append(s);this.#t=t}}static get _svgFactory(){return Xt(this,"_svgFactory",new lh)}static#a(t,[s,n,r,l]){const{style:o}=t;o.top=`${100*n}%`,o.left=`${100*s}%`,o.width=`${100*r}%`,o.height=`${100*l}%`}#n(){const t=Ze._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#o(t,s){const n=Ze._svgFactory.createElement("clipPath");t.append(n);const r=`clip_${s}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const l=Ze._svgFactory.createElement("use");return n.append(l),l.setAttribute("href",`#${s}`),l.classList.add("clip"),r}#l(t,s){for(const[n,r]of Object.entries(s))r===null?t.removeAttribute(n):t.setAttribute(n,r)}draw(t,s=!1,n=!1){const r=this.#e++,l=this.#n(),o=Ze._svgFactory.createElement("defs");l.append(o);const u=Ze._svgFactory.createElement("path");o.append(u);const d=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),s&&this.#i.set(r,u);const h=n?this.#o(o,d):null,g=Ze._svgFactory.createElement("use");return l.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#s.set(r,l),{id:r,clipPathId:`url(#${h})`}}drawOutline(t,s){const n=this.#e++,r=this.#n(),l=Ze._svgFactory.createElement("defs");r.append(l);const o=Ze._svgFactory.createElement("path");l.append(o);const u=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let d;if(s){const b=Ze._svgFactory.createElement("mask");l.append(b),d=`mask_p${this.pageIndex}_${n}`,b.setAttribute("id",d),b.setAttribute("maskUnits","objectBoundingBox");const v=Ze._svgFactory.createElement("rect");b.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const x=Ze._svgFactory.createElement("use");b.append(x),x.setAttribute("href",`#${u}`),x.setAttribute("stroke","none"),x.setAttribute("fill","black"),x.setAttribute("fill-rule","nonzero"),x.classList.add("mask")}const h=Ze._svgFactory.createElement("use");r.append(h),h.setAttribute("href",`#${u}`),d&&h.setAttribute("mask",`url(#${d})`);const g=h.cloneNode();return r.append(g),h.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#s.set(n,r),n}finalizeDraw(t,s){this.#i.delete(t),this.updateProperties(t,s)}updateProperties(t,s){if(!s)return;const{root:n,bbox:r,rootClass:l,path:o}=s,u=typeof t=="number"?this.#s.get(t):t;if(u){if(n&&this.#l(u,n),r&&Ze.#a(u,r),l){const{classList:d}=u;for(const[h,g]of Object.entries(l))d.toggle(h,g)}if(o){const h=u.firstChild.firstChild;this.#l(h,o)}}}updateParent(t,s){if(s===this)return;const n=this.#s.get(t);n&&(s.#t.append(n),this.#s.delete(t),s.#s.set(t,n))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#s.get(t).remove(),this.#s.delete(t))}destroy(){this.#t=null;for(const t of this.#s.values())t.remove();this.#s.clear(),this.#i.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Hd};Pt.AbortException;Pt.AnnotationEditorLayer;Pt.AnnotationEditorParamsType;Pt.AnnotationEditorType;Pt.AnnotationEditorUIManager;Pt.AnnotationLayer;Pt.AnnotationMode;Pt.ColorPicker;Pt.DOMSVGFactory;Pt.DrawLayer;Pt.FeatureTest;var Q_=Pt.GlobalWorkerOptions;Pt.ImageKind;Pt.InvalidPDFException;Pt.MissingPDFException;Pt.OPS;Pt.OutputScale;Pt.PDFDataRangeTransport;Pt.PDFDateString;Pt.PDFWorker;Pt.PasswordResponses;Pt.PermissionFlag;Pt.PixelsPerInch;Pt.RenderingCancelledException;Pt.TextLayer;Pt.TouchManager;Pt.UnexpectedResponseException;Pt.Util;Pt.VerbosityLevel;Pt.XfaLayer;Pt.build;Pt.createValidAbsoluteUrl;Pt.fetchData;var $0=Pt.getDocument;Pt.getFilenameFromUrl;Pt.getPdfFilenameFromUrl;Pt.getXfaPageViewport;Pt.isDataScheme;Pt.isPdfFile;Pt.noContextMenu;Pt.normalizeUnicode;Pt.setLayerDimensions;Pt.shadow;Pt.stopEvent;Pt.version;const J_="/projects/quire/assets/pdf.worker.min-yatZIOMy.mjs";Q_.workerSrc=J_;const Mo=new Map;function tw(f){const t=f.length,s=f.slice(0,16),n=f.slice(-16);return`${t}-${Array.from(s).join(",")}-${Array.from(n).join(",")}`}async function Oa(f,t,s=.5){try{const n=tw(f);let r=Mo.get(n);r||(r=await $0({data:f.slice()}).promise,Mo.set(n,r));const l=await r.getPage(t+1),o=l.getViewport({scale:s}),u=document.createElement("canvas");u.width=o.width,u.height=o.height;const d=u.getContext("2d");return d?(await l.render({canvasContext:d,viewport:o}).promise,u.toDataURL("image/jpeg",.7)):null}catch{return null}}async function ew(f){try{return(await $0({data:f.slice()}).promise).numPages}catch{return 0}}function sw(){for(const f of Mo.values())f.destroy();Mo.clear()}const iw=Object.freeze(Object.defineProperty({__proto__:null,clearDocumentCache:sw,getPageCount:ew,renderPageThumbnail:Oa},Symbol.toStringTag,{value:"Module"}));class nw{queue=[];active=0;maxConcurrent=3;cancelledSet=new Set;enqueue(t,s,n){return this.cancelledSet.delete(t),this.queue=this.queue.filter(r=>r.pageIndex!==t),new Promise(r=>{const l={pageIndex:t,priority:s,renderFn:n,resolve:r};s==="high"?this.queue.unshift(l):this.queue.push(l),this.processNext()})}cancel(t){this.cancelledSet.add(t),this.queue=this.queue.filter(s=>s.pageIndex===t?(s.resolve(null),!1):!0)}cancelAll(){for(const t of this.queue)this.cancelledSet.add(t.pageIndex),t.resolve(null);this.queue=[]}async processNext(){if(this.active>=this.maxConcurrent||this.queue.length===0)return;const t=this.queue.shift();if(t){if(this.cancelledSet.has(t.pageIndex)){t.resolve(null),this.processNext();return}this.active++;try{const s=await t.renderFn();this.cancelledSet.has(t.pageIndex)?t.resolve(null):t.resolve(s)}catch{t.resolve(null)}finally{this.active--,this.processNext()}}}}const Sa=new nw;function Z0({pdfBytes:f,pageCount:t,selectedPages:s,onPageClick:n,overlayType:r="selected",rotations:l}){const[o,u]=B.useState(new Map),[d,h]=B.useState(new Map),[g,b]=B.useState(0),v=B.useRef(null),x=B.useRef(null),_=B.useCallback(S=>{h(A=>new Map(A).set(S,"loading")),Sa.enqueue(S,"high",()=>Oa(f,S)).then(A=>{A?(u(E=>new Map(E).set(S,A)),h(E=>new Map(E).set(S,"rendered"))):h(E=>new Map(E).set(S,"failed"))})},[f]);B.useEffect(()=>{Sa.cancelAll(),u(new Map),h(new Map)},[f]),B.useEffect(()=>{const S=new IntersectionObserver(E=>{for(const N of E){const R=Number(N.target.getAttribute("data-page"));isNaN(R)||N.isIntersecting&&!o.has(R)&&d.get(R)!=="loading"&&_(R)}},{rootMargin:"200px"});return x.current=S,v.current?.querySelectorAll("[data-page]")?.forEach(E=>S.observe(E)),()=>S.disconnect()},[t,_,o,d]);const w=S=>{const A=Math.floor((v.current?.clientWidth??600)/170);let E=g;if(S.key==="ArrowRight")E=Math.min(g+1,t-1);else if(S.key==="ArrowLeft")E=Math.max(g-1,0);else if(S.key==="ArrowDown")E=Math.min(g+A,t-1);else if(S.key==="ArrowUp")E=Math.max(g-A,0);else if(S.key===" "||S.key==="Enter"){S.preventDefault(),n?.(g);return}else return;S.preventDefault(),b(E)};return m.jsx("div",{ref:v,className:"grid gap-3",style:{gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))"},role:"grid",onKeyDown:w,tabIndex:0,children:Array.from({length:t},(S,A)=>{const E=d.get(A),N=o.get(A),R=s?.has(A),O=l?.[A]??0,G=g===A;return m.jsxs("div",{"data-page":A,role:"gridcell",className:`relative aspect-[3/4] rounded-lg overflow-hidden cursor-pointer border-2 transition-all ${R&&r==="selected"?"border-indigo-500 ring-2 ring-indigo-200 dark:ring-indigo-800":R&&r==="delete"?"border-red-500 ring-2 ring-red-200 dark:ring-red-800":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"} ${G?"ring-2 ring-indigo-400 dark:ring-indigo-600 ring-offset-2 dark:ring-offset-gray-900":""}`,onClick:()=>n?.(A),tabIndex:-1,children:[E==="rendered"&&N?m.jsx("img",{src:N,alt:`Page ${A+1}`,className:"w-full h-full object-cover bg-white"}):E==="failed"?m.jsxs("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-700 flex flex-col items-center justify-center",children:[m.jsx(Ir,{size:20,className:"text-amber-400 mb-1"}),m.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Page ",A+1]})]}):m.jsx("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-700 animate-pulse flex items-center justify-center",children:m.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:A+1})}),m.jsx("span",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 text-[10px] bg-black/60 text-white px-1.5 py-0.5 rounded",children:A+1}),R&&r==="selected"&&m.jsx("div",{className:"absolute inset-0 bg-indigo-500/10 dark:bg-indigo-400/20 flex items-center justify-center",children:m.jsx(qv,{size:24,className:"text-indigo-600 dark:text-indigo-400"})}),R&&r==="delete"&&m.jsx("div",{className:"absolute inset-0 bg-red-500/20 dark:bg-red-400/30 flex items-center justify-center",children:m.jsx(Dn,{size:24,className:"text-red-600 dark:text-red-400"})}),O>0&&m.jsxs("span",{className:"absolute top-1 right-1 bg-amber-500 text-white text-[10px] px-1 rounded flex items-center gap-0.5",children:[m.jsx(Xs,{size:10})," ",O,""]})]},A)})})}function $o({pageCount:f,pdfBytes:t,selectedPages:s,onSelectionChange:n,overlayType:r="selected"}){const[l,o]=B.useState(""),[u,d]=B.useState(null),h=B.useRef(void 0),g=B.useRef(!1);B.useEffect(()=>{if(g.current){g.current=!1;return}o(Hx(Array.from(s).map(E=>E+1)))},[s]);const b=B.useCallback(E=>{o(E),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(!E.trim()){n(new Set),d(null);return}const N=Po(E,f);N.error?d(N.error):(d(null),g.current=!0,n(new Set(N.pages.map(R=>R-1))))},300)},[f,n]),v=E=>{g.current=!0;const N=new Set(s);N.has(E)?N.delete(E):N.add(E),n(N)},x=()=>{g.current=!0,n(new Set(Array.from({length:f},(E,N)=>N)))},_=()=>{g.current=!0,n(new Set(Array.from({length:f},(E,N)=>N).filter(E=>(E+1)%2===0)))},w=()=>{g.current=!0,n(new Set(Array.from({length:f},(E,N)=>N).filter(E=>(E+1)%2===1)))},S=()=>{g.current=!0,n(new Set(Array.from({length:f},(E,N)=>N).filter(E=>!s.has(E))))},A=()=>{g.current=!0,n(new Set)};return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"page-range",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Page range"}),m.jsx("input",{id:"page-range",type:"text",value:l,onChange:E=>b(E.target.value),placeholder:"e.g., 1-3, 5, 8-end",className:`w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none dark:bg-gray-800 dark:text-gray-100 ${u?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600"}`}),u&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400 mt-1",children:u})]}),m.jsx(Qx,{pageCount:f,selectedCount:s.size,onSelectAll:x,onSelectEven:_,onSelectOdd:w,onInvert:S,onClear:A}),m.jsx(Z0,{pdfBytes:t,pageCount:f,selectedPages:s,onPageClick:v,overlayType:r})]})}function ds(){const{status:f,progress:t,error:s}=It();if(f==="idle")return null;const n=t&&t.total>0?Math.round(t.current/t.total*100):null,r=f==="done",l=f==="error";return m.jsxs("div",{className:"mb-4",role:"progressbar","aria-valuenow":n??(r?100:0),"aria-valuemin":0,"aria-valuemax":100,"aria-label":r?"Processing complete":l?"Processing failed":"Processing",children:[m.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:r?m.jsx("div",{className:"h-full bg-green-500 w-full transition-all duration-300"}):l?m.jsx("div",{className:"h-full bg-red-500 w-full"}):n!==null?m.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${n}%`}}):m.jsx("div",{className:"h-full bg-indigo-500 animate-pulse w-full"})}),m.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r&&m.jsxs("span",{className:"text-green-600 dark:text-green-400 flex items-center gap-1",children:[m.jsx(ko,{size:12})," Done"]}),l&&m.jsx("span",{className:"text-red-600 dark:text-red-400",children:s}),f==="processing"&&t&&`${t.step} ${t.current} of ${t.total}...`,f==="processing"&&!t&&"Processing...",f==="cancelled"&&"Cancelled"]}),f==="processing"&&m.jsxs("button",{onClick:()=>Ye.cancelAll(),className:"text-xs text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400 flex items-center gap-1 transition-colors","aria-label":"Cancel processing",children:[m.jsx(Nn,{size:12})," Cancel"]})]})]})}function aw(f){const t=f/1e3;return t<1?`${f}ms`:`${t.toFixed(1)}s`}function rw({pdfBytes:f,pageCount:t}){const[s,n]=B.useState(new Map),[r,l]=B.useState(new Set),o=B.useRef(null),u=B.useCallback(d=>{s.has(d)||r.has(d)||(l(h=>new Set(h).add(d)),Oa(f,d,1).then(h=>{h&&n(g=>new Map(g).set(d,h)),l(g=>{const b=new Set(g);return b.delete(d),b})}))},[f,s,r]);return B.useEffect(()=>{n(new Map),l(new Set)},[f]),B.useEffect(()=>{if(!o.current)return;const d=new IntersectionObserver(g=>{for(const b of g)if(b.isIntersecting){const v=Number(b.target.getAttribute("data-page-idx"));isNaN(v)||u(v)}},{rootMargin:"300px",root:null});return o.current.querySelectorAll("[data-page-idx]").forEach(g=>d.observe(g)),()=>d.disconnect()},[t,f,u]),m.jsx("div",{ref:o,className:"space-y-3 max-h-[600px] overflow-y-auto pr-1","data-testid":"page-renderer",children:Array.from({length:t},(d,h)=>{const g=s.get(h);return m.jsxs("div",{"data-page-idx":h,className:"relative",children:[g?m.jsx("img",{src:g,alt:`Page ${h+1}`,className:"w-full h-auto rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm"}):m.jsx("div",{className:"w-full aspect-[3/4] rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-100 dark:bg-gray-700 animate-pulse flex items-center justify-center",children:m.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:["Page ",h+1]})}),m.jsxs("span",{className:"absolute bottom-2 right-2 bg-black/50 text-white text-[10px] px-2 py-0.5 rounded-full backdrop-blur-sm",children:[h+1," / ",t]})]},h)})})}function hs({result:f,originalBytes:t,showOriginalToggle:s}){const[n,r]=B.useState(!1),[l,o]=B.useState(0),u=f.files.length>1,d=f.files[l],h=n&&t?t:d?.bytes,g=n&&t?f.files[0]?.pageCount??0:d?.pageCount??0,b=f.files.reduce((_,w)=>_+w.bytes.length,0),v=t?.length??0,x=v>0?(b-v)/v*100:0;return B.useEffect(()=>{o(0),r(!1)},[f]),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 space-y-4",children:[m.jsxs("div",{className:"flex items-start justify-between gap-4",children:[m.jsxs("div",{className:"space-y-1",children:[!u&&d&&m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:d.name}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[d.pageCount," page",d.pageCount!==1?"s":"","  ",Mn(d.bytes.length)]})]}),u&&m.jsxs(m.Fragment,{children:[m.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[f.files.length," files"]}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Total: ",Mn(b)]})]}),v>0&&m.jsx("p",{className:`text-xs ${x<0?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"}`,children:x<0?` ${Math.abs(x).toFixed(0)}% smaller`:x>5?` ${x.toFixed(0)}% larger`:"Similar size"}),m.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Completed in ",aw(f.processingTime)]})]}),s&&t&&m.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-1.5 text-xs text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 shrink-0",children:[n?m.jsx(Eo,{size:12}):m.jsx(Co,{size:12}),n?"Show processed":"Show original"]})]}),u&&!n&&m.jsx("div",{className:"flex gap-1 overflow-x-auto pb-1 border-b border-gray-200 dark:border-gray-700",children:f.files.map((_,w)=>m.jsxs("button",{onClick:()=>o(w),className:`flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-t-lg border border-b-0 whitespace-nowrap transition-colors ${l===w?"bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-indigo-700 dark:text-indigo-300 font-medium":"bg-transparent border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[m.jsx(Xe,{size:12}),_.name,m.jsxs("span",{className:"text-gray-400 dark:text-gray-500 ml-1",children:[_.pageCount,"p"]})]},w))}),h&&g>0&&m.jsx(rw,{pdfBytes:h,pageCount:g})]})}function fs({result:f,onReset:t}){const s=f.files.length===1;return m.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[s?m.jsxs("button",{onClick:()=>zm(f.files[0]),className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors focus-ring",children:[m.jsx(Cm,{size:16})," Download"]}):m.jsxs(m.Fragment,{children:[m.jsxs("button",{onClick:()=>Wx(f.files,"quire-output.zip"),className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors focus-ring",children:[m.jsx(Cm,{size:16})," Download All as ZIP"]}),f.files.map((n,r)=>m.jsx("button",{onClick:()=>zm(n),className:"px-3 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:n.name},r))]}),m.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2.5 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors focus-ring",children:[m.jsx(Lr,{size:16})," Process another file"]})]})}function lw(){const f=window.location.hash.replace("#","");return f==="pipeline"?{currentView:"pipeline",currentToolId:null,pipelineMode:!0}:f?{currentView:"tool",currentToolId:f,pipelineMode:!1}:{currentView:"grid",currentToolId:null,pipelineMode:!1}}const zn=Vr(f=>({...lw(),pipelineSelection:[],setView:(s,n)=>{s==="tool"&&n?(window.location.hash=`#${n}`,f({currentView:"tool",currentToolId:n})):s==="pipeline"?(window.location.hash="#pipeline",f({currentView:"pipeline",currentToolId:null,pipelineMode:!0})):(window.location.hash="",f({currentView:"grid",currentToolId:null}))},togglePipelineMode:()=>f(s=>({pipelineMode:!s.pipelineMode,pipelineSelection:[]})),togglePipelineTool:s=>f(n=>n.pipelineSelection.indexOf(s)>=0?{pipelineSelection:n.pipelineSelection.filter(l=>l!==s)}:n.pipelineSelection.length>=5?n:{pipelineSelection:[...n.pipelineSelection,s]}),clearPipelineSelection:()=>f({pipelineSelection:[]}),setPipelineSelection:s=>f({pipelineSelection:s.slice(0,5)})}));function ks({analysis:f,currentToolId:t}){const[s,n]=B.useState(!1),r=zn(g=>g.setView);if(!f||s)return null;let l=null,o=m.jsx(Zd,{size:16}),u="bg-blue-50 dark:bg-blue-950 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800",d=null,h="";if(f.isEncrypted&&t!=="unlock")l="This PDF is password-protected. Try Unlock PDF first.",o=m.jsx(Ir,{size:16}),u="bg-amber-50 dark:bg-amber-950 text-amber-700 dark:text-amber-300 border-amber-200 dark:border-amber-800",d=()=>r("tool","unlock"),h="Go to Unlock";else if(f.pageCount>=50&&t!=="split")l=`Large document (${f.pageCount} pages). Split PDF can help extract what you need.`;else if(f.hasMixedPageSizes)l="This PDF has mixed page sizes. Page Numbers and Watermark will adapt to each page.",u="bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-700";else return null;return m.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm mb-4 ${u}`,children:[o,m.jsx("span",{className:"flex-1",children:l}),d&&m.jsx("button",{onClick:d,className:"font-medium underline",children:h}),m.jsx("button",{onClick:()=>n(!0),className:"p-0.5 hover:opacity-70","aria-label":"Dismiss",children:m.jsx(Nn,{size:14})})]})}let ow={data:""},cw=f=>{if(typeof window=="object"){let t=(f?f.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(f||document.head).appendChild(t),t.firstChild}return f||ow},uw=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,dw=/\/\*[^]*?\*\/|  +/g,e0=/\n+/g,Ji=(f,t)=>{let s="",n="",r="";for(let l in f){let o=f[l];l[0]=="@"?l[1]=="i"?s=l+" "+o+";":n+=l[1]=="f"?Ji(o,l):l+"{"+Ji(o,l[1]=="k"?"":t)+"}":typeof o=="object"?n+=Ji(o,t?t.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,u):u?u+" "+d:d)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Ji.p?Ji.p(l,o):l+":"+o+";")}return s+(t&&r?t+"{"+r+"}":r)+n},wi={},K0=f=>{if(typeof f=="object"){let t="";for(let s in f)t+=s+K0(f[s]);return t}return f},hw=(f,t,s,n,r)=>{let l=K0(f),o=wi[l]||(wi[l]=(d=>{let h=0,g=11;for(;h<d.length;)g=101*g+d.charCodeAt(h++)>>>0;return"go"+g})(l));if(!wi[o]){let d=l!==f?f:(h=>{let g,b,v=[{}];for(;g=uw.exec(h.replace(dw,""));)g[4]?v.shift():g[3]?(b=g[3].replace(e0," ").trim(),v.unshift(v[0][b]=v[0][b]||{})):v[0][g[1]]=g[2].replace(e0," ").trim();return v[0]})(f);wi[o]=Ji(r?{["@keyframes "+o]:d}:d,s?"":"."+o)}let u=s&&wi.g?wi.g:null;return s&&(wi.g=wi[o]),((d,h,g,b)=>{b?h.data=h.data.replace(b,d):h.data.indexOf(d)===-1&&(h.data=g?d+h.data:h.data+d)})(wi[o],t,n,u),o},fw=(f,t,s)=>f.reduce((n,r,l)=>{let o=t[l];if(o&&o.call){let u=o(s),d=u&&u.props&&u.props.className||/^go/.test(u)&&u;o=d?"."+d:u&&typeof u=="object"?u.props?"":Ji(u,""):u===!1?"":u}return n+r+(o??"")},"");function Zo(f){let t=this||{},s=f.call?f(t.p):f;return hw(s.unshift?s.raw?fw(s,[].slice.call(arguments,1),t.p):s.reduce((n,r)=>Object.assign(n,r&&r.call?r(t.p):r),{}):s,cw(t.target),t.g,t.o,t.k)}let W0,qd,Vd;Zo.bind({g:1});let Ei=Zo.bind({k:1});function gw(f,t,s,n){Ji.p=t,W0=f,qd=s,Vd=n}function rn(f,t){let s=this||{};return function(){let n=arguments;function r(l,o){let u=Object.assign({},l),d=u.className||r.className;s.p=Object.assign({theme:qd&&qd()},u),s.o=/ *go\d+/.test(d),u.className=Zo.apply(s,n)+(d?" "+d:"");let h=f;return f[0]&&(h=u.as||f,delete u.as),Vd&&h[0]&&Vd(u),W0(h,u)}return r}}var pw=f=>typeof f=="function",Ro=(f,t)=>pw(f)?f(t):f,mw=(()=>{let f=0;return()=>(++f).toString()})(),Q0=(()=>{let f;return()=>{if(f===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");f=!t||t.matches}return f}})(),bw=20,hh="default",J0=(f,t)=>{let{toastLimit:s}=f.settings;switch(t.type){case 0:return{...f,toasts:[t.toast,...f.toasts].slice(0,s)};case 1:return{...f,toasts:f.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:n}=t;return J0(f,{type:f.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...f,toasts:f.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...f,toasts:[]}:{...f,toasts:f.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...f,pausedAt:t.time};case 6:let l=t.time-(f.pausedAt||0);return{...f,pausedAt:void 0,toasts:f.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+l}))}}},So=[],tb={toasts:[],pausedAt:void 0,settings:{toastLimit:bw}},ii={},eb=(f,t=hh)=>{ii[t]=J0(ii[t]||tb,f),So.forEach(([s,n])=>{s===t&&n(ii[t])})},sb=f=>Object.keys(ii).forEach(t=>eb(f,t)),yw=f=>Object.keys(ii).find(t=>ii[t].toasts.some(s=>s.id===f)),Ko=(f=hh)=>t=>{eb(t,f)},vw={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},xw=(f={},t=hh)=>{let[s,n]=B.useState(ii[t]||tb),r=B.useRef(ii[t]);B.useEffect(()=>(r.current!==ii[t]&&n(ii[t]),So.push([t,n]),()=>{let o=So.findIndex(([u])=>u===t);o>-1&&So.splice(o,1)}),[t]);let l=s.toasts.map(o=>{var u,d,h;return{...f,...f[o.type],...o,removeDelay:o.removeDelay||((u=f[o.type])==null?void 0:u.removeDelay)||f?.removeDelay,duration:o.duration||((d=f[o.type])==null?void 0:d.duration)||f?.duration||vw[o.type],style:{...f.style,...(h=f[o.type])==null?void 0:h.style,...o.style}}});return{...s,toasts:l}},_w=(f,t="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:f,pauseDuration:0,...s,id:s?.id||mw()}),Zr=f=>(t,s)=>{let n=_w(t,f,s);return Ko(n.toasterId||yw(n.id))({type:2,toast:n}),n.id},De=(f,t)=>Zr("blank")(f,t);De.error=Zr("error");De.success=Zr("success");De.loading=Zr("loading");De.custom=Zr("custom");De.dismiss=(f,t)=>{let s={type:3,toastId:f};t?Ko(t)(s):sb(s)};De.dismissAll=f=>De.dismiss(void 0,f);De.remove=(f,t)=>{let s={type:4,toastId:f};t?Ko(t)(s):sb(s)};De.removeAll=f=>De.remove(void 0,f);De.promise=(f,t,s)=>{let n=De.loading(t.loading,{...s,...s?.loading});return typeof f=="function"&&(f=f()),f.then(r=>{let l=t.success?Ro(t.success,r):void 0;return l?De.success(l,{id:n,...s,...s?.success}):De.dismiss(n),r}).catch(r=>{let l=t.error?Ro(t.error,r):void 0;l?De.error(l,{id:n,...s,...s?.error}):De.dismiss(n)}),f};var ww=1e3,Aw=(f,t="default")=>{let{toasts:s,pausedAt:n}=xw(f,t),r=B.useRef(new Map).current,l=B.useCallback((b,v=ww)=>{if(r.has(b))return;let x=setTimeout(()=>{r.delete(b),o({type:4,toastId:b})},v);r.set(b,x)},[]);B.useEffect(()=>{if(n)return;let b=Date.now(),v=s.map(x=>{if(x.duration===1/0)return;let _=(x.duration||0)+x.pauseDuration-(b-x.createdAt);if(_<0){x.visible&&De.dismiss(x.id);return}return setTimeout(()=>De.dismiss(x.id,t),_)});return()=>{v.forEach(x=>x&&clearTimeout(x))}},[s,n,t]);let o=B.useCallback(Ko(t),[t]),u=B.useCallback(()=>{o({type:5,time:Date.now()})},[o]),d=B.useCallback((b,v)=>{o({type:1,toast:{id:b,height:v}})},[o]),h=B.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),g=B.useCallback((b,v)=>{let{reverseOrder:x=!1,gutter:_=8,defaultPosition:w}=v||{},S=s.filter(N=>(N.position||w)===(b.position||w)&&N.height),A=S.findIndex(N=>N.id===b.id),E=S.filter((N,R)=>R<A&&N.visible).length;return S.filter(N=>N.visible).slice(...x?[E+1]:[0,E]).reduce((N,R)=>N+(R.height||0)+_,0)},[s]);return B.useEffect(()=>{s.forEach(b=>{if(b.dismissed)l(b.id,b.removeDelay);else{let v=r.get(b.id);v&&(clearTimeout(v),r.delete(b.id))}})},[s,l]),{toasts:s,handlers:{updateHeight:d,startPause:u,endPause:h,calculateOffset:g}}},Sw=Ei`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,kw=Ei`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ew=Ei`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Cw=rn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${f=>f.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Sw} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${kw} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${f=>f.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ew} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Tw=Ei`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Nw=rn("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${f=>f.secondary||"#e0e0e0"};
  border-right-color: ${f=>f.primary||"#616161"};
  animation: ${Tw} 1s linear infinite;
`,Mw=Ei`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Rw=Ei`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,jw=rn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${f=>f.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Mw} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Rw} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${f=>f.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Dw=rn("div")`
  position: absolute;
`,Ow=rn("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,zw=Ei`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Lw=rn("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${zw} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Pw=({toast:f})=>{let{icon:t,type:s,iconTheme:n}=f;return t!==void 0?typeof t=="string"?B.createElement(Lw,null,t):t:s==="blank"?null:B.createElement(Ow,null,B.createElement(Nw,{...n}),s!=="loading"&&B.createElement(Dw,null,s==="error"?B.createElement(Cw,{...n}):B.createElement(jw,{...n})))},Fw=f=>`
0% {transform: translate3d(0,${f*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Bw=f=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${f*-150}%,-1px) scale(.6); opacity:0;}
`,Iw="0%{opacity:0;} 100%{opacity:1;}",Uw="0%{opacity:1;} 100%{opacity:0;}",Hw=rn("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Gw=rn("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,qw=(f,t)=>{let s=f.includes("top")?1:-1,[n,r]=Q0()?[Iw,Uw]:[Fw(s),Bw(s)];return{animation:t?`${Ei(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ei(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Vw=B.memo(({toast:f,position:t,style:s,children:n})=>{let r=f.height?qw(f.position||t||"top-center",f.visible):{opacity:0},l=B.createElement(Pw,{toast:f}),o=B.createElement(Gw,{...f.ariaProps},Ro(f.message,f));return B.createElement(Hw,{className:f.className,style:{...r,...s,...f.style}},typeof n=="function"?n({icon:l,message:o}):B.createElement(B.Fragment,null,l,o))});gw(B.createElement);var Xw=({id:f,className:t,style:s,onHeightUpdate:n,children:r})=>{let l=B.useCallback(o=>{if(o){let u=()=>{let d=o.getBoundingClientRect().height;n(f,d)};u(),new MutationObserver(u).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[f,n]);return B.createElement("div",{ref:l,className:t,style:s},r)},Yw=(f,t)=>{let s=f.includes("top"),n=s?{top:0}:{bottom:0},r=f.includes("center")?{justifyContent:"center"}:f.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Q0()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(s?1:-1)}px)`,...n,...r}},$w=Zo`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,yo=16,Zw=({reverseOrder:f,position:t="top-center",toastOptions:s,gutter:n,children:r,toasterId:l,containerStyle:o,containerClassName:u})=>{let{toasts:d,handlers:h}=Aw(s,l);return B.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:yo,left:yo,right:yo,bottom:yo,pointerEvents:"none",...o},className:u,onMouseEnter:h.startPause,onMouseLeave:h.endPause},d.map(g=>{let b=g.position||t,v=h.calculateOffset(g,{reverseOrder:f,gutter:n,defaultPosition:t}),x=Yw(b,v);return B.createElement(Xw,{id:g.id,key:g.id,onHeightUpdate:h.updateHeight,className:g.visible?$w:"",style:x},g.type==="custom"?Ro(g.message,g):r?r(g):B.createElement(Vw,{toast:g,position:b}))}))},Qe=De;function Kw(){const[f,t]=B.useState([]),[s,n]=B.useState(new Set),[r,l]=B.useState("single"),[o,u]=B.useState(""),[d,h]=B.useState(null),g=It(E=>E.status),b=f[0]??null,v=B.useMemo(()=>b?{isEncrypted:b.isEncrypted,pageCount:b.pageCount,hasMixedPageSizes:!1}:null,[b]),x=B.useMemo(()=>{if(r!=="separate"||!b||!o.trim())return null;const E=o.split(",").map(R=>R.trim()).filter(Boolean),N=[];for(const R of E){const O=Po(R,b.pageCount);if(O.error)return{error:O.error,ranges:[]};N.push(O.pages.map(G=>G-1))}return{error:null,ranges:N}},[r,o,b]),_=B.useMemo(()=>b?r==="single"?s.size>0:r==="separate"?x!==null&&!x.error&&x.ranges.length>0:!1:!1,[b,r,s,x]),w=B.useCallback(E=>{t(E),n(new Set),u(""),h(null),It.getState().reset()},[]),S=B.useCallback(async()=>{if(!b||!_)return;let E;if(r==="single")E=[Array.from(s).sort((N,R)=>N-R)];else{if(!x||x.error)return;E=x.ranges}try{const N=await Ye.process("split",[b.bytes],{mode:r,ranges:E});h(N)}catch(N){const R=N instanceof Error?N.message:String(N);Qe.error(R)}},[b,_,r,s,x]),A=B.useCallback(()=>{t([]),n(new Set),l("single"),u(""),h(null),It.getState().reset()},[]);return d?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:d}),m.jsx(fs,{result:d,onReset:A})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:w}),b&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:v,currentToolId:"split"}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[b.pageCount," page",b.pageCount!==1?"s":"",r==="single"&&s.size>0&&`  ${s.size} selected`]}),m.jsxs("div",{className:"flex items-center gap-2",children:[r==="single"&&s.size>0&&m.jsx("button",{onClick:()=>n(new Set),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Reset Selection"}),m.jsxs("button",{onClick:S,disabled:!_||g==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Ra,{size:14}),g==="processing"?"Processing...":"Split PDF"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Split mode"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>l("single"),className:`px-4 py-2 text-sm rounded-lg border transition-colors ${r==="single"?"bg-indigo-50 border-indigo-300 text-indigo-700 font-medium dark:bg-indigo-950 dark:border-indigo-700 dark:text-indigo-300":"border-gray-200 text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-800"}`,children:"Extract pages"}),m.jsx("button",{onClick:()=>l("separate"),className:`px-4 py-2 text-sm rounded-lg border transition-colors ${r==="separate"?"bg-indigo-50 border-indigo-300 text-indigo-700 font-medium dark:bg-indigo-950 dark:border-indigo-700 dark:text-indigo-300":"border-gray-200 text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-800"}`,children:"Split into ranges"})]})]}),r==="single"&&m.jsx($o,{pageCount:b.pageCount,pdfBytes:b.bytes,selectedPages:s,onSelectionChange:n,overlayType:"selected"}),r==="separate"&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"split-ranges",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Page ranges (comma-separated)"}),m.jsx("input",{id:"split-ranges",type:"text",value:o,onChange:E=>u(E.target.value),placeholder:"e.g., 1-3, 4-7, 8-end",className:`w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none ${x?.error?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100"}`}),x?.error&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400",children:x.error}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:'Each comma-separated range will become a separate PDF file. Use "end" for the last page.'})]}),m.jsx(ds,{}),m.jsxs("button",{onClick:S,disabled:!_||g==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Ra,{size:16}),g==="processing"?"Processing...":"Split PDF"]}),"      "]})]})}function Ww(){const[f,t]=B.useState([]),[s,n]=B.useState(null),r=It(x=>x.status),l=B.useMemo(()=>f.reduce((x,_)=>x+_.pageCount,0),[f]),o=B.useMemo(()=>f.length===0?null:{isEncrypted:f.some(x=>x.isEncrypted),pageCount:l,hasMixedPageSizes:!1},[f,l]),u=f.length>=2,d=B.useCallback(x=>{t(x),n(null),It.getState().reset()},[]),h=B.useCallback((x,_)=>{t(w=>{const S=[...w],A=_==="up"?x-1:x+1;return A<0||A>=S.length?w:([S[x],S[A]]=[S[A],S[x]],S)})},[]),g=B.useCallback(x=>{t(_=>_.filter((S,A)=>A!==x))},[]),b=B.useCallback(async()=>{if(f.length<2){Qe.error(ja.MERGE_MIN_FILES);return}try{const x=await Ye.process("merge",f.map(_=>_.bytes),{order:f.map((_,w)=>w)});n(x)}catch(x){const _=x instanceof Error?x.message:String(x);Qe.error(_)}},[f]),v=B.useCallback(()=>{t([]),n(null),It.getState().reset()},[]);return s?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:s}),m.jsx(fs,{result:s,onReset:v})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:d,multiple:!0}),f.length>0&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:o,currentToolId:"merge"}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[f.length," file",f.length!==1?"s":"","  ",l," total page",l!==1?"s":""]}),m.jsxs("button",{onClick:b,disabled:!u||r==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Em,{size:14}),r==="processing"?"Processing...":"Merge PDFs"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["File order (",f.length," file",f.length!==1?"s":"",")"]}),m.jsx("div",{className:"space-y-1",children:f.map((x,_)=>m.jsxs("div",{className:"flex items-center gap-2 border border-gray-200 dark:border-gray-700 rounded-lg p-3 bg-white dark:bg-gray-800",children:[m.jsx("span",{className:"text-xs font-mono text-gray-400 dark:text-gray-500 w-6 text-center shrink-0",children:_+1}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:x.name}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.pageCount," page",x.pageCount!==1?"s":"","  ",Mn(x.fileSize)]})]}),m.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[m.jsx("button",{onClick:()=>h(_,"up"),disabled:_===0,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":`Move ${x.name} up`,children:m.jsx(d0,{size:16,className:"text-gray-500 dark:text-gray-400"})}),m.jsx("button",{onClick:()=>h(_,"down"),disabled:_===f.length-1,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":`Move ${x.name} down`,children:m.jsx(u0,{size:16,className:"text-gray-500 dark:text-gray-400"})}),m.jsx("button",{onClick:()=>g(_),className:"p-1 rounded hover:bg-red-50 dark:hover:bg-red-950 transition-colors","aria-label":`Remove ${x.name}`,children:m.jsx(Dn,{size:16,className:"text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400"})})]})]},x.id))}),m.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Total: ",l," page",l!==1?"s":""]})]}),m.jsx(ds,{}),m.jsxs("button",{onClick:b,disabled:!u||r==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Em,{size:16}),r==="processing"?"Processing...":"Merge PDFs"]}),"      "]})]})}function Qw(){const[f,t]=B.useState([]),[s,n]=B.useState({}),[r,l]=B.useState(null),o=It(A=>A.status),u=f[0]??null,d=B.useMemo(()=>u?{isEncrypted:u.isEncrypted,pageCount:u.pageCount,hasMixedPageSizes:!1}:null,[u]),h=B.useMemo(()=>Object.values(s).some(A=>A!==0),[s]),g=B.useCallback(A=>{t(A),n({}),l(null),It.getState().reset()},[]),b=B.useCallback(A=>{n(E=>{const R=((E[A]??0)+90)%360;if(R===0){const O={...E};return delete O[A],O}return{...E,[A]:R}})},[]),v=B.useCallback(A=>{u&&n(E=>{const N={};for(let R=0;R<u.pageCount;R++){const G=(((E[R]??0)+A)%360+360)%360;G!==0&&(N[R]=G)}return N})},[u]),x=B.useCallback((A,E)=>{u&&n(N=>{const R={...N};for(let O=0;O<u.pageCount;O++){const G=O+1;if(A==="even"?G%2===0:G%2===1){const Y=(((R[O]??0)+E)%360+360)%360;Y===0?delete R[O]:R[O]=Y}}return R})},[u]),_=B.useCallback(()=>{n({})},[]),w=B.useCallback(async()=>{if(!(!u||!h))try{const A=await Ye.process("rotate",[u.bytes],{rotations:s});l(A)}catch(A){const E=A instanceof Error?A.message:String(A);Qe.error(E)}},[u,h,s]),S=B.useCallback(()=>{t([]),n({}),l(null),It.getState().reset()},[]);return r?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:r,originalBytes:u?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:r,onReset:S})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:g}),u&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:d,currentToolId:"rotate"}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u.pageCount," page",u.pageCount!==1?"s":"",h&&`  ${Object.keys(s).length} rotated`]}),m.jsxs("button",{onClick:w,disabled:!h||o==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Xs,{size:14}),o==="processing"?"Processing...":"Rotate Pages"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Bulk actions"}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsxs("button",{onClick:()=>v(90),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[m.jsx(Xs,{size:14})," Rotate All 90 CW"]}),m.jsxs("button",{onClick:()=>v(-90),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[m.jsx(p0,{size:14})," Rotate All 90 CCW"]}),m.jsxs("button",{onClick:()=>v(180),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[m.jsx(Xs,{size:14})," Rotate All 180"]}),m.jsxs("button",{onClick:()=>x("even",90),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[m.jsx(Xs,{size:14})," Rotate Even 90 CW"]}),m.jsxs("button",{onClick:()=>x("odd",90),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[m.jsx(Xs,{size:14})," Rotate Odd 90 CW"]}),h&&m.jsxs("button",{onClick:_,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-950 transition-colors",children:[m.jsx(Lr,{size:14})," Reset all"]})]}),m.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Click individual thumbnails to cycle rotation (90 increments).",h&&m.jsxs("span",{className:"ml-1 text-amber-600",children:[Object.keys(s).length," page",Object.keys(s).length!==1?"s":""," rotated"]})]})]}),m.jsx(Z0,{pdfBytes:u.bytes,pageCount:u.pageCount,onPageClick:b,overlayType:"rotate",rotations:s}),m.jsx(ds,{}),m.jsxs("button",{onClick:w,disabled:!h||o==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Xs,{size:16}),o==="processing"?"Processing...":"Rotate Pages"]}),"      "]})]})}function Jw(){const[f,t]=B.useState([]),[s,n]=B.useState([]),[r,l]=B.useState(null),[o,u]=B.useState(new Map),[d,h]=B.useState(new Map),[g,b]=B.useState(null),[v,x]=B.useState(null),_=B.useRef(null),w=It(D=>D.status),S=f[0]??null,A=S?Array.from({length:S.pageCount},(D,X)=>X):[],E=s.length>0&&s.some((D,X)=>D!==X),N=B.useCallback(D=>{t(D),l(null),u(new Map),h(new Map),Sa.cancelAll(),D.length>0?n(Array.from({length:D[0].pageCount},(X,q)=>q)):n([])},[]),R=B.useCallback(D=>{S&&(h(X=>new Map(X).set(D,"loading")),Sa.enqueue(D,"high",()=>Oa(S.bytes,D)).then(X=>{X?(u(q=>new Map(q).set(D,X)),h(q=>new Map(q).set(D,"rendered"))):h(q=>new Map(q).set(D,"failed"))}))},[S]);B.useEffect(()=>{!S||s.length===0||(Sa.cancelAll(),u(new Map),h(new Map))},[S]),B.useEffect(()=>{if(!S||s.length===0)return;const D=new IntersectionObserver(q=>{for(const ut of q){const M=Number(ut.target.getAttribute("data-page"));isNaN(M)||ut.isIntersecting&&!o.has(M)&&d.get(M)!=="loading"&&R(M)}},{rootMargin:"200px"});return _.current?.querySelectorAll("[data-page]")?.forEach(q=>D.observe(q)),()=>D.disconnect()},[s,S,R,o,d]);const O=D=>{D<=0||n(X=>{const q=[...X];return[q[D-1],q[D]]=[q[D],q[D-1]],q})},G=D=>{D>=s.length-1||n(X=>{const q=[...X];return[q[D],q[D+1]]=[q[D+1],q[D]],q})},I=()=>{n([...A])},P=(D,X)=>{b(X),D.dataTransfer.effectAllowed="move",D.dataTransfer.setData("text/plain",String(X)),D.currentTarget instanceof HTMLElement&&(D.currentTarget.style.opacity="0.5")},Y=D=>{D.currentTarget instanceof HTMLElement&&(D.currentTarget.style.opacity="1"),b(null),x(null)},W=(D,X)=>{D.preventDefault(),D.dataTransfer.dropEffect="move";const q=D.currentTarget.getBoundingClientRect(),ut=q.left+q.width/2,M=D.clientX<ut?X:X+1;x(M)},gt=()=>{},z=D=>{_.current&&!_.current.contains(D.relatedTarget)&&x(null)},Q=D=>{D.preventDefault();const X=g;if(X===null||v===null){b(null),x(null);return}let q=v;if(X<q&&(q-=1),X===q){b(null),x(null);return}n(ut=>{const M=[...ut],[L]=M.splice(X,1);return M.splice(q,0,L),M}),b(null),x(null)},T=async()=>{if(S)try{const D=await Ye.process("reorder",[S.bytes],{newOrder:s});l(D)}catch(D){Qe.error(D instanceof Error?D.message:String(D))}},lt=()=>{t([]),n([]),l(null),u(new Map),h(new Map),Sa.cancelAll(),It.getState().reset()},H=S?{isEncrypted:S.isEncrypted,pageCount:S.pageCount,hasMixedPageSizes:!1}:null;return r?m.jsxs("div",{className:"space-y-6",children:[m.jsx(hs,{result:r,originalBytes:S?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:r,onReset:lt})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:N}),S&&m.jsx(ks,{analysis:H,currentToolId:"reorder"}),w==="processing"&&m.jsx(ds,{}),S&&s.length>0&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[S.pageCount," page",S.pageCount!==1?"s":"","  drag or use arrows to reorder"]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("button",{onClick:I,disabled:!E,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:[m.jsx(p0,{size:14}),"Reset Order"]}),m.jsx("button",{onClick:T,disabled:!E||w==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w==="processing"?"Processing...":"Reorder Pages"})]})]}),m.jsx("div",{ref:_,className:"grid gap-3",style:{gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))"},onDragLeave:z,children:s.map((D,X)=>{const q=o.get(D),ut=d.get(D),M=D!==X,L=g===X,J=v===X&&g!==null&&g!==X&&g!==X-1,rt=X===s.length-1&&v===s.length&&g!==null&&g!==X;return m.jsxs("div",{"data-page":D,draggable:!0,onDragStart:nt=>P(nt,X),onDragEnd:Y,onDragOver:nt=>W(nt,X),onDragLeave:gt,onDrop:Q,className:`relative aspect-[3/4] rounded-lg border-2 transition-all cursor-grab active:cursor-grabbing ${L?"border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-800 opacity-50":M?"border-indigo-300 dark:border-indigo-700 bg-indigo-50 dark:bg-indigo-950":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"}`,children:[J&&m.jsxs("div",{className:"absolute -left-[7px] top-0 bottom-0 w-[3px] bg-indigo-500 rounded-full z-20","data-testid":"insertion-line",children:[m.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-indigo-500 rounded-full"}),m.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-indigo-500 rounded-full"})]}),rt&&m.jsxs("div",{className:"absolute -right-[7px] top-0 bottom-0 w-[3px] bg-indigo-500 rounded-full z-20","data-testid":"insertion-line",children:[m.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-indigo-500 rounded-full"}),m.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-indigo-500 rounded-full"})]}),m.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 z-10",children:m.jsx(ax,{size:14,className:"text-gray-400 dark:text-gray-500"})}),m.jsx("div",{className:"w-full h-full overflow-hidden rounded-md",children:ut==="rendered"&&q?m.jsx("img",{src:q,alt:`Page ${D+1}`,className:"w-full h-full object-cover bg-white pointer-events-none",draggable:!1}):ut==="failed"?m.jsxs("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-800 flex flex-col items-center justify-center",children:[m.jsx(Ir,{size:20,className:"text-amber-400 mb-1"}),m.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Page ",D+1]})]}):m.jsx("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-800 animate-pulse flex items-center justify-center",children:m.jsx("span",{className:"text-lg font-bold text-gray-300 dark:text-gray-600",children:D+1})})}),m.jsx("span",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 text-[10px] bg-black/60 text-white px-1.5 py-0.5 rounded",children:D+1}),M&&m.jsxs("span",{className:"absolute top-1 right-1 text-[9px] bg-indigo-500 text-white px-1 rounded",children:["was ",D+1]}),m.jsxs("div",{className:"absolute bottom-1.5 left-0 right-0 flex justify-center gap-1",children:[m.jsx("button",{onClick:nt=>{nt.stopPropagation(),O(X)},disabled:X===0,className:"p-1 bg-white/90 dark:bg-gray-800/90 border border-gray-200 dark:border-gray-700 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":`Move page ${D+1} left`,children:m.jsx($d,{size:12,className:"text-gray-600 dark:text-gray-400"})}),m.jsx("button",{onClick:nt=>{nt.stopPropagation(),G(X)},disabled:X===s.length-1,className:"p-1 bg-white/90 dark:bg-gray-800/90 border border-gray-200 dark:border-gray-700 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":`Move page ${D+1} right`,children:m.jsx(Lv,{size:12,className:"text-gray-600 dark:text-gray-400"})})]})]},`${X}-${D}`)})}),m.jsx("button",{onClick:T,disabled:!E||w==="processing",className:"w-full py-3 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:w==="processing"?"Processing...":"Reorder Pages"})]})]})}function tA(){const[f,t]=B.useState([]),[s,n]=B.useState(new Set),[r,l]=B.useState(null),o=It(_=>_.status),u=f[0]??null,d=u!==null&&s.size===u.pageCount,h=s.size===0,g=B.useCallback(_=>{t(_),n(new Set),l(null)},[]),b=async()=>{if(!(!u||h||d))try{const _=await Ye.process("delete",[u.bytes],{pagesToDelete:Array.from(s)});l(_)}catch(_){Qe.error(_ instanceof Error?_.message:String(_))}},v=()=>{t([]),n(new Set),l(null),It.getState().reset()},x=u?{isEncrypted:u.isEncrypted,pageCount:u.pageCount,hasMixedPageSizes:!1}:null;return r?m.jsxs("div",{className:"space-y-6",children:[m.jsx(hs,{result:r,originalBytes:u?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:r,onReset:v})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:g}),u&&m.jsx(ks,{analysis:x,currentToolId:"delete-pages"}),o==="processing"&&m.jsx(ds,{}),u&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u.pageCount," page",u.pageCount!==1?"s":"",s.size>0&&`  ${s.size} selected for deletion`]}),m.jsxs("div",{className:"flex items-center gap-2",children:[s.size>0&&m.jsx("button",{onClick:()=>n(new Set),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Reset Selection"}),m.jsx("button",{onClick:b,disabled:h||d||o==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o==="processing"?"Processing...":h?"Select pages":`Delete ${s.size} Page${s.size!==1?"s":""}`})]})]}),m.jsx($o,{pageCount:u.pageCount,pdfBytes:u.bytes,selectedPages:s,onSelectionChange:n,overlayType:"delete"}),s.size>0&&m.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Delete"," ",m.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:s.size})," ","of"," ",m.jsx("span",{className:"font-semibold",children:u.pageCount})," ","page",s.size!==1?"s":"","?"]}),d&&m.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg px-3 py-2",children:ja.CANNOT_DELETE_ALL}),m.jsx("button",{onClick:b,disabled:h||d||o==="processing",className:"w-full py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:o==="processing"?"Processing...":h?"Select pages to delete":`Delete ${s.size} Page${s.size!==1?"s":""}`})]})]})}function eA(){const[f,t]=B.useState([]),[s,n]=B.useState(new Set),[r,l]=B.useState("single"),[o,u]=B.useState(null),d=It(w=>w.status),h=f[0]??null,g=s.size===0,b=B.useCallback(w=>{t(w),n(new Set),u(null)},[]),v=async()=>{if(!(!h||g))try{const w=await Ye.process("extract",[h.bytes],{pages:Array.from(s).sort((S,A)=>S-A),mode:r});u(w)}catch(w){Qe.error(w instanceof Error?w.message:String(w))}},x=()=>{t([]),n(new Set),l("single"),u(null),It.getState().reset()},_=h?{isEncrypted:h.isEncrypted,pageCount:h.pageCount,hasMixedPageSizes:!1}:null;return o?m.jsxs("div",{className:"space-y-6",children:[m.jsx(hs,{result:o,originalBytes:h?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:o,onReset:x})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:b}),h&&m.jsx(ks,{analysis:_,currentToolId:"extract-pages"}),d==="processing"&&m.jsx(ds,{}),h&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[h.pageCount," page",h.pageCount!==1?"s":"",s.size>0&&`  ${s.size} selected`]}),m.jsxs("div",{className:"flex items-center gap-2",children:[s.size>0&&m.jsx("button",{onClick:()=>n(new Set),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Reset Selection"}),m.jsx("button",{onClick:v,disabled:g||d==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d==="processing"?"Processing...":g?"Select pages":`Extract ${s.size} Page${s.size!==1?"s":""}`})]})]}),m.jsx($o,{pageCount:h.pageCount,pdfBytes:h.bytes,selectedPages:s,onSelectionChange:n}),s.size>0&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Extract mode"}),m.jsxs("div",{className:"flex rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[m.jsx("button",{onClick:()=>l("single"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${r==="single"?"bg-indigo-600 dark:bg-indigo-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"As single PDF"}),m.jsx("button",{onClick:()=>l("individual"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors border-l border-gray-200 dark:border-gray-700 ${r==="individual"?"bg-indigo-600 dark:bg-indigo-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Each page as separate PDF"})]}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1.5",children:r==="single"?`${s.size} page${s.size!==1?"s":""} will be combined into one PDF.`:`${s.size} separate PDF file${s.size!==1?"s":""} will be created.`})]}),m.jsx("button",{onClick:v,disabled:g||d==="processing",className:"w-full py-3 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:d==="processing"?"Processing...":g?"Select pages to extract":`Extract ${s.size} Page${s.size!==1?"s":""}`})]})]})}const sA={a4:{width:595.28,height:841.89},letter:{width:612,height:792},legal:{width:612,height:1008},a3:{width:841.89,height:1190.55},a5:{width:419.53,height:595.28}},iA=[{value:"match",label:"Match first page"},{value:"a4",label:"A4 (210x297mm)"},{value:"letter",label:"Letter (8.5x11in)"},{value:"legal",label:"Legal (8.5x14in)"},{value:"a3",label:"A3 (297x420mm)"},{value:"a5",label:"A5 (148x210mm)"},{value:"custom",label:"Custom"}];function nA(){const[f,t]=B.useState([]),[s,n]=B.useState("end"),[r,l]=B.useState(1),[o,u]=B.useState(1),[d,h]=B.useState("match"),[g,b]=B.useState(595.28),[v,x]=B.useState(841.89),[_,w]=B.useState(null),S=It(P=>P.status),A=f[0]??null,E=B.useMemo(()=>A?{isEncrypted:A.isEncrypted,pageCount:A.pageCount,hasMixedPageSizes:!1}:null,[A]),N=B.useMemo(()=>d==="custom"?{width:g,height:v}:d==="match"?{width:595.28,height:841.89}:sA[d]??{width:595.28,height:841.89},[d,g,v]),R=B.useMemo(()=>!(!A||o<1||o>100||d==="custom"&&(g<=0||v<=0)||(s==="before"||s==="after")&&(r<1||r>A.pageCount)),[A,o,d,g,v,s,r]),O=B.useCallback(P=>{t(P),w(null),l(1),It.getState().reset()},[]),G=B.useCallback(async()=>{if(!(!A||!R))try{const P=await Ye.process("add-blank-pages",[A.bytes],{position:s,targetPage:r-1,count:o,width:N.width,height:N.height});w(P)}catch(P){const Y=P instanceof Error?P.message:String(P);Qe.error(Y)}},[A,R,s,r,o,N]),I=B.useCallback(()=>{t([]),n("end"),l(1),u(1),h("match"),b(595.28),x(841.89),w(null),It.getState().reset()},[]);return _?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:_,originalBytes:A?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:_,onReset:I})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:O}),A&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:E,currentToolId:"add-blank-pages"}),m.jsx("div",{className:"flex items-center justify-end",children:m.jsxs("button",{onClick:G,disabled:!R||S==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Na,{size:14}),S==="processing"?"Processing...":`Add ${o} Blank Page${o!==1?"s":""}`]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Insert position"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"beginning",label:"At beginning"},{value:"end",label:"At end"},{value:"before",label:"Before page"},{value:"after",label:"After page"}].map(P=>m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"position",value:P.value,checked:s===P.value,onChange:()=>n(P.value),className:"text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:P.label})]},P.value))}),(s==="before"||s==="after")&&m.jsxs("div",{className:"mt-2",children:[m.jsxs("label",{htmlFor:"target-page",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:["Page number (1-",A.pageCount,")"]}),m.jsx("input",{id:"target-page",type:"number",min:1,max:A.pageCount,value:r,onChange:P=>l(Math.max(1,Math.min(A.pageCount,parseInt(P.target.value,10)||1))),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"blank-count",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Number of blank pages"}),m.jsx("input",{id:"blank-count",type:"number",min:1,max:100,value:o,onChange:P=>u(Math.max(1,Math.min(100,parseInt(P.target.value,10)||1))),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Between 1 and 100 blank pages."})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"page-size",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Page size"}),m.jsx("select",{id:"page-size",value:d,onChange:P=>h(P.target.value),className:"w-64 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none bg-white",children:iA.map(P=>m.jsx("option",{value:P.value,children:P.label},P.value))}),d==="custom"&&m.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"custom-width",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Width (pt)"}),m.jsx("input",{id:"custom-width",type:"number",min:1,value:g,onChange:P=>b(parseFloat(P.target.value)||0),className:"w-28 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]}),m.jsx("span",{className:"text-gray-400 dark:text-gray-500 mt-5",children:"x"}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"custom-height",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Height (pt)"}),m.jsx("input",{id:"custom-height",type:"number",min:1,value:v,onChange:P=>x(parseFloat(P.target.value)||0),className:"w-28 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]})]})]}),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-3 text-sm text-gray-600 dark:text-gray-400",children:["Adding ",m.jsx("span",{className:"font-semibold",children:o})," blank page",o!==1?"s":""," ",s==="beginning"&&"at the beginning",s==="end"&&"at the end",s==="before"&&`before page ${r}`,s==="after"&&`after page ${r}`," ","(",Math.round(N.width)," x ",Math.round(N.height)," pt). Result will have ",m.jsx("span",{className:"font-semibold",children:A.pageCount+o})," pages."]}),m.jsx(ds,{}),m.jsxs("button",{onClick:G,disabled:!R||S==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Na,{size:16}),S==="processing"?"Processing...":`Add ${o} Blank Page${o!==1?"s":""}`]}),"      "]})]})}const aA=[[{label:"TL",value:"top-left"},{label:"TC",value:"top-center"},{label:"TR",value:"top-right"}],[{label:"ML",value:"middle-left"},{label:"MC",value:"middle-center"},{label:"MR",value:"middle-right"}],[{label:"BL",value:"bottom-left"},{label:"BC",value:"bottom-center"},{label:"BR",value:"bottom-right"}]],rA=[{value:"1",label:"1"},{value:"Page 1",label:"Page 1"},{value:"Page 1 of N",label:"Page 1 of N"},{value:"1/N",label:"1/N"},{value:"roman",label:"i, ii, iii"}];function lA(f){const t=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],s=["m","cm","d","cd","c","xc","l","xl","x","ix","v","iv","i"];let n="";for(let r=0;r<t.length;r++)for(;f>=t[r];)n+=s[r],f-=t[r];return n}function s0(f,t,s){switch(f){case"1":return`${t}`;case"Page 1":return`Page ${t}`;case"Page 1 of N":return`Page ${t} of ${s}`;case"1/N":return`${t}/${s}`;case"roman":return lA(t)}}function Cd(f){return f.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function oA(f,t,s,n){const[r,l]=f.split("-");let o,u,d,h;return l==="left"?(o=n,d="left"):l==="right"?(o=t-n,d="right"):(o=t/2,d="center"),r==="top"?(u=n,h="top"):r==="bottom"?(u=s-n,h="bottom"):(u=s/2,h="middle"),{x:o,y:u,align:d,baseline:h}}function cA(){const[f,t]=B.useState([]),[s,n]=B.useState("bottom-center"),[r,l]=B.useState("1"),[o,u]=B.useState(1),[d,h]=B.useState(12),[g,b]=B.useState("#000000"),[v,x]=B.useState(40),[_,w]=B.useState("all"),[S,A]=B.useState(""),[E,N]=B.useState(null),[R,O]=B.useState(null),G=B.useRef(null),I=It(X=>X.status),P=f[0]??null,Y=B.useMemo(()=>P?{isEncrypted:P.isEncrypted,pageCount:P.pageCount,hasMixedPageSizes:!1}:null,[P]),W=B.useMemo(()=>_!=="range"||!P||!S.trim()?null:Po(S,P.pageCount),[_,P,S]),gt=B.useMemo(()=>{if(!(_==="all"||!W||W.error))return W.pages.map(X=>X-1)},[_,W]),z=B.useMemo(()=>!(!P||_==="range"&&(!W||W.error||W.pages.length===0)),[P,_,W]),Q=B.useMemo(()=>P?s0(r,o,o+P.pageCount-1):"",[P,r,o]),T=B.useMemo(()=>{if(!P)return"";const X=P.pageCount,q=Math.min(3,X),ut=[];for(let M=0;M<q;M++)ut.push(s0(r,o+M,o+X-1));return X>3&&ut.push("..."),ut.join(", ")},[P,r,o]);B.useEffect(()=>{if(!P){O(null);return}let X=!1;return Oa(P.bytes,0,1).then(q=>{!X&&q&&O(q)}),()=>{X=!0}},[P]),B.useEffect(()=>{const X=G.current;if(!X)return;const q=X.getContext("2d");if(!q)return;const ut=X.width,M=X.height;q.clearRect(0,0,ut,M),q.fillStyle="#ffffff",q.fillRect(0,0,ut,M);const L=()=>{if(!Q)return;const J=v*(ut/612),rt=Math.max(10,d*(ut/612)),nt=oA(s,ut,M,J);q.font=`bold ${rt}px sans-serif`,q.textAlign=nt.align,q.textBaseline=nt.baseline;const xt=q.measureText(Q).width,Et=rt;let ot=nt.x;nt.align==="center"?ot-=xt/2:nt.align==="right"&&(ot-=xt);let At=nt.y;nt.baseline==="middle"?At-=Et/2:nt.baseline==="bottom"&&(At-=Et);const Ot=5,zt=ot-Ot,Ft=At-Ot/2,C=xt+Ot*2,dt=Et+Ot,at=4;q.fillStyle="rgba(255, 255, 255, 0.85)",q.beginPath(),q.moveTo(zt+at,Ft),q.lineTo(zt+C-at,Ft),q.quadraticCurveTo(zt+C,Ft,zt+C,Ft+at),q.lineTo(zt+C,Ft+dt-at),q.quadraticCurveTo(zt+C,Ft+dt,zt+C-at,Ft+dt),q.lineTo(zt+at,Ft+dt),q.quadraticCurveTo(zt,Ft+dt,zt,Ft+dt-at),q.lineTo(zt,Ft+at),q.quadraticCurveTo(zt,Ft,zt+at,Ft),q.closePath(),q.fill(),q.fillStyle=g,q.font=`bold ${rt}px sans-serif`,q.textAlign=nt.align,q.textBaseline=nt.baseline,q.fillText(Q,nt.x,nt.y)};if(R){const J=new Image;J.onload=()=>{q.drawImage(J,0,0,ut,M),L()},J.src=R}else{q.strokeStyle="#e5e7eb",q.lineWidth=1;for(let J=30;J<M-20;J+=14){const rt=J<50?ut*.4:ut*(.55+Math.random()*.3);q.beginPath(),q.moveTo(24,J),q.lineTo(Math.min(24+rt,ut-24),J),q.stroke()}L()}},[R,s,r,o,d,g,v,Q]);const lt=B.useCallback(X=>{t(X),N(null),A(""),O(null),It.getState().reset()},[]),H=B.useCallback(async()=>{if(!(!P||!z))try{const X={position:s,format:r,startNumber:o,fontSize:d,color:g,margin:v};gt&&(X.pageRange=gt);const q=await Ye.process("add-page-numbers",[P.bytes],X);N(q)}catch(X){const q=X instanceof Error?X.message:String(X);Qe.error(q)}},[P,z,s,r,o,d,g,v,gt]),D=B.useCallback(()=>{t([]),n("bottom-center"),l("1"),u(1),h(12),b("#000000"),x(40),w("all"),A(""),N(null),O(null),It.getState().reset()},[]);return E?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:E,originalBytes:P?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:E,onReset:D})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:lt}),P&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:Y,currentToolId:"page-numbers"}),m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[m.jsxs("div",{className:"space-y-5",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"num-format",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Number format"}),m.jsx("select",{id:"num-format",value:r,onChange:X=>l(X.target.value),className:"w-48 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none bg-white",children:rA.map(X=>m.jsx("option",{value:X.value,children:X.label},X.value))})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"start-number",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Starting number"}),m.jsx("input",{id:"start-number",type:"number",min:1,value:o,onChange:X=>u(Math.max(1,parseInt(X.target.value,10)||1)),className:"w-24 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{htmlFor:"font-size",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Font size: ",m.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[d,"pt"]})]}),m.jsx("input",{id:"font-size",type:"range",min:8,max:36,value:d,onChange:X=>h(parseInt(X.target.value,10)),className:"w-full accent-indigo-600"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 dark:text-gray-500",children:[m.jsx("span",{children:"8pt"}),m.jsx("span",{children:"36pt"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"num-color",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Color"}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("input",{id:"num-color",type:"color",value:g,onChange:X=>b(X.target.value),className:"w-10 h-10 rounded border border-gray-300 dark:border-gray-600 cursor-pointer"}),m.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:g})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{htmlFor:"margin",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Margin from edge: ",m.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[v,"pt"]})]}),m.jsx("input",{id:"margin",type:"range",min:20,max:100,value:v,onChange:X=>x(parseInt(X.target.value,10)),className:"w-full accent-indigo-600"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 dark:text-gray-500",children:[m.jsx("span",{children:"20pt"}),m.jsx("span",{children:"100pt"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Apply to"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"applyTo",value:"all",checked:_==="all",onChange:()=>w("all"),className:"text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"All pages"})]}),m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"applyTo",value:"range",checked:_==="range",onChange:()=>w("range"),className:"text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Page range"})]})]}),_==="range"&&m.jsxs("div",{className:"mt-2",children:[m.jsx("input",{type:"text",value:S,onChange:X=>A(X.target.value),placeholder:"e.g., 1-5, 8, 10-end",className:`w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none dark:bg-gray-800 dark:text-gray-100 ${W?.error?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600"}`}),W?.error&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400 mt-1",children:W.error})]})]}),m.jsx(ds,{}),m.jsxs("button",{onClick:H,disabled:!z||I==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Gr,{size:16}),I==="processing"?"Processing...":"Add Page Numbers"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Position & Preview",m.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-400 dark:text-gray-500",children:["Click a zone to place the number  ",T]})]}),m.jsx("div",{className:"relative rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 p-4 shadow-inner",children:m.jsxs("div",{className:"relative mx-auto overflow-hidden rounded-lg shadow-md",style:{maxWidth:400},children:[m.jsx("canvas",{ref:G,width:400,height:566,className:"w-full h-auto block bg-white","data-testid":"pagenumber-preview-canvas"}),m.jsx("div",{className:"absolute inset-2 grid grid-cols-3 grid-rows-3 gap-0",children:aA.flat().map(X=>{const q=s===X.value;return m.jsx("button",{onClick:()=>n(X.value),className:`relative rounded transition-all duration-150 border cursor-pointer ${q?"border-indigo-500 bg-indigo-500/10 border-2":"border-gray-300/60 border-dashed hover:bg-indigo-500/5 hover:border-indigo-400/60"}`,title:Cd(X.value),"aria-label":`Place number at ${Cd(X.value)}`,children:q&&m.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:m.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm",children:Cd(X.value)})})},X.value)})}),m.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/50 text-white text-[10px] px-2 py-0.5 rounded-full backdrop-blur-sm pointer-events-none",children:["Page 1 of ",P.pageCount]})]})})]})]})]})]})}function uA(){const[f,t]=B.useState([]),[s,n]=B.useState("CONFIDENTIAL"),[r,l]=B.useState(60),[o,u]=B.useState(45),[d,h]=B.useState(.15),[g,b]=B.useState("#808080"),[v,x]=B.useState("center"),[_,w]=B.useState("all"),[S,A]=B.useState(""),[E,N]=B.useState(null),[R,O]=B.useState(null),G=B.useRef(null),I=It(D=>D.status),P=f[0]??null,Y=B.useMemo(()=>P?{isEncrypted:P.isEncrypted,pageCount:P.pageCount,hasMixedPageSizes:!1}:null,[P]),W=B.useMemo(()=>_!=="range"||!P||!S.trim()?null:Po(S,P.pageCount),[_,P,S]),gt=B.useMemo(()=>{if(!(_==="all"||!W||W.error))return W.pages.map(D=>D-1)},[_,W]),z=B.useMemo(()=>!(!P||!s.trim()||_==="range"&&(!W||W.error||W.pages.length===0)),[P,s,_,W]);B.useEffect(()=>{if(!P){O(null);return}let D=!1;return Oa(P.bytes,0,1).then(X=>{!D&&X&&O(X)}),()=>{D=!0}},[P]),B.useEffect(()=>{const D=G.current;if(!D)return;const X=D.getContext("2d");if(!X)return;const q=D.width,ut=D.height;if(X.clearRect(0,0,q,ut),X.fillStyle="#ffffff",X.fillRect(0,0,q,ut),R){const M=new Image;M.onload=()=>{X.drawImage(M,0,0,q,ut),Q(X,q,ut)},M.src=R}else{X.strokeStyle="#e5e7eb",X.lineWidth=1;for(let M=30;M<ut-20;M+=16){const L=M<50?q*.5:q*(.6+Math.random()*.25);X.beginPath(),X.moveTo(20,M),X.lineTo(Math.min(20+L,q-20),M),X.stroke()}Q(X,q,ut)}},[R,s,r,o,d,g,v]);function Q(D,X,q){const ut=s.trim()||"Watermark";D.save(),D.globalAlpha=d,D.fillStyle=g;const M=Math.max(8,r*(X/612));if(v==="center")D.font=`bold ${M}px sans-serif`,D.textAlign="center",D.textBaseline="middle",D.translate(X/2,q/2),D.rotate(-o*Math.PI/180),D.fillText(ut,0,0);else{const L=Math.max(6,M*.5);D.font=`bold ${L}px sans-serif`,D.textAlign="center",D.textBaseline="middle";const rt=D.measureText(ut).width+40,nt=L+30;for(let _t=-X;_t<X*2;_t+=rt)for(let xt=-q;xt<q*2;xt+=nt)D.save(),D.translate(_t,xt),D.rotate(-o*Math.PI/180),D.fillText(ut,0,0),D.restore()}D.restore()}const T=B.useCallback(D=>{t(D),N(null),A(""),O(null),It.getState().reset()},[]),lt=B.useCallback(async()=>{if(!(!P||!z))try{const D={text:s.trim(),fontSize:r,angle:o,opacity:d,color:g,mode:v};gt&&(D.pageRange=gt);const X=await Ye.process("add-watermark",[P.bytes],D);N(X)}catch(D){const X=D instanceof Error?D.message:String(D);Qe.error(X)}},[P,z,s,r,o,d,g,v,gt]),H=B.useCallback(()=>{t([]),n("CONFIDENTIAL"),l(60),u(45),h(.15),b("#808080"),x("center"),w("all"),A(""),N(null),O(null),It.getState().reset()},[]);return E?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:E,originalBytes:P?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:E,onReset:H})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:T}),P&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:Y,currentToolId:"text-watermark"}),m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[m.jsxs("div",{className:"space-y-5",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"watermark-text",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Watermark text"}),m.jsx("input",{id:"watermark-text",type:"text",value:s,onChange:D=>n(D.target.value),placeholder:"Enter watermark text",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{htmlFor:"wm-font-size",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Font size: ",m.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[r,"pt"]})]}),m.jsx("input",{id:"wm-font-size",type:"range",min:20,max:120,value:r,onChange:D=>l(parseInt(D.target.value,10)),className:"w-full accent-indigo-600"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 dark:text-gray-500",children:[m.jsx("span",{children:"20pt"}),m.jsx("span",{children:"120pt"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{htmlFor:"wm-angle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Rotation: ",m.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[o,""]})]}),m.jsx("input",{id:"wm-angle",type:"range",min:-90,max:90,value:o,onChange:D=>u(parseInt(D.target.value,10)),className:"w-full accent-indigo-600"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 dark:text-gray-500",children:[m.jsx("span",{children:"-90"}),m.jsx("span",{children:"0"}),m.jsx("span",{children:"90"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{htmlFor:"wm-opacity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Opacity: ",m.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[Math.round(d*100),"%"]})]}),m.jsx("input",{id:"wm-opacity",type:"range",min:.05,max:1,step:.05,value:d,onChange:D=>h(parseFloat(D.target.value)),className:"w-full accent-indigo-600"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 dark:text-gray-500",children:[m.jsx("span",{children:"5%"}),m.jsx("span",{children:"100%"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"wm-color",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Color"}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("input",{id:"wm-color",type:"color",value:g,onChange:D=>b(D.target.value),className:"w-10 h-10 rounded border border-gray-300 dark:border-gray-600 cursor-pointer"}),m.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:g})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Placement mode"}),m.jsxs("div",{className:"flex rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[m.jsx("button",{onClick:()=>x("center"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors ${v==="center"?"bg-indigo-600 dark:bg-indigo-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Center"}),m.jsx("button",{onClick:()=>x("tile"),className:`flex-1 px-4 py-2 text-sm font-medium transition-colors border-l border-gray-200 dark:border-gray-700 ${v==="tile"?"bg-indigo-600 dark:bg-indigo-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Tile"})]}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:v==="center"?"Single watermark placed at the center of each page.":"Watermark repeated in a tiled pattern across each page."})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Apply to"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"wm-applyTo",value:"all",checked:_==="all",onChange:()=>w("all"),className:"text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"All pages"})]}),m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"wm-applyTo",value:"range",checked:_==="range",onChange:()=>w("range"),className:"text-indigo-600 focus:ring-indigo-500"}),m.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Page range"})]})]}),_==="range"&&m.jsxs("div",{className:"mt-2",children:[m.jsx("input",{type:"text",value:S,onChange:D=>A(D.target.value),placeholder:"e.g., 1-5, 8, 10-end",className:`w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none dark:bg-gray-800 dark:text-gray-100 ${W?.error?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600"}`}),W?.error&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400 mt-1",children:W.error})]})]}),m.jsx(ds,{}),m.jsxs("button",{onClick:lt,disabled:!z||I==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Wv,{size:16}),I==="processing"?"Processing...":"Add Watermark"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Preview",m.jsx("span",{className:"ml-2 text-xs font-normal text-gray-400 dark:text-gray-500",children:"Page 1"})]}),m.jsx("div",{className:"relative rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 p-4 shadow-inner",children:m.jsxs("div",{className:"relative mx-auto overflow-hidden rounded-lg shadow-md",style:{maxWidth:400},children:[m.jsx("canvas",{ref:G,width:400,height:566,className:"w-full h-auto block bg-white","data-testid":"watermark-preview-canvas"}),m.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/50 text-white text-[10px] px-2 py-0.5 rounded-full backdrop-blur-sm",children:["Page 1 of ",P.pageCount]})]})})]})]})]})]})}const i0={A4:{width:595.28,height:841.89,label:"A4 (210x297mm)"},Letter:{width:612,height:792,label:"Letter (8.5x11in)"},Legal:{width:612,height:1008,label:"Legal (8.5x14in)"},A3:{width:841.89,height:1190.55,label:"A3"},A5:{width:419.53,height:595.28,label:"A5"},Custom:{width:0,height:0,label:"Custom"}};function dA(){const[f,t]=B.useState([]),[s,n]=B.useState("A4"),[r,l]=B.useState(595),[o,u]=B.useState(842),[d,h]=B.useState(!0),[g,b]=B.useState("all"),[v,x]=B.useState(new Set),[_,w]=B.useState(null),S=It(P=>P.status),A=f[0]??null,E=B.useMemo(()=>A?{isEncrypted:A.isEncrypted,pageCount:A.pageCount,hasMixedPageSizes:!1}:null,[A]),N=B.useMemo(()=>{if(s==="Custom")return{width:r,height:o};const P=i0[s];return P?{width:P.width,height:P.height}:{width:595.28,height:841.89}},[s,r,o]),R=B.useMemo(()=>!(!A||N.width<=0||N.height<=0||g==="selected"&&v.size===0),[A,N,g,v]),O=B.useCallback(P=>{t(P),x(new Set),w(null),It.getState().reset()},[]),G=B.useCallback(async()=>{if(!(!A||!R))try{const P=await Ye.process("scale",[A.bytes],{targetWidth:N.width,targetHeight:N.height,fitContent:d,pages:g==="all"?void 0:Array.from(v)});w(P)}catch(P){const Y=P instanceof Error?P.message:String(P);Qe.error(Y)}},[A,R,N,d,g,v]),I=B.useCallback(()=>{t([]),n("A4"),l(595),u(842),h(!0),b("all"),x(new Set),w(null),It.getState().reset()},[]);return _?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:_,originalBytes:A?.bytes,showOriginalToggle:!0}),m.jsx(fs,{result:_,onReset:I})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:O}),A&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:E,currentToolId:"scale"}),m.jsx("div",{className:"flex items-center justify-end",children:m.jsxs("button",{onClick:G,disabled:!R||S==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Tm,{size:14}),S==="processing"?"Processing...":"Resize PDF"]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"target-size",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Target page size"}),m.jsx("select",{id:"target-size",value:s,onChange:P=>n(P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none bg-white",children:Object.entries(i0).map(([P,Y])=>m.jsx("option",{value:P,children:Y.label},P))})]}),s==="Custom"&&m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{htmlFor:"custom-width",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Width (points)"}),m.jsx("input",{id:"custom-width",type:"number",min:1,value:r,onChange:P=>l(Number(P.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{htmlFor:"custom-height",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Height (points)"}),m.jsx("input",{id:"custom-height",type:"number",min:1,value:o,onChange:P=>u(Number(P.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]}),m.jsx("p",{className:"col-span-2 text-xs text-gray-400 dark:text-gray-500",children:"1 inch = 72 points, 1 mm = 2.835 points"})]}),m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx("input",{id:"fit-content",type:"checkbox",checked:d,onChange:P=>h(P.target.checked),className:"mt-0.5 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"fit-content",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Fit content to new page size"}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Scale existing content proportionally to fit within the new page dimensions. When unchecked, content retains its original size and may be cropped or have extra whitespace."})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Apply to"}),m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"apply-to",value:"all",checked:g==="all",onChange:()=>b("all"),className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"All pages"]}),m.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[m.jsx("input",{type:"radio",name:"apply-to",value:"selected",checked:g==="selected",onChange:()=>b("selected"),className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Selected pages"]})]})]}),g==="selected"&&m.jsx($o,{pageCount:A.pageCount,pdfBytes:A.bytes,selectedPages:v,onSelectionChange:x,overlayType:"selected"}),m.jsx(ds,{}),m.jsxs("button",{onClick:G,disabled:!R||S==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Tm,{size:16}),S==="processing"?"Processing...":"Resize PDF"]}),"      "]})]})}function hA(f){if(f.length===0)return"empty";if(f.length<6)return"weak";const t=/[A-Z]/.test(f),s=/[a-z]/.test(f),n=/[0-9]/.test(f),r=/[^A-Za-z0-9]/.test(f),l=[t,s,n,r].filter(Boolean).length;return f.length>=10&&l>=3?"strong":l>=2?"medium":"weak"}const fA={empty:{color:"bg-gray-200 dark:bg-gray-700",label:"",width:"w-0"},weak:{color:"bg-red-500",label:"Weak",width:"w-1/3"},medium:{color:"bg-yellow-500",label:"Medium",width:"w-2/3"},strong:{color:"bg-green-500",label:"Strong",width:"w-full"}};function gA(){const[f,t]=B.useState([]),[s,n]=B.useState(""),[r,l]=B.useState(""),[o,u]=B.useState(!1),[d,h]=B.useState(!1),[g,b]=B.useState({printing:!0,copying:!0,modifying:!1}),[v,x]=B.useState(null),_=It(W=>W.status),w=f[0]??null,S=B.useMemo(()=>w?{isEncrypted:w.isEncrypted,pageCount:w.pageCount,hasMixedPageSizes:!1}:null,[w]),A=B.useMemo(()=>hA(s),[s]),E=fA[A],N=s===r,R=d&&!N&&r.length>0,O=B.useMemo(()=>!(!w||s.length===0||!N),[w,s,N]),G=B.useCallback(W=>{t(W),x(null),It.getState().reset()},[]),I=B.useCallback(W=>{b(gt=>({...gt,[W]:!gt[W]}))},[]),P=B.useCallback(async()=>{if(!(!w||!O))try{const W=await Ye.process("encrypt",[w.bytes],{userPassword:s,ownerPassword:s,permissions:g});x(W)}catch(W){const gt=W instanceof Error?W.message:String(W);Qe.error(gt)}},[w,O,s,g]),Y=B.useCallback(()=>{t([]),n(""),l(""),u(!1),h(!1),b({printing:!0,copying:!0,modifying:!1}),x(null),It.getState().reset()},[]);return v?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:v}),m.jsx(fs,{result:v,onReset:Y})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:G}),w&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:S,currentToolId:"encrypt"}),m.jsx("div",{className:"flex items-center justify-end",children:m.jsxs("button",{onClick:P,disabled:!O||_==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(ki,{size:14}),_==="processing"?"Processing...":"Encrypt PDF"]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"encrypt-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{id:"encrypt-password",type:o?"text":"password",value:s,onChange:W=>n(W.target.value),placeholder:"Enter password",className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"}),m.jsx("button",{type:"button",onClick:()=>u(W=>!W),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":o?"Hide password":"Show password",children:o?m.jsx(Eo,{size:16}):m.jsx(Co,{size:16})})]}),s.length>0&&m.jsxs("div",{className:"space-y-1",children:[m.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:m.jsx("div",{className:`h-full ${E.color} ${E.width} rounded-full transition-all duration-300`})}),m.jsx("p",{className:`text-xs ${A==="weak"?"text-red-500 dark:text-red-400":A==="medium"?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"}`,children:E.label})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"encrypt-confirm-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm password"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{id:"encrypt-confirm-password",type:o?"text":"password",value:r,onChange:W=>l(W.target.value),onBlur:()=>h(!0),placeholder:"Confirm password",className:`w-full px-3 py-2 pr-10 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none dark:bg-gray-800 dark:text-gray-100 ${R?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600"}`}),m.jsx("button",{type:"button",onClick:()=>u(W=>!W),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":o?"Hide password":"Show password",children:o?m.jsx(Eo,{size:16}):m.jsx(Co,{size:16})})]}),R&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400",children:"Passwords do not match."})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Permissions"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:g.printing,onChange:()=>I("printing"),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Allow printing"]}),m.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:g.copying,onChange:()=>I("copying"),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Allow copying text"]}),m.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:g.modifying,onChange:()=>I("modifying"),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),"Allow editing"]})]})]}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"AES-128 encryption"}),m.jsx(ds,{}),m.jsxs("button",{onClick:P,disabled:!O||_==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(ki,{size:16}),_==="processing"?"Processing...":"Encrypt PDF"]}),"      "]})]})}function pA(){const[f,t]=B.useState([]),[s,n]=B.useState(""),[r,l]=B.useState(!1),[o,u]=B.useState(null),[d,h]=B.useState(null),[g,b]=B.useState(null),v=It(O=>O.status),x=zn(O=>O.setView),_=f[0]??null,w=B.useMemo(()=>_?{isEncrypted:_.isEncrypted,pageCount:_.pageCount,hasMixedPageSizes:!1}:null,[_]),S=B.useMemo(()=>!(!_||!o||s.length===0),[_,o,s]),A=B.useCallback(O=>{t(O),n(""),h(null),b(null),It.getState().reset();const G=O[0]??null;u(G?G.isEncrypted:null)},[]),E=B.useCallback(async()=>{if(!(!_||!S)){h(null);try{const O=await Ye.process("unlock",[_.bytes],{password:s});b(O)}catch(O){const G=O instanceof Error?O.message:String(O);G===ja.WRONG_PASSWORD||G.toLowerCase().includes("password")?h(ja.WRONG_PASSWORD):Qe.error(G)}}},[_,S,s]),N=B.useCallback(()=>{t([]),n(""),l(!1),u(null),h(null),b(null),It.getState().reset()},[]),R=B.useCallback(()=>{x("grid")},[x]);return g?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:g}),m.jsx(fs,{result:g,onReset:N})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:A}),_&&o===!1&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg",children:[m.jsx(Zd,{size:20,className:"text-blue-500 shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-300",children:"This PDF is not password-protected. No action needed."}),m.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Upload a different file or go back to the tool grid."})]})]}),m.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-gray-700 dark:text-gray-300",children:[m.jsx($d,{size:16}),"Back to tools"]})]}),_&&o&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:w,currentToolId:"unlock"}),m.jsx("div",{className:"flex items-center justify-end",children:m.jsxs("button",{onClick:E,disabled:!S||v==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Ma,{size:14}),v==="processing"?"Processing...":"Unlock PDF"]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"unlock-password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"PDF Password"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{id:"unlock-password",type:r?"text":"password",value:s,onChange:O=>{n(O.target.value),h(null)},onKeyDown:O=>{O.key==="Enter"&&S&&E()},placeholder:"Enter the PDF password",className:`w-full px-3 py-2 pr-10 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none dark:bg-gray-800 dark:text-gray-100 ${d?"border-red-300 dark:border-red-700":"border-gray-300 dark:border-gray-600"}`}),m.jsx("button",{type:"button",onClick:()=>l(O=>!O),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":r?"Hide password":"Show password",children:r?m.jsx(Eo,{size:16}):m.jsx(Co,{size:16})})]}),d&&m.jsx("p",{className:"text-xs text-red-500 dark:text-red-400",children:d})]}),m.jsx(ds,{}),m.jsxs("button",{onClick:E,disabled:!S||v==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Ma,{size:16}),v==="processing"?"Processing...":"Unlock PDF"]})]})]})}const Td={title:"",author:"",subject:"",keywords:"",creator:"",producer:""},mA=[{key:"title",label:"Title",placeholder:"Document title"},{key:"author",label:"Author",placeholder:"Author name"},{key:"subject",label:"Subject",placeholder:"Document subject"},{key:"keywords",label:"Keywords",placeholder:"Comma-separated keywords"},{key:"creator",label:"Creator",placeholder:"Application that created the document"},{key:"producer",label:"Producer",placeholder:"PDF producer"}];function bA(){const[f,t]=B.useState([]),[s,n]=B.useState({...Td}),[r,l]=B.useState(null),o=It(_=>_.status),u=f[0]??null,d=B.useMemo(()=>u?{isEncrypted:u.isEncrypted,pageCount:u.pageCount,hasMixedPageSizes:!1}:null,[u]),h=B.useCallback(_=>{t(_),n({...Td}),l(null),It.getState().reset()},[]),g=B.useCallback((_,w)=>{n(S=>({...S,[_]:w}))},[]),b=B.useCallback(async()=>{if(u)try{const _=await Ye.process("edit-metadata",[u.bytes],{...s,clearAll:!1});l(_)}catch(_){const w=_ instanceof Error?_.message:String(_);Qe.error(w)}},[u,s]),v=B.useCallback(async()=>{if(u)try{const _=await Ye.process("edit-metadata",[u.bytes],{clearAll:!0});l(_)}catch(_){const w=_ instanceof Error?_.message:String(_);Qe.error(w)}},[u]),x=B.useCallback(()=>{t([]),n({...Td}),l(null),It.getState().reset()},[]);return r?m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:r}),m.jsx(fs,{result:r,onReset:x})]}):m.jsxs("div",{className:"space-y-6",children:[m.jsx(us,{onFilesLoaded:h}),u&&m.jsxs(m.Fragment,{children:[m.jsx(ks,{analysis:d,currentToolId:"edit-metadata"}),m.jsx("div",{className:"flex items-center justify-end",children:m.jsxs("button",{onClick:b,disabled:!u||o==="processing",className:"flex items-center gap-1.5 px-4 py-1.5 text-sm font-medium bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Xe,{size:14}),o==="processing"?"Processing...":"Save Changes"]})}),m.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Enter the metadata you want to set. Existing metadata will be replaced."}),m.jsx("div",{className:"space-y-4",children:mA.map(({key:_,label:w,placeholder:S})=>m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{htmlFor:`metadata-${_}`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:w}),m.jsx("input",{id:`metadata-${_}`,type:"text",value:s[_],onChange:A=>g(_,A.target.value),placeholder:S,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none"})]},_))}),m.jsxs("button",{onClick:v,disabled:o==="processing",className:"flex items-center gap-2 px-4 py-2 text-sm border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-950 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[m.jsx(Dn,{size:14}),"Clear all metadata"]}),m.jsx(ds,{}),m.jsxs("button",{onClick:b,disabled:!u||o==="processing",className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring",children:[m.jsx(Xe,{size:16}),o==="processing"?"Processing...":"Save Changes"]}),"      "]})]})}const ws={split:f=>.5+f*.01,merge:f=>.5+f*.02,rotate:f=>.3+f*.005,reorder:f=>.5+f*.01,"delete-pages":f=>.5+f*.01,"extract-pages":f=>.5+f*.01,"add-blank-pages":()=>.5,"add-page-numbers":f=>1+f*.05,"text-watermark":f=>1+f*.05,scale:f=>1+f*.03,encrypt:f=>.5+f*.02,unlock:()=>.5,"edit-metadata":()=>.3},ib={organize:{label:"Organize",color:"blue-500"},transform:{label:"Transform",color:"amber-500"},stamp:{label:"Stamp",color:"purple-500"},security:{label:"Security",color:"red-500"},info:{label:"Info",color:"green-500"}},fh=[{id:"split",name:"Split PDF",description:"Split document into separate files",icon:"Scissors",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:Kw,estimateTime:ws.split,generateFilename:(f,t)=>_s("split",f,t)},{id:"merge",name:"Merge PDFs",description:"Combine multiple PDFs into one",icon:"Layers",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!0,pipelineCompatible:!1,component:Ww,estimateTime:ws.merge,generateFilename:(f,t)=>_s("merge",f,t)},{id:"reorder",name:"Reorder Pages",description:"Rearrange pages by dragging",icon:"ArrowUpDown",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:Jw,estimateTime:ws.reorder,generateFilename:(f,t)=>_s("reorder",f,t)},{id:"delete-pages",name:"Delete Pages",description:"Remove unwanted pages",icon:"Trash2",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:tA,estimateTime:ws["delete-pages"],generateFilename:(f,t)=>_s("delete-pages",f,t)},{id:"extract-pages",name:"Extract Pages",description:"Pull specific pages into a new PDF",icon:"FileOutput",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:eA,estimateTime:ws["extract-pages"],generateFilename:(f,t)=>_s("extract-pages",f,t)},{id:"add-blank-pages",name:"Add Blank Pages",description:"Insert blank pages at any position",icon:"FilePlus",category:"organize",categoryColor:"blue-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:nA,estimateTime:ws["add-blank-pages"],generateFilename:(f,t)=>_s("add-blank-pages",f,t)},{id:"rotate",name:"Rotate Pages",description:"Rotate pages in any direction",icon:"RotateCw",category:"transform",categoryColor:"amber-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:Qw,estimateTime:ws.rotate,generateFilename:(f,t)=>_s("rotate",f,t)},{id:"scale",name:"Scale / Resize",description:"Change page dimensions",icon:"Maximize",category:"transform",categoryColor:"amber-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:dA,estimateTime:ws.scale,generateFilename:(f,t)=>_s("scale",f,t)},{id:"add-page-numbers",name:"Page Numbers",description:"Add page numbers to your document",icon:"Hash",category:"stamp",categoryColor:"purple-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:cA,estimateTime:ws["add-page-numbers"],generateFilename:(f,t)=>_s("add-page-numbers",f,t)},{id:"text-watermark",name:"Text Watermark",description:"Add text watermark to pages",icon:"Type",category:"stamp",categoryColor:"purple-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:uA,estimateTime:ws["text-watermark"],generateFilename:(f,t)=>_s("text-watermark",f,t)},{id:"encrypt",name:"Encrypt PDF",description:"Password-protect your PDF",icon:"Lock",category:"security",categoryColor:"red-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:gA,estimateTime:ws.encrypt,generateFilename:(f,t)=>_s("encrypt",f,t)},{id:"unlock",name:"Unlock PDF",description:"Remove password protection",icon:"Unlock",category:"security",categoryColor:"red-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:pA,estimateTime:ws.unlock,generateFilename:(f,t)=>_s("unlock",f,t)},{id:"edit-metadata",name:"Edit Metadata",description:"View and edit document properties",icon:"FileText",category:"info",categoryColor:"green-500",acceptsMultipleFiles:!1,pipelineCompatible:!0,component:bA,estimateTime:ws["edit-metadata"],generateFilename:(f,t)=>_s("edit-metadata",f,t)}],si=Object.fromEntries(fh.map(f=>[f.id,f]));function nb(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n0(f){return f==="system"?nb():f}function Nd(f){typeof document>"u"||document.documentElement.classList.toggle("dark",f==="dark")}function yA(){if(typeof localStorage>"u")return"system";const f=localStorage.getItem("quire-theme");return f==="light"||f==="dark"||f==="system"?f:"system"}const gh=Vr(f=>{const t=yA(),s=n0(t);return Nd(s),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{if(gh.getState().mode==="system"){const l=nb();Nd(l),f({resolved:l})}}),{mode:t,resolved:s,setMode:n=>{const r=n0(n);Nd(r);try{localStorage.setItem("quire-theme",n)}catch{}f({mode:n,resolved:r})}}}),vA={Scissors:Ra,Layers:qr,ArrowUpDown:Do,Trash2:Dn,FileOutput:Oo,FilePlus:Na,RotateCw:Xs,Maximize:zo,Hash:Gr,Type:Lo,Lock:ki,Unlock:Ma,FileText:Xe},xA={"blue-500":"bg-blue-500","amber-500":"bg-amber-500","purple-500":"bg-purple-500","red-500":"bg-red-500","green-500":"bg-green-500"},_A={"blue-500":"text-blue-500","amber-500":"text-amber-500","purple-500":"text-purple-500","red-500":"text-red-500","green-500":"text-green-500"},wA=Object.entries(ib).map(([f,t])=>({key:f,...t,tools:fh.filter(s=>s.category===f)})),AA={light:Mx,dark:xx,system:yx},Md=["system","light","dark"];function SA({onShowShortcuts:f}){const{currentToolId:t,setView:s}=zn(),{mode:n,setMode:r}=gh(),l=d=>{const h=It.getState().status,g=zd.getState().currentFiles.length>0;if(h==="processing"){if(!window.confirm("You have work in progress. Leave this page?"))return}else if(g&&!window.confirm("You have a file loaded. Leave this tool?"))return;s("tool",d)},o=()=>{const d=Md.indexOf(n);r(Md[(d+1)%Md.length])},u=AA[n];return m.jsxs("header",{className:"h-14 flex items-center justify-between px-4 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[m.jsx("h1",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:"Quire"}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("nav",{className:"hidden md:flex items-center gap-1",children:wA.map(d=>m.jsxs("div",{className:"relative group",children:[m.jsxs("button",{className:"px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center gap-1.5","aria-haspopup":"true",children:[m.jsx("span",{className:`w-2 h-2 rounded-full ${xA[d.color]}`}),d.label]}),m.jsx("div",{className:"absolute top-full right-0 hidden group-hover:block pt-1 z-50",children:m.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 py-2 min-w-[220px]",children:d.tools.map(h=>{const g=vA[h.icon],b=t===h.id;return m.jsxs("button",{onClick:()=>l(h.id),className:`w-full text-left px-3 py-2 rounded-lg flex items-center gap-3 transition-colors ${b?"bg-indigo-50 text-indigo-700 dark:bg-indigo-950 dark:text-indigo-300":"hover:bg-gray-50 text-gray-700 dark:hover:bg-gray-800 dark:text-gray-300"}`,children:[g&&m.jsx(g,{size:16,className:`shrink-0 ${b?"text-indigo-500 dark:text-indigo-400":_A[h.categoryColor]}`}),m.jsxs("div",{className:"min-w-0",children:[m.jsx("div",{className:"text-sm font-medium",children:h.name}),m.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 truncate",children:h.description})]})]},h.id)})})})]},d.key))}),m.jsx("button",{onClick:o,className:"p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-ring","aria-label":`Theme: ${n}`,children:m.jsx(u,{size:20})}),m.jsx("button",{onClick:f,className:"p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-ring","aria-label":"Keyboard shortcuts",children:m.jsx(Xv,{size:20})})]})]})}function kA(){return m.jsx("footer",{className:"py-4 text-center",children:m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center justify-center gap-1.5",children:[m.jsx(ki,{size:12}),"Your files never leave your browser. All processing happens locally."]})})}function vo(f){const t=[];f.length>5&&t.push({message:"Pipeline is limited to 5 steps to ensure reliable performance.",type:"error"}),f.indexOf("unlock")>0&&t.push({message:"Unlock PDF should be the first step so other tools can read the PDF content.",type:"warning"});const n=f.indexOf("encrypt");n>=0&&n<f.length-1&&t.push({message:"Encrypt should be the last step. Tools after it would need the password to process the PDF.",type:"warning"});const r=f.indexOf("delete-pages"),l=f.indexOf("add-page-numbers");r>=0&&l>=0&&r>l&&t.push({message:"Consider moving Delete Pages before Add Page Numbers so numbers are correct after deletion.",type:"suggestion"});const o=new Set;for(const d of f)o.has(d)&&t.push({message:`'${d}' appears twice in the pipeline. Is that intentional?`,type:"suggestion"}),o.add(d);return{valid:!t.some(d=>d.type==="error"),warnings:t}}const a0={valid:!0,warnings:[]},je=Vr()((f,t)=>({selectedTools:[],currentStep:-1,stepStatus:{},intermediateResults:{},originalInput:null,validation:a0,isExecuting:!1,stepErrors:{},addTool:s=>f(n=>{if(n.selectedTools.length>=5)return n;const r=[...n.selectedTools,s];return{selectedTools:r,validation:vo(r)}}),removeTool:s=>f(n=>{const r=n.selectedTools.filter((l,o)=>o!==s);return{selectedTools:r,validation:vo(r)}}),reorderTools:(s,n)=>f(r=>{const l=[...r.selectedTools],[o]=l.splice(s,1);return l.splice(n,0,o),{selectedTools:l,validation:vo(l)}}),loadPreset:s=>f(()=>{const n=s.tools.slice(0,5);return{selectedTools:n,validation:vo(n)}}),clearPipeline:()=>f({selectedTools:[],currentStep:-1,stepStatus:{},intermediateResults:{},originalInput:null,validation:a0,isExecuting:!1,stepErrors:{}}),startPipeline:()=>f(s=>{const n={};for(let r=1;r<=s.selectedTools.length;r++)n[r]="pending";return{isExecuting:!0,currentStep:0,stepStatus:n,intermediateResults:{},originalInput:null,stepErrors:{}}}),setOriginalInput:s=>f({originalInput:s}),advanceToStep:s=>f(n=>{const r={...n.stepStatus};return r[s]==="pending"&&(r[s]="configuring"),{currentStep:s,stepStatus:r}}),setStepConfiguring:s=>f(n=>({stepStatus:{...n.stepStatus,[s]:"configuring"}})),setStepProcessing:s=>f(n=>({stepStatus:{...n.stepStatus,[s]:"processing"}})),completeStep:(s,n)=>f(r=>{const l={...r.intermediateResults};for(const o of Object.keys(l)){const u=Number(o);u<s-1&&delete l[u]}return l[s]=n,{stepStatus:{...r.stepStatus,[s]:"done"},intermediateResults:l}}),failStep:(s,n)=>f(r=>({stepStatus:{...r.stepStatus,[s]:"failed"},stepErrors:{...r.stepErrors,[s]:n}})),skipStep:s=>f(n=>{const r=t().getStepInput(s),l={...n.intermediateResults};if(r){for(const o of Object.keys(l)){const u=Number(o);u<s-1&&delete l[u]}l[s]=r}return{stepStatus:{...n.stepStatus,[s]:"skipped"},intermediateResults:l}}),retryStep:s=>f(n=>({stepStatus:{...n.stepStatus,[s]:"configuring"},stepErrors:{...n.stepErrors,[s]:""}})),cancelPipeline:()=>f({isExecuting:!1,currentStep:-1}),resetPipeline:()=>f({currentStep:-1,stepStatus:{},intermediateResults:{},originalInput:null,isExecuting:!1,stepErrors:{}}),getStepInput:s=>{const n=t();if(s<=1)return n.originalInput;for(let r=s-1;r>=1;r--)if(n.intermediateResults[r])return n.intermediateResults[r];return n.originalInput},getLastSuccessfulOutput:()=>{const s=t(),n=Object.keys(s.intermediateResults).map(Number).sort((r,l)=>l-r);return n.length>0?s.intermediateResults[n[0]]:s.originalInput}}));function EA({children:f,onShowShortcuts:t}){return B.useEffect(()=>{const s=n=>{(It.getState().status==="processing"||je.getState().isExecuting)&&n.preventDefault()};return window.addEventListener("beforeunload",s),()=>window.removeEventListener("beforeunload",s)},[]),m.jsxs("div",{className:"min-h-screen flex flex-col",children:[m.jsx(SA,{onShowShortcuts:t}),m.jsx("main",{className:"flex-1 w-full max-w-[1200px] mx-auto px-4 py-6",children:f}),m.jsx(kA,{})]})}const CA={Scissors:Ra,Layers:qr,ArrowUpDown:Do,Trash2:Dn,FileOutput:Oo,FilePlus:Na,RotateCw:Xs,Maximize:zo,Hash:Gr,Type:Lo,Lock:ki,Unlock:Ma,FileText:Xe},TA={"blue-500":"border-l-blue-500","amber-500":"border-l-amber-500","purple-500":"border-l-purple-500","red-500":"border-l-red-500","green-500":"border-l-green-500"},NA={"blue-500":"bg-blue-500","amber-500":"bg-amber-500","purple-500":"bg-purple-500","red-500":"bg-red-500","green-500":"bg-green-500"},MA={"blue-500":"text-blue-500","amber-500":"text-amber-500","purple-500":"text-purple-500","red-500":"text-red-500","green-500":"text-green-500"};function Rd(){const{pipelineMode:f,setView:t,togglePipelineMode:s}=zn(),n=je(u=>u.selectedTools),r=Object.entries(ib).map(([u,d])=>({key:u,...d,tools:fh.filter(h=>h.category===u)})),l=u=>{if(f){if(!u.pipelineCompatible)return;const d=n.lastIndexOf(u.id);d>=0?je.getState().removeTool(d):je.getState().addTool(u.id)}else t("tool",u.id)},o=()=>{je.getState().startPipeline(),t("pipeline")};return m.jsxs("div",{children:[m.jsx("div",{className:"flex justify-center mb-6",children:m.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 dark:border-gray-700 p-1 bg-gray-50 dark:bg-gray-800",children:[m.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${f?"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300":"bg-white dark:bg-gray-700 shadow-sm text-gray-900 dark:text-gray-100"}`,onClick:()=>{f&&(s(),je.getState().clearPipeline())},children:"Single Tool"}),m.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${f?"bg-white dark:bg-gray-700 shadow-sm text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>{f||s()},children:"Pipeline"})]})}),f&&n.length>0&&m.jsxs("div",{className:"mb-4 p-3 bg-indigo-50 dark:bg-indigo-950 rounded-lg flex items-center justify-between",children:[m.jsxs("span",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[n.length," tool",n.length!==1?"s":""," selected"]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:()=>je.getState().clearPipeline(),className:"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Clear"}),m.jsx("button",{onClick:()=>t("pipeline"),className:"px-4 py-1.5 text-sm text-indigo-600 dark:text-indigo-400 border border-indigo-300 dark:border-indigo-700 rounded-lg hover:bg-indigo-100 dark:hover:bg-indigo-900 transition-colors",children:"Configure"}),m.jsx("button",{onClick:o,className:"px-4 py-1.5 bg-indigo-600 dark:bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:n.length<2,children:"Start Pipeline"})]})]}),r.map(u=>m.jsxs("div",{className:"mb-8",children:[m.jsxs("h2",{className:"text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-2",children:[m.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${NA[u.color]}`}),u.label]}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:u.tools.map(d=>{const h=CA[d.icon],g=n.indexOf(d.id),b=g>=0,v=f&&!d.pipelineCompatible,x=f&&n.length>=5&&!b;return m.jsxs("button",{onClick:()=>l(d),disabled:v||x,className:`
                    relative text-left p-5 bg-white dark:bg-gray-800 rounded-xl shadow-sm border-l-4
                    ${TA[d.categoryColor]}
                    transition-all duration-150
                    ${v||x?"opacity-50 cursor-not-allowed":"hover:-translate-y-0.5 hover:shadow-md cursor-pointer"}
                    ${b?"ring-2 ring-indigo-500":""}
                    focus-ring
                  `,"aria-label":`${d.name}${v?" (not available in pipeline)":""}`,title:v?"Not available in pipeline mode":x?"Pipeline is limited to 5 tools":"",children:[b&&m.jsx("span",{className:"absolute top-2 right-2 w-6 h-6 bg-indigo-600 text-white text-xs font-bold rounded-full flex items-center justify-center",children:g+1}),m.jsxs("div",{className:"flex items-start gap-3",children:[h&&m.jsx(h,{size:24,className:`${MA[d.categoryColor]} shrink-0 mt-0.5`}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:d.name}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:d.description})]})]})]},d.id)})})]},u.key))]})}const RA=[{key:"Escape",description:"Go back to tool grid",action:"navigate-back"},{key:"a",ctrl:!0,description:"Select all pages",action:"select-all"},{key:"a",ctrl:!0,shift:!0,description:"Deselect all pages",action:"deselect-all"},{key:"z",ctrl:!0,description:"Reset tool to original state",action:"reset-tool"},{key:"s",ctrl:!0,description:"Download result",action:"download"},{key:"?",description:"Show keyboard shortcuts",action:"show-shortcuts"}];function jA({isOpen:f,onClose:t}){const s=B.useRef(null);return B.useEffect(()=>{if(!f)return;const n=r=>{r.key==="Escape"&&t()};return window.addEventListener("keydown",n),s.current?.focus(),()=>window.removeEventListener("keydown",n)},[f,t]),f?m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t,children:m.jsxs("div",{ref:s,className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full mx-4 p-6",onClick:n=>n.stopPropagation(),tabIndex:-1,children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Keyboard Shortcuts"}),m.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Close",children:m.jsx(Nn,{size:18})})]}),m.jsx("table",{className:"w-full text-sm",children:m.jsx("tbody",{children:RA.map(n=>m.jsxs("tr",{className:"border-t border-gray-100 dark:border-gray-700",children:[m.jsx("td",{className:"py-2 pr-4",children:m.jsxs("kbd",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-xs font-mono",children:[n.ctrl&&(navigator.platform.includes("Mac")?"":"Ctrl+"),n.shift?"Shift+":"",n.key]})}),m.jsx("td",{className:"py-2 text-gray-600 dark:text-gray-400",children:n.description})]},n.action))})})]})}):null}class jd extends B.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("ErrorBoundary caught:",t,s)}render(){return this.state.hasError?m.jsxs("div",{className:"text-center py-16",children:[m.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:"Something went wrong."}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:this.state.error?.message}),m.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.hash=""},className:"px-4 py-2 bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors",children:"Go back to tools"})]}):this.props.children}}const DA=[{id:"scan-cleanup",name:"Scan Cleanup",description:"Remove password, delete blank pages, add page numbers",icon:"ScanLine",tools:["unlock","delete-pages","add-page-numbers"]},{id:"secure-stamp",name:"Secure & Stamp",description:"Add a watermark and password-protect",icon:"ShieldCheck",tools:["text-watermark","encrypt"]},{id:"document-prep",name:"Document Prep",description:"Reorder, clean up, number, and brand your document",icon:"FileCheck",tools:["reorder","delete-pages","add-page-numbers","text-watermark"]},{id:"number-lock",name:"Number & Lock",description:"Add page numbers and password-protect",icon:"Lock",tools:["add-page-numbers","encrypt"]}],OA={Scissors:Ra,Layers:qr,ArrowUpDown:Do,Trash2:Dn,FileOutput:Oo,FilePlus:Na,RotateCw:Xs,Maximize:zo,Hash:Gr,Type:Lo,Lock:ki,Unlock:Ma,FileText:Xe,ScanLine:m0,ShieldCheck:b0,FileCheck:f0},zA={ScanLine:m0,ShieldCheck:b0,FileCheck:f0,Lock:ki};function LA(f){return OA[f]??Xe}function PA(f){return zA[f]??Xe}function r0(f){switch(f){case"error":return"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950 border-red-200 dark:border-red-800";case"warning":return"text-amber-600 dark:text-amber-300 bg-amber-50 dark:bg-amber-950 border-amber-200 dark:border-amber-800";case"suggestion":return"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800";default:return"text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"}}function l0(f){switch(f){case"error":return m.jsx(Ir,{className:"h-3.5 w-3.5 flex-shrink-0"});case"warning":return m.jsx(Ir,{className:"h-3.5 w-3.5 flex-shrink-0"});case"suggestion":return m.jsx(Zd,{className:"h-3.5 w-3.5 flex-shrink-0"});default:return null}}function FA(){const f=je(g=>g.selectedTools),t=je(g=>g.validation),s=je(g=>g.isExecuting),n=B.useCallback(g=>{je.getState().loadPreset(g)},[]),r=B.useCallback(g=>{je.getState().removeTool(g)},[]),l=B.useCallback(g=>{g>0&&je.getState().reorderTools(g,g-1)},[]),o=B.useCallback(g=>{g<je.getState().selectedTools.length-1&&je.getState().reorderTools(g,g+1)},[]),u=B.useCallback(()=>{je.getState().clearPipeline()},[]),d=B.useCallback(()=>{je.getState().startPipeline(),zn.getState().setView("pipeline")},[]),h=f.length>=2&&t.valid&&!s;return m.jsxs("div",{className:"mx-auto max-w-3xl space-y-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Quick Start Presets"}),m.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:DA.map(g=>{const b=PA(g.icon);return m.jsxs("button",{onClick:()=>n(g),className:"group flex flex-col items-start gap-2 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-3 text-left shadow-sm transition-all hover:border-indigo-300 dark:hover:border-indigo-700 hover:shadow-md",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(b,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"}),m.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:g.name})]}),m.jsx("p",{className:"text-xs leading-relaxed text-gray-500 dark:text-gray-400",children:g.description}),m.jsx("div",{className:"flex flex-wrap gap-1",children:g.tools.map(v=>{const x=si[v];return m.jsx("span",{className:"inline-block rounded-full bg-gray-100 dark:bg-gray-700 px-2 py-0.5 text-[10px] font-medium text-gray-600 dark:text-gray-400 group-hover:bg-indigo-50 dark:group-hover:bg-indigo-950 group-hover:text-indigo-700 dark:group-hover:text-indigo-300",children:x?.name??v},v)})})]},g.id)})})]}),m.jsxs("div",{children:[m.jsxs("h3",{className:"mb-3 text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Pipeline Steps",f.length>0&&m.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-400 dark:text-gray-500",children:["(",f.length," tool",f.length!==1?"s":"",")"]})]}),m.jsx("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm",children:f.length===0?m.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[m.jsx(qr,{className:"mb-3 h-8 w-8 text-gray-300 dark:text-gray-600"}),m.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Select tools from the grid below to build your pipeline"})]}):m.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:f.map((g,b)=>{const v=si[g],x=v?LA(v.icon):Xe,_=t.warnings.filter(w=>w.message.toLowerCase().includes(v?.name?.toLowerCase()??""));return m.jsxs("li",{children:[m.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[m.jsx("span",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-indigo-100 dark:bg-indigo-900 text-xs font-semibold text-indigo-700 dark:text-indigo-300",children:b+1}),m.jsxs("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[m.jsx(x,{className:"h-4 w-4 flex-shrink-0 text-gray-500 dark:text-gray-400"}),m.jsx("span",{className:"truncate text-sm font-medium text-gray-900 dark:text-gray-100",children:v?.name??g}),v?.category&&m.jsx("span",{className:"rounded-full px-2 py-0.5 text-[10px] font-medium",style:{backgroundColor:`${v.categoryColor}15`,color:v.categoryColor},children:v.category})]}),m.jsxs("div",{className:"flex flex-shrink-0 items-center gap-1",children:[m.jsx("button",{onClick:()=>l(b),disabled:b===0,className:"rounded p-1 text-gray-400 dark:text-gray-500 transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-600 dark:hover:text-gray-300 disabled:cursor-not-allowed disabled:opacity-30","aria-label":"Move up",children:m.jsx(d0,{className:"h-4 w-4"})}),m.jsx("button",{onClick:()=>o(b),disabled:b===f.length-1,className:"rounded p-1 text-gray-400 dark:text-gray-500 transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-600 dark:hover:text-gray-300 disabled:cursor-not-allowed disabled:opacity-30","aria-label":"Move down",children:m.jsx(u0,{className:"h-4 w-4"})}),m.jsx("button",{onClick:()=>r(b),className:"ml-1 rounded p-1 text-gray-400 dark:text-gray-500 transition-colors hover:bg-red-50 dark:hover:bg-red-950 hover:text-red-500 dark:hover:text-red-400","aria-label":"Remove",children:m.jsx(Nn,{className:"h-4 w-4"})})]})]}),_.length>0&&m.jsx("div",{className:"space-y-1 px-4 pb-3",children:_.map((w,S)=>m.jsxs("div",{className:`flex items-center gap-1.5 rounded-lg border px-3 py-1.5 text-xs ${r0(w.type)}`,children:[l0(w.type),m.jsx("span",{children:w.message})]},S))})]},`${g}-${b}`)})})}),t.warnings.length>0&&f.length>0&&m.jsx("div",{className:"mt-3 space-y-1.5",children:t.warnings.filter(g=>!f.some(b=>{const v=si[b];return v&&g.message.toLowerCase().includes(v.name.toLowerCase())})).map((g,b)=>m.jsxs("div",{className:`flex items-center gap-1.5 rounded-lg border px-3 py-2 text-xs ${r0(g.type)}`,children:[l0(g.type),m.jsx("span",{children:g.message})]},b))})]}),m.jsxs("div",{className:"flex items-center justify-end gap-3",children:[m.jsx("button",{onClick:u,disabled:f.length===0||s,className:"rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Clear"}),m.jsxs("button",{onClick:d,disabled:!h,className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 dark:bg-indigo-500 px-5 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-indigo-700 dark:hover:bg-indigo-600 disabled:cursor-not-allowed disabled:bg-indigo-400 disabled:opacity-70",children:[m.jsx(g0,{className:"h-4 w-4"}),"Start Pipeline"]})]})]})}const BA={Scissors:Ra,Layers:qr,ArrowUpDown:Do,Trash2:Dn,FileOutput:Oo,FilePlus:Na,RotateCw:Xs,Maximize:zo,Hash:Gr,Type:Lo,Lock:ki,Unlock:Ma,FileText:Xe};function o0(f){return BA[f]??Xe}function Dd({status:f}){switch(f){case"pending":return m.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800",children:m.jsx("span",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"})});case"configuring":return m.jsxs("span",{className:"relative flex h-7 w-7 items-center justify-center rounded-full border-2 border-indigo-500 bg-indigo-50 dark:bg-indigo-950",children:[m.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-indigo-400 opacity-30"}),m.jsx("span",{className:"h-2 w-2 rounded-full bg-indigo-500"})]});case"processing":return m.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full border-2 border-indigo-500 bg-indigo-50 dark:bg-indigo-950",children:m.jsx(ux,{className:"h-4 w-4 animate-spin text-indigo-600 dark:text-indigo-400"})});case"done":return m.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-green-500 text-white",children:m.jsx(ko,{className:"h-4 w-4"})});case"failed":return m.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-red-500 text-white",children:m.jsx(Nn,{className:"h-4 w-4"})});case"skipped":return m.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full border-2 border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500",children:m.jsx(mx,{className:"h-4 w-4"})})}}function IA({toolId:f,options:t,onChange:s}){const n=(d,h)=>s({...t,[d]:h}),r="block text-sm font-medium text-gray-700 dark:text-gray-300",l="w-full rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500",o="text-xs text-gray-500 dark:text-gray-400",u="text-sm text-gray-500 dark:text-gray-400 italic";switch(f){case"rotate":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Rotation Angle"}),m.jsxs("select",{className:l,value:t.angle??90,onChange:d=>n("angle",Number(d.target.value)),children:[m.jsx("option",{value:90,children:"90 degrees clockwise"}),m.jsx("option",{value:180,children:"180 degrees"}),m.jsx("option",{value:270,children:"270 degrees clockwise"})]})]});case"delete-pages":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Pages to Delete"}),m.jsx("input",{type:"text",placeholder:"e.g. 1,3,5-8",className:l,value:t.pageRange??"",onChange:d=>n("pageRange",d.target.value)}),m.jsx("p",{className:o,children:"Comma-separated page numbers or ranges."})]});case"extract-pages":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Pages to Extract"}),m.jsx("input",{type:"text",placeholder:"e.g. 1-3,5,7",className:l,value:t.pageRange??"",onChange:d=>n("pageRange",d.target.value)}),m.jsx("p",{className:o,children:"Comma-separated page numbers or ranges."})]});case"add-page-numbers":{const d=["top-left","top-center","top-right","bottom-left","bottom-center","bottom-right"];return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Position"}),m.jsx("select",{className:l,value:t.position??"bottom-center",onChange:h=>n("position",h.target.value),children:d.map(h=>m.jsx("option",{value:h,children:h.replace("-"," ").replace(/\b\w/g,g=>g.toUpperCase())},h))})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Format"}),m.jsxs("select",{className:l,value:t.format??"number",onChange:h=>n("format",h.target.value),children:[m.jsx("option",{value:"number",children:"1, 2, 3..."}),m.jsx("option",{value:"pageOfTotal",children:"Page 1 of N"}),m.jsx("option",{value:"dash",children:"- 1 -"})]})]})]})}case"text-watermark":return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Watermark Text"}),m.jsx("input",{type:"text",placeholder:"e.g. CONFIDENTIAL",className:l,value:t.text??"",onChange:d=>n("text",d.target.value)})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Font Size"}),m.jsx("input",{type:"number",min:8,max:200,className:l,value:t.fontSize??48,onChange:d=>n("fontSize",Number(d.target.value))})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Opacity"}),m.jsx("input",{type:"number",min:.05,max:1,step:.05,className:l,value:t.opacity??.3,onChange:d=>n("opacity",Number(d.target.value))})]})]})]});case"encrypt":return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"User Password"}),m.jsx("input",{type:"password",placeholder:"Password to open the PDF",className:l,value:t.userPassword??"",onChange:d=>n("userPassword",d.target.value)})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Owner Password"}),m.jsx("input",{type:"password",placeholder:"Password for full access",className:l,value:t.ownerPassword??"",onChange:d=>n("ownerPassword",d.target.value)})]})]});case"unlock":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Password"}),m.jsx("input",{type:"password",placeholder:"Enter PDF password",className:l,value:t.password??"",onChange:d=>n("password",d.target.value)})]});case"add-blank-pages":return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Position"}),m.jsxs("select",{className:l,value:t.position??"end",onChange:d=>n("position",d.target.value),children:[m.jsx("option",{value:"start",children:"Beginning"}),m.jsx("option",{value:"end",children:"End"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Number of Pages"}),m.jsx("input",{type:"number",min:1,max:100,className:l,value:t.count??1,onChange:d=>n("count",Number(d.target.value))})]})]});case"scale":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Target Size"}),m.jsxs("select",{className:l,value:t.targetSize??"A4",onChange:d=>n("targetSize",d.target.value),children:[m.jsx("option",{value:"A4",children:"A4 (210 x 297 mm)"}),m.jsx("option",{value:"Letter",children:"Letter (8.5 x 11 in)"}),m.jsx("option",{value:"Legal",children:"Legal (8.5 x 14 in)"}),m.jsx("option",{value:"A3",children:"A3 (297 x 420 mm)"}),m.jsx("option",{value:"A5",children:"A5 (148 x 210 mm)"})]})]});case"reorder":return m.jsx("p",{className:u,children:"Pages will be passed through in their current order. Reordering is best done in the standalone tool."});case"edit-metadata":return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Title"}),m.jsx("input",{type:"text",placeholder:"Document title",className:l,value:t.title??"",onChange:d=>n("title",d.target.value)})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:r,children:"Author"}),m.jsx("input",{type:"text",placeholder:"Author name",className:l,value:t.author??"",onChange:d=>n("author",d.target.value)})]})]});default:return m.jsx("p",{className:u,children:"No additional configuration needed. Click Apply to process."})}}function Od(f){try{const s=new TextDecoder("latin1").decode(f.slice(0,Math.min(f.length,512e3))).match(/\/Type\s*\/Page(?!s)/g);return s?s.length:1}catch{return 1}}function UA(){const{selectedTools:f,currentStep:t,stepStatus:s,intermediateResults:n,stepErrors:r,setOriginalInput:l,advanceToStep:o,setStepConfiguring:u,setStepProcessing:d,completeStep:h,failStep:g,skipStep:b,retryStep:v,cancelPipeline:x,resetPipeline:_,getStepInput:w,getLastSuccessfulOutput:S}=je(),A=zn(ot=>ot.setView),[E,N]=B.useState({}),[R,O]=B.useState({}),[G,I]=B.useState({}),P=f.length,Y=B.useMemo(()=>f.map((ot,At)=>{const Ot=si[ot];return{index:At+1,toolId:ot,name:Ot?.name??ot,iconName:Ot?.icon}}),[f]);B.useEffect(()=>{if(t>=1){const ot=s[t];(!ot||ot==="pending")&&u(t)}},[t,s,u]);const W=B.useCallback(ot=>{ot.length!==0&&(l(ot[0].bytes),o(1))},[l,o]),gt=B.useCallback(async ot=>{const At=f[ot-1],Ot=w(ot);if(!Ot)return;const zt=E[ot]??{};It.getState().reset(),d(ot);try{const Ft=await Ye.process(At,[Ot],zt);Ft.files.length>0?(h(ot,Ft.files[0].bytes),O(C=>({...C,[ot]:Ft}))):g(ot,"No output was produced.")}catch(Ft){g(ot,Ft instanceof Error?Ft.message:String(Ft))}},[f,E,w,d,h,g]),z=B.useCallback(ot=>{ot<P&&o(ot+1)},[P,o]),Q=B.useCallback(ot=>{u(ot)},[u]),T=B.useCallback(ot=>{b(ot),ot<P&&o(ot+1)},[b,P,o]),lt=B.useCallback(ot=>{v(ot)},[v]),H=B.useCallback(()=>{x(),A("pipeline")},[x,A]),D=B.useCallback(()=>{_(),N({}),O({}),I({})},[_]),X=B.useCallback(ot=>{const At=s[ot];(At==="done"||At==="skipped"||At==="failed")&&o(ot)},[s,o]),q=B.useMemo(()=>{for(let ot=1;ot<=P;ot++){const At=s[ot];if(At!=="done"&&At!=="skipped")return!1}return P>0},[s,P]),ut=B.useMemo(()=>{if(!q)return null;for(let At=P;At>=1;At--)if(R[At])return R[At];const ot=S();return ot?{files:[{name:"pipeline-output.pdf",bytes:ot,pageCount:Od(ot)}],processingTime:0}:null},[q,P,R,S]),M=()=>m.jsxs("aside",{className:"flex w-64 flex-shrink-0 flex-col border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[m.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 px-4 py-4",children:m.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Pipeline Steps"})}),m.jsx("nav",{className:"flex-1 overflow-y-auto px-3 py-3",children:m.jsxs("ol",{className:"space-y-1",children:[m.jsx("li",{children:m.jsxs("button",{type:"button",onClick:()=>X(0),className:`flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-left text-sm transition-colors ${t===0?"bg-indigo-50 dark:bg-indigo-950 text-indigo-700 dark:text-indigo-300 font-medium":s[0]==="done"?"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer":"text-gray-400 dark:text-gray-500 cursor-default"}`,disabled:t===0,children:[m.jsx(Dd,{status:s[0]??(t===0?"configuring":"pending")}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(y0,{className:"h-4 w-4"}),m.jsx("span",{children:"Upload File"})]})]})}),Y.map(ot=>{const At=s[ot.index]??"pending",Ot=t===ot.index,zt=ot.iconName?o0(ot.iconName):Xe;return m.jsx("li",{children:m.jsxs("button",{type:"button",onClick:()=>X(ot.index),className:`flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-left text-sm transition-colors ${Ot?"bg-indigo-50 dark:bg-indigo-950 text-indigo-700 dark:text-indigo-300 font-medium":At==="done"||At==="skipped"||At==="failed"?"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer":"text-gray-400 dark:text-gray-500 cursor-default"}`,disabled:At==="pending"&&!Ot,children:[m.jsx(Dd,{status:At}),m.jsxs("div",{className:"flex items-center gap-2 truncate",children:[m.jsx(zt,{className:"h-4 w-4 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:ot.name})]})]})},ot.index)})]})}),m.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-4",children:m.jsxs("button",{type:"button",onClick:H,className:"flex w-full items-center justify-center gap-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(yd,{className:"h-4 w-4"}),"Cancel Pipeline"]})})]}),L=()=>m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Upload Your PDF"}),m.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Select a PDF file to process through your pipeline of ",P," step",P!==1?"s":"","."]})]}),m.jsx(us,{onFilesLoaded:W})]}),J=ot=>{const At=f[ot-1],Ot=si[At],zt=w(ot),Ft=zt?Od(zt):0,C=zt?zt.byteLength:0,dt=E[ot]??{},at=G[ot]??!0;return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:["Step ",ot," of ",P,": ",Ot?.name??At]}),m.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Configure this step and click Apply to process."})]}),m.jsxs("div",{className:"flex items-center gap-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 px-4 py-3",children:[m.jsx(Xe,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"}),m.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[m.jsx("span",{className:"font-medium",children:"Input:"})," ","~",Ft," page",Ft!==1?"s":"",", ",Mn(C)]})]}),m.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm",children:[m.jsxs("button",{type:"button",onClick:()=>I(U=>({...U,[ot]:!at})),className:"flex w-full items-center justify-between px-5 py-4 text-left",children:[m.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Configuration"}),m.jsx(km,{className:`h-4 w-4 text-gray-400 dark:text-gray-500 transition-transform ${at?"rotate-90":""}`})]}),at&&m.jsx("div",{className:"border-t border-gray-100 dark:border-gray-700 px-5 py-4",children:m.jsx(IA,{toolId:At,options:dt,onChange:U=>N(F=>({...F,[ot]:U}))})})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("button",{type:"button",onClick:()=>gt(ot),className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 dark:bg-indigo-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-indigo-700 dark:hover:bg-indigo-600",children:[m.jsx(g0,{className:"h-4 w-4"}),"Apply"]}),m.jsxs("button",{type:"button",onClick:()=>T(ot),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(ho,{className:"h-4 w-4"}),"Skip this step"]})]})]})},rt=ot=>{const At=si[f[ot-1]];return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:["Processing: ",At?.name??f[ot-1]]}),m.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Processing step ",ot," of ",P,"..."]})]}),m.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-6 shadow-sm",children:[m.jsx(ds,{}),m.jsx("p",{className:"mt-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Please wait while the operation completes."})]})]})},nt=ot=>{const At=f[ot-1],Ot=si[At],zt=n[ot],Ft=zt?Od(zt):0,C=zt?zt.byteLength:0,dt=ot===P;return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:["Step ",ot,": ",Ot?.name??At]}),m.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[m.jsx(ko,{className:"h-4 w-4"}),m.jsx("span",{children:"Completed successfully"})]})]}),m.jsx("div",{className:"rounded-xl border border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-950 px-5 py-4",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100 dark:bg-green-900",children:m.jsx(ko,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),m.jsxs("div",{children:[m.jsxs("p",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:["Output: ~",Ft," page",Ft!==1?"s":"",", ",Mn(C)]}),R[ot]?.processingTime!=null&&m.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300",children:["Processed in ",(R[ot].processingTime/1e3).toFixed(1),"s"]})]})]})}),!dt&&m.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[m.jsxs("button",{type:"button",onClick:()=>z(ot),className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 dark:bg-indigo-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-indigo-700 dark:hover:bg-indigo-600",children:["Continue to Next Step",m.jsx(km,{className:"h-4 w-4"})]}),m.jsxs("button",{type:"button",onClick:()=>Q(ot),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(Lr,{className:"h-4 w-4"}),"Reconfigure"]}),m.jsxs("button",{type:"button",onClick:()=>T(ot),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(ho,{className:"h-4 w-4"}),"Skip & Continue"]})]})]})},_t=ot=>{const At=f[ot-1],Ot=si[At],zt=r[ot]??"An unknown error occurred.";return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:["Step ",ot,": ",Ot?.name??At]}),m.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-red-600 dark:text-red-400",children:[m.jsx(yd,{className:"h-4 w-4"}),m.jsx("span",{children:"Step failed"})]})]}),m.jsx("div",{className:"rounded-xl border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-950 px-5 py-4",children:m.jsxs("div",{className:"flex gap-3",children:[m.jsx(h0,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-red-500 dark:text-red-400"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"Error"}),m.jsx("p",{className:"mt-1 text-sm text-red-700 dark:text-red-300",children:zt})]})]})}),m.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[m.jsxs("button",{type:"button",onClick:()=>lt(ot),className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 dark:bg-indigo-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-indigo-700 dark:hover:bg-indigo-600",children:[m.jsx(Lr,{className:"h-4 w-4"}),"Retry"]}),m.jsxs("button",{type:"button",onClick:()=>T(ot),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(ho,{className:"h-4 w-4"}),"Skip"]}),m.jsxs("button",{type:"button",onClick:H,className:"inline-flex items-center gap-2 rounded-xl border border-red-300 dark:border-red-700 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-red-700 dark:text-red-400 shadow-sm transition-colors hover:bg-red-50 dark:hover:bg-red-950",children:[m.jsx(yd,{className:"h-4 w-4"}),"Cancel Pipeline"]})]})]})},xt=()=>m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Pipeline Complete"}),m.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["All ",P," step",P!==1?"s":""," have been processed."]})]}),m.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm",children:[m.jsx("div",{className:"border-b border-gray-100 dark:border-gray-700 px-5 py-3",children:m.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Summary"})}),m.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:Y.map(ot=>{const At=s[ot.index]??"pending",Ot=ot.iconName?o0(ot.iconName):Xe,zt=At==="done"?"Completed":At==="skipped"?"Skipped":At==="failed"?"Failed":At,Ft=At==="done"?"text-green-600 dark:text-green-400":At==="skipped"?"text-gray-500 dark:text-gray-400":At==="failed"?"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500";return m.jsxs("li",{className:"flex items-center gap-3 px-5 py-3",children:[m.jsx(Dd,{status:At}),m.jsx(Ot,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"}),m.jsx("span",{className:"flex-1 text-sm text-gray-900 dark:text-gray-100",children:ot.name}),m.jsx("span",{className:`text-xs font-medium ${Ft}`,children:zt})]},ot.index)})})]}),ut&&m.jsxs("div",{className:"space-y-4",children:[m.jsx(hs,{result:ut}),m.jsx(fs,{result:ut,onReset:D})]}),m.jsx("div",{className:"flex items-center gap-3 border-t border-gray-200 dark:border-gray-700 pt-6",children:m.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm transition-colors hover:bg-gray-50 dark:hover:bg-gray-700",children:[m.jsx(Lr,{className:"h-4 w-4"}),"Process Another File"]})})]}),Et=()=>{if(q)return xt();if(t===0)return L();if(t>=1&&t<=P)switch(s[t]??"pending"){case"configuring":return J(t);case"processing":return rt(t);case"done":return nt(t);case"failed":return _t(t);case"skipped":return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:["Step ",t,": ",si[f[t-1]]?.name??f[t-1]]}),m.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[m.jsx(ho,{className:"h-4 w-4"}),m.jsx("span",{children:"This step was skipped."})]})]});default:return J(t)}return L()};return m.jsxs("div",{className:"flex h-full min-h-0",children:[M(),m.jsx("main",{className:"flex-1 overflow-y-auto",children:m.jsx("div",{className:"mx-auto max-w-2xl px-6 py-8",children:Et()})})]})}function HA(){const{currentView:f,currentToolId:t,setView:s}=zn(),n=je(d=>d.isExecuting),r=gh(d=>d.resolved==="dark"),[l,o]=B.useState(!1);B.useEffect(()=>{const d=()=>{const h=window.location.hash.replace("#","");h==="pipeline"?s("pipeline"):h?s("tool",h):s("grid")};return window.addEventListener("hashchange",d),()=>window.removeEventListener("hashchange",d)},[s]),B.useEffect(()=>{const d=h=>{const g=h.target;if(!(g.tagName==="INPUT"||g.tagName==="TEXTAREA"||g.isContentEditable)){if(h.key==="Escape"){if(l){o(!1);return}if(f!=="grid"){s("grid");return}}h.key==="?"&&(h.preventDefault(),o(b=>!b))}};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[f,s,l]);const u=B.useCallback(()=>{if(f==="grid")return m.jsx(Rd,{});if(f==="tool"&&t){const d=si[t];return d?m.jsxs("div",{className:"max-w-tool mx-auto",children:[m.jsxs("button",{onClick:()=>s("grid"),className:"flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 mb-4 focus-ring rounded-lg px-2 py-1",children:[m.jsx($d,{size:16}),m.jsx("span",{className:"text-sm",children:"Back to tools"})]}),m.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6",children:d.name}),d.component?m.jsx(jd,{children:m.jsx(d.component,{})}):m.jsxs("div",{className:"text-center py-20 text-gray-400 dark:text-gray-500",children:[m.jsx("p",{className:"text-lg",children:"Coming soon"}),m.jsx("p",{className:"text-sm mt-1",children:"This tool is not yet implemented."})]})]}):m.jsx(Rd,{})}return f==="pipeline"?n?m.jsx(jd,{children:m.jsx(UA,{})}):m.jsx(jd,{children:m.jsx(FA,{})}):m.jsx(Rd,{})},[f,t,s,n]);return m.jsxs(m.Fragment,{children:[m.jsx(EA,{onShowShortcuts:()=>o(!0),children:u()}),m.jsx(jA,{isOpen:l,onClose:()=>o(!1)}),m.jsx(Zw,{position:"top-right",toastOptions:{duration:4e3,style:{borderRadius:"8px",fontSize:"14px",background:r?"#1f2937":"#fff",color:r?"#f3f4f6":"#111827",border:r?"1px solid #374151":"none"}}})]})}Tv.createRoot(document.getElementById("root")).render(m.jsx(Dr.StrictMode,{children:m.jsx(HA,{})}));export{qA as a,fo as b,tn as c,Xd as g};
