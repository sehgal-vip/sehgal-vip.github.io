---
layout: page
title: Reading List
description: Papers, books, articles, and other things I've found valuable
permalink: /reading/
---

<div class="reading-list">
  <!-- Papers Section -->
  {% if site.data.reading_papers.size > 0 %}
  {% assign papers_by_year_temp = site.data.reading_papers | group_by: "year" %}
  {% assign papers_years = papers_by_year_temp | map: "name" | sort | reverse %}
  {% assign papers_by_author_temp = site.data.reading_papers | group_by: "author" %}
  {% assign papers_authors = papers_by_author_temp | map: "name" | sort %}
  <section class="collapsible-section" data-section="papers">
    <h2 class="section-title">
      <span class="section-icon">ðŸ“„</span>
      Papers
    </h2>
    <div class="section-filters" aria-label="Filter papers">
      <div class="filter-group">
        <button class="filter-toggle" data-filter="year" data-section="papers">
          <span class="filter-label">Year</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-year" data-section="papers">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for y in papers_years %}
          <label class="filter-option">
            <input type="checkbox" value="{{ y }}">
            <span>{{ y }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle" data-filter="author" data-section="papers">
          <span class="filter-label">Author</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-author" data-section="papers">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for a in papers_authors %}
          <label class="filter-option">
            <input type="checkbox" value="{{ a }}">
            <span>{{ a }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle sort-toggle" data-section="papers">
          <span class="filter-label">Sort</span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown sort-dropdown" data-section="papers">
          <label class="filter-option">
            <input type="radio" name="sort-papers" value="year" checked>
            <span>Year</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-papers" value="title-asc">
            <span>Title (A-Z)</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-papers" value="title-desc">
            <span>Title (Z-A)</span>
          </label>
          <button class="sort-apply-btn" data-section="papers">Apply</button>
        </div>
      </div>
    </div>
    
    {% assign papers_sorted = site.data.reading_papers | sort: "year" | reverse %}
    <table class="data-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Year</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for item in papers_sorted %}
        <tr data-year="{{ item.year }}" data-author="{{ item.author }}">
          <td class="title-cell">
            {% if item.url and item.url != "" %}
            <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer">{{ item.title }}</a>
            {% else %}
            {{ item.title }}
            {% endif %}
          </td>
          <td class="author-cell">{{ item.author }}</td>
          <td class="year-cell">{{ item.year }}</td>
          <td class="desc-cell">{{ item.description }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endif %}

  <!-- Books Section -->
  {% if site.data.reading_books.size > 0 %}
  {% assign books_by_year_temp = site.data.reading_books | group_by: "year" %}
  {% assign books_years = books_by_year_temp | map: "name" | sort | reverse %}
  {% assign books_by_author_temp = site.data.reading_books | group_by: "author" %}
  {% assign books_authors = books_by_author_temp | map: "name" | sort %}
  <section class="collapsible-section" data-section="books">
    <h2 class="section-title">
      <span class="section-icon">ðŸ“š</span>
      Books
    </h2>
    <div class="section-filters" aria-label="Filter books">
      <div class="filter-group">
        <button class="filter-toggle" data-filter="year" data-section="books">
          <span class="filter-label">Year</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-year" data-section="books">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for y in books_years %}
          <label class="filter-option">
            <input type="checkbox" value="{{ y }}">
            <span>{{ y }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle" data-filter="author" data-section="books">
          <span class="filter-label">Author</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-author" data-section="books">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for a in books_authors %}
          <label class="filter-option">
            <input type="checkbox" value="{{ a }}">
            <span>{{ a }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle sort-toggle" data-section="books">
          <span class="filter-label">Sort</span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown sort-dropdown" data-section="books">
          <label class="filter-option">
            <input type="radio" name="sort-books" value="year" checked>
            <span>Year</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-books" value="title-asc">
            <span>Title (A-Z)</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-books" value="title-desc">
            <span>Title (Z-A)</span>
          </label>
          <button class="sort-apply-btn" data-section="books">Apply</button>
        </div>
      </div>
    </div>
    
    {% assign books_sorted = site.data.reading_books | sort: "year" | reverse %}
    <table class="data-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Year</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for item in books_sorted %}
        <tr data-year="{{ item.year }}" data-author="{{ item.author }}">
          <td class="title-cell">
            {% if item.url and item.url != "" %}
            <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer">{{ item.title }}</a>
            {% else %}
            {{ item.title }}
            {% endif %}
          </td>
          <td class="author-cell">{{ item.author }}</td>
          <td class="year-cell">{{ item.year }}</td>
          <td class="desc-cell">{{ item.description }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endif %}

  <!-- Articles Section -->
  {% if site.data.reading_articles.size > 0 %}
  {% assign articles_by_year_temp = site.data.reading_articles | group_by: "year" %}
  {% assign articles_years = articles_by_year_temp | map: "name" | sort | reverse %}
  {% assign articles_by_author_temp = site.data.reading_articles | group_by: "author" %}
  {% assign articles_authors = articles_by_author_temp | map: "name" | sort %}
  <section class="collapsible-section" data-section="articles">
    <h2 class="section-title">
      <span class="section-icon">ðŸ“°</span>
      Articles
    </h2>
    <div class="section-filters" aria-label="Filter articles">
      <div class="filter-group">
        <button class="filter-toggle" data-filter="year" data-section="articles">
          <span class="filter-label">Year</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-year" data-section="articles">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for y in articles_years %}
          <label class="filter-option">
            <input type="checkbox" value="{{ y }}">
            <span>{{ y }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle" data-filter="author" data-section="articles">
          <span class="filter-label">Author</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-author" data-section="articles">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for a in articles_authors %}
          <label class="filter-option">
            <input type="checkbox" value="{{ a }}">
            <span>{{ a }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle sort-toggle" data-section="articles">
          <span class="filter-label">Sort</span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown sort-dropdown" data-section="articles">
          <label class="filter-option">
            <input type="radio" name="sort-articles" value="year" checked>
            <span>Year</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-articles" value="title-asc">
            <span>Title (A-Z)</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-articles" value="title-desc">
            <span>Title (Z-A)</span>
          </label>
          <button class="sort-apply-btn" data-section="articles">Apply</button>
        </div>
      </div>
    </div>
    
    {% assign articles_sorted = site.data.reading_articles | sort: "year" | reverse %}
    <table class="data-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Year</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for item in articles_sorted %}
        <tr data-year="{{ item.year }}" data-author="{{ item.author }}">
          <td class="title-cell">
            {% if item.url and item.url != "" %}
            <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer">{{ item.title }}</a>
            {% else %}
            {{ item.title }}
            {% endif %}
          </td>
          <td class="author-cell">{{ item.author }}</td>
          <td class="year-cell">{{ item.year }}</td>
          <td class="desc-cell">{{ item.description }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endif %}

  <!-- Others Section -->
  {% if site.data.reading_others.size > 0 %}
  {% assign others_by_year_temp = site.data.reading_others | group_by: "year" %}
  {% assign others_years = others_by_year_temp | map: "name" | sort | reverse %}
  {% assign others_by_author_temp = site.data.reading_others | group_by: "author" %}
  {% assign others_authors = others_by_author_temp | map: "name" | sort %}
  <section class="collapsible-section" data-section="others">
    <h2 class="section-title">
      <span class="section-icon">ðŸ”—</span>
      Others
    </h2>
    <div class="section-filters" aria-label="Filter others">
      <div class="filter-group">
        <button class="filter-toggle" data-filter="year" data-section="others">
          <span class="filter-label">Year</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-year" data-section="others">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for y in others_years %}
          <label class="filter-option">
            <input type="checkbox" value="{{ y }}">
            <span>{{ y }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle" data-filter="author" data-section="others">
          <span class="filter-label">Author</span>
          <span class="filter-selected-count"></span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown filter-author" data-section="others">
          <label class="filter-option">
            <input type="checkbox" value="all" checked>
            <span>All</span>
          </label>
          {% for a in others_authors %}
          <label class="filter-option">
            <input type="checkbox" value="{{ a }}">
            <span>{{ a }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      <div class="filter-group">
        <button class="filter-toggle sort-toggle" data-section="others">
          <span class="filter-label">Sort</span>
          <svg class="filter-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="filter-dropdown sort-dropdown" data-section="others">
          <label class="filter-option">
            <input type="radio" name="sort-others" value="year" checked>
            <span>Year</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-others" value="title-asc">
            <span>Title (A-Z)</span>
          </label>
          <label class="filter-option">
            <input type="radio" name="sort-others" value="title-desc">
            <span>Title (Z-A)</span>
          </label>
          <button class="sort-apply-btn" data-section="others">Apply</button>
        </div>
      </div>
    </div>
    
    {% assign others_sorted = site.data.reading_others | sort: "year" | reverse %}
    <table class="data-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Year</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {% for item in others_sorted %}
        <tr data-year="{{ item.year }}" data-author="{{ item.author }}">
          <td class="title-cell">
            {% if item.url and item.url != "" %}
            <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer">{{ item.title }}</a>
            {% else %}
            {{ item.title }}
            {% endif %}
          </td>
          <td class="author-cell">{{ item.author }}</td>
          <td class="year-cell">{{ item.year }}</td>
          <td class="desc-cell">{{ item.description }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Collapsible filter dropdowns
  const filterToggles = document.querySelectorAll('.filter-toggle');
  const filterDropdowns = document.querySelectorAll('.filter-dropdown');
  
  // Toggle dropdown visibility
  filterToggles.forEach(toggle => {
    toggle.addEventListener('click', function(e) {
      e.stopPropagation();
      const dropdown = this.nextElementSibling;
      const isOpen = dropdown.classList.contains('open');
      
      // Close all other dropdowns
      filterDropdowns.forEach(d => {
        if (d !== dropdown) {
          d.classList.remove('open');
          d.previousElementSibling.classList.remove('active');
        }
      });
      
      // Toggle current dropdown
      dropdown.classList.toggle('open', !isOpen);
      this.classList.toggle('active', !isOpen);
    });
  });
  
  // Close dropdowns when clicking outside
  document.addEventListener('click', function(e) {
    if (!e.target.closest('.filter-group')) {
      filterDropdowns.forEach(d => {
        d.classList.remove('open');
        d.previousElementSibling.classList.remove('active');
      });
    }
  });
  
  // Get selected values from checkboxes
  const getSelectedValues = (dropdown) => {
    const checkboxes = dropdown.querySelectorAll('input[type="checkbox"]:checked');
    return Array.from(checkboxes).map(cb => cb.value);
  };
  
  // Update selected count display
  const updateSelectedCount = (toggle, dropdown) => {
    const selected = getSelectedValues(dropdown);
    const count = selected.includes('all') ? 0 : selected.length;
    const countSpan = toggle.querySelector('.filter-selected-count');
    if (count > 0) {
      countSpan.textContent = `(${count})`;
    } else {
      countSpan.textContent = '';
    }
  };
  
  // Handle checkbox changes
  filterDropdowns.forEach(dropdown => {
    const checkboxes = dropdown.querySelectorAll('input[type="checkbox"]');
    const toggle = dropdown.previousElementSibling;
    
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const allCheckbox = dropdown.querySelector('input[type="checkbox"][value="all"]');
        
        if (this.value === 'all') {
          // If "All" is checked, uncheck all others
          if (this.checked) {
            checkboxes.forEach(cb => {
              if (cb !== this) cb.checked = false;
            });
          }
        } else {
          // If any other option is checked, uncheck "All"
          if (this.checked) {
            allCheckbox.checked = false;
          }
          
          // If nothing is selected, check "All"
          const hasSelection = Array.from(checkboxes).some(cb => cb !== allCheckbox && cb.checked);
          if (!hasSelection) {
            allCheckbox.checked = true;
          }
        }
        
        updateSelectedCount(toggle, dropdown);
        applyFilters();
      });
    });
    
    // Initial count update
    updateSelectedCount(toggle, dropdown);
  });
  
  // Filtering per section
  const sections = document.querySelectorAll('.collapsible-section');
  
  const applyFilters = () => {
    sections.forEach(section => {
      const yearDropdown = section.querySelector('.filter-year');
      const authorDropdown = section.querySelector('.filter-author');
      const table = section.querySelector('.data-table');
      
      if (!table) return;
      
      const selectedYears = yearDropdown ? getSelectedValues(yearDropdown) : ['all'];
      const selectedAuthors = authorDropdown ? getSelectedValues(authorDropdown) : ['all'];
      
      const rows = table.querySelectorAll('tbody tr');
      let visibleRows = 0;
      
      rows.forEach(row => {
        const rowYear = row.getAttribute('data-year');
        const rowAuthor = row.getAttribute('data-author');
        const matchYear = selectedYears.includes('all') || selectedYears.includes(rowYear);
        const matchAuthor = selectedAuthors.includes('all') || selectedAuthors.includes(rowAuthor);
        const shouldShow = matchYear && matchAuthor;
        row.style.display = shouldShow ? '' : 'none';
        if (shouldShow) visibleRows++;
      });
      
      // Hide table if no rows match
      table.style.display = visibleRows > 0 ? '' : 'none';
    });
  };
  
  // Store sort state for each section
  const sortState = {};
  
  // Sorting functionality - completely independent of filters
  const applySort = (section) => {
    console.log('applySort called with section:', section);
    
    const dropdown = document.querySelector(`.sort-dropdown[data-section="${section}"]`);
    const sectionElement = document.querySelector(`.collapsible-section[data-section="${section}"]`);
    const table = sectionElement ? sectionElement.querySelector('.data-table') : null;
    
    console.log('Sort elements found:', { 
      dropdown: !!dropdown, 
      sectionElement: !!sectionElement, 
      table: !!table,
      section 
    });
    
    if (!dropdown || !table) {
      console.error('Sort: Dropdown or table not found', { dropdown, table, section, sectionElement });
      alert(`Sort error: Could not find dropdown or table for section "${section}". Check console for details.`);
      return;
    }
    
    const selectedRadio = dropdown.querySelector('input[type="radio"]:checked');
    if (!selectedRadio) {
      console.error('Sort: No radio button selected');
      return;
    }
    
    const tbody = table.querySelector('tbody');
    if (!tbody) {
      console.error('Sort: tbody not found');
      return;
    }
    
    // Get ALL rows, including hidden ones - sort operates on all data
    const rows = Array.from(tbody.querySelectorAll('tr'));
    if (rows.length === 0) {
      console.error('Sort: No rows found');
      return;
    }
    
    const sortType = selectedRadio.value;
    console.log('Applying sort:', { section, sortType, rowCount: rows.length });
    
    // Store sort state for this section
    sortState[section] = sortType;
    
    // Store current display states before sorting
    const displayStatesMap = new Map();
    rows.forEach(row => {
      displayStatesMap.set(row, row.style.display);
    });
    
    // Sort rows based on selected option
    rows.sort((a, b) => {
      if (sortType === 'year') {
        const yearA = parseInt(a.getAttribute('data-year')) || 0;
        const yearB = parseInt(b.getAttribute('data-year')) || 0;
        return yearB - yearA; // Descending (newest first)
      } else if (sortType === 'title-asc') {
        const titleCellA = a.querySelector('.title-cell');
        const titleCellB = b.querySelector('.title-cell');
        if (!titleCellA || !titleCellB) return 0;
        const titleA = titleCellA.textContent.trim().toLowerCase();
        const titleB = titleCellB.textContent.trim().toLowerCase();
        return titleA.localeCompare(titleB);
      } else if (sortType === 'title-desc') {
        const titleCellA = a.querySelector('.title-cell');
        const titleCellB = b.querySelector('.title-cell');
        if (!titleCellA || !titleCellB) return 0;
        const titleA = titleCellA.textContent.trim().toLowerCase();
        const titleB = titleCellB.textContent.trim().toLowerCase();
        return titleB.localeCompare(titleA);
      }
      return 0;
    });
    
    // IMPORTANT: We need to physically reorder rows in the DOM
    // Create a document fragment to hold sorted rows
    const fragment = document.createDocumentFragment();
    
    // Add sorted rows to fragment with preserved display states
    // appendChild automatically removes the node from its current parent
    rows.forEach(row => {
      const savedDisplay = displayStatesMap.get(row) || '';
      // Remove row from current parent (tbody) and add to fragment
      fragment.appendChild(row);
      // Restore display state after moving
      row.style.display = savedDisplay;
    });
    
    // Now append the fragment to tbody
    // This moves all rows from fragment to tbody in sorted order
    tbody.appendChild(fragment);
    
    console.log('Sort applied, rows reordered. New order:', 
      Array.from(tbody.querySelectorAll('tr')).map(r => {
        const title = r.querySelector('.title-cell')?.textContent.trim() || 'no title';
        const year = r.getAttribute('data-year') || 'no year';
        return `${title} (${year})`;
      })
    );
    
    // Reapply filters to show/hide rows based on current filter state
    // This doesn't change the sort order, just visibility
    // Use setTimeout to ensure DOM is updated first
    setTimeout(() => {
      applyFilters();
    }, 0);
  };
  
  // Initial filter application
  applyFilters();
  
  // Add Apply button click handlers - use event delegation for reliability
  document.addEventListener('click', function(e) {
    // Check if clicked element is a sort apply button or inside one
    const applyBtn = e.target.closest('.sort-apply-btn');
    if (!applyBtn) return;
    
    e.stopPropagation();
    e.preventDefault();
    
    const section = applyBtn.getAttribute('data-section');
    if (!section) {
      console.error('Apply button has no data-section attribute');
      return;
    }
    
    console.log('Apply button clicked for section:', section);
    
    // Apply the sort
    try {
      applySort(section);
    } catch (error) {
      console.error('Error applying sort:', error);
      return;
    }
    
    // Close the dropdown
    const dropdown = applyBtn.closest('.sort-dropdown');
    if (dropdown) {
      dropdown.classList.remove('open');
      const toggle = dropdown.previousElementSibling;
      if (toggle && toggle.classList.contains('filter-toggle')) {
        toggle.classList.remove('active');
      }
    }
  });
  
  // Also log how many buttons were found for debugging
  const applyButtons = document.querySelectorAll('.sort-apply-btn');
  console.log('Found sort apply buttons:', applyButtons.length);
  applyButtons.forEach((btn, index) => {
    const section = btn.getAttribute('data-section');
    console.log(`Button ${index}: section="${section}"`);
  });
});
</script>
